try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},d=(new e.Error).stack;d&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[d]="352ffeb5-77b5-4ae9-aad9-f621c4dcfd82",e._sentryDebugIdIdentifier="sentry-dbid-352ffeb5-77b5-4ae9-aad9-f621c4dcfd82")}catch(e){}("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:{}).SENTRY_RELEASE={id:"6f1faf434b0a85eb183c91391b598f364a828f27"};(self.webpackChunkcloud_frontend=self.webpackChunkcloud_frontend||[]).push([[2003],{92003:(e,d,a)=>{a.r(d),a.d(d,{Dropdown:()=>R,default:()=>B});var t=a(96540),r=a(33185),o=a(65258),n=a(43375),s=a(60602),i=a(29263),l=a(32788),c=a(41579),u=a(67294),h=a(92726),p=a(55093),b=a(15524),g=a(74848);const f=e=>(0,r.keyframes)(["from{border-color:",";border-width:2px;}to{border-color:",";border-width:1px;}"],(0,o.getColor)("primary")(e),(0,o.getColor)("textLite")(e)),m=(0,r.default)(o.Flex).withConfig({displayName:"dropArea__AnimatedFlex",componentId:"sc-vs4sjk-0"})(["animation:",";"],(e=>{let{animate:d}=e;return d?(0,r.css)([""," 0.15s linear infinite"],f):""})),x={},w=(0,t.memo)((e=>{let{item:d=x,itemProps:a=x}=e;const{id:t,name:r,isNew:s}=d,{overDashboardId:i}=a,{setNodeRef:l,isOver:c,over:u}=(0,n.zM)({id:t,data:{droppable:!0,dropArea:!0,dashboardId:t,onlyPointerWithin:!0}}),{processing:p,loading:b}=(0,h.fz)(t),f=p||b;return(0,g.jsx)(o.Flex,{padding:[2],flex:!0,background:i===t&&"successSemi",children:(0,g.jsx)(m,{alignItems:"center",justifyContent:"center",padding:[2],border:{side:"all",type:"dashed",color:c?"primary":"textLite"},round:!0,ref:l,width:"100%",height:15,animate:u?.id===t&&i!==t,children:f?(0,g.jsx)(o.Text,{color:"textLite",children:"Loading..."}):(0,g.jsxs)(o.TextBig,{color:i===t?"successText":"text",children:[s?"":(0,g.jsx)(g.Fragment,{children:"Add in "}),(0,g.jsx)(o.TextBig,{strong:!0,color:s?"primary":i===t?"successText":"text",children:r})]})})})})),y=((0,r.default)(o.Drop).attrs({align:{top:"bottom",left:"left"},animation:!0,backdrop:!0,column:!0,padding:[2,0],background:"dropdown",round:1,overflow:{vertical:"auto"},margin:[.5,0,0],width:30}).withConfig({displayName:"list__Dropdown",componentId:"sc-s8yppy-0"})([""]),(0,t.memo)((e=>{let{dashboards:d,selected:a,setSelected:t,itemProps:r}=e;const n=(0,b.A)();return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(w,{item:{id:"new",name:"Create a new dashboard",isNew:!0},itemProps:r}),(0,g.jsx)(o.MenuDropdown,{items:d,Item:w,value:a,hasSearch:!1,onItemClick:t,hideShadow:!0,itemProps:r,overflow:"hidden",ref:n})]})})));var D=a(97799),I=a(24609),v=a(19186),j=a(45706),A=a(15920),C=a(19371),k=a(63872),S=a(47090),_=a(3319),T=a(28864),F=a(5907),L=a(79748),N=a(52795),E=a(44245);const M=e=>{let{onDone:d}=e;const a=(0,A.Zp)(),r=(0,I.vt)(),o=(0,v.ID)(),n=(0,I.ns)(r,"slug"),s=(0,v.wz)(o,"slug"),i=(0,C.eg)(),[l,c]=(0,k.A)(),{sendLog:u}=(0,_.A)(),h=(0,E.tV)(),p=(0,T.DH)(null,{onSuccess:e=>{h({title:e.slug,id:e.id,destination:e.slug,type:"dashboards",droppable:!0,droppableProps:{dashboardId:e.id,dropArea:!0}}),l({header:"Added",text:(0,g.jsxs)(g.Fragment,{children:["Chart added in"," ",(0,g.jsx)(L.A,{as:"a",strong:!0,onClick:()=>a(`/spaces/${n}/rooms/${s}/dashboards/${e.slug}`),children:e.name})," ","dashboard."]})}),setTimeout((()=>d()),2e3),u({feature:"drag-in-dashboard",isSuccess:!0})},onFail:e=>{const a=e?.response?.data,t=(0,S.o)(a?.errorMsgKey)||a?.errorMessage||"Something went wrong";c({message:t}),d(),u({feature:"drag-in-dashboard",isFailure:!0,message:t})}}),b=(0,F.nM)(),f=(0,F.Dn)(r,o);return(0,t.useCallback)(((e,d)=>{const a=i.getNode({id:d?.itemId}),t=(0,N.h)(a.getAttributes());"new"!==e?b(t.contextScope,{...t,dashboardId:e,itemLayout:d},(()=>p(e))):f({name:"[Untitled]"},(e=>{b(t.contextScope,{...t,dashboardId:e.id,itemLayout:d},(()=>p(e.id)))}))}),[f,b])},P=(0,r.default)(o.Flex).attrs({background:"mainBackground",padding:[2],overflow:"auto",height:"80%",width:"600px"}).withConfig({displayName:"dropDashboard__ScaledDownContainer",componentId:"sc-zd7fpn-0"})(["box-shadow:0 0 0 1px rgba(63,63,68,0.05),-1px 0 15px 0 rgba(34,33,81,0.01),0px 15px 15px 0 rgba(34,33,81,0.25);"]),z=e=>{let{id:d,setOverDashboard:a}=e;const t=(0,I.vt)(),r=(0,v.ID)(),n=(0,I.ns)(t,"slug"),s=(0,v.wz)(r,"slug"),i=(0,j.A)(d,{spaceId:t,spaceSlug:n,roomId:r,roomSlug:s}),l=M({onDone:a});return d?(0,g.jsx)(o.Flex,{flex:!0,width:"100%",height:"100%",alignItems:"center",justifyContent:"center",children:(0,g.jsx)(P,{children:i?(0,g.jsx)(p.A,{title:"Loading dashboard..."}):(0,g.jsx)(D.A,{id:d,containerWidth:600,trashable:!1,containerDndProps:{droppable:!0},onDragEnd:(e,t)=>{if(!t)return a();l(d,t)}})})}):null},R=(0,r.default)(o.Flex).attrs({column:!0,background:"dropdown",width:{max:"auto",min:100,base:100}}).withConfig({displayName:"dropInDashboard__Dropdown",componentId:"sc-12fd9r3-0"})(["box-shadow:0 0 0 1px rgba(63,63,68,0.05),-1px 0 15px 0 rgba(34,33,81,0.01),0px 15px 15px 0 rgba(34,33,81,0.25);"]),B=()=>{const[e,d]=(0,t.useState)(),[a,r]=(0,t.useState)();(0,c.A)();const b=(0,u.q)();let f=(0,h.Sf)(b);f=(0,t.useMemo)((()=>[...f].sort(((e,d)=>new Date(e.updatedAt)<new Date(d.updatedAt)?1:-1))),[b]);const m=(0,u.RQ)(),x=(0,s.A)(a?.id,500),w=M({onDone:r});(0,n.E5)({onDragMove:e=>{let{active:d,over:a}=e;if(a?.id&&d&&d.data.current)if(a.data.current.dropinDashboards&&d.data.current.dashboardable)r((e=>e||{active:d,dropinDashboards:!0}));else if(a.data.current.dashboardId&&d.data.current.dashboardable){if("new"===a.data.current.dashboardId)return;r((e=>e&&e?.id===a.data.current.dashboardId?e:{...e,id:a.data.current.dashboardId,active:d}))}},onDragEnd:e=>{let{active:d,over:a}=e;a?.id&&d&&d.data.current&&(a.data.current.dashboardId&&d.data.current.dashboardable?w(a.data.current.dashboardId,d.data.current):setTimeout((()=>r()),1e3))},onDragCancel:()=>{r()}});const D=(0,t.useMemo)((()=>({overDashboardId:x})),[x]);if(!a?.active)return null;const{isItem:I,isContainer:v,dashboardable:j}=a.active.data.current;return j&&(I||v)?(0,g.jsxs)(o.Layer,{position:"right",full:!0,backdrop:!0,shadow:!0,justifyContent:"end",children:[(0,g.jsx)(z,{id:x,setOverDashboard:r}),a?.dropinDashboards&&(0,g.jsxs)(R,{children:[(0,g.jsx)(i.z,{title:"Drop in a dashboard",onClose:()=>r()}),(0,g.jsx)(l.Yv,{gap:2,height:"100%",overflow:"hidden",background:"dropdown",children:m?(0,g.jsx)(y,{dashboards:f,selected:e,setSelected:d,itemProps:D}):(0,g.jsx)(p.A,{title:"Loading dashboards..."})})]})]}):null}}}]);