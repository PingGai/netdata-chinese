try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ce00278e-6ef2-48ba-bd57-eb064d0a7e98",e._sentryDebugIdIdentifier="sentry-dbid-ce00278e-6ef2-48ba-bd57-eb064d0a7e98")}catch(e){}("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:{}).SENTRY_RELEASE={id:"6f1faf434b0a85eb183c91391b598f364a828f27"};(self.webpackChunkcloud_frontend=self.webpackChunkcloud_frontend||[]).push([[4142],{4142:(e,t,n)=>{n.d(t,{A:()=>b});var i=n(96540),r=n(65258),a=n(21996),s=(n(98992),n(81454),n(79997)),o=n(43252),c=n(74848);const l="Something went wrong",d=e=>{let{message:t=l}=e;return(0,c.jsx)(r.Flex,{"data-testid":"insights-investigation-chat-item-error",children:(0,c.jsx)(s.qm,{children:(0,c.jsxs)(r.TextBig,{color:"error",children:["Error: ",t]})})})},u=e=>{let{type:t,question:n,response:a,error:u}=e;const{message:p}=(0,i.useMemo)((()=>(e=>e?"string"===typeof e?{message:e}:{message:e.response?.data?.errorMessage||e?.message||l}:{})(u)),[u]);return t===o.$p.error?(0,c.jsx)(d,{message:p}):(0,c.jsxs)(r.Flex,{column:!0,gap:2,children:[n?(0,c.jsx)(r.Flex,{"data-testid":"insights-investigation-chat-item-question",children:(0,c.jsx)(s.qm,{children:(0,c.jsx)(r.TextBig,{children:n})})}):null,a?(0,c.jsx)(r.Flex,{justifyContent:"end","data-testid":"insights-investigation-chat-item-response",children:(0,c.jsx)(s.qm,{background:"inputBg",children:(0,c.jsx)(r.TextBig,{children:a})})}):null]})},p=function(){let{chat:e=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=(0,i.useRef)();return(0,i.useEffect)((()=>{t?.current&&t.current.scrollIntoView({behavior:"smooth"})}),[e,t?.current]),(0,c.jsxs)(c.Fragment,{children:[e.map((e=>(0,c.jsx)(u,{...e},e.id))),(0,c.jsx)("div",{ref:t})]})};const m=(0,n(33185).default)(r.Flex).attrs((e=>({alignItems:"start",gap:2,cursor:"pointer",...e}))).withConfig({displayName:"item__ItemContainer",componentId:"sc-4utsmr-0"})(["&:hover{span{text-decoration:underline;}}"]),h=e=>{let{id:t,title:n,onClick:a}=e;const s=(0,i.useCallback)((()=>{"function"===typeof a&&a({id:t})}),[t,a]);return(0,c.jsxs)(m,{onClick:s,children:[(0,c.jsx)(r.Flex,{padding:[1,0,0,0],children:(0,c.jsx)(r.Icon,{name:"chevron_left",rotate:2,color:"primary"})}),(0,c.jsx)(r.TextBig,{children:n})]})},f=e=>{let{title:t,items:n=[],onItemClick:i}=e;return(0,c.jsxs)(r.Flex,{column:!0,gap:4,padding:[4],round:2,border:{side:"all",color:"border"},children:[(0,c.jsx)(r.TextBigger,{strong:!0,children:t}),(0,c.jsx)(r.Flex,{column:!0,gap:2,children:n.map((e=>(0,c.jsx)(h,{onClick:i,...e},e.id)))})]})};var g=n(55744);const y=e=>{let{isNarrow:t,onItemClick:n}=e;return(0,c.jsxs)(r.Flex,{column:!0,gap:4,padding:[0,4],children:[(0,c.jsxs)(r.Flex,{column:!0,gap:2,children:[(0,c.jsx)(r.H4,{children:"Start a New Investigation"}),(0,c.jsx)(r.TextBig,{color:"textLite",children:"These examples provide starting templates\u2014customize them with your specific context. Netdata understands any investigation query, not just these categories."})]}),(0,c.jsx)(r.Flex,{column:t,gap:4,children:g.K.map((e=>(0,c.jsx)(f,{onItemClick:n,...e},e.id)))})]})};var x=n(5310);const v=(0,n(74891).A)(r.Flex),b=e=>{let{flavour:t,variables:n,parentRef:l}=e;const d=(0,i.useRef)(),u=t===o.Rh.troubleshooter,{isLoading:m,chat:h,submitButtonToootip:f,canSubmit:g,textValue:b,textPlaceHolder:w,textMaxLength:k,onTextChange:C,onTextBlur:I,onKeyDown:j,onSubmit:S,onExampleItemClick:A}=(0,x.A)({flavour:t,variables:n,textRef:d,parentRef:l});return(0,c.jsxs)(r.Flex,{column:!0,gap:14,...u?{}:{alignItems:"center"},children:[(0,c.jsxs)(r.Flex,{"data-testid":"insights-investigation-container",width:{base:"500px"},alignItems:"center",justifyContent:h.length?"between":"center",column:!0,gap:2,padding:[2,0,0,0],children:[h.length?(0,c.jsx)(r.Flex,{"data-testid":"insights-investigation-chat-container",width:"100%",height:"calc(100vh - 550px)",overflow:{vertical:"auto"},column:!0,gap:2,padding:[2,2,2,0],children:(0,c.jsx)(p,{chat:h})}):null,(0,c.jsx)(r.Flex,{"data-testid":"insights-investigation-prompt-container",width:"100%",column:!0,gap:4,alignItems:"center",justifyContent:"center",children:(0,c.jsxs)(r.Flex,{"data-testid":"insights-investigation-prompt-input-container",width:"100%",position:"relative",children:[(0,c.jsx)(a.A,{ref:d,tabIndex:"0","data-testid":"insights-investigation-prompt-input",width:"100%",maxLength:k,rows:3,placeholder:w,value:b,onChange:C,onBlur:I,onKeyDown:j,autoFocus:"autofocus",disabled:m,round:"8px"}),(0,c.jsx)(v,{tooltip:f,position:"absolute",right:"-45px",top:"50%",style:{transform:"translateY(-50%)"},children:(0,c.jsx)(r.Button,{onClick:S,round:"50%",disabled:!g||m,children:(0,c.jsx)(r.Flex,{width:"19px",height:"19px",alignItems:"center",justifyContent:"center",children:(0,c.jsx)(s.AQ,{isBlinking:m,name:"arrow_s_down",rotate:2})})})})]})})]}),h.length?null:(0,c.jsx)(y,{isNarrow:u,onItemClick:A})]})}},5310:(e,t,n)=>{n.d(t,{A:()=>h,u:()=>m});n(98992),n(54520),n(72577),n(81454),n(37550);var i=n(96540),r=n(81685),a=n(2356),s=n(43252),o=n(55744),c=n(25279);const l=e=>{let{state:t,query:n,variableIds:i}=e;return t&&n?t.clarificationId?(n.variables.find((e=>{let{id:t}=e;return t===i.clarifications}))?.value||[]).map((e=>e.id===t.clarificationId?{...e,response:t.textValue}:e)):t.textValue:""},d=e=>({id:(0,c.A)(),type:s.$p.response,response:e.textValue}),u=e=>{let{query:t,variableIds:n}=e;return{...t,variables:t.variables.filter((e=>!(e.id===n.clarifications&&!Array.isArray(e.value))))}},p=()=>!1,m={textValue:"",textPlaceHolder:"Describe your investigation. Include context like when it started, what changed, impact, and what you've already tried...",variableId:s.Vs.reportDescription,clarificationId:null,clarifications:[],chat:[],error:null},h=e=>{let{flavour:t=s.Rh.default,variables:n,textRef:h,parentRef:f}=e;const{query:g,onVariableChange:y}=(0,r.g0)(),[,x]=(0,r.W5)(),[v,b]=(0,i.useState)(m),{textValue:w,textPlaceHolder:k,chat:C}=v,I=(0,i.useCallback)((()=>{b((e=>({...e,textValue:m.textValue})))}),[m,b]),j=(0,i.useCallback)((()=>{h?.current&&h.current.focus(),x(),I()}),[t,h,x,I]),S=(0,i.useCallback)((e=>{const t=e?.response?.status;if(422===t){const t=e?.response?.data?.details?.clarification_questions;Array.isArray(t)&&(b((e=>{const n=t.filter((t=>!e.clarifications.map((e=>{let{id:t}=e;return t})).includes(t.id)));return{...e,variableId:s.Vs.clarifications,textPlaceHolder:"Type your answer",clarificationId:n[0]?.id,clarifications:[...e.clarifications,...n],chat:[...e.chat,n[0]]}})),I())}else b((t=>({...t,chat:[...t.chat,{id:(0,c.A)(),type:s.$p.error,error:e}]})));h?.current&&h.current.focus()}),[h,b,I]),{isLoading:A,onGenerate:T}=(0,a.J)({query:u({query:g,variableIds:s.Vs}),onSuccess:j,onError:S,checkErrorNotification:p}),{maxLength:B}=(0,i.useMemo)((()=>n.find((e=>{let{id:t}=e;return t===s.Vs.reportDescription}))),[n]),{items:V}=(0,i.useMemo)((()=>n.find((e=>{let{id:t}=e;return t===s.Vs.clarifications}))),[n]),F=(0,i.useMemo)((()=>V?.properties?.find((e=>{let{id:t}=e;return"response"===t}))?.max_length||1e3),[V]),M=(0,i.useMemo)((()=>v.clarificationId?F||s.Gt:B||s.Gt),[v,B,F]),R=(0,i.useMemo)((()=>v.clarifications.some((e=>{let{response:t}=e;return!t}))),[v]),P=(0,i.useMemo)((()=>v.clarifications.map((e=>{let{id:t}=e;return t})).indexOf(v.clarificationId)===v.clarifications.length-1),[v]),q=(0,i.useMemo)((()=>A?"Loading...":w?.length?null:"Please type something"),[A,w]),_=(0,i.useMemo)((()=>!!w?.length),[w]),D=(0,i.useCallback)((e=>{b((t=>({...t,textValue:e})))}),[b]),z=(0,i.useCallback)((()=>{const e=l({state:v,query:g,variableIds:s.Vs});y({id:v.variableId,value:e})}),[v,g,y]),L=(0,i.useCallback)((e=>{if(R){const{clarificationId:e,clarifications:t,pendingClarification:n}=(e=>{let t=e.clarificationId;const n=e.clarifications.map(((n,i)=>n.id===e.clarificationId?(t=e.clarifications[i+1]?.id,{...n,response:e.textValue}):n)),i=n.find((e=>{let{response:t}=e;return!t}));return{clarificationId:t,clarifications:n,pendingClarification:i}})(v);if(P){const e={...g,variables:g.variables.map((e=>e.id===s.Vs.clarifications?{...e,value:t}:e))};b((e=>({...e,chat:[...e.chat,d(e)]}))),T(e)}else b((i=>({...i,textValue:m.textValue,clarificationId:e,clarifications:t,chat:[...i.chat,d(i),n]})))}else b((e=>({...e,chat:[...e.chat,d(e)]}))),T(e)}),[v,m,g,R,P,T]),N=(0,i.useCallback)((()=>{_&&L()}),[_,L]),W=(0,i.useCallback)((e=>{if("Enter"===e.key&&_){e.preventDefault(),v.variableId===s.Vs.reportDescription&&y({id:v.variableId,value:v.textValue});const t=l({state:v,query:g,variableIds:s.Vs}),n={...g,variables:g.variables.map((e=>e.id===v.variableId?{...e,value:t}:e))};L(u({query:n,variableIds:s.Vs}))}}),[v,g,_,y,L]),E=(0,i.useCallback)((e=>{let{id:t}=e;const n=(e=>o.K.map((e=>[...e.items])).flat().find((t=>t.id===e)))(t);n&&(b((e=>({...e,textValue:n.content}))),y({id:s.Vs.reportDescription,value:n.content}),f?.current&&f.current.scrollTo({top:0,behavior:"smooth"}))}),[b,y,f]);return{isLoading:A,chat:C,submitButtonToootip:q,canSubmit:_,textValue:w,textPlaceHolder:k,textMaxLength:M,onTextChange:D,onTextBlur:z,onKeyDown:W,onSubmit:N,onExampleItemClick:E}}},55744:(e,t,n)=>{n.d(t,{K:()=>i});const i=[{id:"troubleshoot-problem",title:"Troubleshoot a problem",items:[{id:"checkout-pods-crashing",title:"Why are my checkout-service pods crashing repeatedly?",content:'Why are my checkout-service pods crashing repeatedly?\n\nContext:\n- Started after: [deployment at 14:00 UTC of version 2.3.1]\n- Impact: [Customer checkout failures, lost revenue ~$X/hour]\n- Recent changes: [Updated payment gateway integration, increased worker threads from 10 to 20]\n- Error pattern in logs: ["connection refused to payment-service:8080", "Java heap space"]\n\nEnvironment: production / eks-prod-us-east-1\nRelated services: payment-service, inventory-service, redis-session-store'},{id:"root-cause-increased-5xx-errors",title:"Find root cause of increased 5xx errors in API gateway",content:'Find root cause of increased 5xx errors in API gateway\n\nweb_log_1m_unmatched and web_log_1m_bad_requests are spiking. Context:\n- Affected endpoints: [/api/v2/checkout, /api/v2/inventory/check]\n- Started when: [Right after payments-service v1.5.0 deployment]\n- External factors: [Marketing campaign launched, 3x normal traffic, new payment provider integration went live]\n- Customer impact: [Cart abandonment up 40%, support tickets about "payment errors"]'},{id:"high-memory-usage",title:"What's causing high memory usage on node web-prod-03?",content:"What's causing high memory usage on node web-prod-03?\n\nThe system.ram utilization alert triggered. Additional context:\n- Recent changes: [Deployed new caching strategy, increased Node.js heap size to 4GB]\n- This node runs: [customer-facing API, websocket connections for live chat]\n- Business impact: [Customer complaints about slow page loads, chat disconnections]\n- Different from other nodes because: [Only node running the legacy monolith alongside microservices]"},{id:"microservices-causing-latency",title:"Which microservices are causing latency in user requests?",content:'Which microservices are causing latency in user requests?\n\nUser experience context:\n- Customer complaints: [Mobile app "freezing" during checkout, web pages taking 5+ seconds to load]\n- Started: [After microservices migration last week]\n- Critical user journeys affected: [Login \u2192 Browse \u2192 Add to Cart \u2192 Checkout]\n\nArchitecture context:\n- Total microservices: [23 services in production]\n- Recent changes: [Split monolith into user, catalog, and order services]\n- Service mesh: [Using Istio with mTLS enabled]\n- Tracing: [Jaeger deployed but only 10% sampling]\n\nSpecific issues observed:\n- [Cascading timeouts during peak hours]\n- [Checkout service calling 7 different services synchronously]\n- [No circuit breakers implemented yet]\n\nBusiness impact: [Cart abandonment up 25%, mobile app store rating dropped to 3.2 stars]'}]},{id:"analyze-change",title:"Analyze a change",items:[{id:"compare-system-metrics",title:"Compare system metrics before and after recent deployment",content:"Compare system metrics before and after recent deployment\n\nDeployment details:\n- Service: user-authentication-service v2.2.0\n- Deployed: 2025-01-24 09:00 UTC\n- Changes: [Switched from JWT to Redis sessions, added Argon2 password hashing, implemented rate limiting]\n\nSpecific concerns:\n- [Users reporting intermittent logouts]\n- [Session persistence issues after pod restarts]\n- [Suspicious increase in redis_connected_clients]\n\nTime windows: 24h before deployment vs 24h after"},{id:"redis-affect-cache-performance",title:"How did the Redis upgrade affect cache performance?",content:"How did the Redis upgrade affect cache performance?\n\nUpgrade: Redis 6.2.7 \u2192 7.2.0 on 2025-01-22 02:00 UTC\n\nBusiness context:\n- [Product catalog cache serving Black Friday traffic prep]\n- [Concerns about new Redis features overhead]\n- [Need to validate investment in upgrade was worthwhile]\n\nSpecific checks needed:\n- Impact on our Node.js connection pooling\n- Whether new eviction policies are better for our use case\n- Any compatibility issues with our caching library"},{id:"impact-of-scaling-from-3-to-5",title:"Show impact of scaling from 3 to 5 replicas on user-service",content:"Show impact of scaling from 3 to 5 replicas on user-service\n\nScaling event: 2025-01-23 15:00 UTC (HPA triggered by cpu.utilization > 80%)\n\nBusiness context:\n- [New feature launch driving 30% more traffic]\n- [Customer complaints about slow profile pages]\n- [Preparing for Super Bowl Sunday traffic spike]\n\nSpecific concerns:\n- [Database connection pool exhaustion errors in logs]\n- [Uneven load distribution despite round-robin LB]\n- [Session affinity issues after scaling]"},{id:"what-changed-in-network-traffic-patterns-this-week",title:"What changed in network traffic patterns this week?",content:"What changed in network traffic patterns this week?\n\nContext for unusual patterns:\n- [Launched new mobile app on Tuesday]\n- [CDN configuration changed Thursday - moved static assets to new domain]\n- [Office VPN migration might be affecting internal traffic]\n- [New customer in Asia significantly increasing APAC traffic]\n\nSpecific concerns:\n- [20% increase in AWS bandwidth costs]\n- [European users reporting latency issues]\n- [Suspicious traffic spike from specific IP ranges]\n\nInfrastructure: AWS multi-region with Istio service mesh"}]},{id:"optimize-performance",title:"Optimize performance",items:[{id:"additional-resources",title:"Which services would benefit most from additional resources?",content:"Which services would benefit most from additional resources?\n\nBusiness context:\n- Budget: [Additional $5K/month approved for scaling]\n- Growth: [20% MoM traffic increase, Black Friday prep needed]\n- New features coming: [Real-time inventory, ML-based recommendations]\n\nCurrent pain points:\n- [Payment service timeouts during flash sales]\n- [Search service degradation when catalog updates run]\n- [Batch processing jobs failing due to OOM kills]\n\nSLA requirements:\n- API 95th percentile < 200ms\n- Search results < 500ms\n- Payment processing < 2s\n\nHelp prioritize which services to scale first for maximum business impact."},{id:"identify-underutilized-nodes-for-cost-optimization",title:"Identify underutilized nodes for cost optimization",content:"Identify underutilized nodes for cost optimization\n\nContext:\n- Monthly AWS bill: [$12K for compute]\n- Environment: Mixed workloads (prod + staging on same cluster)\n- Constraints: [Need 2 nodes per AZ for HA, GPU nodes must stay for ML workloads]\n\nKnown issues:\n- [Dev environments running 24/7 but only used 9-5]\n- [Batch processing nodes idle 20h/day]\n- [Overprovisioned after last Black Friday, traffic never reached expected levels]\n\nGoal: Find $2-3K/month in savings without impacting reliability"},{id:"analyze-container-resource-limits-vs-actual-usage",title:"Analyze container resource limits vs actual usage",content:"Analyze container resource limits vs actual usage\n\nCurrent state:\n- Total pods: [150 across production]\n- Resource requests/limits set: [Only 60% have proper limits defined]\n- Recent OOMKills: [12 in the last week]\n\nProblem indicators:\n- [Some pods using 10% of requested resources (overprovisioned)]\n- [Others constantly hitting CPU throttling]\n- [Memory limits based on old load tests from 2023]\n- [Java apps with -Xmx not aligned with container limits]\n\nBusiness impact:\n- [Wasting ~$3K/month on overprovisioned resources]\n- [Critical services getting throttled during peak hours]\n- [Unpredictable performance affecting SLAs]\n\nRecent changes:\n- [Migrated from VMs to containers 6 months ago]\n- [Copied VM resource allocations without optimization]\n- [Traffic patterns changed significantly after new feature launch]\n\nGoal: Right-size all containers for optimal performance and cost"},{id:"predict-capacity-needs-for-black-friday-traffic",title:"Predict capacity needs for Black Friday traffic",content:"Predict capacity needs for Black Friday traffic\n\nLast year's data:\n- Peak: 50K concurrent users, 2K orders/minute\n- Growth rate: 40% YoY\n- Multiplier: 8-10x normal traffic\n\nCurrent limitations:\n- Payment gateway: 100 TPS rate limit\n- Database connections: 200 max\n- Redis memory: 32GB per node\n- CDN: 100TB monthly quota\n\nBusiness requirements:\n- Zero downtime\n- <500ms response time during peak\n- Handle 3K orders/minute\n- Support new livestream shopping feature\n\nWhat's our scaling strategy and when should we start provisioning?"}]}]}}]);