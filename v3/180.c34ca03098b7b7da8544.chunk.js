try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="de16b194-b436-4e27-9208-da42fd74f8fd",e._sentryDebugIdIdentifier="sentry-dbid-de16b194-b436-4e27-9208-da42fd74f8fd")}catch(e){}("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:{}).SENTRY_RELEASE={id:"6f1faf434b0a85eb183c91391b598f364a828f27"};(self.webpackChunkcloud_frontend=self.webpackChunkcloud_frontend||[]).push([[180],{97799:(e,t,r)=>{r.d(t,{A:()=>le});var n=r(96540),i=r(33185),o=r(65258),d=r(57068),a=r(15524),s=r(64156),l=r(20871),c=(r(98992),r(54520),r(72577),r(81454),r(8872),r(67012)),g=r(57377),u=r(40961),h=r(43375),p=r(43627),m=r(43305),f=r(71123),x=r(61710),b=r(74979),I=r(45427),y=r(74848);const C=e=>(0,p.uU)({...e,wasDragging:!0}),v=e=>{let{id:t,items:r,containerWidth:n,rowHeight:i,gutter:o,Component:d,isSortingContainer:a,onRemove:s,onItemRemove:l,Item:c,gridTracks:g,transforming:u,containerDndProps:h,itemProps:m,dragOverlay:x,rootId:v,...w}=e;const{active:j,attributes:k,isDragging:S,listeners:T,over:A,setNodeRef:D,transition:E,transform:R}=(0,p.gl)({id:x?`dragOverlay-${t}`:t,disabled:x,data:{rootId:v,isContainer:!0,items:r,containerId:t,dropArea:!0,...h},animateLayoutChanges:C}),P=!!A&&(t===A.id&&"container"!==j?.data.current?.type||r.includes(A.id)),O=(0,f.Hp)(r),_=O*i+(O-1)*o+"px";return(0,y.jsx)(d,{ref:D,style:x?{width:n,height:_}:{transition:E,transform:b.Ks.Translate.toString(R),opacity:S?.5:void 0,width:n,height:_},hover:P,onRemove:s,attributes:k,listeners:T,...w,itemProps:m,id:t,dragOverlay:x,children:r.map(((e,d)=>(0,y.jsx)(I.A,{disabled:a,...e,index:d,containerId:t,Item:c,onRemove:l,draggable:!0,containerWidth:n,rowHeight:i,gridTracks:g,gutter:o,transformed:u?r[d]:null,itemProps:m,containerDragOverlay:x,rootId:v,containerDndProps:h,draggableProps:e},e.id)))})},w=e=>{let{containers:t,Container:r,containerWidth:n,isSortingContainer:i,items:o,Item:d,transforming:a,onContainerRemove:s,onRemove:l,rowHeight:c,gridTracks:g,gutter:u,containerDndProps:h,itemProps:p,rootId:m}=e;return t.map((e=>(0,y.jsx)(v,{id:e,items:o[e],onRemove:()=>s(e),containerWidth:n,rowHeight:c,gridTracks:g,gutter:u,Component:r,Item:d,isSortingContainer:i,transforming:a,onItemRemove:l,containerDndProps:h,itemProps:p,rootId:m},e)))},j={sideEffects(e){let{active:t}=e;t.node.animate([{opacity:0},{opacity:1}],{easing:"ease-in",duration:250})}},k="TRASH_ID",S="PLACEHOLDER_ID",T=e=>{let{id:t}=e;const{setNodeRef:r,isOver:n}=(0,h.zM)({id:t,data:{dropArea:!0,isTrash:!0}});return(0,y.jsx)("div",{ref:r,style:{display:"flex",alignItems:"center",justifyContent:"center",position:"fixed",left:"50%",marginLeft:-150,bottom:20,width:300,height:60,borderRadius:5,border:"1px solid",borderColor:n?"red":"#DDD"},children:"Drop here to delete"})},A=e=>{let{rootId:t,items:r,containers:i,trashable:o=!0,onRemove:d,Item:a,containerWidth:s=800,rowHeight:l=40,gridTracks:b=12,gutter:C=4,allowOverlap:A=!1,compactType:D="vertical",maxRows:E=3e5,Container:R=m.A,onDragEnd:P,containerDndProps:O,itemProps:_,updateOnNewProps:B=!1,rearrangeable:H=!0}=e;const{active:N}=(0,h.fF)(),F=(0,n.useRef)(null),[L,W]=(0,n.useState)((()=>(i||Object.keys(r)).reduce(((e,t)=>(e[t]=(0,f.oE)((0,f.Su)(r[t]),D,b),e)),{})),{}),[$,z]=(0,n.useState)((()=>i||Object.keys(L)));(0,c.A)((()=>{W((i||Object.keys(r)).reduce(((e,t)=>(e[t]=(0,f.oE)((0,f.Su)(r[t]),D,b),e)),{}))}),[b]),(0,c.A)((()=>{B&&((0,g.Ay)(r,L)||(W((i||Object.keys(r)).reduce(((e,t)=>(e[t]=(0,f.oE)((0,f.Su)(r[t]),D,b),e)),{})),z(i)))}),[i,r]);const M=N?.isContainer,[V,G]=(0,n.useState)(null),[U,q]=(0,n.useState)(null),J=(0,n.useRef)(null),Y=e=>e in L?e:null,Z=()=>{V&&W(V),G(null),q(null),J.current=null},K=()=>{const e=Object.keys(L),t=e[e.length-1];return String.fromCharCode(t.charCodeAt(0)+1)},Q=e=>{let{active:t}=e;const{isContainer:r}=t.data.current||{};G(L),r||q(L)};return(0,n.useLayoutEffect)((()=>{if(N)return Q({active:N}),Z}),[]),(0,h.E5)({onDragStart:Q,onDragMove:e=>{let{active:t,over:r,collisions:n}=e;const{isResizer:i,isContainer:o,itemId:d,itemContainerId:a}=t.data.current||{};if(o||!U)return;const{initial:c,translated:g}=t.rect.current;let u=(0,f.Su)(U[a]);const h=!U[a],p=(0,f.GN)(h?U:u,d,h)||(0,f.lc)(t.data.current);if(!p||!p.width)return;const m=r?.id;if(i){if(!m)return;const e=r.rect.width+(g.right-c.right),t=r.rect.height+(g.bottom-c.bottom);let{width:i,height:o}=(0,x.tr)({gutter:C,maxRows:E,gridTracks:b,rowHeight:l,containerWidth:s},e,t,p);if(p.width===i&&p.height===o)return;if(!n)return;return u=u.map((e=>e.id===p.id?{...p,width:i,height:o}:e)),n=n.filter((e=>e.id!==p.id)),u=(0,f.oE)(u,D,b),J.current={...p,itemContainerId:a},void q((e=>({...e,[a]:[...u]})))}if(m===k)return void q(V);if(!H)return;const I=Y(a),y=Y(m)||r&&Y(r.data.current.itemContainerId)||I;if(!y)return;if(y&&y===I||(u=[...U[y],p]),!n)return;const v=n.find((e=>e.id===y));if(!v)return;let{left:w,top:j}=(0,x.zA)({gutter:C,maxRows:E,gridTracks:b,rowHeight:l,containerWidth:s},g.top-v.data.droppableContainer.rect.current.top,g.left-v.data.droppableContainer.rect.current.left,p);if(p.top===j&&p.left===w&&I===y)return;u=(0,f.Pe)(u,p,w,j,!0,!1,D,b,A),u=(0,f.oE)(u,D,b);const S=y!==I;S&&(F.current=t.itemContainerId),J.current={...p,itemContainerId:y},q((e=>({...e,[y]:u.filter((e=>!!e)),...S&&!!e[a]&&{[a]:(0,f.oE)(e[a].filter((e=>e.id!==p.id)),D,b)}})))},onDragEnd:e=>{let{active:t,over:r}=e;if(!U)return;const{isResizer:n,isItem:i}=t.data.current||{},o=r?.id;if(null===o)return void q(null);if(o===k)return W((e=>({...e,[t.containerId]:(0,f.oE)(e[t.containerId].filter((e=>{let{id:r}=e;return r!==t.itemId})),D,b)}))),void q(null);if(i||n)return U&&W(U),q(null),void P(U,J.current,$);t.id in L&&r?.id&&z((e=>{const n=e.indexOf(t.id),i=e.indexOf(r.id),o=(0,p.be)(e,n,i);return P(U,J.current,o),o}));const d=Y(t.id);if(d)if(o!==S)U&&W(U),q(null),P(U,J.current,$);else{const e=K();(0,u.unstable_batchedUpdates)((()=>{z((t=>[...t,e])),W((r=>({...r,[d]:r[d].filter((e=>e!==t.itemId)),[e]:[t.id]})))}))}},onDragCancel:Z}),U||L?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(p.gB,{items:[...$,S],strategy:p._G,children:(0,y.jsx)(w,{rootId:t,containers:$,Container:R,containerWidth:s,isSortingContainer:M,items:U||L,transforming:null!==U,Item:a,onContainerRemove:e=>{z((t=>t.filter((t=>t!==e))))},onRemove:d,rowHeight:l,gridTracks:b,gutter:C,itemProps:_,containerDndProps:O})}),(0,u.createPortal)((0,y.jsx)(h.Hd,{adjustScale:!1,dropAnimation:j,children:N&&N.data.current?.rootId===t?N.data.current.isContainer?(X=N.data.current,(0,y.jsx)(v,{rootId:t,id:X,items:U||L,containerWidth:s,rowHeight:l,gutter:C,Component:R,Item:a,gridTracks:b,containerDndProps:O,itemProps:_,dragOverlay:!0})):N.data.current.isItem?(e=>{const r=(U||L)[e.itemContainerId];if(!r)return null;const n=r.find((t=>t.id===e.itemId));return n?(0,y.jsx)(I.A,{rootId:t,...n,containerId:e.itemContainerId,Item:a,onRemove:d,draggable:!0,containerWidth:s,rowHeight:l,gridTracks:b,gutter:C,dragOverlay:!0,itemProps:_}):null})(N.data.current):null:null}),document.body),o&&N&&(N.isContainer||N.isItem)?(0,y.jsx)(T,{id:k}):null]}):null;var X},D=i.default.div.withConfig({displayName:"gridLayout__Div",componentId:"sc-jna1fu-0"})(["position:relative;"]),E=e=>{let{id:t,onRemove:r,children:n,attributes:i,listeners:a,itemProps:s={},itemProps:{dashboardId:l},style:c,dragOverlay:g,ref:u,...h}=e;(0,d.QZ)(l,t);return(0,y.jsx)(o.Flex,{...h,ref:u,column:!0,flex:!0,round:!0,background:"mainBackground",padding:[3],gap:2,children:(0,y.jsx)(D,{style:c,children:n})})},R=e=>{let{id:t,Component:r,containerWidth:i,onActiveMenuId:c,...g}=e;const[u,h]=(0,d.B1)(t),[p,m]=(0,d.Ix)(t),f=(0,s.A)("(max-width: 767px)"),x=(0,a.A)(),b=(0,n.useRef)(),I=(0,n.useMemo)((()=>(b.current&&b.current.cancel(),b.current=(0,l.A)(),()=>{})),[u,c]);return(0,y.jsx)(o.Flex,{ref:x,column:!0,overflow:{vertical:"auto"},flex:"1","data-testid":"dashboardGrid",height:"100%",onScroll:I,children:(0,y.jsx)(A,{rootId:t,Container:E,onDragEnd:(e,t,r)=>{h(e),m(r)},containers:p,items:u,containerWidth:i-(f?16:26),...g,Item:r,gridTracks:12,itemProps:{dashboardId:t},containerDndProps:{droppable:!0},updateOnNewProps:!0},t)})};var P=r(4844),O=r(6393),_=r(28973),B=r(19371);const H=(0,i.default)(o.Flex).attrs((e=>({height:"100%",background:"mainChartBg",round:!0,...e}))).withConfig({displayName:"container__Card",componentId:"sc-esi601-0"})(["",""],(e=>{let{dragging:t,theme:r}=e;return t&&`\n    &:before {\n      content: '';\n      position: absolute;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      left: 0;\n      background-color: ${(0,o.getRgbColor)("primary",.2)({theme:r})};\n      z-index: 10;\n      backdrop-filter: blur(3px);\n    }\n\n  `}));var N=r(92726),F=r(93536),L=r(28657);const W={},$=(0,n.memo)((e=>{let{dashboardId:t,id:r,handleProps:i,listeners:o,attributes:d,style:a,dragging:s,dragOverlay:l,isOnTV:g,...u}=e;const h=(0,B.eg)(),{nodesScope:p,contextScope:m,...f}=(0,O.bE)(t,r)||W,x=(0,O.v_)(t,r),b=(0,N.fz)(t,"respectNodesScope"),I=(0,n.useMemo)((()=>{const e=(0,P.My)(h,t);let n=e.getNode({id:l?`dragOverlay-${r}`:r});if(n)return n;const[a]=m||[];return a?(n=h.makeChart({attributes:{...(0,F.L)(a),id:l?`dragOverlay-${r}`:r,cardId:r,dashboardId:t,contextScope:m,...b?{nodesScope:p}:{},...f,toolboxProps:{drag:{...i,...o,...d},isOnTV:g}},makeTrack:P.qh}),e.appendChild(n),n):null}),[t,r]);(0,c.A)((()=>{I&&(I.updateAttributes({height:a.height,width:a.width}),I.trigger("resize"))}),[I,a.height,a.width]),(0,c.A)((()=>{I&&I.updateAttributes({toolboxProps:{drag:{...i,...o,...d,dragging:s},isOnTV:g}})}),[s]),(0,n.useLayoutEffect)((()=>{if(I)return(0,_.unregister)(I.onAttributesChange(["aggregationMethod","groupBy","groupByLabel","postAggregationMethod","postGroupBy","postGroupByLabel","groupingMethod","groupingTime","chartType","chartLibrary","selectedDimensions","selectedLabels","selectedNodes","selectedInstances","sparkline","selectedLegendDimensions","showingInfo","dimensionsSortBy","instancesSortBy","nodesSortBy","groupBySortBy","labelsSortBy","dimensionsSort","nodesExpanded","groupByExpanded","labelsExpanded","expanded","staticZones","title","description","showPostAggregations","selectedNodeLabelsFilter","staticValueRange","enabledYAxis","enabledXAxis","legend","desiredUnits","staticFractionDigits"],((e,t,r)=>{x((t=>({...t,[r]:e})))})))}),[I,x]),(0,c.A)((()=>{I&&I.updateAttributes(f)}),[f]),(0,c.A)((()=>{if(!I||!b)return;I.updateAttribute("nodesScope",p);I.getAttribute("active")&&"chart"===I.type&&I.fetch()}),[b,p]);const{onRemove:C,...v}=u;return I?(0,y.jsx)(H,{"data-testid":`chartCard-${(f.contextScope||[]).join(",")}`,height:a.height,width:"100%",...v,dragging:s,children:(0,y.jsx)(L.A,{chart:I,"data-chartid":l?`dragOverlay-${r}`:r,"data-track":I.track("container"),height:a.height,width:"100%"})}):null})),z=$;var M=r(99728),V=r(64981),G=r(5907);const U="text",q="customDashboard",J=e=>{let{dashboardId:t,id:r,onClick:n}=e;const i=(0,O.bE)(t,r,"editing"),o=(0,O.v_)(t,r,"editing");return(0,y.jsx)(V.t,{icon:"pencilSolid",onClick:()=>{n(),o(!0)},"data-ga":`${U}-reset::${q}`,"data-testid":"textCard-edit",disabled:i,children:"Edit"})},Y=e=>{let{dashboardId:t,id:r}=e;const n=(0,G.c6)(t,r);return(0,y.jsx)(V.t,{icon:"trashcan",onClick:n,"data-ga":`${U}-reset::${q}`,"data-testid":"textCard-remove",children:"Remove"})},Z=e=>{let{dashboardId:t,id:r,children:n,...i}=e;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(V.A,{category:U,context:q,testId:"chartTextDropdown",...i,children:e=>{let{close:n}=e;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(J,{dashboardId:t,id:r,onClick:n}),(0,y.jsx)(Y,{dashboardId:t,id:r})]})}}),n]})},K=(0,i.default)(o.Flex).attrs({as:"form",column:!0,flex:!0,gap:2,height:"100%",padding:[0,0,2],onMouseDown:e=>e.stopPropagation()}).withConfig({displayName:"form__CardContent",componentId:"sc-3tcqxu-0"})(["cursor:auto;"]),Q=(0,i.default)(o.Box).attrs((e=>({as:"textarea",background:"inputBg",height:"100%",round:!0,border:!0,padding:[2],...e}))).withConfig({displayName:"form__Textarea",componentId:"sc-3tcqxu-1"})(["resize:none;font-size:12px;color:",";"],(0,o.getColor)("text")),X=(0,n.memo)((e=>{let{dashboardId:t,id:r}=e;const i=(0,O.bE)(t,r,"text"),d=(0,O.v_)(t,r,"editing"),a=(0,O.v_)(t,r,"text"),[s,l]=(0,n.useState)(i);return(0,y.jsxs)(K,{"data-testid":"textCardForm",children:[(0,y.jsx)(Q,{placeholder:"Add some text",value:s.replace(/<\/?[^>]+(>|$)/g,""),onChange:e=>l(e.target.value)}),(0,y.jsxs)(o.Flex,{position:"absolute",right:"24px",bottom:0,gap:1,children:[(0,y.jsx)(o.IconButton,{icon:"check",small:!0,padding:[0],onClick:()=>{a(s),d(!1)},"data-testid":"textCardForm-cancel",neutral:!1,flavour:"default"}),(0,y.jsx)(o.IconButton,{icon:"x",small:!0,padding:[0],onClick:()=>d(!1),"data-testid":"textCardForm-done",flavour:"default"})]})]})})),ee={h1:o.H2,h2:o.H4,text:o.Text,micro:o.TextNano},te=e=>{let{dashboardId:t,id:r}=e;const n=(0,O.bE)(t,r,"text")||"",i=(0,O.bE)(t,r,"textType"),d=ee[i]||ee.text;return(0,y.jsx)(o.Box,{"data-testid":"textCardContent",children:(0,y.jsx)(d,{whiteSpace:"pre-wrap",children:n.replace(/<\/?[^>]+(>|$)/g,"")})})},re=(0,i.default)(o.Flex).attrs({column:!0}).withConfig({displayName:"text__StyledOptions",componentId:"sc-1f67m9f-0"})([""]),ne=(0,n.forwardRef)(((e,t)=>{let{dragging:r,...n}=e;const i=(0,M.JT)("dashboard:Update");return(0,y.jsx)(o.IconButton,{ref:t,position:"absolute",top:0,right:0,padding:[0],width:"12px",height:"12px",icon:"rearrange",title:"Drag & drop","data-testid":"text-drag",disabled:!i,cursor:r?"grabbing":"grab",...n})})),ie=["h1","h2","text","micro"],oe=e=>{let{id:t,dashboardId:r}=e;const n=(0,M.JT)("dashboard:Update"),i=(0,O.bE)(r,t,"textType")||"text",d=(0,O.v_)(r,t,"textType");return(0,y.jsx)(o.IconButton,{padding:[0],width:"12px",height:"12px",icon:"text_add",title:"Change text component","data-testid":"text-component",disabled:!n,onClick:()=>{const e=ie.findIndex((e=>e===i)),t=ie[e>ie.length-2?0:e+1];d(t)}})},de=(0,i.default)(H).withConfig({displayName:"text__StyledCard",componentId:"sc-1f67m9f-1"})(["","{opacity:0;}&:hover{border:1px solid ",";}&:hover ","{opacity:1;}"],re,(0,o.getColor)("border"),re),ae={chart:z,text:(0,n.memo)((e=>{let{dashboardId:t,id:r,listeners:n,handleProps:i,dragging:o,isOnTV:d}=e;const a=(0,O.bE)(t,r,"editing");return(0,y.jsxs)(de,{"data-testid":"textCard",alignItems:"start",overflow:"hidden",dragging:o,children:[!d&&(0,y.jsxs)(re,{children:[(0,y.jsx)(Z,{dashboardId:t,id:r}),(0,y.jsx)(oe,{dashboardId:t,id:r})]}),a&&!d&&(0,y.jsx)(X,{dashboardId:t,id:r}),!a&&(0,y.jsx)(te,{dashboardId:t,id:r}),!d&&(0,y.jsx)(ne,{...n,...i,dragging:o})]})})),placeholder:(0,n.memo)((()=>(0,y.jsx)(H,{column:!0,"data-testid":"placeholderCard",background:"secondaryHighlight",width:"100%"})))},se=e=>{let{dashboardId:t,id:r,attributes:n,style:i,resizeHandle:o,ref:d,isOnTV:a,...s}=e;const l=(0,O.bE)(t,r,"type")||"placeholder",c=ae[l]||ae.chart;return(0,y.jsxs)("div",{ref:d,...n,style:i,children:[(0,y.jsx)(c,{dashboardId:t,id:r,style:i,isOnTV:a,...s}),!a&&o]})},le=(0,n.memo)((e=>{let{id:t,...r}=e;return(0,P.Ay)(t),(0,y.jsx)(R,{id:t,Component:se,...r})}))}}]);