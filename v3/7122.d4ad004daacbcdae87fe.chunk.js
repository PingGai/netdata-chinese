try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="d8ddd8c3-ed18-4748-92c5-5b40f2a1fc34",e._sentryDebugIdIdentifier="sentry-dbid-d8ddd8c3-ed18-4748-92c5-5b40f2a1fc34")}catch(e){}("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:{}).SENTRY_RELEASE={id:"6f1faf434b0a85eb183c91391b598f364a828f27"};(self.webpackChunkcloud_frontend=self.webpackChunkcloud_frontend||[]).push([[7122],{13846:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(96540),a=n(15920),o=n(16373),s=n(19075),l=n(77679);const i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[t,n]=(0,l.A)(e),i=(0,o.aR)({extraKey:e.keyFlavour||e.extraKey}),d=(0,s.le)({...n&&{key:t},...e}),{state:c}=(0,a.zy)();(0,r.useEffect)((()=>{if(!c)return;const{fn:e,alertTabIndex:t}=c;e&&i([e]),t&&d(t),window.history.replaceState({},"")}),[t,n,i,d])}},27122:(e,t,n)=>{n.r(t),n.d(t,{default:()=>lo});var r=n(96540),a=n(88255),o=n(83268),s=n(16373),l=n(67782),i=n(37479),d=n(85660),c=(n(98992),n(72577),n(5287)),u=n.n(c),h=n(65258),m=n(24013),x=n(87083),p=n(19186),g=n(64973),f=n(13846),y=n(77679),b=n(79748),j=n(93926),v=n(74848);const C=e=>{let{paramsKey:t,...n}=e;const r=n?.["data-testid"]||"capableNodesError",a=(0,x.a7)(t),o=(0,m.xY)(a?.[0],"name");return(0,v.jsxs)(h.Flex,{alignItems:"center",flex:!0,gap:8,justifyContent:"center",...n,"data-testid":r,children:[(0,v.jsx)(h.Icon,{"data-testid":`${r}-icon`,height:"230px",name:"unreachableNode",width:"230px"}),(0,v.jsx)(j.A,{"data-testid":`${r}-details`,gap:2,title:o?`${o} is not configured for Functions`:"Your nodes are not configured for Functions",message:(0,v.jsxs)(v.Fragment,{children:["Learn how to configure your nodes"," ",(0,v.jsx)(b.A,{Component:h.TextBig,"data-ga":"functions-capable-nodes-error::click-docs-link::functions-view","data-testid":`${r}-docsLink`,href:"https://learn.netdata.cloud/docs/nightly/operations/run-time-troubleshooting-with-functions#prerequisites",target:"_blank",rel:"noopener noreferrer",children:"to support functions"})]}),width:{max:"fit-content"}})]})};var w=n(1817),k=n(38648),F=n(3692),S=n(58042),I=(n(54520),n(81454),n(8872),n(37550),n(18121)),A=n(23226),T=n(73613),K=n(6304),E=n(68531),L=n(42790),P=n(33185);const z=(0,P.default)(h.Flex).attrs({alignItems:"center",border:{side:"bottom",color:"borderSecondary"},padding:[2]}).withConfig({displayName:"styled__MenuItem",componentId:"sc-1bb2nho-0"})(["&:last-child{border:none;}"]),M=(0,P.default)(h.TextInput).withConfig({displayName:"styled__TextInput",componentId:"sc-1bb2nho-1"})(['margin:0 10px;min-width:unset;width:45px;> div{margin:0;}input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0;}input[type="number"]{-moz-appearance:textfield;}']),B=(0,v.jsxs)(h.Flex,{column:!0,width:{max:"500px"},gap:1,children:[(0,v.jsx)(h.TextSmall,{children:"Full data queries will always provide all the available facets with counters for your search, which depending on the size of the query could result in poor performance."}),(0,v.jsx)(h.TextSmall,{children:"i.e. Querying logs for multiple days with multitudes of entries."}),(0,v.jsx)(h.TextSmall,{children:"With this toggle \u201coff\u201d (default), queries will slice the data and will lower performance hit on your servers."})]}),$=e=>{let{onClose:t,targetRef:n,paramsKey:a,...o}=e;const l=o?.["data-testid"]||"config",i=(0,s.Ol)(a,"acceptedParams"),[d,c]=(0,L.r$)("slice",{defaultValue:!0,flavour:"bool",...a}),[u,m]=(0,K.A)(!d);(0,E.A)((()=>{!!d===!!u&&c(!u)}),200,[d,u,c]);const x=(0,s.Ol)(a,"updateEvery"),[p,g]=(0,L.r$)("pollingInterval",{...a,flavour:"int",defaultValue:x}),[f,y]=(0,r.useState)(p);return(0,E.A)((()=>{p!==f&&g(f)}),400,[p,f,g]),n.current?(0,v.jsxs)(h.Drop,{align:{top:"bottom",right:"right"},animation:!0,background:"dropdown",close:t,column:!0,"data-testid":l,margin:[.5,0,0],onClickOutside:t,onEsc:t,round:1,target:n.current,width:58,children:[!!i?.includes?.("slice")&&(0,v.jsxs)(z,{"data-testid":`${l}-slice-data`,justifyContent:"between",children:[(0,v.jsxs)(h.Flex,{gap:1,alignItems:"center",children:[(0,v.jsx)(h.Text,{color:"textNoFocus","data-testid":`${l}-slice-data-label`,children:"Full data queries (slow)"}),(0,v.jsx)(T.A,{plain:!0,content:B,isBasic:!0,allowHoverOnTooltip:!0,stretch:"align",children:(0,v.jsx)(h.Icon,{name:"information",color:"textDescription",width:"14px",height:"14px"})})]}),(0,v.jsx)(h.Toggle,{colored:!0,checked:u,"data-ga":"functions-config::auto-slice-data-switch::functions-view::"+(u?"enabled":"disabled"),"data-testid":`${l}-slice-data-switch`,onChange:m})]}),(0,v.jsxs)(z,{"data-testid":`${l}-pollingInterval`,children:[(0,v.jsx)(h.Text,{color:"textNoFocus","data-testid":`${l}-pollingInterval-label`,children:"Refresh every"}),(0,v.jsx)(M,{"data-ga":"functions-config::polling-interval::functions-view","data-testid":`${l}-pollingInterval-input`,min:1,onChange:e=>{let{target:t}=e;const n=+t.value;n>0&&y(n)},size:"tiny",type:"number",value:f}),(0,v.jsx)(h.Text,{color:"textNoFocus","data-testid":`${l}-pollingInterval-units`,children:"seconds"})]})]}):null};var R=n(64587);const O=e=>{let{paramsKey:t}=e;const n=(0,s.Ol)(t,"updatedAt"),{localeTimeString:r,localeDateString:a}=(0,R.$j)();return(0,v.jsxs)(h.TextMicro,{color:"textLite",children:["Last updated: ",a(n,{long:!0})," ",r(n,{secs:!0})]})};var N=n(81641);const D=P.default.div.withConfig({displayName:"reload__IconsContainer",componentId:"sc-gd414j-0"})(["position:relative;"]),V=(0,P.default)(h.Icon).withConfig({displayName:"reload__SmallIcon",componentId:"sc-gd414j-1"})(["position:absolute;top:3px;left:3px;"]),_=(0,P.keyframes)(["from{transform:rotate(0deg);}to{transform:rotate(359deg);}"]),q=(0,P.default)(h.IconButton).withConfig({displayName:"reload__AnimatedIcon",componentId:"sc-gd414j-2"})(["&& svg{animation:",";}animation:rotation 2s infinite linear;"],(e=>{let{animate:t}=e;return t?(0,P.css)([""," 3s linear infinite"],_):""})),W=e=>{let{onRefresh:t,dataGa:n,testId:a,loading:o}=e;const s=(0,N.gC)(),[l,i]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{if(!o)return void i(!1);const e=setTimeout((()=>i(!0)),500);return()=>{clearTimeout(e)}}),[o]),(0,v.jsx)(h.Flex,{alignItems:"center",children:(0,v.jsxs)(D,{children:[(0,v.jsx)(V,{name:s?"playSolid":"pauseSolid",width:"6px",height:"6px",color:s?"primary":"text"}),(0,v.jsx)(q,{animate:l,"data-testid":`${a}-refreshNowBtn`,"data-ga":`${n}::click-refresh-now::functions-view`,flavour:"hollow",icon:"refresh",onClick:()=>t({merge:!1}),disabled:s,padding:[1]})]})})};n(25509),n(65223),n(60321),n(41927),n(11632),n(64377),n(66771),n(12516),n(68931),n(52514),n(35694),n(52774),n(49536),n(21926),n(94483),n(16215);var H=n(63928),U=n(49163),G=n(23565),Z=n(99728),Y=n(24609),J=n(3203);const X={room:"space_new",space:"spaces_v2",personal:"user"},Q=(0,J.A)(h.Button),ee=e=>{let{onSubmit:t,onClose:n,canAddSpaceSettings:a}=e;const[o,s]=(0,r.useState)(""),[l,i]=(0,r.useState)("personal"),d=(e=>(0,r.useMemo)((()=>[{icon:X.personal,value:"personal",label:"Personal"},{icon:X.room,value:"room",label:"Room",disabled:!e},{icon:X.space,value:"space",label:"Space",disabled:!e}]),[e]))(a);return(0,v.jsx)(h.Modal,{onClickOutside:n,onEsc:n,children:(0,v.jsxs)(h.ModalContent,{background:"dropdown",children:[(0,v.jsxs)(h.ModalHeader,{children:["Create a new settings snapshot",(0,v.jsx)(h.ModalCloseButton,{testId:"close-button",onClose:n})]}),(0,v.jsx)(h.ModalBody,{children:(0,v.jsxs)(h.Flex,{column:!0,width:80,gap:3,children:[(0,v.jsx)(h.TextInput,{"data-testid":"name",label:"Name",onChange:e=>{let{target:t}=e;return s(t.value)},value:o}),(0,v.jsxs)(h.Flex,{column:!0,gap:1,children:[(0,v.jsx)(h.TextSmall,{strong:!0,children:"Scope"}),(0,v.jsx)(h.Select,{options:d,value:d.find((e=>e.value===l)),onChange:e=>{let{value:t}=e;return i(t)},styles:{minWidth:"80px"}})]})]})}),(0,v.jsx)(h.ModalFooter,{children:(0,v.jsx)(Q,{disabled:""===o.trim(),label:"Create",onClick:()=>t({name:o,scope:l}),"data-testid":"btn-create",payload:{description:"Modal - Create Settings"}})})]})})},te={color:"textLite",margin:[0,1,0,0],width:"14px",height:"14px"},ne=e=>{let{openForm:t,close:n}=e;return(0,v.jsx)(h.Flex,{padding:[2,1],border:{side:"top"},justifyContent:"center",children:(0,v.jsx)(h.Button,{small:!0,icon:"save",onClick:()=>{t(),n()},"data-ga":"user-settings::click-create",title:"Create a new setting with your changes",children:"Add new setting"})})},re=()=>({}),ae=e=>{let{id:t,close:n,getValue:r=re}=e;const a=(0,H.xS)(t,{onSuccess:n});return(0,v.jsx)(h.IconButton,{icon:"save",iconColor:"textLite",onClick:e=>{e.stopPropagation(),a({value:r()})},"data-ga":"user-settings::click-update",neutral:!0,padding:[0],title:"Update this setting with your changes"})},oe=e=>{let{id:t,close:n}=e;const r=(0,H.z2)(t,{onSuccess:n});return(0,v.jsx)(h.IconButton,{icon:"trashcan",iconColor:"textLite",onClick:e=>{e.stopPropagation(),r()},"data-ga":"user-settings::click-delete",neutral:!0,padding:[0],title:"Delete this setting"})},se=e=>{let{item:{value:t,label:n,icon:r,disabled:a,onClick:o,canUpdate:s,hideActions:l,...i},value:d,onItemClick:c,index:u,style:m,close:x,itemProps:p={},...g}=e;const{getLocalSettingsValue:f}=p,y=d===t;return(0,v.jsxs)(h.MenuItemContainer,{"data-index":u,"aria-selected":y,disabled:a,selected:y,onClick:e=>{o&&o(e),c(t)},...i,...g,style:m,alignItems:"center",justifyContent:"between",padding:[1],overflow:"hidden",children:[(0,v.jsxs)(h.Flex,{alignItems:"center",children:[r,(0,v.jsx)(h.TextSmall,{whiteSpace:"normal",wordBreak:"break-word",children:n})]}),!l&&(0,v.jsxs)(h.Flex,{alignItems:"center",gap:.5,children:[(0,v.jsx)(ae,{id:t,close:x,getValue:f,disabled:!s}),(0,v.jsx)(oe,{id:t,close:x,disabled:!s})]})]})},le=e=>{let{disabled:t,type:n,types:a,entity:o,entities:s,paths:l,path:i,getLocalSettingsValue:d,...c}=e;a=Array.isArray(a)?a:n?[n]:[],s=Array.isArray(s)?s:o?[o]:[],l=Array.isArray(l)?l:i?[i]:[];const u=(0,U._)({params:{type:a,entity:s,path:l}}),[m,x]=(0,G.WY)({type:n,entity:o,path:i}),p=(0,Z.JT)("space:UpdateSettings"),g=((e,t)=>{let{canAddSpaceSettings:n}=t;return(0,r.useMemo)((()=>[{value:"default",label:"Default",icon:(0,v.jsx)(h.Icon,{name:X.personal,...te}),"data-track":"setting-default",canUpdate:!1,hideActions:!0},...e.map((e=>({value:e.id,label:e.name,icon:(0,v.jsx)(h.Icon,{name:X[e.scope]||X.personal,...te}),"data-track":`setting-${e.scope}`,canUpdate:"personal"===e.scope||n})))]),[e,n])})(u,{canAddSpaceSettings:p}),[f,,y,b]=(0,K.A)(),j=(0,H.yK)({onSuccess:()=>{b(),close()}}),C=(0,Y.dg)();return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h.Menu,{value:m,items:g,dropProps:{align:{top:"bottom",right:"right"},"data-toolbox":!0},dropdownProps:{width:"200px"},onChange:x,"data-track":"user-settings",Item:se,itemProps:{getLocalSettingsValue:d},Footer:(0,r.useMemo)((()=>e=>C?(0,v.jsx)(h.Flex,{padding:[1],children:(0,v.jsx)(h.TextSmall,{children:"Settings can be saved when the agent is part of a Netdata cloud space."})}):(0,v.jsx)(ne,{...e,openForm:y})),[C]),children:(0,v.jsx)(h.IconButton,{icon:"save",padding:[0],title:"User settings",disabled:t,"data-testid":"toolbox-addSettings",...c})}),f&&(0,v.jsx)(ee,{onSubmit:function(){return j({type:n,entity:o,path:i,...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},value:d()})},onClose:b,canAddSpaceSettings:p})]})},ie=(0,r.memo)(le),de=(e,t)=>{"undefined"!==typeof e&&t(e)},ce=(e,t)=>{const n={...e};for(const r in t)Array.isArray(t[r])?n[r]=Array.isArray(n[r])?[...new Set([...n[r],...t[r]])]:[...t[r]]:"object"===typeof t[r]&&null!==t[r]?n[r]=ce(n[r],t[r]):n[r]=t[r];return n},ue={},he=(0,r.memo)((e=>{let{fn:t,paramsKey:n,dataGa:a,testId:o}=e;const[l,i]=(0,r.useState)(),d=(0,s.Ol)(n,"columnVisibility"),c=(0,s.Ol)(n,"requiredParams"),u=(0,G.ub)(),h=(0,G.CS)({type:"function",entity:t,path:"/view"}),[m,x]=(0,L.r$)(void 0,{...n,defaultValue:ue}),[p,g]=(0,s.UB)({param:"colSizing",defaultValue:ue,flavour:"obj",...n}),[f,y]=(0,s.UB)({param:"sortBy",flavour:"arrobj",...n}),[b,j]=(0,s.ZY)({...n,flavour:"arr"}),[C,w]=(0,s.ZY)({param:"query",flavour:"val",...n,defaultValue:""}),[k,F]=(0,s.UB)({param:"groupBy",defaultValue:"",flavour:"val",...n}),[S,I]=(0,s.UB)({param:"columnVisibility",defaultValue:d,flavour:"obj",...n}),[A,T]=(0,s.oV)({param:"selectedFacets",extraKey:n?.extraKey,flavour:"arr",defaultValue:null});return(0,r.useLayoutEffect)((()=>()=>i()),[t]),(0,r.useLayoutEffect)((()=>{if(l||!d||!c)return;const e=c.reduce(((e,t)=>{if(!t.options?.length)return e;const n=t.options.filter((e=>!!e.defaultSelected));return e[t.id]=n.length?n.map((e=>e.id)):[t.options[0].id],e}),{});i({columnSizing:ue,fnSortBy:void 0,fnFilters:{query:"",...e},groupBy:"",columnVisibility:d,fnFacets:null,roomSettings:m})}),[m,d,h,c]),(0,r.useEffect)((()=>{if(!h)return;let e=l?Object.keys(h).length?h:l:{columnSizing:{...h.columnSizing,...p},fnSortBy:f||h.fnSortBy,fnFilters:{...ce(b,h.fnFilters),query:C||h.fnFilters?.query||""},groupBy:k||h.groupBy,columnVisibility:{...h.columnVisibility,...S},fnFacets:h.fnFacets&&A?[...h.fnFacets,...A]:A||h.fnFacets,roomSettings:{...h?.roomSettings,...m}};const{query:t,...n}=e.fnFilters||ue;de(e.columnSizing,g),y(e.fnSortBy),de(n,j),de(t,w),de(e.columnVisibility,I),de(e.fnFacets,T),de(e.groupBy,F),de(e.roomSettings,x)}),[h,u]),(0,v.jsx)(ie,{type:"function",path:"/view",entity:t,padding:[1],"data-testid":`${o}-SettingsBtn`,"data-ga":`${a}::click-config::functions-view`,flavour:"hollow",getLocalSettingsValue:()=>({columnSizing:p,fnSortBy:f,fnFilters:{query:C,...b},groupBy:k,columnVisibility:S,fnFacets:A})})})),me={fn:{dataGa:"functions-header",hasConfig:!0,Title:e=>{let{name:t,fn:n}=e;return n?t?`${n} on ${t}`:n:"Top"},titleTooltip:(0,v.jsxs)(h.Flex,{width:{max:"500px"},alignItems:"center",flexWrap:!0,children:[(0,v.jsx)(h.Text,{children:"Netdata Functions enable detailed low-level monitoring at the edge. "}),(0,v.jsx)(b.A,{Component:h.Text,"data-ga":"functions-header::click-docs-link::functions-view","data-testid":"docsLink",href:"https://learn.netdata.cloud/docs/nightly/concepts/netdata-functions",target:"_blank",rel:"noopener noreferrer",children:"Read the Netdata functions documentation to learn more"}),(0,v.jsx)(h.Text,{children:"."})]})},logs:{dataGa:"logs-header",hasConfig:!0,Title:e=>{let{name:t,fn:n}=e;return n?t?`${n} logs on ${t}`:`${n} logs`:"Logs"},titleTooltip:(0,v.jsxs)(h.Flex,{width:{max:"500px"},alignItems:"center",flexWrap:!0,children:[(0,v.jsx)(h.Text,{children:"Explore system and applications logs. "}),(0,v.jsx)(b.A,{Component:h.Text,"data-ga":"functions-header::click-docs-link::functions-view","data-testid":"docsLink",href:"https://learn.netdata.cloud/docs/logs/systemd-journal",target:"_blank",rel:"noopener noreferrer",children:"Read the Netdata logs documentation to learn more"}),(0,v.jsx)(h.Text,{children:"."})]})},feed:{dataGa:"feed-header",Title:()=>"Events",titleTooltip:(0,v.jsxs)(h.Flex,{width:{max:"500px"},alignItems:"center",flexWrap:!0,children:[(0,v.jsxs)(h.Text,{children:["Troubleshoot faster with Netdata Events. Access topology and alert events across the room in one convenient location."," "]}),(0,v.jsx)(b.A,{Component:h.Text,"data-ga":"feed-header::click-docs-link::feed-view","data-testid":"docsLink",href:"https://learn.netdata.cloud/docs/nightly/concepts/events-feed",target:"_blank",rel:"noopener noreferrer",children:"Read the Events feed documentation to learn more"}),(0,v.jsx)(h.Text,{children:"."})]})}},xe=(0,r.memo)((e=>{let{onRefresh:t,onCancel:n,paramsKey:a,flavour:o,...l}=e;const i=l?.["data-testid"]||"functionsHeader",d=(0,r.useRef)(),{dataGa:c,hasConfig:u,titleTooltip:p,Title:g}=me[o]||me.fn,[f,y,,b]=(0,K.A)(!1),j=(0,s.Ak)(a),C=(0,x.a7)({...a,extraKey:j||a.extraKey}),w=(0,m.xY)(C?.[0],"name"),{loaded:k,data:F,totalSize:S,actualSize:I,loading:A,loadingMore:E,aggregatedView:L}=(0,s.Ol)(a),P=(0,s.rc)(a);return(0,v.jsxs)(h.Flex,{"data-testid":i,justifyContent:"between",children:[(0,v.jsxs)(h.Flex,{column:!0,children:[(0,v.jsxs)(h.Flex,{alignItems:"start","data-testid":`${i}-title`,gap:1,children:[(0,v.jsx)(h.H3,{children:(0,v.jsx)(g,{name:w,fn:P})}),(0,v.jsx)(T.A,{plain:!0,content:p,isBasic:!0,allowHoverOnTooltip:!0,stretch:"align",children:(0,v.jsx)(h.Icon,{name:"information",color:"textDescription",width:"16px",height:"16px"})})]}),(0,v.jsxs)(h.Flex,{alignItems:"center",gap:2,children:[k&&(0,v.jsxs)(h.TextSmall,{color:"textLite",strong:!0,children:["(",!!L&&!!I&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(h.TextSmall,{color:"text",strong:!0,children:[I||0," ",L.aggregatedLabel]}),(0,v.jsx)("span",{children:" \u2283 "})]}),S||F?.length||0," ",L?.resultsLabel||"results",")"]}),(0,v.jsx)(O,{paramsKey:a})]})]}),k&&(0,v.jsxs)(h.Flex,{gap:1,alignItems:"start",children:[(0,v.jsx)(W,{testId:i,dataGa:c,onRefresh:t,onCancel:n,loading:A||E}),u&&(0,v.jsx)(h.IconButton,{"data-testid":`${i}-ConfigBtn`,"data-ga":`${c}::click-config::functions-view`,flavour:"hollow",icon:"gear",ref:d,onClick:y,padding:[1]}),f&&(0,v.jsx)($,{"data-testid":`${i}-Config`,isOpen:f,onClose:b,targetRef:d,paramsKey:a}),(0,v.jsx)(he,{fn:j,testId:i,dataGa:c,paramsKey:a})]})]})}),((e,t)=>e.onRefresh===t.onRefresh));var pe=n(99238),ge=n.n(pe),fe=n(57377),ye=n(16099),be=n.n(ye),je=n(98830);const ve=(0,P.default)(h.Icon).attrs({color:"text",height:"16px",width:"16px"}).withConfig({displayName:"value__Arrow",componentId:"sc-1apuy8c-0"})(["rotate:",";transition:all 200ms ease;"],(e=>{let{rotate:t}=e;return t})),Ce=function(e){let{transform:t,decimalPoints:n=0,units:a,defaultValue:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=(0,je.py)();return(0,r.useMemo)((()=>{switch(t){case"number":return(0,je.iX)(e,{decimalPoints:n,units:a,defaultValue:o});case"duration":return(0,je.Sh)(e,{defaultValue:o});case"datetime":return s(e,{defaultValue:o});case"datetime_usec":return s(e,{defaultValue:o,usec:!0});case"xml":return be()(e||o||"");default:return null===e||"undefined"===typeof e?o:e}}),[e,a,s])},we=e=>{let{description:t="",value:n,units:r=""}=e;return t?(0,v.jsxs)(h.Flex,{column:!0,gap:1,justifyContent:"center",children:[(0,v.jsx)(h.TextSmall,{children:t}),(0,v.jsxs)(h.TextSmall,{strong:!0,textAlign:"center",children:[n," ",r]})]}):`${n} ${r}`},ke=(0,P.default)(h.Flex).withConfig({displayName:"value__ValueContainer",componentId:"sc-1apuy8c-1"})(["",""],(e=>{let{overflowWrap:t}=e;return t&&"* {\n      overflow-wrap: anywhere;\n      white-space: pre-wrap;\n      word-break: break-word;\n    }\n  "})),Fe={debug:{strong:!0,color:"textLite"},normal:{},notice:{strong:!0},warning:{strong:!0,color:"warningText"},critical:{strong:!0,color:"errorText"}},Se=(0,P.default)(h.Text).attrs((e=>({...e,...Fe[e.severity]||Fe.normal}))).withConfig({displayName:"value__ValueLabel",componentId:"sc-1apuy8c-2"})([""]),Ie=e=>{let{icon:t,iconRotate:n,children:r,onClick:a,strong:o,testId:s="cell",textAlign:l,wrap:i,truncate:d=!0,rowOptions:c,ref:u,labelProps:h,...m}=e;return(0,v.jsxs)(ke,{cursor:a?"pointer":"inherit",gap:.5,onClick:a,overflow:"hidden",ref:u,width:{max:"100%",base:"100%"},flexWrap:!0,overflowWrap:i,...m,children:[t&&(0,v.jsx)(ve,{name:t,rotate:n}),(0,v.jsx)(Se,{"data-testid":`${s}-value`,strong:o,textAlign:l,truncate:!i&&d,whiteSpace:i?"wrap":"nowrap",...h,...c,children:r})]})},Ae=e=>{let{description:t="",tooltipValue:n,value:r,valueOptions:a={},wrap:o,rowOptions:s,showRaw:l,...i}=e;const d=Ce(r,a);return l&&"xml"!==a?.transform?(0,v.jsxs)(h.Flex,{gap:3,justifyContent:"between",flex:!0,children:[(0,v.jsx)(Ie,{wrap:o,rowOptions:s,justifyContent:"start",labelProps:{strong:!0},children:d}),d!==r&&(0,v.jsx)(Ie,{wrap:o,rowOptions:s,justifyContent:"end",labelProps:{color:"textDescription"},title:"Raw value",children:r})]}):(0,v.jsx)(T.A,{content:!o&&(0,v.jsx)(we,{description:t,value:n||r,units:a.units}),"data-testid":"valueComponent",isBasic:!0,...i,children:(0,v.jsx)(Ie,{wrap:o,rowOptions:s,justifyContent:"number"===a.transform?"end":"start",children:d})})},Te=e=>{let{value:t,...n}=e;return(0,v.jsx)(Ae,{value:t.value,...n})},Ke=e=>{let{description:t="",maxValue:n,strong:r,type:a,value:o,valueOptions:s={},wrap:l,...i}=e;const d=100*o/n,c="bar"===a,u=i?.["data-testid"]||"progressValue",m=Ce(o,s);return(0,v.jsx)(T.A,{content:(0,v.jsx)(we,{description:t,value:o,units:s.units}),isBasic:!0,stretch:"align",children:(0,v.jsxs)(h.Flex,{column:!0,"data-testid":u,gap:1,flexWrap:l,flex:!0,children:[!c&&(0,v.jsx)(Ie,{strong:r,testid:u,justifyContent:"end",children:m}),null!==o&&(0,v.jsx)(h.ProgressBar,{background:"border",border:"none",color:["green","netdata"],containerWidth:"100%","data-testid":`${u}-bar`,height:2,width:`${d}%`})]})})},Ee=e=>{let{value:t,wrap:n}=e;return t=Array.isArray(t)?t:[t],(0,v.jsx)(h.Flex,{alignItems:"center",justifyContent:"center",flexWrap:n,children:t.map(((e,t)=>(0,v.jsx)(h.Pill,{flavour:"neutral","data-testid":"pillValueComponent",margin:[.3],normal:!1,children:e},`${e}-${t}`)))})};var Le=n(75894);const Pe=e=>{let{hide:t,user:n}=e;return t||!n?null:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h.Text,{children:"by"}),(0,v.jsx)(ze,{children:n})]})},ze=e=>{let{color:t="text",...n}=e;return(0,v.jsx)(h.Text,{color:t,strong:!0,...n})},Me=e=>{let{type:t,text:n=t,hollow:r}=e;return(0,v.jsx)(Le.A,{flavour:t.toLowerCase(),...r&&{border:!1},children:n})},Be=(0,P.default)(h.Flex).attrs({gap:1,flexWrap:!0,alignItems:"center"}).withConfig({displayName:"components__Container",componentId:"sc-b5rk6g-0"})([""]);var $e=n(15920);const Re={CLEAR:0,WARNING:1,CRITICAL:2,UNINITIALIZED:3,UNDEFINED:4},Oe=e=>{let{chart:t,context:n,nodeId:a,nodeName:o,spaceSlug:s,roomSlug:l,alert:i}=e;const d=(0,$e.Zp)(),c=(0,m.Zl)(a),u=(0,r.useCallback)((()=>{d(c,i?.id?{state:{alertId:i.id}}:{state:{contextToGo:n?.name?.[0]}})}),[c,i]),x=`/spaces/${s}/rooms/${l}/alerts/${i?.id}`,{current:p,name:g,previous:f}=i;if("ERROR"===p.status)return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"For the alert"}),(0,v.jsx)(b.A,{Component:ze,as:$e.N_,to:x,children:g}),(0,v.jsx)(h.Text,{children:"for"}),(0,v.jsx)(b.A,{Component:ze,onClick:u,children:t.name}),(0,v.jsx)(h.Text,{children:"on"}),(0,v.jsx)(b.A,{Component:ze,onClick:u,children:o}),(0,v.jsx)(h.Text,{children:"we couldn't calculate the current value"}),(0,v.jsx)(T.A,{align:"bottom",content:"Please check your alert configuration",children:(0,v.jsx)(h.Icon,{color:"nodeBadgeColor",size:"small",name:"information"})})]});if("REMOVED"===p.status)return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Alert"}),(0,v.jsx)(b.A,{Component:ze,as:$e.N_,to:x,children:g}),(0,v.jsx)(h.Text,{children:"for"}),(0,v.jsx)(b.A,{Component:ze,onClick:u,children:t.name}),(0,v.jsx)(h.Text,{children:"on"}),(0,v.jsx)(b.A,{Component:ze,onClick:u,children:o}),(0,v.jsx)(h.Text,{children:"is no longer available, state can't be assessed"})]});const y=Re[p.status]===Re.CLEAR;return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Alert"}),(0,v.jsx)(b.A,{Component:ze,as:$e.N_,to:x,children:g}),(0,v.jsx)(h.Text,{children:"for"}),(0,v.jsx)(b.A,{Component:ze,onClick:u,children:t.name}),(0,v.jsx)(h.Text,{children:"on"}),(0,v.jsx)(b.A,{Component:ze,onClick:u,children:o}),y?(0,v.jsx)(h.Text,{children:"recovered"}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h.Text,{strong:!0,children:Re[f.status]===Re.CRITICAL?"was demoted":Re[f.status]===Re.WARNING?"escalated":Re[p.status]===Re.UNDEFINED?"transitioned":"was raised"}),(0,v.jsx)(h.Text,{children:"to"}),(0,v.jsx)(Me,{type:p.status}),Re[p.status]===Re.UNDEFINED&&(0,v.jsx)(h.Text,{children:"state"})]}),(0,v.jsx)(h.Text,{children:"with value"}),(0,v.jsx)(Me,{type:p.status,text:p.value_string,hollow:!0,padding:[0]})]})},Ne=e=>{let{id:t,name:n}=e;const r=`/spaces/${(0,Y.bq)()}/rooms/${(0,p.wz)(t,"slug")}/home`;return(0,v.jsx)(b.A,{Component:ze,as:$e.N_,to:r,children:n})},De=e=>{let{rooms:t}=e;return t.map(((e,n)=>(0,v.jsxs)(r.Fragment,{children:[n>0&&(n<t.length-1?", ":" and "),(0,v.jsx)(Ne,{...e})]},e.id)))},Ve=e=>{let{rooms:t}=e;if(!t.length)return null;const n=t.length>1?"rooms":"room";return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(h.Text,{children:["on ",n]}),(0,v.jsx)(De,{rooms:t})]})},_e=e=>{let{contexts:t}=e;t.map(((e,n)=>(0,v.jsxs)(r.Fragment,{children:[n>0&&(n<t.length-1?", ":" and "),(0,v.jsx)(ze,{children:e})]},e)))},qe=e=>{let{contexts:t}=e;if(!t.length)return null;const n=t.length>1?"contexts":"context";return(0,v.jsxs)(h.Text,{children:["on ",n," ",(0,v.jsx)(_e,{contexts:t})]})},We={month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",long:!1,dateStyle:void 0},He=e=>{let{start:t,end:n}=e;const{localeDateString:r}=(0,R.$j)();if(!t||!n)return null;const a=r(new Date(t),We),o=r(new Date(n),We);return(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(h.Text,{children:["(scheduled ",a," - ",o,")"]})})},Ue={"silencing-rule-created":"created","silencing-rule-deleted":"deleted","silencing-rule-changed":"changed"},Ge=e=>{let{rooms:t=[],contexts:n=[]}=e;return t.length||n.length?(0,v.jsxs)(v.Fragment,{children:[!!t.length&&(0,v.jsx)(Ve,{rooms:t}),!!t.length&&!!n.length&&(0,v.jsxs)(h.Text,{children:["and ",(0,v.jsx)(qe,{contexts:n})]})]}):null},Ze=e=>{let{action:t,notification:n,user:r,room:a,context:o}=e;const s=(n?.silencing?.rule||[])[0],l=r?.name,i=o?.name||[];return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Silencing rule"}),(0,v.jsx)(ze,{children:s.name}),(0,v.jsx)(Ge,{rooms:a,contexts:i}),(0,v.jsxs)(h.Text,{children:["was ",Ue[t]]}),(0,v.jsx)(Pe,{user:l}),(0,v.jsx)(He,{...s})]})};var Ye=n(16866);const Je=(e,t)=>e.target?.[t]||e.target?.id||e[t]||e.id,Xe=(e,t)=>{if(e)return t=t||"name",Array.isArray(e)?e[0][t]:e[t]},Qe={"space-setting-created":()=>(0,v.jsxs)(h.Text,{children:["was ",(0,v.jsx)(h.Text,{strong:!0,children:"created"})]}),"space-setting-changed":()=>(0,v.jsxs)(h.Text,{children:["was ",(0,v.jsx)(h.Text,{strong:!0,children:"updated"})]}),"space-setting-removed":()=>(0,v.jsxs)(h.Text,{children:["was ",(0,v.jsx)(h.Text,{strong:!0,children:"deleted"})]})},et=function(){let{event:e={},user:t={},token:n={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"space-claiming-token-created"==e.action?(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Claiming Token was created by user"}),(0,v.jsx)(Pe,{hide:!t.target,user:t.name})]}):"space-claiming-token-revoked"==e.action?(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Claiming Token"}),(0,v.jsx)(h.Text,{strong:!0,children:n.prefix}),(0,v.jsx)(h.Text,{children:"was revoked by user"}),(0,v.jsx)(Pe,{hide:!t.target,user:t.name})]}):null},tt=e=>{let{action:t,Netdata:n}=e;const r=Qe[t];return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Setting on"}),(0,v.jsx)(ze,{children:Xe(n.settings,"type")}),r?(0,v.jsx)(r,{}):t,(0,v.jsxs)(h.Text,{children:["on ",Xe(n.space)]})]})},nt=e=>{let{statistics:t}=e;const{live:n,stale:r,removed:a,total:o}=t?.nodes||{};return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Space statistics. Nodes:"}),(0,v.jsxs)(h.Text,{color:Ye.J4.live.statusTextColor,children:[n," live"]}),(0,v.jsx)(h.Text,{children:","}),(0,v.jsxs)(h.Text,{color:Ye.J4.stale.statusTextColor,children:[r," stale"]}),(0,v.jsx)(h.Text,{children:","}),(0,v.jsxs)(h.Text,{color:Ye.J4.offline.statusTextColor,children:[a," removed"]}),(0,v.jsx)(h.Text,{children:","}),(0,v.jsxs)(h.Text,{strong:!0,children:[o," total"]})]})};n(78898);var rt=n(71341);const at=e=>{let{stateColor:t,state:n}=e;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h.Text,{children:"became"}),(0,v.jsx)(ze,{color:t,children:n})]})},ot=e=>{let{stateColor:t,state:n}=e;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h.Text,{children:"was"}),(0,v.jsx)(ze,{color:t,children:n})]})},st={"node-created":ot,"node-state-live":at,"node-state-stale":at,"node-state-offline":at,"node-removed":ot,"node-deleted":ot,"node-restored":ot,default:ot},lt=e=>{let{action:t,hosts:n=[]}=e;const{id:a,name:o}=n[0],s=(0,$e.Zp)(),l=(0,m.Zl)(a),i=(0,r.useCallback)((()=>s(l)),[l]),d=st[t]||st.default,c=t.split("-").at(-1),u=rt.P[c]?.statusTextColor;return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Node"}),(0,v.jsx)(b.A,{Component:ze,onClick:i,children:o}),(0,v.jsx)(d,{stateColor:u,state:c})]})},it=e=>{let{room:t}=e;const n=(0,p.XA)("untouchable");return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(h.Text,{children:["was ",(0,v.jsx)(h.Text,{strong:!0,children:"added"})," to",n?" room":""]}),(0,v.jsx)(ze,{children:n?Xe(t):"this room"})]})},dt=()=>(0,v.jsxs)(h.Text,{children:["was ",(0,v.jsx)(h.Text,{strong:!0,children:"created"})]}),ct=()=>(0,v.jsxs)(h.Text,{children:["was ",(0,v.jsx)(h.Text,{strong:!0,children:"deleted"})]}),ut=e=>{let{room:t}=e;const n=(0,p.XA)("untouchable");return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(h.Text,{children:["was ",(0,v.jsx)(h.Text,{strong:!0,children:"removed"})," from",n?" room":""]}),(0,v.jsx)(ze,{children:n?Xe(t):"this room"})]})},ht=e=>{let{room:t}=e;const n=(0,p.XA)("untouchable");return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h.Text,{children:n?"room":""}),(0,v.jsx)(ze,{children:n?Xe(t):"this room"})]})},mt={"room-created":dt,"room-deleted":ct,"room-node-added":it,"room-node-removed":ut,"room-user-added":it,"room-user-removed":ut,"room-setting-created":dt,"room-setting-changed":()=>(0,v.jsxs)(h.Text,{children:["was ",(0,v.jsx)(h.Text,{strong:!0,children:"updated"})]}),"room-setting-removed":ct},xt=e=>{let{action:t,hosts:n=[],Netdata:r,user:a}=e;const o=mt[t],s=n[0]?.name;return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Node"}),(0,v.jsx)(ze,{children:s}),o?(0,v.jsx)(o,{room:r.room}):t,(0,v.jsx)(Pe,{user:a?.name})]})},pt=e=>{let{action:t,Netdata:n,user:r}=e;const a=mt[t];return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"User"}),(0,v.jsx)(ze,{children:Je(r,"name")}),a?(0,v.jsx)(a,{room:n.room}):t,(0,v.jsx)(Pe,{hide:!r.target,user:r.name})]})},gt=e=>{let{action:t,Netdata:n}=e;const r=mt[t];return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Setting on"}),(0,v.jsx)(ze,{children:Xe(n.settings,"type")}),r?(0,v.jsx)(r,{}):t,(0,v.jsx)(h.Text,{children:"on"}),(0,v.jsx)(ht,{room:n.room})]})},ft=e=>{let{action:t,Netdata:n,user:r}=e;const a=mt[t];return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Room"}),(0,v.jsx)(ze,{children:Xe(n.room)}),a?(0,v.jsx)(a,{}):t,(0,v.jsx)(Pe,{user:r.name})]})},yt={"alert-node-transition":e=>{let{chart:t,hosts:n,alert:r,...a}=e;return n.map(((e,n)=>{let{id:o,name:s}=e;const l={...r,name:r.name[n],...r.current?{current:{...r.current,...r.current.status?{status:r.current.status[n]||r.current.status[0]}:{}}}:{}};return(0,v.jsx)(Oe,{chart:t,nodeId:o,nodeName:s,alert:l,...a},o)}))},"node-created":lt,"node-state-live":lt,"node-state-stale":lt,"node-state-offline":lt,"node-removed":lt,"node-deleted":lt,"node-restored":lt,"agent-connected":e=>{let{agentId:t}=e;return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Agent with claim ID"}),(0,v.jsx)(ze,{children:t})," ",(0,v.jsxs)(h.Text,{children:["has ",(0,v.jsx)(h.Text,{strong:!0,children:"connected"})," to Netdata"]})]})},"agent-connection-initialized":e=>{let{agentId:t,reason:n}=e;return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Agent with claim ID"}),(0,v.jsx)(ze,{children:t}),(0,v.jsxs)(h.Text,{children:["has ",(0,v.jsx)(h.Text,{strong:!0,children:"initialized"})," its connection to Netdata"]})]})},"agent-disconnected":e=>{let{agentId:t,reason:n}=e;return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Agent with claim ID"}),(0,v.jsx)(ze,{children:t}),(0,v.jsxs)(h.Text,{children:["has ",(0,v.jsx)(h.Text,{strong:!0,children:"disconnected"})," from Netdata with reason: \u201c",n,"\u201d"]})]})},"agent-authenticated":e=>{let{agentId:t}=e;return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Agent with claim ID"}),(0,v.jsx)(ze,{children:t}),(0,v.jsxs)(h.Text,{children:["has ",(0,v.jsx)(h.Text,{strong:!0,children:"successfully"})," authenticated"]})]})},"agent-authentication-failed":e=>{let{agentId:t}=e;return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Agent with claim ID"}),(0,v.jsx)(ze,{children:t}),(0,v.jsxs)(h.Text,{children:["has ",(0,v.jsx)(h.Text,{strong:!0,children:"failed"})," to authenticate"]})]})},"room-created":ft,"room-deleted":ft,"room-node-added":xt,"room-node-removed":xt,"room-user-added":pt,"room-user-removed":pt,"space-created":e=>{let{Netdata:t,user:n}=e;return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Space"}),(0,v.jsx)(ze,{children:Xe(t.space)}),(0,v.jsx)(h.Text,{children:"was created"}),(0,v.jsx)(Pe,{user:n.name})]})},"space-statistics":nt,"space-user-added":e=>{let{Netdata:t,user:n}=e;const{name:r}=t?.inviter||{};return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"User"}),(0,v.jsx)(ze,{children:Je(n,"name")}),(0,v.jsx)(h.Text,{children:"was added to this space"}),r&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h.Text,{children:"by invite of"}),(0,v.jsx)(ze,{children:r})]})]})},"space-user-changed":e=>{let{user:t}=e;if(!!t.changes?.roles&&1===Object.keys(t.changes).length){const e=t.changes.roles.length>1,n=t.changes.roles.join(", ");return(0,v.jsxs)(Be,{children:[(0,v.jsxs)(h.Text,{children:["User ",e?"roles":"role"," for"]}),(0,v.jsx)(ze,{children:Je(t,"name")}),(0,v.jsxs)(h.Text,{children:[e?"were":"was"," changed to"]}),(0,v.jsx)(ze,{children:n}),(0,v.jsx)(Pe,{hide:!t.target,user:t.name})]})}return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"User"}),(0,v.jsx)(ze,{children:Je(t,"name")}),(0,v.jsx)(h.Text,{children:"was modified"})]})},"space-user-invited":e=>{let{user:t}=e;return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"User"}),(0,v.jsx)(ze,{children:Je(t,"email")}),(0,v.jsx)(h.Text,{children:"was invited to this space"}),(0,v.jsx)(Pe,{user:t.name})]})},"space-user-removed":e=>{let{user:t}=e;const{name:n}=t.target||{};return(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"User"}),(0,v.jsx)(ze,{children:Je(t,"name")}),(0,v.jsx)(h.Text,{children:"was removed from this space"}),n&&(0,v.jsx)(Pe,{user:t.name})]})},"space-user-uninvited":e=>{let{event:t,user:n}=e;return"space-invite-expired"===t.reason?(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"The invite for"}),(0,v.jsx)(ze,{children:Je(n,"email")}),(0,v.jsx)(h.Text,{children:"to this space has expired"})]}):(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"User"}),(0,v.jsx)(ze,{children:Je(n,"email")}),(0,v.jsx)(h.Text,{children:"was uninvited from this space"}),(0,v.jsx)(Pe,{hide:!n.target,user:n.name})]})},"space-claiming-token-created":et,"space-claiming-token-revoked":et,"silencing-rule-created":Ze,"silencing-rule-deleted":Ze,"silencing-rule-changed":Ze,"space-settings-created":tt,"space-settings-removed":tt,"space-settings-changed":tt,"room-settings-created":gt,"room-settings-removed":gt,"room-settings-changed":gt},bt=e=>{let{data:t}=e;const{action:n,roomId:r,space:a}=t.source,o=(0,Y.ns)(a.id,"slug"),s=(0,p.wz)(r,"slug"),l=yt[n];return l?(0,v.jsx)(l,{...t.source,spaceSlug:o,roomSlug:s}):(0,v.jsxs)(Be,{children:[(0,v.jsx)(h.Text,{children:"Event"})," ",(0,v.jsx)(h.Text,{strong:!0,children:n})," ",(0,v.jsx)(h.Text,{children:"emitted"})]})},jt={bar:Ke,"bar-with-integer":Ke,duration:Ke,pill:Ee,number:Ae,string:Ae,feedTemplate:bt,datetime:e=>{let{value:t,...n}=e;const r=new Date(t),{localeTimeString:a,localeDateString:o,utcOffset:s}=(0,R.$j)(),l=isNaN(r.valueOf())?"Missing date & time":`${o(r,{long:!1})} ${a(r,{secs:!0})}`;return(0,v.jsx)(Ae,{value:l,...n})},value:Ae},vt={bar:Ke,pill:Ee,value:Ae,richValue:Te,feedTemplate:bt,rowOptions:"skip"},Ct=e=>{let{visualization:t,type:n,value:r,data:a,...o}=e;const s=vt[t]||jt[n]||vt.value;return s===vt.rowOptions?null:(0,v.jsx)(s,{value:r,type:n,rowOptions:a?.rowOptions,data:a,...o})},wt={sum:"sum",min:"min",max:"max",extent:"extent",mean:"mean",median:"median",unique:"unique",uniqueCount:"uniqueCount",count:"count"};var kt=n(52035),Ft=n(34843),St=n(84929);const It={query:(e,t,n)=>{let{columnVisibility:r}=n;const a="string"===typeof t?t.toLowerCase():"";return Object.entries(e).some((e=>{let[t,n]=e;return!!r[t]&&(null!==n&&"undefined"!==typeof n&&(Array.isArray(n)?n.some((e=>String(e).toLowerCase().includes(a))):("object"===typeof n&&Object.keys(n).some((e=>String(n[e]).toLowerCase().includes(a))),String(n).toLowerCase().includes(a))))}))}},At=e=>(t,n)=>!e.some((e=>{let[r,a]=e;return It[r]?!It[r](t,a,n):!(e=>(t,n,r)=>{if(!r.columns[e]||"facet"===r.columns[e]?.filter)return!0;if("range"===r.columns[e]?.filter&&n?.length)return t[e]>=n[0]&&t[e]<=n[1];if(!Array.isArray(n)||!n.length)return!0;let a=t[e];return"number"===typeof a?(a=parseFloat(a),n.some((e=>parseFloat(e)===a))):n.includes(a)})(r)(t,a,n)})),Tt=(0,St.Iz)((e=>{let{extraKey:t,baseKey:n,omit:r,keepAll:a,fn:o}=e;return(0,kt.eU)((e=>{const{columnVisibility:l,data:i,columns:d,aggregations:c,requiredParams:u}=e((0,s.WB)({id:o}));if(c||!i)return i||[];const h=e((0,L.GA)({key:n,extraKey:`${t}Filters`,merge:!1})),m=r?r.split(":::"):[],x=Object.keys(h).reduce(((e,t)=>(u.some((e=>e.id===t))||m.includes(t)||e.push([t,h[t]]),e)),[]);if(!x.length)return i;const p=At(x),g=e((0,L.GA)({key:n,extraKey:`${o}Settings`,flavour:"val"}))?.sortColumn;return a?i.map((e=>p(e,{columnVisibility:l,columns:d,sortColumn:g})?e:{...e,hidden:!0})):i.filter((e=>p(e,{columnVisibility:l,columns:d,sortColumn:g})))}))}),fe.Ay),Kt=function(){let{extraKey:e="fn",omit:t,keepAll:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=(0,s.Ak)({extraKey:e}),[a,o]=(0,s.l0)({extraKey:e});return(0,Ft.md)(Tt({extraKey:o,fn:r,baseKey:a,omit:t,keepAll:n}))};var Et=n(64463),Lt=n(62193),Pt=n.n(Lt),zt=(n(3949),n(71517),n(11379),n(93777),n(14190),n(12359),n(86097),n(17273),n(27415),n(19929),n(37583),n(55122),n(20230),n(57268),n(79733),n(67012));const Mt=(0,r.memo)((e=>{let{paramsKey:t,noSearch:n}=e;const[a,o]=(0,s.ZY)({param:"query",flavour:"val",...t,defaultValue:""}),[l,i]=(0,r.useState)(""),[d,c]=(0,r.useState)(),[u,m]=(0,r.useState)(!1);(0,r.useEffect)((()=>{u||l===a||""===l||m(!0)}),[l,u,a]);const[x,p]=(0,r.useState)(0),g=(0,r.useRef)(),f=(0,r.useRef)(),[,y]=(0,A.A)(),b=(0,s.Ol)(t,"aggregations"),j=(0,s.Ol)(t,"columns"),C=(0,s.Ol)(t,"alphabetical"),{requiredParams:w}=(0,s.Ol)(t)||{},k=(0,s.Ph)(t.extraKey),[F,S]=(0,s.S3)(t),I=(0,s.Be)(t),[K,E]=(0,s.oV)({...t,param:"selectedFacets",flavour:"arr",defaultValue:null}),L=Kt({extraKey:t.extraKey,keepAll:!0}),P=(0,r.useMemo)((()=>{const e={searchAction:null,topFilters:[],groupedValues:{},allFilters:[]},t=l.toLowerCase().trim(),n=!!b;t&&(e.searchAction={query:l,text:`Search for "${l}"`});const r=[],a=new Map,o=new Set;return k&&k.length>0&&k.forEach((e=>{const n={id:e.id,name:e.name||e.id,count:e.options?.length||0,score:0};if(!F.includes(e.id)&&!o.has(e.id)){if(t){const r=(e.name||"").toLowerCase().includes(t),a=e.id.toLowerCase().includes(t);r&&(n.score+=10),a&&(n.score+=5),e.name&&e.name.toLowerCase().startsWith(t)&&(n.score+=15)}else n.score=e.options?.length||0;(n.score>0||!t)&&r.push(n),o.add(e.id)}if(e.options){const n=[];e.options.forEach((e=>{const r=e.name||e.id;let a=!t,o=e.count||0;if(t){r.toLowerCase().includes(t)&&(a=!0,o=100,r.toLowerCase().startsWith(t)&&(o+=50))}a&&n.push({value:e.id,label:r,count:e.count||0,score:o})})),n.length>0&&(n.sort(((e,t)=>t.score-e.score)),a.set(e.id,{filterName:e.name||e.id,values:n.slice(0,t?10:5)}))}})),w&&w.length>0&&w.forEach((e=>{if(!F.includes(e.id)&&!o.has(e.id)){const n={id:e.id,name:e.name||e.id,count:e.options?.length||0,score:0};if(t){const r=(e.name||"").toLowerCase().includes(t),a=e.id.toLowerCase().includes(t);r&&(n.score+=10),a&&(n.score+=5),e.name&&e.name.toLowerCase().startsWith(t)&&(n.score+=15)}else n.score=e.options?.length||0;(n.score>0||!t)&&r.push(n),o.add(e.id)}if(e.options){const n=[];e.options.forEach((e=>{const r=e.name||e.id;let a=!t,o=1;if(t){r.toLowerCase().includes(t)&&(a=!0,o=100,r.toLowerCase().startsWith(t)&&(o+=50))}a&&n.push({value:e.id,label:r,count:1,score:o})})),n.length>0&&(n.sort(((e,t)=>t.score-e.score)),a.set(e.id,{filterName:e.name||e.id,values:n.slice(0,t?10:5)}))}})),C&&j&&C.forEach((e=>{const s=j[e];if(!s)return;const l=s.filter&&"none"!==s.filter&&"facet"!==s.filter,i=F.includes(e);if(n&&("facet"===s.filter||"multiselect"===s.filter)||!n&&l){if(!i&&!o.has(e)){const n={id:e,name:s.name||e,filterType:s.filter,score:0};if(t){const r=(s.name||"").toLowerCase().includes(t),a=e.toLowerCase().includes(t);r&&(n.score+=10),a&&(n.score+=5),s.name&&s.name.toLowerCase().startsWith(t)&&(n.score+=15)}else n.score=1;(n.score>0||!t)&&r.push(n),o.add(e)}if(!n&&L){const n=new Map;L.forEach((r=>{if(!r.hidden){const a=r[e];if(void 0!==a&&null!==a&&""!==a){const e=String(a);let r=!t,o=1;if(t){e.toLowerCase().includes(t)&&(r=!0,o=100,e.toLowerCase().startsWith(t)&&(o+=50))}r&&(n.has(e)||n.set(e,{count:0,score:o}),n.get(e).count++)}}}));const r=Array.from(n.entries()).map((e=>{let[t,n]=e;return{value:t,label:t,count:n.count,score:n.score*n.count}})).sort(((e,t)=>t.score-e.score)).slice(0,t?10:5);r.length>0&&a.set(e,{filterName:s.name||e,values:r})}}})),r.sort(((e,t)=>t.score-e.score)),e.allFilters=r,e.topFilters=t?r.slice(0,5):r,a.forEach(((n,r)=>{(e.topFilters.some((e=>e.id===r))||t)&&(e.groupedValues[r]=n)})),e}),[l,b,k,C,j,F,L,w,K,t.extraKey]),z=(0,r.useMemo)((()=>{const e=[];return P.searchAction&&e.push({type:"search",...P.searchAction}),P.topFilters.forEach((t=>{e.push({type:"filter",...t})})),Object.entries(P.groupedValues).forEach((t=>{let[n,r]=t;r.values.forEach((t=>{e.push({type:"value",filterId:n,filterName:r.filterName,...t})}))})),e}),[P]),M=(0,s.U6)(t),B=(0,r.useCallback)((()=>{n||o(l),i(""),c((new Date).getTime()),m(!1)}),[l,o,n]),$=(0,r.useCallback)((e=>{K&&!K.includes(e)&&E((t=>[...t||[],e])),S((t=>[...t,e])),i(""),c((new Date).getTime()),m(!1)}),[S,K,E]),R=(0,r.useCallback)(((e,t)=>{F.includes(e)||(K&&!K.includes(e)&&E((t=>[...t||[],e])),S((t=>[...t,e])));const n=I[e]||[];n.includes(t)||M(e,[...n,t]),i(""),c((new Date).getTime()),m(!1)}),[F,S,I,M,K,E]),O=(0,r.useCallback)((e=>{if(u)if("ArrowDown"===e.key)e.preventDefault(),p((e=>(e+1)%z.length));else if("ArrowUp"===e.key)e.preventDefault(),p((e=>(e-1+z.length)%z.length));else if("Enter"===e.key){e.preventDefault();const t=z[x];t&&("search"===t.type?B():"filter"===t.type?$(t.id):"value"===t.type&&R(t.filterId,t.value))}else"Escape"===e.key&&(m(!1),i(""),c((new Date).getTime()));else"Enter"!==e.key&&"ArrowDown"!==e.key||(e.preventDefault(),m(!0))}),[u,x,z,B,$,R]);(0,r.useEffect)((()=>{p(0)}),[l]),(0,zt.A)((()=>{y(!!u)}),[u]);const N=(0,r.useCallback)((()=>{m(!0),p(0)}),[]),D=(0,r.useCallback)((e=>{f.current?.contains(e.relatedTarget)||setTimeout((()=>m(!1)),200)}),[]);let V=0;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h.SearchInput,{ref:g,value:l,reset:d,onChange:i,onKeyDown:O,onFocus:N,onClick:N,onBlur:D,onReset:n?null:()=>o(""),placeholder:"Search or filter...","data-testid":"search-filter-input",border:"none",_hover:{border:"none"},_focus:{border:"none"},containerStyles:{flex:"1",minWidth:"200px"},width:{base:"100%",min:"150px"},background:"panelBg"}),g.current&&u&&(0,v.jsx)(h.Drop,{align:{top:"bottom",left:"left"},target:g.current,onEsc:()=>m(!1),zIndex:1e3,backdrop:!0,backdropProps:{background:["transparent","full"]},children:(0,v.jsx)(h.Flex,{ref:f,background:"dropdown",border:!0,round:2,width:{base:"100%",min:"480px",max:"600px"},height:{max:"30vh"},overflow:"hidden",column:!0,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.12)",children:(0,v.jsxs)(h.Box,{overflow:"auto",flex:"1",children:[!n&&P.searchAction&&(0,v.jsxs)(h.Flex,{onClick:B,padding:[1.5,2],cursor:"pointer",alignItems:"center",gap:2,background:x===V++?"secondaryHighlight":void 0,_hover:{background:"secondaryHighlight"},children:[(0,v.jsx)(h.Icon,{name:"search",width:"16px",height:"16px",color:"textLite"}),(0,v.jsx)(h.TextSmall,{children:P.searchAction.text})]}),P.topFilters.length>0&&(0,v.jsxs)(v.Fragment,{children:[l&&(0,v.jsx)(h.Flex,{padding:[.75,2],background:"modalBackground",position:"sticky",top:0,zIndex:1,children:(0,v.jsx)(h.TextMicro,{color:"textLite",strong:!0,uppercase:!0,children:"Top Filters"})}),P.topFilters.map((e=>(0,v.jsxs)(h.Flex,{onClick:()=>$(e.id),padding:[1.25,2],cursor:"pointer",alignItems:"center",justifyContent:"between",background:x===V++?"secondaryHighlight":void 0,_hover:{background:"secondaryHighlight"},children:[(0,v.jsxs)(h.Flex,{alignItems:"center",gap:1.5,children:[(0,v.jsx)(h.Icon,{name:"filterList",width:"14px",height:"14px",color:"textLite"}),(0,v.jsx)(h.TextSmall,{strong:!0,children:e.name}),e.id!==e.name&&(0,v.jsxs)(h.TextMicro,{color:"textLite",children:["(",e.id,")"]})]}),e.count>0&&(0,v.jsx)(T.A,{align:"top",content:`${e.count} results`,children:(0,v.jsx)(h.Pill,{flavour:"neutral",hollow:!0,size:"small",children:(0,v.jsx)(h.TextMicro,{children:e.count})})})]},e.id)))]}),Object.entries(P.groupedValues).map((e=>{let[t,n]=e;return(0,v.jsxs)(h.Box,{children:[(0,v.jsxs)(h.Flex,{padding:[1,2],background:"inputBg",borderTop:!0,margin:[1,0,0,0],alignItems:"center",justifyContent:"between",children:[(0,v.jsx)(h.TextSmall,{strong:!0,color:"text",children:n.filterName}),(0,v.jsx)(h.TextMicro,{color:"textLite",children:t!==n.filterName&&t})]}),n.values.map((e=>(0,v.jsxs)(h.Flex,{onClick:()=>R(t,e.value),padding:[1,2,1,4],cursor:"pointer",alignItems:"center",justifyContent:"between",background:x===V++?"secondaryHighlight":void 0,_hover:{background:"secondaryHighlight"},children:[(0,v.jsx)(h.TextSmall,{children:e.label}),e.count>0&&(0,v.jsx)(h.TextMicro,{color:"textDescription",children:e.count})]},`${t}-${e.value}`)))]},t)})),!l&&0===P.topFilters.length&&0===Object.keys(P.groupedValues).length&&(0,v.jsxs)(h.Flex,{column:!0,alignItems:"center",justifyContent:"center",padding:[4],children:[(0,v.jsx)(h.Icon,{name:"search",width:"32px",height:"32px",color:"textLite"}),(0,v.jsx)(h.TextSmall,{color:"textLite",margin:[2,0,0,0],children:"Start typing to search and filter"})]}),l&&!P.searchAction&&0===P.topFilters.length&&0===Object.keys(P.groupedValues).length&&(0,v.jsx)(h.Flex,{column:!0,alignItems:"center",justifyContent:"center",padding:[4],children:(0,v.jsxs)(h.TextSmall,{color:"textLite",children:['No results for "',l,'"']})})]})})})]})})),Bt=Mt,$t=e=>{let{onRemove:t,end:n=!0,...r}=e;return(0,v.jsx)(h.Box,{"data-testid":"remove-button",onClick:t,cursor:"pointer",...r,children:(0,v.jsx)(h.Icon,{name:"close_circle",width:"12px",height:"12px",color:"textLite",sx:{visibility:"hidden",".selected-item:hover &":{visibility:"visible"}}})})},Rt=e=>{let{children:t,paramsKey:n,noSearch:r}=e;const[a,o]=(0,s.ZY)({param:"query",flavour:"val",...n,defaultValue:""}),l=a&&""!==a.trim();return(0,v.jsxs)(h.Flex,{"data-testid":"selected-items-container",width:"100%",alignItems:"center",padding:[.5,1],gap:1,flexWrap:!0,children:[(0,v.jsx)(h.Icon,{name:"filterList",color:"textLite",width:"16px",height:"16px"}),t,l&&(0,v.jsx)(h.Flex,{className:"selected-item",children:(0,v.jsx)(h.Pill,{flavour:"neutral",hollow:!0,position:"relative",children:(0,v.jsxs)(h.Flex,{gap:.5,alignItems:"center",children:[(0,v.jsx)(h.TextSmall,{children:a}),(0,v.jsx)(T.A,{content:`Remove search "${a}"`,align:"top",children:(0,v.jsx)($t,{onRemove:()=>{o("")}})})]})})}),(0,v.jsx)(Bt,{paramsKey:n,noSearch:r})]})},Ot=(0,r.memo)(Rt);var Nt=n(56967),Dt=n(900),Vt=n(62672),_t=n(20982),qt=n(64007),Wt=n(74193),Ht=n(32755),Ut=n(48306),Gt=n(88038);const Zt=[{id:"alpha-asc",icon:n(59215).Ye,tooltip:"Sort by name ascending"},{id:"alpha-desc",icon:Gt.PE,tooltip:"Sort by name descending"},{id:"num-asc",icon:Ut.v6,tooltip:"Sort by value ascending"},{id:"num-desc",icon:Ht.ut,tooltip:"Sort by value descending"}],Yt=e=>{let{sortBy:t,onChange:n,testIdPrefix:r}=e;const a=Zt.find((e=>e.id===t)),o=Zt[(Zt.findIndex((e=>e.id===t))+1)%Zt.length];return(0,v.jsx)(T.A,{content:()=>(0,v.jsxs)(v.Fragment,{children:[a?.tooltip||"Sort",".",(0,v.jsx)("br",{}),"Click to ",o?.tooltip.toLowerCase()||"change sorting"]}),align:"top",isBasic:!0,children:(0,v.jsx)(h.IconButton,{padding:[0],flavour:"borderless",onClick:e=>{e.stopPropagation(),n(o.id)},"data-testid":`${r}-filter-download-csv`,tiny:!0,neutral:!0,children:(0,v.jsx)(_t.g,{icon:a?.icon||Wt.OM,size:"lg",alt:"Sort by"})})})},Jt=e=>{let{extraKey:t,param:n,title:r,testIdPrefix:a}=e;const[o,s]=(0,L.r$)(`${n}-sort`,{extraKey:t,flavour:"val",defaultValue:"alpha-asc"});return[o,s,(0,v.jsx)(Yt,{sortBy:o,onChange:s,testIdPrefix:a},r)]};var Xt=n(65890);const Qt=(e,t)=>{(0,r.useEffect)((()=>{if(!e)return;const n=()=>{requestAnimationFrame((()=>{let e;if(t){const n=document.querySelectorAll('[data-testid="drop"]'),r=Array.from(n).find((e=>e.querySelector(t)));e=r?.querySelector('input[data-testid="dropdown-search"]')}else{const t=document.querySelectorAll('input[data-testid="dropdown-search"]');e=t[t.length-1]}e&&document.activeElement!==e&&(document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),Promise.resolve().then((()=>{e.focus(),e.click(),setTimeout((()=>{document.activeElement!==e&&e.focus()}),10)})))}))};n();const r=[100,200,500].map((e=>setTimeout(n,e)));return()=>{r.forEach(clearTimeout)}}),[e,t])},en=(0,P.default)(h.Flex).withConfig({displayName:"dropdownFilter__HoveredFlex",componentId:"sc-49bt09-0"})(["position:relative;& .remove-button-wrapper{visibility:hidden;position:absolute;top:-6px;right:-6px;z-index:1;}&:hover .remove-button-wrapper{visibility:visible;}"]),tn=(0,r.memo)((e=>{let{id:t,label:n,isEnabled:r,handleToggleEnabled:a,selectedCount:o,isDisabled:s,selected:l,setFilter:i,hiddenZeros:d,toggleHideZeros:c,sortAction:u,filteredOptions:m,sortBy:x,baseKey:p,filtersKey:g,paramsKey:f,checkboxesRef:y,nonZeroCount:b,totalCount:j,hasAggregatedView:C,totalActualCount:w,aggregatedLabel:k,resultsLabel:F}=e;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(h.Flex,{padding:[1,2],justifyContent:"between",children:[(0,v.jsxs)(h.Flex,{gap:2,alignItems:"center",children:[(0,v.jsx)(h.Checkbox,{checked:r,onChange:a,"data-testid":`filter-enabled-${t}`}),(0,v.jsxs)(h.Flex,{column:!0,gap:.5,children:[(0,v.jsxs)(h.Flex,{gap:1,alignItems:"center",children:[(0,v.jsx)(h.TextSmall,{strong:!0,children:n}),s&&o>0&&(0,v.jsxs)(h.TextSmall,{color:"textLite",children:["(",o," stored)"]})]}),(0,v.jsxs)(h.TextMicro,{color:"textDescription",children:[n!==t&&t,n!==t&&(j>0||C)&&" \u2022 ",C?(0,v.jsxs)(v.Fragment,{children:[w," ",k," \u2283 ",b," ",F]}):j>0&&(b===j?`${b} values`:`${b} out of ${j} values used`)]})]})]}),(0,v.jsxs)(h.Flex,{gap:1,alignItems:"center",children:[(0,v.jsx)(T.A,{content:"Reset selections",align:"top",children:(0,v.jsx)(h.IconButton,{padding:[0],flavour:"borderless",onClick:e=>{e.stopPropagation(),i([])},"data-testid":`dropdown-filter-${t}-resetAll`,neutral:!0,tiny:!0,disabled:!l?.length,children:(0,v.jsx)(_t.g,{icon:Vt.Df,size:"sm",alt:"Reset"})})}),(0,v.jsx)(T.A,{content:d?"Show zeros":"Hide zeros",align:"top",children:(0,v.jsx)(h.IconButton,{padding:[0],flavour:"borderless",onClick:e=>{e.stopPropagation(),c(!d)},"data-testid":`dropdown-filter-${t}-toggle-zeros`,tiny:!0,neutral:!0,children:(0,v.jsx)(_t.g,{icon:d?Dt.pS:Nt.k6,size:"md",alt:"Hide/show zeros"})})}),u,(0,v.jsx)(Xt.A,{title:n,options:m,testIdPrefix:`dropdown-filter-${t}`})]})]}),(0,v.jsxs)(h.Flex,{flex:"1",height:{min:0},overflow:"hidden",column:!0,children:[s&&(0,v.jsx)(h.Flex,{padding:[1,2],background:"warningLight",margin:[0,0,1,0],children:(0,v.jsx)(h.TextSmall,{children:"Filter is disabled. Enable to apply selections to results."})}),(0,v.jsx)(qt.Ay,{ref:y,param:t,baseKey:p,extraKey:g,collection:m,getValue:e=>e.id,getLabel:e=>e.name||e.id,hasSearch:!0,multi:!0,placeholder:`Search ${n.toLowerCase()}...`,searchInputProps:{autoFocus:!0},noResultsMessage:`No ${n.toLowerCase()} found`,hideZeros:!1,itemProps:{multi:!0,actualCountLabel:"results"},baseExtraKey:f.extraKey,height:{max:"100%"},resizeable:!1,sortBy:x,debounceDelay:0,batchMode:"event"})]})]})})),nn=(0,r.memo)((e=>{let{id:t,label:n,values:a,paramsKey:o,isRequired:l=!1}=e;const i=(0,r.useRef)(),d=(0,r.useRef)(),[c,u,,m]=(0,K.A)(!1),[,x]=(0,A.A)(),p=(0,s.hG)({...o,param:t}),g=(0,r.useCallback)((e=>p(e)),[p]),f=(0,s.Ol)(o,"aggregations"),y=(0,s.Ol)(o,"columns"),{requiredParams:b}=(0,s.Ol)(o)||{},j=(0,s.Ol)(o,"aggregatedView"),C=(0,s.Ph)(o.extraKey),w=(0,s.Cs)(o),k=`${(0,s.Ak)(o)||o.extraKey}Filters`;(0,zt.A)((()=>{x(!!c)}),[c]);const F=!f,S=Kt({extraKey:o.extraKey,omit:t,keepAll:F}),[I,E]=(0,s.Eh)(o),[,P]=(0,s.S3)(o),[z,M]=(0,s.f5)(o),B=(0,r.useMemo)((()=>I.includes(t)),[I,t]),$=!B,R=B?z[t]||[]:a,O=B||0===a.length,N=(0,r.useMemo)((()=>b?.find((e=>e.id===t))),[b,t]),D=(0,r.useMemo)((()=>C?.find((e=>e.id===t))||{}),[C,t]),V=(0,r.useMemo)((()=>{if(N?.options)return N.options;if(f&&D.options)return D.options;if(!f&&c&&S&&y&&y[t]){const e=S.reduce(((e,n)=>{const r=n[t];return void 0!==r&&null!==r&&""!==r&&(e[r]||(e[r]={count:0,actualCount:0}),e[r].count+=1,j&&j.column&&n[j.column]&&(e[r].actualCount+=n[j.column])),e}),{});return Object.entries(e).map((e=>{let[t,n]=e;return{id:t,name:t,count:n.count,...j&&n.actualCount>0&&{actualCount:n.actualCount,actualCountLabel:j.aggregatedLabel,countLabel:j.resultsLabel}}}))}return[]}),[N,f,D,S,y,t,c,j]),[_,q]=(0,L.r$)(`hiddenZeros-${t}`,{extraKey:o.extraKey,flavour:"bool",defaultValue:!1}),W=(0,r.useCallback)((e=>q(e)),[q]),H=(0,s.Be)({param:t,extraKey:o.extraKey,flavour:"arr"}),U=(0,r.useMemo)((()=>_&&V?.length?V.filter((e=>!("number"===typeof e.count&&0===e.count&&!H.includes(e.id)))):V),[V,H,_]),[G,,Z]=Jt({param:t,extraKey:o.extraKey,title:n,testIdPrefix:`dropdown-filter-${t}`}),Y=R.length,{nonZeroCount:J,totalCount:X,hasAggregatedView:Q,totalActualCount:ee,aggregatedLabel:te,resultsLabel:ne}=(0,r.useMemo)((()=>{if(!V||0===V.length)return{nonZeroCount:0,totalCount:0,hasAggregatedView:!1};const e=V.find((e=>void 0!==e.actualCount)),t=!!e;if(f&&D&&D.options){const n=D.options||[],r=n.filter((e=>(void 0!==e.count?e.count:void 0!==e.actualCount?e.actualCount:void 0!==e.value?e.value:0)>0)).length;let a=0;return t&&(a=n.reduce(((e,t)=>e+(t.actualCount||0)),0)),{nonZeroCount:r,totalCount:n.length,hasAggregatedView:t,totalActualCount:a,aggregatedLabel:e?.actualCountLabel||j?.aggregatedLabel,resultsLabel:e?.countLabel||j?.resultsLabel}}let n=0;return t&&(n=V.reduce(((e,t)=>e+(t.actualCount||0)),0)),{nonZeroCount:V.length,totalCount:V.length,hasAggregatedView:t,totalActualCount:n,aggregatedLabel:e?.actualCountLabel||j?.aggregatedLabel,resultsLabel:e?.countLabel||j?.resultsLabel}}),[f,D,V,j]),re=(0,r.useMemo)((()=>{if(0===Y)return"No selection";if(1===Y){const e=R[0];if(D?.options){const t=D.options.find((t=>t.id===e));if(t)return t.name||e}if(N?.options){const t=N.options.find((t=>t.id===e));if(t)return t.name||e}if(y&&y[t]){const n=y[t];if(n.values&&n.values[e])return n.values[e]}return e}return`${Y} selected`}),[Y,R,D,N,y,t]),ae=(0,r.useRef)(!1);(0,r.useEffect)((()=>{ae.current?B&&a.length>0&&(E((e=>e.filter((e=>e!==t)))),M((e=>{const n={...e};return delete n[t],n}))):ae.current=!0}),[a,B,t,E,M]);const oe=(0,r.useCallback)((()=>{g([]),P((e=>e.filter((e=>e!==t)))),E((e=>e.filter((e=>e!==t)))),M((e=>{const n={...e};return delete n[t],n}))}),[g,P,E,M,t]),se=(0,r.useCallback)((()=>{if(B){const e=z[t]||[];e.length>0&&g(e),E((e=>e.filter((e=>e!==t)))),M((e=>{const n={...e};return delete n[t],n}))}else a.length>0&&(M((e=>({...e,[t]:a}))),g([])),E((e=>[...e,t]))}),[E,M,g,B,t,a,z]);Qt(c,`[data-testid="filter-enabled-${t}"]`);const le=(0,r.useCallback)((()=>{c&&d.current?.hasPendingChanges&&d.current.applyChanges(),u()}),[c,u]),ie=(0,r.useCallback)((()=>{d.current?.hasPendingChanges&&d.current.applyChanges(),m()}),[m]),de=(0,r.useCallback)((()=>{d.current?.hasPendingChanges&&d.current.cancelChanges(),m()}),[m]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(en,{children:[(0,v.jsxs)(h.Flex,{ref:i,onClick:le,"data-testid":`dropdown-filter-${t}`,padding:[.5,1],border:"panelBg",round:!0,background:c?"border":void 0,cursor:"pointer",alignItems:"center",justifyContent:"between",opacity:$?1:.5,height:{min:8},width:{min:25,max:50},_hover:{background:"border"},children:[(0,v.jsxs)(h.Flex,{column:!0,gap:0,alignItems:"start",overflow:"hidden",flex:!0,children:[(0,v.jsx)(h.TextSmall,{strong:!0,color:O?"textLite":"text",truncate:!0,children:n}),(0,v.jsx)(h.TextMicro,{color:O?"textNoFocus":"textLite",truncate:!0,children:re})]}),(0,v.jsx)(h.Flex,{alignItems:"center",margin:[0,0,0,2],flexShrink:0,children:(0,v.jsx)(h.Icon,{name:"chevron_down",width:"12px",height:"12px",rotate:c?2:0,color:O?"textLite":"text"})})]}),!l&&(0,v.jsx)("div",{className:"remove-button-wrapper",children:(0,v.jsx)(T.A,{content:`Remove ${n} filter`,align:"top",children:(0,v.jsx)($t,{onRemove:oe})})})]}),c&&(0,v.jsx)(h.Drop,{align:{top:"bottom",left:"left"},target:i.current,onEsc:de,onClickOutside:ie,dropPlain:!0,zIndex:1e3,backdrop:!0,backdropProps:{background:["transparent","full"]},children:(0,v.jsxs)(h.Box,{width:{base:"320px",min:"320px",max:"600px"},height:{base:"400px",min:"200px",max:"600px"},background:"dropdown",overflow:"hidden",position:"relative",sx:{resize:"both","&::-webkit-resizer":{display:"none"}},children:[(0,v.jsx)(h.Flex,{background:"dropdown",border:!0,round:1,padding:[2],column:!0,gap:2,height:"100%",onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),sx:{boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)"},children:(0,v.jsx)(tn,{id:t,label:n,isEnabled:$,handleToggleEnabled:se,selectedCount:Y,isDisabled:B,selected:H,setFilter:g,hiddenZeros:_,toggleHideZeros:W,sortAction:Z,filteredOptions:U,sortBy:G,baseKey:w,filtersKey:k,paramsKey:o,checkboxesRef:d,nonZeroCount:J,totalCount:X,hasAggregatedView:Q,totalActualCount:ee,aggregatedLabel:te,resultsLabel:ne})}),(0,v.jsx)(h.IconButton,{icon:"resize_handler",padding:[0],position:"absolute",bottom:0,right:0,hoverColor:"textDescription",width:"14px",height:"14px",style:{cursor:"nwse-resize",pointerEvents:"none"}})]})})]})})),rn=nn,an=(0,P.default)(h.Flex).withConfig({displayName:"rangeDropdownFilter__HoveredFlex",componentId:"sc-1qw9i8d-0"})(["position:relative;& .remove-button-wrapper{visibility:hidden;position:absolute;top:-6px;right:-6px;z-index:1;}&:hover .remove-button-wrapper{visibility:visible;}"]),on=[],sn=(0,r.memo)((e=>{let{id:t,label:n,isEnabled:r,handleToggleEnabled:a,isDisabled:o,displayValues:s,handleReset:l,min:i,max:d,draftRange:c,currentMin:u,currentMax:m,handleRangeChange:x,step:p,containerWidth:g}=e;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(h.Flex,{padding:[1,2],justifyContent:"between",children:[(0,v.jsxs)(h.Flex,{gap:2,alignItems:"center",children:[(0,v.jsx)(h.Checkbox,{checked:r,onChange:a,"data-testid":`filter-enabled-${t}`}),(0,v.jsxs)(h.Flex,{column:!0,gap:.5,children:[(0,v.jsxs)(h.Flex,{gap:1,alignItems:"center",children:[(0,v.jsx)(h.TextSmall,{strong:!0,children:n}),o&&s.length>0&&(0,v.jsxs)(h.TextSmall,{color:"textLite",children:["(",s[0]," - ",s[1]," stored)"]})]}),(0,v.jsxs)(h.TextMicro,{color:"textDescription",children:[n!==t&&t,n!==t&&" \u2022 ","Range: ",i," - ",d]})]})]}),(0,v.jsx)(h.Flex,{gap:1,alignItems:"center",children:(0,v.jsx)(T.A,{content:"Reset to full range",align:"top",children:(0,v.jsx)(h.IconButton,{padding:[0],flavour:"borderless",onClick:l,"data-testid":`dropdown-filter-${t}-resetAll`,neutral:!0,tiny:!0,disabled:!s||0===s.length,children:(0,v.jsx)(_t.g,{icon:Vt.Df,size:"sm",alt:"Reset"})})})})]}),o&&(0,v.jsx)(h.Flex,{padding:[1,2],background:"warningLight",margin:[0,0,1,0],children:(0,v.jsx)(h.TextSmall,{children:"Filter is disabled. Enable to apply selections to results."})}),(0,v.jsx)(h.MultiRangeInput,{min:i,max:d,onChange:x,initMin:c?c[0]:u,initMax:c?c[1]:m,step:p,disabled:o,padding:[4]},`${t}-${g}`)]})})),ln=(0,r.memo)((e=>{let{id:t,label:n,values:a,paramsKey:o,isRequired:l=!1}=e;const i=(0,r.useRef)(),[d,c,,u]=(0,K.A)(!1),[,m]=(0,A.A)(),x=(0,s.hG)({...o,param:t}),p=(0,s.Ol)(o,"columns"),g=p?.[t]||{},f=1*(g.min||0),y=1*(g.max||0),b=g.valueOptions?.decimal_points||0,j=Math.pow(10,-b),[C,w]=(0,r.useState)(null),k=(0,r.useRef)(!1),[F,S]=(0,r.useState)(320),I=(0,r.useRef)(null),E=(0,r.useRef)(null),[L,P]=(0,s.Eh)(o),[,z]=(0,s.S3)(o),[M,B]=(0,s.f5)(o),$=(0,r.useMemo)((()=>L.includes(t)),[L,t]),R=!$,O=$?M[t]||on:a,N=$||0===a.length,D=void 0!==O[0]?1*O[0]:f,V=void 0!==O[1]?1*O[1]:y,_=(0,r.useCallback)((e=>{let{min:t,max:n}=e;w([t,n]),k.current=!0}),[]),q=(0,r.useMemo)((()=>{if(!O||0===O.length)return"Full range";const e=1*O[0],t=1*O[1],n=e=>b>0?e.toFixed(b):e.toString();return`${n(e)} - ${n(t)}`}),[O,b]),W=(0,r.useRef)(!1);(0,r.useEffect)((()=>{W.current?$&&a.length>0&&(P((e=>e.filter((e=>e!==t)))),B((e=>{const n={...e};return delete n[t],n}))):W.current=!0}),[a,$,t,P,B]);const H=(0,r.useCallback)((()=>{x([]),z((e=>e.filter((e=>e!==t)))),P((e=>e.filter((e=>e!==t)))),B((e=>{const n={...e};return delete n[t],n}))}),[x,z,P,B,t]),U=(0,r.useCallback)((()=>{if($){const e=M[t]||[];e.length>0&&x(e),P((e=>e.filter((e=>e!==t)))),B((e=>{const n={...e};return delete n[t],n}))}else a.length>0&&(B((e=>({...e,[t]:a}))),x([])),P((e=>[...e,t]))}),[P,B,x,$,t,a,M]),G=(0,r.useCallback)((()=>{x([])}),[x]);(0,zt.A)((()=>{m(!!d)}),[d]),Qt(d,`[data-testid="filter-enabled-${t}"]`),(0,r.useEffect)((()=>{if(!d||!E.current)return;return I.current=new ResizeObserver((e=>{for(const t of e){const e=t.contentRect.width;Math.abs(e-F)>5&&S(e)}})),I.current.observe(E.current),()=>{I.current&&I.current.disconnect()}}),[d,F]);const Z=(0,r.useCallback)((()=>{k.current&&C&&(C[0]===f&&C[1]===y?x([]):x(C),k.current=!1)}),[C,f,y,x]),Y=(0,r.useCallback)((()=>{w(null),k.current=!1}),[]),J=(0,r.useCallback)((()=>{d?Z():w(O.length>0?[...O]:null),c()}),[d,c,Z,O]),X=(0,r.useCallback)((()=>{Z(),u()}),[u,Z]),Q=(0,r.useCallback)((()=>{Y(),u()}),[u,Y]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(an,{children:[(0,v.jsxs)(h.Flex,{ref:i,onClick:J,"data-testid":`dropdown-filter-${t}`,padding:[.5,1],border:"panelBg",round:!0,background:d?"border":void 0,cursor:"pointer",alignItems:"center",justifyContent:"between",opacity:R?1:.5,height:{min:8},width:{min:25,max:50},_hover:{background:"border"},children:[(0,v.jsxs)(h.Flex,{column:!0,gap:0,alignItems:"start",overflow:"hidden",flex:!0,children:[(0,v.jsx)(h.TextSmall,{strong:!0,color:N?"textLite":"text",truncate:!0,children:n}),(0,v.jsx)(h.TextMicro,{color:N?"textNoFocus":"textLite",truncate:!0,children:q})]}),(0,v.jsx)(h.Flex,{alignItems:"center",margin:[0,0,0,2],flexShrink:0,children:(0,v.jsx)(h.Icon,{name:"chevron_down",width:"12px",height:"12px",rotate:d?2:0,color:N?"textLite":"text"})})]}),!l&&(0,v.jsx)("div",{className:"remove-button-wrapper",children:(0,v.jsx)(T.A,{content:`Remove ${n} filter`,align:"top",children:(0,v.jsx)($t,{onRemove:H})})})]}),d&&(0,v.jsx)(h.Drop,{align:{top:"bottom",left:"left"},target:i.current,onEsc:Q,onClickOutside:X,dropPlain:!0,zIndex:1e3,backdrop:!0,backdropProps:{background:["transparent","full"]},children:(0,v.jsxs)(h.Box,{ref:E,width:{base:"320px",min:"280px",max:"500px"},height:{base:"100px",min:"100px",max:"300px"},background:"dropdown",overflow:"hidden",position:"relative",sx:{resize:"both","&::-webkit-resizer":{display:"none"}},children:[(0,v.jsx)(h.Flex,{background:"dropdown",border:!0,round:1,padding:[2],column:!0,gap:2,height:"100%",onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),sx:{boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)"},children:(0,v.jsx)(sn,{id:t,label:n,isEnabled:R,handleToggleEnabled:U,isDisabled:$,displayValues:O,handleReset:G,min:f,max:y,draftRange:C,currentMin:D,currentMax:V,handleRangeChange:_,step:j,containerWidth:F})}),(0,v.jsx)(h.IconButton,{icon:"resize_handler",padding:[0],position:"absolute",bottom:0,right:0,hoverColor:"textDescription",width:"14px",height:"14px",style:{cursor:"nwse-resize",pointerEvents:"none"}})]})})]})})),dn=ln,cn=(0,r.memo)((e=>{let{paramsKey:t,noSearch:n}=e;const a=(0,s.Be)(t),o=(0,s.Ol)(t,"columns"),l=(0,s.Ol)(t,"aggregations"),{requiredParams:i}=(0,s.Ol)(t)||{},d=(0,s.Ph)(t.extraKey),[c,u]=(0,s.S3)(t),[m]=(0,s.oV)({...t,param:"selectedFacets",flavour:"arr"}),x=!l,p=(0,r.useMemo)((()=>i?.length?i.reduce(((e,t)=>(e[t.id]=t,e)),{}):{}),[i]);(0,r.useEffect)((()=>{Pt()(a)||u((e=>{const t=Object.keys(a).filter((t=>!Pt()(a[t])&&!e.includes(t)));return t.length>0?[...new Set([...e,...t])]:e}))}),[a,u]);const g=(0,r.useMemo)((()=>{const e=c.filter((e=>{if(void 0!==p[e])return!0;const t=d&&d.some((t=>t.id===e));return!(void 0===o[e]&&!t)&&(!!x||(!m||0===m.length||m.includes(e)))})),t=i?i.filter((t=>a[t.id]?.length>0&&!e.includes(t.id))).map((e=>e.id)):[];return[...e,...t]}),[c,o,i,p,a,m,x,t.extraKey,d]);return(0,v.jsx)(h.Flex,{width:"100%",overflow:"hidden",padding:[0],children:(0,v.jsx)(Ot,{paramsKey:t,noSearch:n,children:g.map((e=>{const n=o[e]||{},r=p[e],s=d?.find((t=>t.id===e)),l=n.name||r?.name||s?.name||e,i=a[e]||[],c=!!r;return"range"===(n.filter||"multiselect")?(0,v.jsx)(dn,{id:e,label:l,values:i,paramsKey:t,isRequired:c},e):(0,v.jsx)(rn,{id:e,label:l,values:i,paramsKey:t,isRequired:c},e)}))})})})),un=cn;var hn=n(15992),mn=n(88307);const xn=(0,n(74891).A)(h.Icon),pn=e=>{let{data:t}=e;return(0,v.jsx)(hn.A,{name:"Files",isEnabled:!1,children:(0,v.jsxs)(h.Flex,{gap:1,padding:[0,1],alignItems:"center",children:[(0,v.jsx)(h.Box,{sx:{fontWeight:"500",letterSpacing:"1px"},as:h.Text,color:"textLite",children:"{;}"}),(0,v.jsx)(h.TextSmall,{children:"Copy data as"}),(0,v.jsxs)(h.Flex,{cursor:"pointer",gap:1,onClick:(0,mn.C)(JSON.stringify(t),{text:"JSON copied to clipboard"}),children:[(0,v.jsx)(h.TextSmall,{color:"primary",children:"json"}),(0,v.jsx)(h.Icon,{color:"primary",size:"small",name:"copy"})]})]})})},gn=function(){let{data:e={},columns:t={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"fn";return Object.entries(e).sort(((e,n)=>{let[r]=e,[a]=n;return(t[r]?.displayName||r).localeCompare(t[a]?.displayName||a,void 0,{sensitivity:"accent",ignorePunctuation:!0})})).reduce(((e,n)=>{let[s,l]=n;const i=r?`${r}.${t[s]?.displayName||s}`:t[s]?.displayName||s;if(t[s]?.dummy)return e;if("feed"!==o&&!t[s])return e;const d=Array.isArray(l);if(d&&"object"===typeof l[0]&&null!==l[0]||d&&l.length>1)e.push([i,JSON.stringify(l)]),a[i]=l;else if(l&&"object"===typeof l)gn({data:l},e,i,a,o);else{if(null===l)return e;e.push([i,d?l.length>1?`[${l.join(", ")}]`:l[0]:l]),a[i]=d?l.length>1?`[${l.join(", ")}]`:l[0]:l}return e}),n)},fn=(0,P.default)(h.Flex).withConfig({displayName:"rowInfo__Container",componentId:"sc-1de592g-0"})(["*{font-family:monospace;letter-spacing:0.09px;line-height:13px;font-size:12px;overflow-wrap:anywhere;white-space:pre-wrap;word-break:break-word;}"]),yn=e=>{let{label:t,value:n,paramsKey:r,column:a}=e;const o=(0,s.Ol)(r,"aggregations"),[l,i]=(0,s.ZY)({...r,param:t,flavour:"arr",defaultValue:[]}),d=l?.includes?.(n),[c,u]=(0,s.oV)({param:"selectedFacets",...r,flavour:"arr",defaultValue:o?.map?.((e=>e.id))||null}),m=Array.isArray(c)&&c.length?c.includes(t):!!o?.some?.((e=>e.id===t||e.name===t));return(0,v.jsxs)(h.Flex,{alignItems:"start","data-testid":`sidebar-rowInfoContent-${t}`,gap:.5,children:[(0,v.jsxs)(h.Flex,{width:10,flex:!1,children:[("multiselect"===a?.filter||"facet"===a?.filter)&&(0,v.jsx)(xn,{name:d?"minimize_s":"plus",size:"small",color:d?"textNoFocus":"text",cursor:"pointer",tooltip:d?"Remove this filter":"Filter by this value",onClick:()=>i(d?l.filter((e=>e!==n)):[...l,n])}),"facet"===a?.filter&&(0,v.jsx)(xn,{name:"filter",size:"small",color:m?"textNoFocus":"text",cursor:"pointer",tooltip:m?"Remove filter from the sidebar":"Add filter on the sidebar",onClick:()=>u(m?c.filter((e=>e!==t)):[...c,t])})]}),(0,v.jsx)(h.Flex,{width:{base:"20%",max:50,min:20},flex:!1,children:(0,v.jsx)(h.TextSmall,{"data-testid":"entry-line-text-label",whiteSpace:"nowrap",color:"textDescription",children:t})}),(0,v.jsx)(h.Flex,{flex:!0,children:(0,v.jsx)(Ae,{value:n,valueOptions:a?.valueOptions,wrap:!0,showRaw:!0})})]},t)},bn=e=>{let{data:t,flavour:n,paramsKey:a,...o}=e;const l=(0,s.Ol)(a,"columns");let i={};const d=(0,r.useMemo)((()=>gn({data:t,columns:l},[],null,i,n).sort(((e,t)=>{let[n]=e,[r]=t;return n.localeCompare(r)}))),[t]);return(0,v.jsxs)(h.Flex,{column:!0,padding:[3],width:"100%",...o,children:[(0,v.jsxs)(fn,{column:!0,gap:2,children:[(0,v.jsxs)(h.Flex,{alignItems:"start",gap:.5,border:{side:"bottom"},padding:[2,0],children:[(0,v.jsx)(h.Flex,{width:{base:"5%",max:40,min:10},flex:!1,children:(0,v.jsx)(h.TextSmall,{"data-testid":"entry-line-text-label",whiteSpace:"nowrap",color:"textDescription"})}),(0,v.jsx)(h.Flex,{width:{base:"20%",max:100,min:50},flex:!1,children:(0,v.jsx)(h.TextSmall,{"data-testid":"entry-line-text-label",whiteSpace:"nowrap",color:"textDescription",children:"Label"})}),(0,v.jsx)(h.Flex,{flex:!0,children:(0,v.jsx)(h.TextSmall,{"data-testid":"entry-line-text-label",whiteSpace:"nowrap",color:"textDescription",children:"Value"})})]}),d.map((e=>{let[t,n]=e;return(0,v.jsx)(yn,{label:t,value:n,paramsKey:a,column:l[t]},t)}))]}),(0,v.jsx)(pn,{data:t.json||i})]})},jn=(0,P.default)(h.Table).withConfig({displayName:"table__StyledTable",componentId:"sc-1n2s6gl-0"})(["*{font-family:monospace;letter-spacing:0.09px;}"]),vn=(0,r.memo)(jn,((e,t)=>!t.paused&&(0,fe.Ay)(e,t,{keep:["columnVisibility","data","fnQuery","sortBy","virtualizeOptions","columnSizing","columnPinning","grouping"]})));let Cn;const wn=(0,r.memo)((e=>{let{"data-testid":t,paramsKey:n,refetch:a,flavour:o,paused:l,ref:i}=e;const d=(0,s.Ol)(n),{columns:c,sortedColumns:u,sortColumn:m,sortDirection:x,columnVisibility:p,pinnedColumns:g,loadingMore:f,retentionWarning:y,groupByColumns:b,pagination:j,merged:C,latestDirection:w,hasDirection:k,tail:F,aggregations:S,loaded:I}=d,A=(0,r.useRef)();A.current=d;const[T,K]=(0,s.UB)({param:"groupBy",defaultValue:"",flavour:"val",...n}),[E,L]=(0,s.UB)({param:"columnVisibility",defaultValue:p,flavour:"obj",...n}),P=(0,r.useMemo)((()=>({...p,...E})),[Object.keys(p).length,E]),z=Kt(n),M=(0,s.rc)(n),B="feed"===n.extraKey,$=((e,t,n)=>{let{groupBy:a}=n;return(0,r.useMemo)((()=>(e||[]).reduce(((e,n)=>{const r=t[n];if(!r)return e;const{displayName:o,name:s,sortable:l,sticky:i,units:d,max:c,dummy:u,cellSize:m,valueOptions:x,summary:p,type:g,visualization:f,wrap:y=!1,...b}=r;return u?e:[...e,{...b,displayName:o,id:o,accessorFn:e=>e[n],cell:e=>{let{getValue:t,row:n,cell:r}=e;const o=r.getIsAggregated(),l=t(),i=o&&(wt[p]===wt.count||wt[p]===wt.uniqueCount||!wt[p]);return(0,v.jsx)(Ct,{description:s,data:n.original,maxValue:c,padding:n.depth>0?[0,0,0,2.5*n.depth]:[0],strong:o,value:i?`${l}x`:l,tooltipValue:i?`${l} ${1===l?"item":"items"} associated with ${a} grouping`:l,valueOptions:i?{...x,transform:"none"}:x,type:g,visualization:f,wrap:y})},header:(0,v.jsxs)(h.Flex,{column:!0,children:[(0,v.jsx)(h.TextSmall,{strong:!0,children:o}),d&&(0,v.jsxs)(h.TextMicro,{children:["(",d,")"]})]}),headerString:()=>`${o} ${d?`(${d})`:""}`,enableSorting:l,aggregationFn:wt[p]||wt.count,...m,meta:{...o!==s?{tooltip:s}:{}}}]}),[])),[e,t,a])})(u,c,{...B?{}:{groupBy:T}}),[R,O]=(0,s.UB)({param:"colSizing",defaultValue:{},flavour:"obj",...n}),[N,D]=(0,s.UB)({param:"sortBy",flavour:"arrobj",...n}),V=(0,r.useMemo)((()=>N||(m?[{id:m,desc:"descending"===x}]:[])),[m,x,N]),_=(0,r.useMemo)((()=>({left:g})),[g]),q=(0,r.useRef)();q.current=f;const{pauseRef:W}=(0,Et.A)(),[H,U]=(0,r.useState)({}),G=(0,r.useCallback)(((e,t)=>{let{fullRow:n}=e;return n.getToggleExpandedHandler()(t)}),[]),Z=(0,r.useRef)(),Y=(0,r.useRef)(),J=(0,r.useRef)(),X=(0,r.useRef)(0),Q=(0,r.useRef)(0),ee=(0,r.useRef)(C);(0,r.useLayoutEffect)((()=>{C&&!F||!Y.current?.scrollOffset||Y.current.scrollToOffset(0)}),[C,F]),(0,r.useLayoutEffect)((()=>{clearTimeout(Cn),f||(Cn=setTimeout((()=>{ee.current=!1}),200))}),[f]),(0,r.useLayoutEffect)((()=>{if(!j||!k||F)return;if(Q.current!==z.length&&"forward"===w){const e=Y.current.scrollOffset;let t=0,n=Y.current.getMeasurements().find(((n,r)=>0!==r&&(t+=n.size,t>e)));if(n||(n=Y.current.getMeasurements()?.[1]),!n)return;J.current={...z[z.length-Q.current+(n.index-1)],headerSize:Y.current.getMeasurements()?.[0]?.size||0},C&&!F?X.current=0:J.current=null}const e=()=>{if(J.current&&X.current<5){X.current=X.current+1,Q.current=z.length;const t=J.current?.[j.column]?.toString?.();let n=Y.current.getMeasurements().find((e=>e.key.replace(/-\d+?/,"")===t));if(!n){const e=z.findIndex((e=>e[j.column]===t));n=Y.current.getMeasurements()[e+1]}return n?(Y.current.scrollToOffset(n.start-J.current.headerSize),void setTimeout(e)):(X.current=5,void(J.current=null))}X.current=5,J.current=null};e(),Q.current=z.length}),[z]);const te=(0,r.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"backward";F||q.current||A.current.hasDirection&&(ee.current||("backward"!==e||A.current.hasNextPage||A.current.anchorBefore)&&("forward"!==e||A.current.hasPrevPage||A.current.anchorAfter)&&("forward"===e&&(ee.current=!0),a({anchor:"backward"===e?A.current.anchorBefore:A.current.anchorAfter,merge:!0,direction:e,data_only:!0})))}),[F]),ne=(0,r.useCallback)((e=>"undefined"!==typeof A.current.data[e]?.[j?.column]?`${A.current.data[e][j?.column]}-${e}`:`${e}`),[]),re=(0,r.useCallback)((()=>A.current.hasNextPage),[]),ae=(0,r.useCallback)((()=>A.current.hasPrevPage),[]),oe=(0,r.useCallback)((e=>{e.scrollOffset>10&&W.current()}),[]),se=(0,r.useMemo)((()=>({overscan:15,getHasNextPage:re,getHasPrevPage:ae,loading:f,loadMore:te,warning:y,virtualRef:Y,getItemKey:ne,onVirtualChange:oe})),[z,f]),le=(0,s.dP)(),ie=(0,r.useMemo)((()=>B?{download:{handleAction:(e,t)=>{const n=t.getRowModel().rows.map((e=>e.original?.json)).filter(Boolean).map((e=>JSON.stringify(e))).join("\n"),r=new Blob([n],{type:"application/x-ndjson;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(r),a.setAttribute("download","events.ndjson"),document.body.appendChild(a),a.click(),a.remove()},isDisabled:!1,tooltipText:"Download as NDJSON",icon:"download",confirmation:!1,alwaysEnabled:!0}}:{download:{handleAction:(0,h.downloadCsvAction)(M),isDisabled:!1,tooltipText:"Download as CSV",icon:"download",confirmation:!1,alwaysEnabled:!0}}),[M]),de=(0,r.useCallback)((function(){let{row:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e||le(null),le(e)}),[]),ce=(0,r.useCallback)((e=>{let{data:t,fullRow:r,table:a}=e;return(0,v.jsx)(bn,{data:t?.json||t,flavour:o,paramsKey:n,fullRow:r,table:a})}),[z]),ue=(0,r.useCallback)(((e,t,n)=>n||e?j?.column?e?.[j?.column]:(e=>Object.keys(e).reduce(((t,n)=>e[n]?.unique_key?`${t}${e[n]}`:t),""))(e)||t:t),[]);return I&&!z?.length?null:(0,v.jsx)(vn,{title:(0,v.jsx)(un,{paramsKey:n,noSearch:B}),grouping:T,groupByColumns:b,onClickRow:G,columnPinning:_,columnVisibility:P,data:z,dataColumns:$,dataGa:"functions",enableColumnPinning:!!g?.length,enableColumnVisibility:!B,enableCustomSearch:!!S,enableResizing:!0,enableSorting:!B,onColumnVisibilityChange:L,onColumnSizingChange:O,columnSizing:R,onGroupByChange:B?null:K,onSortingChange:B?null:D,sortBy:V,testPrefix:t,virtualizeOptions:se,ref:i,expanded:H,onExpandedChange:U,tableRef:Z,onHoverCell:de,renderSubComponent:ce,getRowCanExpand:ge(),bulkActions:ie,getRowId:ue,paused:l})}),(()=>!0)),kn=wn;var Fn=n(2404),Sn=n.n(Fn),In=n(25279),An=n(91539),Tn=n(84103),Kn=n(52154),En=n(88055),Ln=n.n(En),Pn=n(72337);const zn=90,Mn=110,Bn=160,$n=1e3,Rn={minSize:1,maxSize:5e3},On=50,Nn={uniqueKey:{size:zn,downLimit:zn-On,upLimit:zn+On},bar:{size:zn,downLimit:zn-On,upLimit:zn+On},value:{size:Mn,downLimit:Mn-On,upLimit:Mn+On},feedTemplate:{size:$n,downLimit:$n-On,upLimit:$n+On,minSize:1,maxSize:5e3,fullWidth:!0},pill:{size:Mn,downLimit:Mn-On,upLimit:Mn+On},timestamp:{size:Bn,downLimit:Bn-On,upLimit:Bn+On},datetime:{size:Bn,downLimit:Bn-On,upLimit:Bn+On}},Dn=(e,t)=>{e((e=>{const{updateEvery:n,merge:r,reset:a,groupBy:o,items:s,direction:l,dataOnly:i,showIds:d=!1!==e.showIds,facetsDelta:c,histogramDelta:u,itemsDelta:h,aggregatedView:m,...x}=t;let p=a?t.columns:i?Ln()(e.columns):Ln()(r?(0,Pn.A)(t.columns,e.columns):t.columns),g=a?{}:{...e.sortedColumnsObj};const f=x.hasHistory||e.hasHistory,y=i?e.pagination:t.pagination;let b=Object.keys(p).reduce(((t,n)=>{const r=p[n],{id:o,name:s,sticky:l,visible:i,index:c}=r;return r.displayName=d?o||n:s,t.columnVisibility[r.displayName]=!a&&e.loaded?!!t.columnVisibility[r.displayName]:i,!l||!a&&e.loaded||t.pinnedColumns.push(r.displayName),r.valueOptions=r.valueOptions||{},r.cellSize=(e=>{let{visualization:t,type:n,fullWidth:r=!1,uniqueKey:a}=e;return{...Rn,fullWidth:r,...(a&&"timestamp"!==n?Nn.uniqueKey:Nn[n])||Nn[t]||{minSize:1,maxSize:5e3,size:Mn,downLimit:Mn-On,upLimit:Mn+On}}})(r),r.sortable=r.sortable&&!y?.enabled,"undefined"!==typeof c&&(g[g[c]!==n?r.displayName:c]=n),t}),{columnVisibility:a?{}:{...e.columnVisibility||{}},pinnedColumns:a?[]:[...e.pinnedColumns||[]]}),j=a||!e.alphabetical?.length?Object.keys(p).sort(((e,t)=>(p[e].displayName||p[e].name).localeCompare(p[t].displayName||p[t].name,void 0,{sensitivity:"accent",ignorePunctuation:!0}))):e.alphabetical,v=a?t.aggregations:r?Ln()(e.aggregations):t.aggregations||Ln()(e.aggregations);c&&Array.isArray(v)&&c.forEach((e=>{const t=v.find((t=>t.id===e.id));t?e.options.forEach((e=>{if(isNaN(e.count))return;const n=t.options.find((t=>t.id===e.id));n?n.count=(n.count||0)+(e?.count||0):t.options.push(e)})):v.push(e)}));let C=a?t.histogram:r?Ln()(e.histogram):t.histogram||Ln()(e.histogram);if(u){if(!a&&e.histogram?.id!==u?.id)return;const t=C.chart.result.labels;if((0,fe.Ay)(t,u.chart.result.labels))C.chart.result.data=[...C.chart.result.data,...u.chart.result.data];else{const e=((e,t)=>{const n=t.reduce(((t,n,r)=>{const a=e.findIndex((e=>n===e));return-1===a||(t[a]=r),t}),{});return t=>e.reduce(((e,r,a)=>("undefined"===typeof n[a]?e.push([0,0,0]):e.push(t[n[a]]),e)),[])})(t,u.chart.result.labels);u.chart.result.data.forEach((t=>C.chart.result.data.push(e(t))))}}let w={};Object.keys(t.columns).forEach((e=>{w[t.columns[e].index]=e}));let k=t.data.map((e=>e.reduce(((e,t,n)=>{const r=w[n];return r?(e[r]=t,e):e}),{}))),F=a?k:r?"forward"===l?k.concat(e.data||[]):(e.data||[]).concat(k):k;x.tail&&F.slice(0,500);let S=y?.enabled&&y.column&&Array.isArray(F)&&F[F.length-1]?.[y.column]&&F[0]?.[y.column]?{anchorBefore:F[F.length-1][y.column],anchorAfter:F[0][y.column],anchorUnits:y.units}:{};const I=t.defaultSortColumn||e.defaultSortColumn,A=(a?t.acceptedParams||[]:t.acceptedParams||e.acceptedParams).includes("direction");let T=0;m&&(T=F.reduce(((e,t)=>e+(t[m.column]||0)),0));const K={...e||Kn.zb.table,...x,groupByColumns:a?o:o||e.groupByColumns,data:F,columns:p,updatedAt:(new Date).getTime(),updateEvery:n||e.updateEvery,sortedColumns:Object.values(g),sortColumn:p[I]?.displayName,sortDirection:I?p[I].sort:"descending",...b,...S,totalSize:x.totalSize||s?.matched||(!i||"forward"===l||k.length||t.partial?(e.totalSize||0)+(h?h.matched:0):0),actualSize:T,...!!f&&{hasNextPage:!(i&&"forward"!==l&&!k.length&&!t.partial)&&(!s||0!==s.after)},...!!f&&A&&{hasPrevPage:!x.tail&&(!(i&&"forward"===l&&!k.length&&!t.partial)&&(!s||0!==s.before))},offset:r?null:s?.before||null,loading:!1,loaded:!0,showIds:d,merged:r,latestDirection:l,hasHistory:f,hasDirection:A,aggregations:v,histogram:C,sortedColumnsObj:g,filtersToRefresh:(x.requiredParams||[]).reduce(((e,t)=>t.uniqueView?{...e,[t.id]:!0}:e),{}),reset:a,aggregatedView:m,alphabetical:j,transactionId:null};return g=null,C=null,v=null,S=null,b=null,p=null,w=null,k=null,F=null,j=null,K}))},Vn={table:Dn,log:Dn,default:(e,t)=>{const{data:n,type:r,updateEvery:a,...o}=t;e({...Kn.zb.default,...o,data:n,updateEvery:a,type:r,loading:!1,loaded:!0,transactionId:null})}},_n={default:{fetch:Tn.ph,isEnabled:e=>{let{nodeIds:t,fn:n,after:r}=e;return!!t?.length&&!!n&&!!r}},feed:{fetch:Tn.d$,isEnabled:e=>{let{roomId:t,fn:n}=e;return!!t&&!!n}}},qn=(e,t)=>{let{after:n,before:r}=e;return t<r&&t>n},Wn=e=>{const{after:t,before:n,highlight:a}=(0,L.rW)(),o=(0,w.A)(e);return(0,r.useMemo)((()=>{const r=t>0?()=>({after:t,before:n}):()=>{const e=Date.now();return{after:e+1e3*t,before:e}},s=((e,t)=>{let{after:n,before:r}=t;return e<r&&e>n?e:null})(e||a.before,r());return[r,t,n,s,!!s&&e!==o]}),[t,n,a?.before,e,o])};var Hn=n(32052);const Un={default:{fetch:Tn.JJ,isEnabled:e=>{let{nodeIds:t,fn:n}=e;return!!t?.length&&!!n}},feed:{fetch:()=>Promise.resolve({data:{type:"table"}}),isEnabled:()=>!0}},Gn=(e,t,n,r)=>{const a=(0,p.ID)(),o=(0,m.yN)(e),[{loading:l,token:i}]=(0,S.f7)(),{fetch:d,isEnabled:c}=Un[t]||Un.default,[{error:u},h]=(0,s.WH)(n),[x]=Wn(),{loaded:g,error:f}=(0,s.vx)(n,r);return(0,Hn.A)((()=>({enabled:g&&!f&&!l&&!u&&c({nodeIds:e,fn:t}),fetch:()=>d({roomId:a,cloudNodeIds:o,nodeIds:e,fn:t,after:x().after,before:x().before}),onFail:e=>{!e?.response?.status||400!==e.response.status&&304!==e.response.status?(e?.response?.data&&(e=e.response.data),h({error:e})):h((e=>({...e,infoLoaded:!0})))},onSuccess:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return h((t=>({...Kn.zb[e.type]||Kn.zb.default,...t,hasHistory:e.hasHistory||!1,acceptedParams:e.acceptedParams||[],requiredParams:e.requiredParams||[],type:e.type,help:e.help,v:e.v,infoLoaded:!0})))}})),[g,t,l,!e?.length,e?.[0],i]),f};var Zn=n(44731),Yn=n(5638),Jn=n(3839),Xn=n(66118);const Qn=(0,kt.eU)({navigation:"pan"}),er=(0,St.Iz)((e=>{let{key:t}=e;return(0,kt.eU)((e=>{const n=e(Qn);return t?n[t]:n}),((e,n,r)=>n(Qn,(e=>t?{...e,[t]:r}:{...e,...r}))))}),fe.Ay),tr=e=>(0,Ft.md)(er({key:e})),nr=e=>(0,Ft.Xr)(er({key:e}));var rr=n(7382);n(67140);const ar=(0,P.default)(h.Button).attrs((e=>{let{active:t}=e;return{flavour:"borderless",iconColor:t?"textDescription":"border",iconSize:"small",padding:[.5],small:!0}})).withConfig({displayName:"styled__Button",componentId:"sc-8s0lqd-0"})(["&&{background-color:",";height:20px;width:20px;&:hover{background-color:",";.button-icon__color{fill:",";}}}"],(e=>{let{theme:t,active:n}=e;return n?(0,h.getColor)("borderSecondary")({theme:t}):"initial"}),(e=>{let{theme:t}=e;return(0,h.getColor)("borderSecondary")({theme:t})}),(e=>{let{theme:t}=e;return(0,h.getColor)("textDescription")({theme:t})})),or=(0,P.default)(h.Flex).attrs({padding:[.5],gap:1,round:!0,border:{side:"all",color:"borderSecondary"}}).withConfig({displayName:"styled__Container",componentId:"sc-8s0lqd-1"})(["position:absolute;top:18px;right:8px;background:",";&:hover{background:",";}"],(0,h.getRgbColor)("elementBackground",.5),(0,h.getColor)("elementBackground")),sr=e=>{let{testIdPrefix:t,...n}=e;const[{after:a,before:o},s]=(0,L.N9)(),[l,i]=[tr(d="navigation"),nr(d)];var d;const c=(0,r.useCallback)((e=>{let t=a,n=o;if(a<0){const e=Date.now();t=e+1e3*a,n=e}const r=e*Math.round((n-t)/4);s((e=>({...e,after:t+r,before:n-r})))}),[a,o]),u=a>0&&Math.abs(o-a)<2e3||-1===a;return(0,v.jsxs)(or,{"data-testid":"chartToolbox","data-track":`chart-toolbox::hover-chart::${t}`,"data-toolbox":"true",...n,children:[(0,v.jsx)(ar,{active:"pan"===l,"data-testid":"chartToolbox-pan","data-track":`chart-toolbox::pan-click::${t}`,icon:"panTool",onClick:()=>i("pan"),title:"Pan"}),(0,v.jsx)(ar,{active:"highlight"===l,"data-testid":"chartToolbox-highlight","data-track":`chart-toolbox::highlight-click::${t}`,icon:"highlightArea",onClick:()=>i("highlight"),title:"Highlight"}),(0,v.jsx)(ar,{active:"zoom"===l,"data-testid":"chartToolbox-zoom","data-track":`chart-toolbox::zoom-click::${t}`,disabled:u,icon:"dragHorizontal",onClick:()=>{i("zoom")},title:"Select and zoom"}),(0,v.jsx)(ar,{"data-testid":"chartToolbox-zoomIn","data-track":`chart-toolbox::zoom-in-click::${t}`,disabled:u,icon:"zoomIn",onClick:()=>{c(1)},title:"Zoom in"}),(0,v.jsx)(ar,{"data-testid":"chartToolbox-zoomOut","data-track":`chart-toolbox::zoom-out-click::${t}`,icon:"zoomOut",onClick:()=>{c(-1)},title:"Zoom out"}),(0,v.jsx)(ar,{"data-testid":"chartToolbox-zoomReset","data-track":`chart-toolbox::zoom-reset-click::${t}`,disabled:-900===a&&0===o,icon:"zoomReset",onClick:()=>{s((e=>({...e,after:-900,before:0})))},title:"Zoom reset"})]})},lr={after:null,before:null};Xn.t1.register(Yn.A,Xn.A6,Xn.E8,Xn.PP,Xn.s$,Xn.kc,Xn.UA,Xn.m_,Jn.Ay);const ir=e=>{let{paramsKey:t,testIdPrefix:n}=e;const a=(0,r.useRef)(),o=(0,r.useContext)(P.ThemeContext),[l,i]=(0,L.N9)(),[d,c]=(0,r.useState)([]),[u,m]=(0,r.useState)(lr),[x,p]=(0,r.useState)(!1),[g,f]=(0,r.useState)(!1),[y,b]=(0,r.useState)([]),[j,C]=(0,r.useState)(null),[w,k]=(0,r.useState)("second"),[F,,S,I]=(0,K.A)(!1),A=(0,s.Ol)(t,"aggregations"),{navigation:T}=tr(),{localeTimeString:E,localeDateString:z}=(0,R.$j)(),[M]=Wn(),B=M.before-M.after,$=(0,r.useMemo)((()=>{const e=Date.now();return{min:M.after-B,max:0===l.before?M.before:e<M.before+B?e:M.before+B}}),[M.after,M.before,l.before]),O=[{backgroundColor:(0,h.getColor)("primary")({theme:o}),borderWidth:0,data:d,label:"Histogram",maxBarThickness:50,minBarLength:0}];(0,r.useEffect)((()=>{if(!A?.event_histogram?.hits?.buckets)return;const e=A.event_histogram.hits.buckets.reduce(((e,t)=>{let{key:n,doc_count:r}=t;return{data:[...e.data,r],labels:[...e.labels,n]}}),{data:[],labels:[]}),t=(0,je.Bp)(l.after,l.before)||{};c(e.data),b(e.labels),C(null),k(t.unit)}),[A?.event_histogram?.hits?.buckets]);const N=(0,r.useMemo)((()=>({animation:!1,interaction:{axis:"x"},maintainAspectRatio:!1,plugins:{annotation:{annotations:{...u.after&&u.before?{annotation:{type:"box",backgroundColor:"rgba(128,128,128,0.3)",borderDash:[1,5,1,1],borderWidth:1,xMax:u.before,xMin:u.after,xScaleID:"x"}}:{}}},legend:{align:"start",display:!1,position:"bottom"},zoom:{limits:{x:$},pan:{enabled:"pan"===T&&!x,mode:"x",onPanStart:e=>{let{chart:t}=e;t.canvas.style.cursor="grabbing"},onPanComplete:e=>{let{chart:t}=e;t.canvas.style.cursor="default";const{min:n,max:r}=t.scales.x;C({min:Math.round(n),max:Math.round(r)}),i((e=>({...e,after:Math.round(n),before:Math.round(r)}))),t.update()},threshold:1},zoom:{drag:{enabled:"zoom"===T||x},mode:"x",onZoomStart:e=>{let{chart:t}=e;t.canvas.style.cursor="col-resize"},onZoomComplete:e=>{let{chart:t}=e;if("zoom"!==T&&!x)return;t.canvas.style.cursor="default";const{min:n,max:r}=t.scales.x;i((e=>({...e,after:Math.round(n),before:Math.round(r)}))),p(!1)}}}},responsive:!0,scales:{x:{type:"time",grid:{drawBorder:!0,drawOnChartArea:!1,drawTicks:!0,offset:!1},parsing:!1,ticks:{color:(0,h.getColor)("textLite")({theme:o}),font:{size:11},autoSkip:!0,maxTicksLimit:20,..."minute"===w&&B>=1e3*rr.wD?{callback:e=>`${z(e,{month:"2-digit",day:"2-digit",year:"numeric",long:!1,dateStyle:void 0}).split("/").reverse().slice(1).join("-")} ${E(e,{secs:!1})}`}:{}},time:{displayFormats:{week:"yyyy-MM-dd",day:"MM-dd",hour:"MM-dd HH:mm",minute:"HH:mm",second:"HH:mm:ss"},tooltipFormat:"yyyy-MM-dd HH:mm:ss",unit:w||"second"},...j?{min:j.min,max:j.max}:{}},y:{beginAtZero:!0,ticks:{precision:0,color:(0,h.getColor)("textLite")({theme:o}),font:{size:11}}}}})),[u,B,x,T,j,C,w,$]);if((0,r.useEffect)((()=>{const e=e=>{"Shift"===e.key&&(e.preventDefault(),p(!0))};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[]),!d.length)return null;return(0,v.jsxs)(h.Flex,{position:"relative",height:{min:50},onMouseEnter:S,onMouseLeave:I,children:[F&&(0,v.jsx)(sr,{testIdPrefix:n}),(0,v.jsx)(Zn.yP,{data:{datasets:O,labels:y},onMouseDown:e=>{if(e.preventDefault(),"highlight"!==T)return;f(!0);const t=e.nativeEvent.offsetX||e.nativeEvent.layerX,n=a.current;n.canvas.style.cursor="crosshair",m({after:Math.round(n.scales.x.getValueForPixel(t)),before:null})},onMouseMove:e=>{if(e.preventDefault(),"highlight"!==T||!g)return;const t=e.nativeEvent.offsetX||e.nativeEvent.layerX,n=a.current;m((e=>({...e,before:Math.round(n.scales.x.getValueForPixel(t))})))},onMouseUp:e=>{e.preventDefault(),f(!1);const t=e.nativeEvent.offsetX||e.nativeEvent.layerX,n=a.current;n.canvas.style.cursor="default";u.after===Math.round(n.scales.x.getValueForPixel(t))?m(lr):m(u)},options:N,ref:a})]})},dr={none:!0,facet:!0},cr=(e,t)=>{const{loaded:n,loading:a,columns:o,sortedColumns:l}=(0,s.Ol)({extraKey:e}),i=(0,r.useRef)([]);return(0,r.useMemo)((()=>(!n||a||(i.current=(l||[]).reduce(((e,n)=>o[n]&&o[n].filter&&!dr[o[n].filter]?[...e,t(n,o)]:e),[])),i.current)),[n,a])};var ur=n(41395);n(23215);const hr={sum:e=>e.reduce(((e,t)=>e+("number"===typeof t?t:0)),0),min:e=>{let t;return e.forEach((e=>{null!=e&&(t>e||void 0===t&&e>=e)&&(t=e)})),t},max:e=>{let t;return e.forEach((e=>{null!=e&&(t<e||void 0===t&&e>=e)&&(t=e)})),t},extent:e=>{let t,n;return e.forEach((e=>{null!=e&&(void 0===t?e>=e&&(t=n=e):(t>e&&(t=e),n<e&&(n=e)))})),[t,n]},mean:e=>{let t=0,n=0;if(e.forEach((e=>{null!=e&&(e=+e)>=e&&(++t,n+=e)})),t)return n/t},median:e=>{if(!e.length)return;if(t=e,!Array.isArray(t)||!t.every((e=>"number"===typeof e)))return;var t;if(1===e.length)return e[0];const n=Math.floor(e.length/2),r=e.sort(((e,t)=>e-t));return e.length%2!==0?r[n]:(r[n-1]+r[n])/2},unique:e=>Array.from(new Set(e.map((e=>e))).values()),uniqueCount:e=>new Set(e.map((e=>e))).size,count:e=>e.length},mr=(0,r.memo)((e=>{let{chart:t,paramsKey:n,selectedFilter:a,tableData:o,stacked:l=!1}=e;const i=(0,s.Ol)(n,"columns"),d=(0,r.useContext)(P.ThemeContext),c=(0,s.Ak)(n),u=(0,r.useMemo)((()=>{if(!t)return{datasets:[],labels:[]};if("all"===t.groupBy){const e=o.reduce(((e,n)=>(t.columns.forEach((t=>{e[t]||(e[t]=[]),e[t].push(n[t])})),e)),{}),n=t.columns.reduce(((n,r)=>{const a=t.aggregation||i[r]?.summary||"count",o=hr[a];return n.push({value:o(e[r]),label:r}),n}),[]).sort(((e,t)=>t.value-e.value));return{datasets:[{backgroundColor:n.map(((e,t)=>rr.b4[t])),borderWidth:0,data:n.map((e=>{let{value:t}=e;return t})),label:n.map((e=>{let{label:t}=e;return t})),maxBarThickness:50,minBarLength:0}],labels:n.map((e=>{let{label:t}=e;return t}))}}{const e=t.columns.reduce(((e,n)=>{const r=((e,t,n)=>e.reduce(((e,r)=>(e[r[n]]||(e[r[n]]={label:r[n],data:[]}),e[r[n]].data.push(r[t]),e)),{}))(o,n,a||n),s=t.aggregation||i[n]?.summary||"count",l=hr[s];return Object.keys(r).forEach((t=>{const a=l(r[t].data);e[r[t].label]={...e[r[t].label],[n]:a,label:r[t].label,sortByValue:e[r[t].label]&&e[r[t].label].sortByValue>a?e[r[t].label].sortByValue:a}})),e}),{}),n=Object.values(e).sort(((e,t)=>t.sortByValue-e.sortByValue)).slice(0,15).map((e=>{let{sortByValue:t,...n}=e;return n}));return{datasets:t.columns.map(((e,t)=>({backgroundColor:rr.b4[t],borderWidth:0,data:n.map((t=>t[e])),label:e,maxBarThickness:50,minBarLength:0}))),labels:n.map((e=>{let{label:t}=e;return t}))}}}),[c,t,a,o]),m=!t.groupBy||"column"===t.groupBy,x={animation:!1,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{boxWidth:4,boxHeight:20,title:{color:(0,h.getColor)("textLite")({theme:d})}}}},responsive:!0,scales:{x:{display:m,stacked:l,grid:{color:(0,h.getColor)("borderSecondary")({theme:d})},afterSetDimensions:e=>{e.maxHeight=50},ticks:{callback:(e,t)=>{let n=u.labels[t];if(!n)return;let r=0;for(;n?.length>20;)n=(0,ur.P3)(n,r),r+=1;return n}}},y:{stacked:l,grid:{color:(0,h.getColor)("borderSecondary")({theme:d})},afterSetDimensions:e=>{e.maxWidth=50}}}};return(0,v.jsx)(Zn.yP,{data:u,options:x})})),xr=mr;n(47154);const pr=(0,r.memo)((e=>{let{chart:t,paramsKey:n,selectedFilter:a,tableData:o,stacked:l=!1}=e;const i=(0,s.Ol)(n,"columns"),d=(0,r.useContext)(P.ThemeContext),c=(0,s.Ak)(n),u=(0,r.useMemo)((()=>{if(!t||!o.length)return{datasets:[],labels:[]};if("all"===t.groupBy){const e=o.reduce(((e,n)=>(t.columns.forEach((t=>{e[t]||(e[t]=[]),e[t].push(n[t])})),e)),{}),n=t.columns.reduce(((n,r)=>{if(!e[r])return n;const a=t.aggregation||i[r]?.summary||"count",o=hr[a];return n.push({value:o(e[r]),label:r}),n}),[]).sort(((e,t)=>t.value-e.value));return{datasets:[{backgroundColor:n.map(((e,t)=>rr.b4[t])),borderWidth:0,data:n.map((e=>{let{value:t}=e;return t})),label:t.name,maxBarThickness:50,minBarLength:0}],labels:n.map((e=>{let{label:t}=e;return t}))}}{const e=t.columns.reduce(((e,n)=>{const r=((e,t,n)=>e.reduce(((e,r)=>(e[r[n]]||(e[r[n]]={label:r[n],data:[]}),e[r[n]].data.push(r[t]),e)),{}))(o,n,a||n),s=t.aggregation||i[n]?.summary||"count",l=hr[s];return Object.keys(r).forEach((t=>{if(!r[t]?.data)return;const a=l(r[t].data);e[r[t].label]={...e[r[t].label],[n]:a,label:r[t].label,sortByValue:e[r[t].label]&&e[r[t].label].sortByValue>a?e[r[t].label].sortByValue:a}})),e}),{}),n=Object.values(e).sort(((e,t)=>t.sortByValue-e.sortByValue)).slice(0,15).map((e=>{let{sortByValue:t,...n}=e;return n}));return{datasets:t.columns.map(((e,t)=>({backgroundColor:rr.b4[t],borderWidth:0,data:n.map((t=>t[e])),label:e,maxBarThickness:50,minBarLength:0}))),labels:n.map((e=>{let{label:t}=e;return t}))}}}),[c,t,a,o]),m={animation:!1,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{boxWidth:4,boxHeight:20,title:{color:(0,h.getColor)("textLite")({theme:d})}}}},responsive:!0};return(0,v.jsx)(Zn.nu,{data:u,options:m})})),gr={"stacked-bar":e=>(0,v.jsx)(mr,{stacked:!0,...e}),bar:xr,doughnut:pr},fr=e=>({label:e,value:e}),yr=(0,r.memo)((e=>{let{paramsKey:t,initData:n,initFilter:a}=e;const{charts:o,loaded:l}=(0,s.Ol)(t),i=Kt(t),d=Object.keys(o).map(fr),c=cr(t.extraKey,fr),[u,m]=(0,r.useState)(n),[x,p]=(0,r.useState)(a);(0,r.useEffect)((()=>{m(n)}),[n]),(0,r.useEffect)((()=>{p(a)}),[a]);const g=o[u],f=!g.groupBy||"column"===g.groupBy,y=(0,r.useMemo)((()=>gr[g.type]||gr["stacked-bar"])),[b,j]=(0,I.useHovered)({},[l]),[,C]=(0,A.A)();return(0,r.useEffect)((()=>{C(j)}),[j]),(0,v.jsxs)(h.Flex,{column:!0,"data-testid":"functionsCharts",gap:3,width:"50%",background:"mainChartBg",border:{side:"all",color:"mainChartBorder"},padding:[4],round:.5,children:[(0,v.jsxs)(h.Flex,{alignItems:"center","data-testid":`functionsChart${u}-selects`,gap:2,children:[(0,v.jsx)(h.Select,{"data-ga":`functions-chart-${u}::select-data::functions-view`,"data-testid":`functionsChart${u}-dataSelect`,isLoading:!l,onChange:e=>{let{value:t}=e;return m(t)},options:d,styles:{size:"tiny",minWidth:120},value:{label:u,value:u}}),f&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(h.Text,{"data-testid":`functionsChart${u}-perLabel`,color:"textLite",children:"per"}),(0,v.jsx)(h.Select,{"data-ga":`functions-chart-${x}::select-filter::functions-view`,"data-testid":`functionsChart${x}-filterSelect`,isLoading:!l,onChange:e=>{let{value:t}=e;return p(t)},options:c,styles:{size:"tiny",minWidth:120},value:{label:x,value:x}})]})]}),(0,v.jsx)(h.Flex,{position:"relative",height:{min:60},width:{min:"100%"},ref:b,children:(0,v.jsx)(y,{paramsKey:t,selectedFilter:x,tableData:i,chart:g})})]})})),br=yr;var jr=n(5020),vr=n(80744),Cr=n(19018),wr=n(24285);const kr={dark:{publicColor:"#FF9700",privateColor:"#0075A2",serverColor:"#00a44a",clientColor:"#DB162F",otherColor:"#3E4551",appFontColor:"#AEBBBB",appFontFamily:"monospace",appFontSize:"12px",appFontWeight:"regular",borderFontColor:"#EDF0F0",borderFontFamily:"monospace",borderFontSize:"14px",borderFontWeight:"bold"},light:{publicColor:"#BFA142",privateColor:"#197EA8",serverColor:"#339979",clientColor:"#CD6364",otherColor:"#AFB5BA",appFontColor:"#526161",appFontFamily:"monospace",appFontSize:"12px",appFontWeight:"regular",borderFontColor:"#5D7070",borderFontFamily:"monospace",borderFontSize:"14px",borderFontWeight:"bold"}},Fr=(0,r.memo)((e=>{let{data:t,width:n,height:a,processing:o,ref:s}=e;const l=(0,r.useRef)({}),i=(0,wr.xd)("theme"),d=(0,w.A)(t),c=(0,w.A)(n),u=(0,w.A)(a),m=(0,w.A)(o),x=(0,r.useRef)({}),p=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const r=!e&&(0,fe.Ay)(t,d);x.current=r?x.current:t.reduce(((e,t)=>(e[t.Process]||(e[t.Process]={listen:0,inbound:0,outbound:0,local:0,private:0,public:0,total:0,name:t.Process}),e[t.Process].total+=t.Count,"listen"===t.Direction?e[t.Process].listen+=t.Count:"local"===t.Direction?e[t.Process].local+=t.Count:"inbound"===t.Direction?e[t.Process].inbound+=t.Count:"outbound"===t.Direction&&(e[t.Process].outbound+=t.Count),"public"===t.RemoteAddressSpace?e[t.Process].public+=t.Count:"private"===t.RemoteAddressSpace&&(e[t.Process].private+=t.Count),e)),{});function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(7!==e.length||"#"!==e[0])throw new Error("Invalid hex color format");return`rgba(${parseInt(e.slice(1,3),16)}, ${parseInt(e.slice(3,5),16)}, ${parseInt(e.slice(5,7),16)}, ${t})`}function s(e,t,n,r,a){const o=t/2,s=n/2;!function(e){e.selectAll(".app").each((function(e){e&&(l.current[e.name]={x:e.x,y:e.y})}))}(e);const i=Cr.scaleOrdinal().domain(["public","private","listenInbound","outbound","others"]).range([a.publicColor,a.privateColor,a.serverColor,a.clientColor,a.otherColor]),d=Cr.pie().value((e=>e.value)),c=Cr.arc(),p=e.selectAll(".app").data(Object.values(x.current),(e=>e.name));p.exit().transition().style("opacity",0).remove();const g=p.enter().append("g").attr("class","app").attr("transform",(e=>{const t=l.current[e.name];return`translate(${t?.x||o}, ${t?.x||s})`}));g.each((function(e){const t=Cr.select(this),n=d(e.d3.pie),r=e.d3.size;t.selectAll("path").data(n).enter().append("path").transition().attr("fill",((e,t)=>i(t))),t.append("text").text((e=>e.name)).attr("text-anchor","middle").attr("y",r+10).style("font-family",a.appFontFamily).style("font-size",a.appFontSize).style("font-weight",a.appFontWeight).style("fill",a.appFontColor)}));const f=g.merge(p);return f.each((function(e){const t=Cr.select(this),n=l.current[e.name]||function(e){return e.d3.isListener?{x:e.d3.x,y:e.d3.y}:{x:o,y:s}}(e);e.x=n.x,e.y=n.y,t.selectAll("path").data(d(e.d3.pie)).transition().attr("d",c.innerRadius(0).outerRadius(e.d3.size)),t.select("text").transition().attr("y",e.d3.size+10)})),f.call(Cr.drag().on("start",u).on("drag",h).on("end",m)),f}let c;function u(e,t){e.active||c.alphaTarget(1).restart(),t.fx=t.x,t.fy=t.y}function h(e,t){t.fx=e.x,t.fy=e.y}function m(e,t){e.active||c.alphaTarget(0),t.fx=null,t.fy=null}!function(t,l){let i=Cr.select("#d3-canvas").select("svg");((e,t,n)=>{if(r)return;const a=e/2-n,o=t/2-n,s=Math.min(2*a/3-n,2*o/3-n,Math.max(5,Math.min(e,t)/Object.keys(x.current).length)+13),l=Object.values(x.current),i={total:Cr.max(l,(e=>e.total)),local:Cr.max(l,(e=>e.local)),listen:Cr.max(l,(e=>e.listen)),private:Cr.max(l,(e=>e.private)),public:Cr.max(l,(e=>e.public)),inbound:Cr.max(l,(e=>e.inbound)),outbound:Cr.max(l,(e=>e.outbound))},d=Cr.scaleLog().domain([1,i.total]).range([13,s]).clamp(!0);let c=0,u=0,h=0,m=t-n;l.forEach((r=>{const s=Cr.scaleLog().domain([1,r.total+1]).range([0,a-n]),l=Cr.scaleLog().domain([1,r.total+1]).range([0,a-n]),p=Cr.scaleLog().domain([1,r.total+1]).range([0,o-n]),g=Cr.scaleLog().domain([1,r.total+1]).range([0,o-n]);x.current[r.name].forces={total:r.total/i.total,local:r.local/i.local,listen:r.listen/i.listen,private:r.private/i.private,public:r.public/i.public,inbound:r.inbound/i.inbound,outbound:r.outbound/i.outbound},x.current[r.name].pos={right:s(r.public+1),left:l(r.private+1),top:p(r.outbound+1),bottom:g((r.listen+r.inbound)/2+1)};const f=r.total-(r.public+r.private+r.listen+r.inbound+r.outbound);let y=n+a+x.current[r.name].pos.right-x.current[r.name].pos.left,b=n+o+x.current[r.name].pos.bottom-x.current[r.name].pos.top,j=d(r.total);r.listen===r.total&&(j=10,h===u&&50*c>2*e/3&&(c=0,h=0,u=0,m-=80),c?h>=u?(u++,y=e/2+50*u,b=m-j-(u%2===0?0:40)):(h++,y=e/2-50*h,b=m-j-(h%2===0?0:40)):(y=e/2,b=m-j),c++),x.current[r.name].d3={isListener:r.listen===r.total,x:y,y:b,size:j,pie:[{value:r.public},{value:r.private},{value:r.listen+r.inbound},{value:r.outbound},{value:f>0?f:0}]},x.current[r.name].d3.x-x.current[r.name].d3.size/2<n&&(x.current[r.name].d3.x=n+2*x.current[r.name].d3.size),x.current[r.name].d3.x+x.current[r.name].d3.size/2>e&&(x.current[r.name].d3.x=e-2*x.current[r.name].d3.size),x.current[r.name].d3.y-x.current[r.name].d3.size/2<n&&(x.current[r.name].d3.y=n+2*x.current[r.name].d3.size),x.current[r.name].d3.y+x.current[r.name].d3.size/2>t&&(x.current[r.name].d3.y=t-2*x.current[r.name].d3.size)}))})(n,a,t),(i.empty()||e)&&(i=i.empty()?Cr.select("#d3-canvas").append("svg").attr("width",n).attr("height",a):i.attr("width",n).attr("height",a),function(e,t,n,r,a){Cr.select("#d3-canvas").selectAll("svg > *").remove();const s=n/2,l=e.append("defs").append("linearGradient").attr("id","clientsGradient").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");l.append("stop").attr("offset","0%").style("stop-color",o(a.clientColor,1)),l.append("stop").attr("offset","100%").style("stop-color",o(a.clientColor,0));const i=e.append("g").attr("class","topRect");i.append("rect").attr("x",0).attr("y",0).attr("width","100%").attr("height",r/2).style("fill","url(#clientsGradient)"),i.append("text").text("Clients").attr("x","50%").attr("y",12).attr("text-anchor","middle").style("font-family",a.borderFontFamily).style("font-size",a.borderFontSize).style("font-weight",a.borderFontWeight).style("fill",a.borderFontColor);const d=e.append("defs").append("linearGradient").attr("id","serversGradient").attr("x1","0%").attr("y1","100%").attr("x2","0%").attr("y2","0%");d.append("stop").attr("offset","0%").style("stop-color",o(a.serverColor,1)),d.append("stop").attr("offset","100%").style("stop-color",o(a.serverColor,0));const c=e.append("g").attr("class","bottomRect");c.append("rect").attr("x",0).attr("y","100%").attr("width","100%").attr("height",r/2).attr("transform",`translate(0, -${r/2})`).style("fill","url(#serversGradient)"),c.append("text").text("Servers").attr("x","50%").attr("y","100%").attr("text-anchor","middle").attr("transform","translate(0, -4)").style("font-family",a.borderFontFamily).style("font-size",a.borderFontSize).style("font-weight",a.borderFontWeight).style("fill",a.borderFontColor);const u=e.append("defs").append("linearGradient").attr("id","publicGradient").attr("x1","100%").attr("y1","0%").attr("x2","0%").attr("y2","0%");u.append("stop").attr("offset","0%").style("stop-color",o(a.publicColor,1)),u.append("stop").attr("offset","100%").style("stop-color",o(a.publicColor,0));const h=e.append("g").attr("class","rightRect");h.append("rect").attr("x","100%").attr("y",0).attr("transform",`translate(-${r/2}, 0)`).attr("width",r/2).attr("height","100%").style("fill","url(#publicGradient)"),h.append("text").text("Public").attr("x","100%").attr("y","50%").attr("text-anchor","middle").attr("dominant-baseline","middle").attr("transform",`rotate(90, ${t-r/4}, ${s})`).style("font-family",a.borderFontFamily).style("font-size",a.borderFontSize).style("font-weight",a.borderFontWeight).style("fill",a.borderFontColor);const m=e.append("defs").append("linearGradient").attr("id","privateGradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%");m.append("stop").attr("offset","0%").style("stop-color",o(a.privateColor,1)),m.append("stop").attr("offset","100%").style("stop-color",o(a.privateColor,0));const x=e.append("g").attr("class","leftRect");x.append("rect").attr("x",0).attr("y",0).attr("width",r/2).attr("height","100%").style("fill","url(#privateGradient)"),x.append("text").text("Private").attr("x",r/2).attr("y","50%").attr("text-anchor","middle").attr("dominant-baseline","middle").attr("transform",`rotate(-90, ${r/2-10}, ${s})`).style("font-family",a.borderFontFamily).style("font-size",a.borderFontSize).style("font-weight",a.borderFontWeight).style("fill",a.borderFontColor)}(i,n,a,t,l));const d=s(i,n,a,0,l);c=Cr.forceSimulation(Object.values(x.current)).force("x",Cr.forceX((e=>e.d3.x)).strength((e=>e.d3.isListener?.2:.1))).force("y",Cr.forceY((e=>e.d3.y)).strength((e=>e.d3.isListener?.2:.1))).force("collision",Cr.forceCollide((e=>1.1*e.d3.size+15)).strength(1)).on("tick",(()=>{d.each((e=>{e.x>n-t?e.x=n-t:e.x<t&&(e.x=t),e.y>a-t?e.y=a-t:e.y<t&&(e.y=t)})),d.attr("transform",(e=>`translate(${e.x}, ${e.y})`))}))}(40,kr[i]||kr.dark)};return(0,r.useLayoutEffect)((()=>{o||n&&a&&p(c!==n||u!==a||m!==o)}),[t,n,a,i,o]),(0,v.jsx)(h.Flex,{id:"d3-canvas",ref:s,width:"100%",height:"100%",flex:!0,round:!0,overflow:"hidden"})})),Sr={"network-viewer":Fr},Ir=e=>{let{id:t,resizeHandle:n,style:a,paramsKey:o,containerWidth:s,resizing:l,ref:i,...c}=e;const u=Kt(o),m=Sr[t],[x,p]=(0,I.useHovered)({},[]),[,g]=(0,A.A)();(0,r.useEffect)((()=>{g(p)}),[p]);const[f,{width:y,height:b}]=(0,d.A)();return(0,v.jsxs)(h.Flex,{ref:(0,h.mergeRefs)(i,f),position:"relative",style:a,children:[(0,v.jsx)(m,{data:u,id:t,role:"graphics-object","aria-roledescription":"chart",ref:x,containerWidth:s,width:y,height:b,processing:l,...c},t),n]})},Ar=(0,r.memo)((e=>{let{paramsKey:t,customCharts:n,containerWidth:a}=e;const o=Object.values(n).filter((e=>!!Sr[e.type])),s=o[0]?.type,[l,i]=(0,r.useState)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[(0,jr.bP)(e,{left:0,top:0,width:12,height:9,id:e,...t,chartId:e,minWidth:12,maxWidth:12,minHeight:4,static:!1,dashboardable:!0})]}(s,{paramsKey:t,containerWidth:a}));return o.length?(0,v.jsx)(h.Flex,{column:!0,"data-testid":"functionsCharts",gap:3,width:"100%",background:"mainChartBg",round:.5,children:(0,v.jsx)(vr.Ay,{rootId:t.extraKey,containerId:t.extraKey,onDragEnd:(e,t)=>{(0,jr.Q)(t),i(e)},items:l,containerWidth:a-40,Item:Ir,rearrangeable:!1})}):"No chart found"})),Tr=Ar;var Kr=n(28657),Er=n(13752),Lr=n(92815),Pr=n(72582),zr=n(82650),Mr=n(19371),Br=n(22332),$r=n(6504);const Rr=(0,P.default)(h.Drop).withConfig({displayName:"facetSelectorDropdown__StyledDrop",componentId:"sc-1j7rmvq-0"})(["z-index:1000;pointer-events:auto;& *{pointer-events:auto;}"]),Or=P.default.div.withConfig({displayName:"facetSelectorDropdown__ResizableWrapper",componentId:"sc-1j7rmvq-1"})(["resize:both;overflow:hidden;position:relative;height:",";min-height:",";max-height:",";width:",";min-width:250px;max-width:",";background:",";pointer-events:auto;isolation:isolate;&::-webkit-resizer{display:none;}"],(e=>e.height||"400px"),(e=>e.minHeight||"200px"),(e=>e.maxHeight||"600px"),(e=>e.width||"300px"),(e=>e.maxWidth||"500px"),(e=>{let{theme:t}=e;return t.colors.dropdown})),Nr=(0,P.default)(h.IconButton).attrs({icon:"resize_handler",padding:[0],position:"absolute",bottom:0,right:0,hoverColor:"textDescription",width:"14px",height:"14px"}).withConfig({displayName:"facetSelectorDropdown__ResizeButton",componentId:"sc-1j7rmvq-2"})(["&&{cursor:nwse-resize;pointer-events:none;}"]),Dr=(0,P.default)(h.Flex).attrs({background:"dropdown",border:!0,round:1,padding:[0],column:!0,gap:0,height:"100%"}).withConfig({displayName:"facetSelectorDropdown__DropdownContent",componentId:"sc-1j7rmvq-3"})(["box-shadow:0 4px 8px rgba(0,0,0,0.1);display:flex;flex-direction:column;"]),Vr=(0,P.default)(h.MenuDropdown).attrs((e=>({background:"",hideShadow:!0,height:{max:"100%"},width:"100%",overflow:"auto",...e}))).withConfig({displayName:"facetSelectorDropdown__StyledMenuDropdown",componentId:"sc-1j7rmvq-4"})(['-webkit-user-select:none;-ms-user-select:none;user-select:none;width:100%;& input[type="search"]{background:transparent !important;border:none !important;outline:none !important;box-shadow:none !important;width:100%;}& > div:first-child{margin-right:0 !important;padding-right:0 !important;}& > div > ul{padding:0;margin:0;}& > div{scrollbar-gutter:stable;}']),_r=(0,P.default)(h.Flex).attrs({as:"li",role:"option",padding:[.5,2],gap:1,justifyContent:"between",alignItems:"center",width:"100%"}).withConfig({displayName:"facetSelectorDropdown__ItemContainer",componentId:"sc-1j7rmvq-5"})(["cursor:pointer;min-height:32px;&:hover{background-color:",";}"],(e=>{let{theme:t}=e;return t.colors.secondaryHighlight})),qr=e=>{let{item:t,onItemClick:n}=e;const{facet:r}=t;return(0,v.jsxs)(_r,{onClick:()=>n({item:t}),children:[(0,v.jsx)(h.Flex,{alignItems:"center",gap:1,children:(0,v.jsxs)(h.TextSmall,{children:[r.name,r.id!==r.name&&r.name!==r.id&&(0,v.jsxs)("span",{style:{opacity:.7},children:[" (",r.id,")"]})]})}),r.isActive?(0,v.jsx)(T.A,{align:"top",content:r.totalCount>0?`${r.filteredCount} of ${r.totalCount} unique values match current filters`:`${r.count} unique ${1===r.count?"value":"values"} available for filtering`,children:(0,v.jsx)(h.Pill,{flavour:r.totalCount>0&&0===r.filteredCount?"warningFaded":"neutral",hollow:!0,size:"small","data-testid":`facet-selector-${r.id}-count`,children:(0,v.jsx)(h.TextSmall,{children:r.totalCount>0?(0,v.jsxs)(v.Fragment,{children:[r.filteredCount,(0,v.jsxs)("span",{style:{opacity:.6},children:["/",r.totalCount]})]}):r.count})})}):(0,v.jsx)(T.A,{align:"top",content:"Click to add this field to filters. The count will be calculated after selection.",children:(0,v.jsx)(h.Pill,{flavour:"neutral",hollow:!0,size:"small","data-testid":`facet-selector-${r.id}-inactive`,children:(0,v.jsx)(h.TextSmall,{children:"inactive"})})})]})},Wr=(0,r.memo)((e=>{let{paramsKey:t,children:n,onSelect:a,onOpenChange:o,title:l="Select field",testIdPrefix:i="facet-selector",showInactiveFields:d=!0,filterExistingFields:c=[]}=e;const u=(0,r.useRef)(),[m,,x,p]=(0,K.A)(!1),[g,f]=(0,A.A)(),y=(0,s.Ol)(t,"aggregations"),{requiredParams:b}=(0,s.Ol)(t)||{},j=(0,s.Ol)(t,"columns"),C=(0,s.Ol)(t,"alphabetical"),[w,k]=(0,s.S3)(t),[F,S]=(0,s.oV)({param:"selectedFacets",...t,flavour:"arr",defaultValue:null}),I=(0,s.Be)(t),T=Object.keys(I||{}).filter((e=>I[e]&&I[e].length>0)),E=Kt({extraKey:t.extraKey,keepAll:!0}),L=Kt({extraKey:t.extraKey,keepAll:!0,omit:T.join(":::")}),[P,,z]=Jt({param:"facetSelector",extraKey:t.extraKey,title:l,testIdPrefix:i}),M=(0,r.useMemo)((()=>{const e=[];return C&&j&&C.forEach((t=>{if(c.includes(t))return;const n=j[t];if(!n)return;const r=n.filter&&"none"!==n.filter&&"facet"!==n.filter,a=!!y;if(a&&("facet"===n.filter||"multiselect"===n.filter)||!a&&r||d&&("facet"===n.filter||"multiselect"===n.filter)){const r=Array.isArray(y)?y.find((e=>e.id===t)):null,o=b?.find((e=>e.id===t));let s=0,l=0;if(a)r?.options?(l=r.options.length,s=r.options.filter((e=>e.count>0||void 0===e.count)).length):o?.options&&(l=o.options.length,s=o.options.length);else{if(E&&E.length>0){const e=new Set;E.forEach((n=>{if(!n.hidden){const r=n[t];void 0!==r&&null!==r&&""!==r&&e.add(r)}})),s=e.size}if(L&&L.length>0){const e=new Set;L.forEach((n=>{if(!n.hidden){const r=n[t];void 0!==r&&null!==r&&""!==r&&e.add(r)}})),l=e.size}}e.push({id:t,name:n.name||t,displayName:n.displayName||n.name||t,options:r?.options||o?.options||[],isActive:!(!r&&!o)||!a,isInSelectedFacets:!F||F.includes(t),count:l||r?.options?.length||o?.options?.length||0,filteredCount:s,totalCount:l})}})),e.sort(((e,t)=>{switch(P){case"alpha-asc":return e.name.localeCompare(t.name,void 0,{sensitivity:"accent",ignorePunctuation:!0,numeric:!0});case"alpha-desc":return t.name.localeCompare(e.name,void 0,{sensitivity:"accent",ignorePunctuation:!0,numeric:!0});case"num-asc":return e.filteredCount!==t.filteredCount?e.filteredCount-t.filteredCount:e.totalCount-t.totalCount;case"num-desc":return t.filteredCount!==e.filteredCount?t.filteredCount-e.filteredCount:t.totalCount-e.totalCount;default:return 0}}))}),[C,j,y,b,F,E,L,P,d,c]),B=(0,r.useMemo)((()=>M.map((e=>({id:e.id,label:e.name,facet:e,searchText:`${e.name} ${e.id}`.toLowerCase()})))),[M]),$=(0,r.useCallback)((e=>{let{item:t}=e;const n=t.facet;!n.isInSelectedFacets&&F&&S((e=>[...e,n.id])),a&&a(n),p()}),[a,S,F,p]),R=(0,r.useCallback)((()=>{p()}),[p]);return(0,r.useEffect)((()=>(m&&!g?f(!0):!m&&g&&f(!1),o&&o(m),()=>{m&&g&&f(!1)})),[m,g,f,o]),Qt(m),0===M.length?null:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{ref:u,onClick:x,children:n}),m&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:999,cursor:"default"},onMouseMove:e=>e.stopPropagation(),onMouseEnter:e=>e.stopPropagation(),onMouseLeave:e=>e.stopPropagation(),onMouseOver:e=>e.stopPropagation(),onClick:R}),(0,v.jsx)(Rr,{align:{top:"bottom",left:"left"},target:u.current,onEsc:R,onClickOutside:R,dropPlain:!0,children:(0,v.jsxs)(Or,{height:"400px",minHeight:"200px",maxHeight:"600px",width:"300px",maxWidth:"500px",onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),onMouseMove:e=>e.stopPropagation(),onMouseEnter:e=>e.stopPropagation(),onMouseLeave:e=>e.stopPropagation(),onMouseOver:e=>e.stopPropagation(),onMouseOut:e=>e.stopPropagation(),children:[(0,v.jsx)(Dr,{children:(0,v.jsxs)(h.Flex,{padding:[2],column:!0,gap:2,height:"100%",overflow:"hidden",children:[(0,v.jsxs)(h.Flex,{padding:[0,0,1,0],justifyContent:"between",alignItems:"center",flexShrink:0,children:[(0,v.jsx)(h.TextSmall,{strong:!0,children:l}),z]}),(0,v.jsx)(Vr,{items:B,Item:qr,onItemClick:$,hasSearch:!0,searchMargin:[0,0,1],placeholder:"Search fields...",noResultsMessage:"No fields match your search",searchInputProps:{autoFocus:!0}})]})}),(0,v.jsx)(Nr,{})]})})]})]})})),Hr=Wr,Ur=e=>{let{paramsKey:t,histograms:n,selectedId:a,disabled:o}=e;const l=(0,Br.useChart)(),[i,d]=(0,s.UB)({...t,param:"histogram",defaultValue:a,flavour:"val"}),[c,u]=(0,s.oV)({param:"selectedFacets",...t,flavour:"arr",defaultValue:null}),h=(0,r.useCallback)((e=>{if(d(e.id),l&&l.track){const t=l.track(`select-histogram-${e.name}`);"function"===typeof t&&t()}!e.isInSelectedFacets&&c&&u((t=>{const n=[...t];return n.includes(e.id)||n.push(e.id),n}))}),[d,u,c,l]),m=(0,r.useCallback)((e=>{setTimeout((()=>{l&&l.setAttribute&&l.setAttribute("dropdownOpen",e)}),0)}),[l]),x=(0,r.useMemo)((()=>l?.track?l.track("selectHistogram"):void 0),[l]);return(0,v.jsx)(Hr,{paramsKey:t,onSelect:h,onOpenChange:m,title:"Select source field",testIdPrefix:"histogram-source",showInactiveFields:!0,filterExistingFields:[],children:(0,v.jsxs)($r.Button,{disabled:o,"data-track":x,children:["Source ",i]})})},Gr=(0,r.memo)(Ur);var Zr=n(62718);const Yr=e=>t=>`histogram::${e.getAttribute("id")}::${t}`,Jr={"-":["#6F8879","#6F8879"],"[unsampled]":["#DBE1E1","#4A5757"],critical:["#F38593","#6E0B18"],debug:["#9E8B6E","#9E8B6E"],error:["#DB162F","#DB162F"],info:["#0EB6F0","#06526D"],information:["#0EB6F0","#06526D"],none:["#6F8879","#6F8879"],notice:["#3366CC","#3366CC"],success:["#00AB44","#00AB44"],verbose:["#854573","#422239"],warning:["#FF9700","#FF9700"]},Xr=e=>{let{nodeIds:t,fn:n,paramsKey:a}=e;const{availableHistograms:o,histogram:l,help:i,pagination:d,data:c}=(0,s.Ol)(a),u=(0,s.nm)(),m=(0,Mr.eg)(),x=(0,r.useRef)();x.current=()=>Promise.resolve(l?.chart);const p=(0,r.useRef)(!1),[g,f]=(0,r.useMemo)((()=>{const e=`${t}-${n}-${l?.id}`,r=m.makeChart({attributes:{id:e,info:i,...l&&{colors:l.chart.view.dimensions.ids.map((e=>Jr[e.toLowerCase()]||null))}},getChart:()=>x.current(),makeTrack:Yr});return m.getRoot().appendChild(r),[r,e]}),[t,n]);(0,r.useEffect)((()=>{l&&(g.setAttribute("colors",l.chart.view.dimensions.ids.map((e=>Jr[e]))),g.trigger("fetch"))}),[l]),(0,r.useEffect)((()=>!!o&&g.updateAttributes({toolboxElements:[e=>{let{disabled:t}=e;return(0,v.jsx)(Gr,{histograms:o,selectedId:l.id,disabled:t,paramsKey:a})},Pr.default,Er.default,Lr.default,zr.default],title:l?.chart?.view?.title})),[o,n]),(0,r.useEffect)((()=>{if(!u||!g||!d)return;if(g.getAttribute&&g.getAttribute("dropdownOpen"))return;const e=c[u],t=Math.floor(e?.[d?.column]/1e6);t&&!isNaN(t)&&g.updateAttribute("hoverX",[1e3*Math.floor(t-t%l.chart.view.update_every),null])}),[c,l,u]);const y=(0,s.hG)({...a,param:l.id}),b=(0,s.Be)({...a,param:l.id});return(0,r.useEffect)((()=>{if(!g)return;const e=g.onAttributeChange("selectedLegendDimensions",(e=>{if(p.current)return;const t=e.filter((e=>"[estimated]"!==e&&"[unsampled]"!==e));y(t)}));return()=>{e()}}),[g,y]),(0,r.useEffect)((()=>{if(!g||!l)return;const e=g.getAttribute("selectedLegendDimensions")||[],t=[...b||[],...e.filter((e=>"[estimated]"===e||"[unsampled]"===e))];(e.length!==t.length||!e.every((e=>t.includes(e))))&&(p.current=!0,g.setAttribute("selectedLegendDimensions",t),Promise.resolve().then((()=>{p.current=!1})))}),[g,b,l]),(0,r.useEffect)((()=>()=>g&&g.destroy()),[g]),(0,v.jsx)(h.Flex,{flex:!1,width:"100%",height:75,children:g?(0,v.jsx)(Kr.A,{"data-chartid":f,chart:g,overflow:"hidden",hasFilters:!1}):(0,v.jsx)(Zr.mo,{})})},Qr=(0,r.memo)((e=>{let{margin:t,defaultCharts:n,hasCustom:r,...a}=e;const[o,s]=(0,K.A)(!r);return n?.length?(0,v.jsxs)(h.Flex,{column:!0,children:[(0,v.jsxs)(h.Flex,{alignItems:"center",justifyContent:"end",gap:1,onClick:s,cursor:"pointer",children:[(0,v.jsxs)(h.TextMicro,{color:"textLite",children:[o?"Collapse":"Expand"," charts"]}),(0,v.jsx)(h.Icon,{name:"chevron_down",color:"textLite",rotate:o?0:3})]}),(0,v.jsx)(h.Collapsible,{open:o,children:(0,v.jsx)(h.Flex,{gap:4,margin:t,children:n.map(((e,t)=>{let[n,r]=e;return(0,v.jsx)(br,{initData:n,initFilter:r,...a},t)}))})})]}):null})),ea=(0,r.memo)((e=>{let{margin:t,hasHistogram:n=!1,...r}=e;const[a,o]=(0,K.A)(!0);return n?(0,v.jsxs)(h.Flex,{column:!0,children:[(0,v.jsxs)(h.Flex,{alignItems:"center",justifyContent:"end",gap:1,onClick:o,cursor:"pointer",alignSelf:"end",children:[(0,v.jsxs)(h.TextMicro,{color:"textLite",children:[a?"Collapse":"Expand"," histogram"]}),(0,v.jsx)(h.Icon,{name:"chevron_down",color:"textLite",rotate:a?0:3})]}),(0,v.jsx)(h.Collapsible,{open:a,children:(0,v.jsx)(h.Flex,{gap:4,margin:t,children:(0,v.jsx)(Xr,{...r})})})]}):null})),ta=(0,r.memo)((e=>{let{margin:t,...n}=e;const[r,a]=(0,K.A)(!0);return n.customCharts?(0,v.jsxs)(h.Flex,{column:!0,children:[(0,v.jsxs)(h.Flex,{alignItems:"center",justifyContent:"end",gap:1,onClick:a,cursor:"pointer",children:[(0,v.jsxs)(h.TextMicro,{color:"textLite",children:[r?"Collapse":"Expand"," chart"]}),(0,v.jsx)(h.Icon,{name:"chevron_down",color:"textLite",rotate:r?0:3})]}),(0,v.jsx)(h.Collapsible,{open:r,children:(0,v.jsx)(h.Flex,{gap:4,margin:t,children:(0,v.jsx)(Tr,{...n})})})]}):null}));var na=n(95565),ra=n(38773),aa=n(64156),oa=n(3941),sa=n(60602);const la=e=>{let{transactionId:t,onCancel:n,...a}=e;const[o,s]=(0,r.useState)(0),[l,,i,d]=(0,K.A)(),[c,u]=(0,r.useState)(null),x=(0,sa.A)(t,500),{loaded:p,value:g,hasError:f,refresh:y}=(0,m.iY)(x);(0,oa.A)(y,1e3),(0,r.useEffect)((()=>{p&&(f||(g.progress<100&&g.ms>1e3?(i(),s(g.progress)):d()))}),[p,f]),(0,r.useEffect)((()=>{c!==t&&u(null)}),[t]);const b=(0,aa.A)("(max-width: 767px)");return t&&l&&c!==t?(0,v.jsx)(h.Layer,{full:"horizontal",position:"bottom",backdrop:!1,...a,children:(0,v.jsxs)(h.Flex,{column:b,gap:2,alignItems:"center",background:"modalBackground",padding:[2,4],round:!0,width:{base:"100%",max:"1200px"},children:[(0,v.jsxs)(h.Text,{children:["Transaction ",t," is taking more than expected."]}),(0,v.jsx)(h.ProgressBar,{background:"borderSecondary",border:"none",color:["green","netdata"],containerWidth:"100%","data-testid":"trnasaction-progress","data-transaction-id":t,height:2,width:`${o}%`}),(0,v.jsxs)(h.Flex,{gap:2,alignItems:"center",children:[(0,v.jsx)(h.Button,{warning:!0,onClick:()=>n(),children:"Cancel"}),(0,v.jsx)(h.Text,{children:"or"}),(0,v.jsx)(h.Button,{padding:[0],onClick:()=>{u(t),d()},flavour:"borderless",children:"Wait for it to finish"})]})]})}):null};var ia=n(41514);class da extends r.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){(0,ia.H)("function-error",{error:e.message,stack:t.componentStack,functionId:this.props.functionId})}handleRetry=()=>{this.setState({hasError:!1,error:null}),this.props.onRetry&&this.props.onRetry()};render(){return this.state.hasError?this.props.fallback||(0,v.jsx)(ca,{onRetry:this.handleRetry,canRetry:!1!==this.props.canRetry,error:this.state.error}):this.props.children}}const ca=e=>{let{onRetry:t,canRetry:n=!0,error:r,paramsKey:a}=e;return(0,v.jsxs)(h.Flex,{column:!0,alignItems:"center",justifyContent:"center",padding:[8],gap:4,children:[(0,v.jsx)(h.Icon,{name:"alert_triangle",size:"large",color:"error"}),(0,v.jsx)(h.Text,{size:"large",strong:!0,children:"Something went wrong"}),(0,v.jsx)(h.Text,{color:"textLite",children:"We're having trouble loading this function"}),(0,v.jsx)(un,{paramsKey:a,noSearch:!a?.extraKey||"feed"===a?.extraKey}),(0,v.jsxs)(h.Flex,{gap:2,children:[(0,v.jsx)(h.Button,{onClick:t,disabled:!n,children:n?"Try Again":"Max Retries Reached"}),(0,v.jsx)(h.Button,{flavour:"borderless",onClick:()=>window.location.reload(),children:"Reload Page"})]})]})},ua=da,ha={extraKey:"fn"},ma={fn:{Chart:Qr,CustomChart:ta,loadingMessage:"Loading function...",item:"functions"},logs:{Chart:ea,CustomChart:ta,loadingMessage:"Loading logs...",item:"logs",missingMessage:(0,v.jsxs)(v.Fragment,{children:["In this room, no node has logs collection configured."," ",(0,v.jsx)("a",{href:"https://learn.netdata.cloud/docs/logs/",target:"_blank",rel:"noopener noreferrer",children:"Learn about monitoring logs with Netdata"}),"."]})},feed:{Chart:ir,CustomChart:ta,loadingMessage:"Loading events...",item:"events"}},xa={table:kn},pa={ErrNoEligibleNodeRequested:"There are no eligible nodes.",default:"Something went wrong."},ga=e=>{let{Chart:t,paramsKey:n,flavour:a,testIdPrefix:o,customCharts:s,defaultCharts:l,histogram:i,refetch:d,selectedFn:c,selectedNodeIds:u,containerWidth:m,loaded:x,type:p,togglePause:g,...f}=e;const y=xa[p]||xa.table,[b,j]=(0,I.useHovered)({isOut:e=>!e||!e.closest('[data-drop="drop-content"]')&&!e.closest('[data-drop="drop-backdrop"]')},[x]);return(0,r.useEffect)((()=>{g(j)}),[j]),x?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(r.Suspense,{fallback:(0,v.jsx)(Zr.V_,{height:"250px"}),children:(0,v.jsx)(ta,{paramsKey:n,testIdPrefix:o,customCharts:s,refetch:d,fn:c,nodeIds:u,containerWidth:m})}),(0,v.jsx)(r.Suspense,{fallback:(0,v.jsx)(Zr.V_,{height:"250px"}),children:(0,v.jsx)(t,{paramsKey:n,testIdPrefix:o,defaultCharts:l,hasCustom:!!s,hasHistogram:!!i,refetch:d,fn:c,nodeIds:u,containerWidth:m})}),(0,v.jsx)(r.Suspense,{fallback:(0,v.jsx)(Zr.nb,{rows:6}),children:(0,v.jsx)(y,{"data-testid":`${o}Component`,paramsKey:n,refetch:d,ref:b,selectedFn:c[0],containerWidth:m,flavour:a,...f},c[0])})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(Zr.V_,{height:"250px"}),(0,v.jsx)(h.Box,{height:"40px"}),(0,v.jsx)(Zr.nb,{rows:6})]})},fa=(0,r.memo)((e=>{let{paramsKey:t=ha,testIdPrefix:n="functions",availableFns:a,availableFnsLoaded:o,hasError:l,containerWidth:i,flavour:d,...c}=e;const{Chart:u,item:g="items",missingMessage:f}=ma[d]||ma.fn,[b,C]=(0,s._H)(t),k=b[0],F=(0,s.rc)(t),I=(0,x.a7)({...t,extraKey:k||t?.extraKey,merge:!1}),{infoLoaded:T,loaded:K,data:E,error:P,type:z,retentionWarning:M,defaultCharts:B,histogram:$,missingRequired:R,requiredParams:O,customCharts:D,transactionId:V}=(0,s.Ol)(t),_=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const[t]=e,n=(0,m.xY)(t,"name");return 0===e.length?"on your nodes":1===e.length&&n?`on ${n}`:"on your selected node"}(I),[q,W]=(0,y.w)();(0,r.useEffect)((()=>{a?.[0]?.name&&!l&&(q&&W&&"feed"!==d&&(a=a.filter((e=>!!e.nodes[W]))),a.some((e=>e.slug===k))||C([a.reduce(((e,t)=>"undefined"===typeof e.priority||e.priority<t.priority?e:t),a.find((e=>"processes"===e.name))||a[0]).slug]))}),[d,o,k,W]);const[H,U]=(0,A.A)(),Z=Gn(I,k,t,d),[J,X]=((e,t,n)=>{const a=(0,Y.vt)(),o=(0,p.QW)(),l=(0,N.mQ)(),i=(0,L.l6)("pollingInterval",{flavour:"int",...n}),d=(0,L.l6)("slice",{defaultValue:!0,flavour:"bool",...n}),[c,u]=(0,s.WH)(n),[h,x]=(0,L.x9)();(0,r.useEffect)((()=>()=>x(null)),[]);const g=(0,r.useRef)();g.current=c;const{fetch:f,isEnabled:y}=_n[t]||_n.default,[b,j,v,C,k]=Wn(h),F=(0,w.A)(C),I=(0,r.useRef)();I.current=b;const A=(0,r.useRef)();A.current=c.lastModified;const T=(0,r.useRef)();T.current=c.anchorAfter;const K=(0,p.ID)(),E=(0,s.Be)(n),P=(0,w.A)(E,!0),[z]=(0,s.UB)({...n,param:"histogram",flavour:"val"}),M=(0,m.yN)(e),[{loading:B,token:$}]=(0,S.f7)();(0,r.useEffect)((()=>{"feed"!==t&&(A.current=null,T.current=null,u({...Kn.zb[c.type]||Kn.zb.default,type:c.type}))}),[e?.[0],t]);const R=!!c.requiredParams.length&&E[Object.keys(E).find((e=>c.filtersToRefresh[e]&&!(0,fe.Ay)(P?.[e],E[e])))],O=(0,G.ub)(),D=(0,r.useRef)();(0,r.useEffect)((()=>{"feed"===t||D.current||(D.current=!0)}),[R,O]),(0,r.useEffect)((()=>{P&&!Sn()(P,E)&&c.loaded&&(A.current=null,T.current=null,u((e=>({...e,lastModified:null,anchorAfter:null,anchorBefore:null,offset:0,transactionId:null}))))}),[!!c.aggregations&&E]);const[V]=(0,s.oV)({...n,param:"selectedFacets",flavour:"arr",defaultValue:null});(0,r.useEffect)((()=>{c.loaded&&(A.current=null,T.current=null,u((e=>({...e,lastModified:null,anchorAfter:null,anchorBefore:null,offset:0,transactionId:null}))))}),[j,d,V,z]);const _=(0,r.useRef)(),q=function(){let{checkPeriod:n,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s=I.current(),l=(0,In.A)();if(u((e=>({...e,tail:!!r.tail,loading:!0,requestedPeriod:s,transactionId:l}))),n&&g.current.tail&&g.current.requestedPeriod.after<s.after&&!T.current&&g.current.requestedPeriod.before-g.current.requestedPeriod.after===s.before-s.after)return Promise.resolve({skip:!0});let i=V;if(V&&c.requiredParams?.length){const e=c.requiredParams.map((e=>e.id));i=[...new Set([...V,...e])]}let h=E;if(V){const e=c.requiredParams?.map((e=>e.id))||[],t=[...V,...e,...c.acceptedParams];h=t.reduce(((e,t)=>(t in h&&(e[t]=E[t]),e)),{})}return _.current=f({roomId:K,spaceId:a,nodeIds:e,cloudNodeIds:M,fn:t,roomSlug:o,filters:h,slice:d,...s,...r,histogram:z,facets:i,acceptedParams:c.acceptedParams,last:200,v:c.v,transactionId:l}),_.current},W=async e=>{let{skip:t,data:n={}}=e;if(!t&&n.data){if(k&&!n.data.length&&!n.direction&&!n.merge)try{const e=await q({...qn(I.current(),C)&&{anchor:1e3*C},data_only:!0,merge:c.hasHistory,direction:"forward",pageSize:1});n=e.data}catch{}(Vn[n.type]||Vn.default)(u,n),D.current=!1}else u((e=>({...e,...n,loading:!1,transactionId:null})))},H=(0,r.useRef)();H.current=q;const U=e=>{const{merge:t,direction:n,dataOnly:r,tail:a}=e||{};!e?.response?.status||400!==e.response.status&&304!==e.response.status?(e?.response?.data&&(e=e.response.data),u((t=>({...t,error:e,loaded:!0,loading:!1,transactionId:null})))):u((o=>({...o,loaded:!0,loading:!1,transactionId:null,...!!e&&{merge:t,direction:n,dataOnly:r,tail:a}})))},Z=(0,An.A)((()=>({enabled:!c.missingRequired&&c.infoLoaded&&!B&&y({nodeIds:e,fn:t,roomId:K,after:j}),fetch:()=>H.current(!l&&j<0?{if_modified_since:A.current,...A.current&&{direction:"forward",merge:c.hasHistory,tail:!0,delta:!0,data_only:!0,anchor:T.current},reset:D.current}:!l&&qn(I.current(),C)?{anchor:1e3*C,data_only:!!A.current,reset:D.current}:{direction:"backward",data_only:!!A.current,checkPeriod:!0,reset:D.current}),onFail:U,onPollingFail:U,onReceive:W,onBlurMode:()=>g.current.loading&&u((e=>({...e,loading:!1,transactionId:null}))),polling:!l&&j<0,pollingOptions:{pollingInterval:1e3*(i||c.updateEvery),shouldPause:!0},force:!0,skip:!!F&&!C})),[l,c.infoLoaded,c.missingRequired,K,e?.length,e?.[0],t,i,E,V,j,v,B,C,d,$,z]);return[(0,r.useCallback)((e=>{if(g.current.loadingMore)return;u((e=>({...e,loadingMore:!0})));const t=H.current(e);return t.then(W).catch(U).finally((()=>u((e=>({...e,loadingMore:!1,transactionId:null}))))),t}),[u]),(0,r.useCallback)((()=>{Z?.clearRef?.current?.promise?.cancel?.(),clearTimeout(Z?.clearRef?.current?.timeoutId),_.current?.cancel?.(),u((e=>({...e,loaded:!0,loading:!1,loadingMore:!1,transactionId:null})))}),[u])]})(I,k,t);if(!o)return(0,v.jsx)(Zr.I1,{flavour:d});if(Z)return(0,v.jsx)(j.A,{title:`${(0,ur.Zr)(g)} couldn't be loaded`,message:"ErrAllNodesFailed"===Z.errorMsgKey?`You do not have permissions to load ${g}`:pa[Z.errorMsgKey]||pa.default,footer:"ErrNoEligibleNodeRequested"===Z.errorMsgKey?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(na.A,{children:(0,v.jsx)(h.Text,{color:"primary",children:"Upgrade to Business"})}),(0,v.jsx)(h.Text,{children:"or"}),(0,v.jsx)(ra.A,{children:(0,v.jsx)(h.Text,{color:"primary",children:"Change your active node selection to unlock it."})})]}):null});if(l||o&&!a.length)return(0,v.jsx)(j.A,{title:`${(0,ur.Zr)(g)} couldn't be loaded`,message:f||`We couldn't find any available ${g}.`});if(P&&"canceled"!==P&&K){if("ErrNodeResourceNotFound"===P?.errorMsgKey)return(0,v.jsx)(j.A,{message:"Please review your selection and try again.",title:`${"feed"===t.extraKey?"Events are":`Function "${F}" is`} not available ${_}.`});if(!E?.length)return(0,v.jsx)(j.A,{title:("feed"===t.extraKey?"Events":`Function "${F}"`)+" couldn't be loaded",message:"ErrForbidden"===P?.errorMsgKey?"Forbidden":P?.errorMessage||""})}return T&&R?(0,v.jsx)(j.A,{title:"Required filters are needed",message:`Function "${F}" needs: ${O.map((e=>e.name)).join(", ")}.`,footer:"Check them on the right sidebar!"}):(0,v.jsxs)(h.Flex,{overflow:{horizontal:"hidden",vertical:"auto"},column:!0,padding:[2,2,0],gap:1,height:"100%",children:[(0,v.jsx)(xe,{nodeIds:I,onRefresh:J,onCancel:X,paramsKey:t,flavour:d}),(0,v.jsxs)(ua,{paramsKey:t,children:[(0,v.jsx)(ga,{Chart:u,paramsKey:t,flavour:d,testIdPrefix:n,customCharts:D,defaultCharts:B,histogram:$,refetch:J,selectedFn:k,selectedNodeIds:I,containerWidth:i,loaded:K,type:z,paused:H,togglePause:U,...c}),K&&!E?.length&&(0,v.jsxs)(h.Flex,{column:!0,justifyContent:"center",alignItems:"center",alignSelf:"center",margin:["feed"===t.extraKey?3:30,0,0],gap:3,children:[(0,v.jsx)(h.H3,{children:"No results to display"}),(0,v.jsx)(h.Text,{color:"textDescription",textAlign:"center",children:"Double-check your search or filters and dates and try again with different conditions"}),(0,v.jsx)(un,{paramsKey:t,noSearch:"feed"===t.extraKey}),M&&(0,v.jsx)(h.Text,{color:"text",textAlign:"center",children:M})]})]}),(0,v.jsx)(la,{transactionId:V,onCancel:X})]},W)})),ya=fa;var ba=n(41936);const ja=e=>{const t=(0,S.OS)();return(0,v.jsx)(h.Button,{label:"Get a fresh agent token",onClick:t,...e})},va="Functions expose sensitive information about your systems and applications. To protect your privacy, Netdata exposes this information only to logged-in users and claimed agents. When viewing Functions directly on a  Netdata Agent UI, this information is sent directly from the Netdata Agent to your web browser, without exposing it to any third parties.",Ca={notLoggedIn:{title:"Sign in to Netdata to use this function",description:va,footer:(0,v.jsx)(k.default,{})},notClaimed:{title:"Connect this agent to Netdata to use this function",description:va,footer:(0,v.jsx)(F.A,{})},noAccess:{title:"This agent belongs to a Netdata Space you are not member of",description:va,footer:(0,v.jsx)(h.TextBig,{color:"textDescription",children:"Ask for an invitation from the administrators of the Netdata Space of the agent to use functions."})},bearerError:{title:"You are not authorized to use this function",description:va,footer:(0,v.jsx)(ja,{})},default:{title:"Internal error",description:"Something went wrong, please reload the page"}},wa={extraKey:"fn"},ka=e=>{let{paramsKey:t=wa,hasError:n,refreshAvailableFns:a,availableFnsLoaded:o,availableFns:l,...i}=e;const d=(0,m.dN)(),c=(0,s.Ak)(t),[,h]=(0,y.w)();(0,f.A)({...t,extraKey:c||t.extraKey,keyFlavour:t.extraKey});const[b,k]=(0,x.Oj)({...t,extraKey:c||t.extraKey}),F=(0,x.w7)({...t,extraKey:c||t?.extraKey,emptyIfAll:!1,merge:!0}),I=(0,w.A)(b),A=(0,s.E)(t);(0,r.useEffect)((()=>A),[c,b?.[0]]),(0,r.useEffect)((()=>{if(h||!c)return;const e=l.find((e=>e.slug===c))?.nodes;if(!e)return;if(u()(b,F).length&&e[b[0]])return;let t=I?.length?I.find((t=>e[t])):null;t=t||F.find((t=>e[t])),t&&k([t])}),[h,k,F.length,c,l]);const[T]=(0,g.Q8)(),[{bearerProtection:K,error:E,token:L}]=(0,S.f7)(),{error:P}=(0,s.Ol)(t),z=(0,p.GJ)(),[{canBeClaimed:M,cloudStatus:B}]=(0,ba.RJ)();if((0,r.useEffect)((()=>{n&&L&&a()}),[B,L]),(0,r.useEffect)((()=>{L&&P&&A((e=>({...e,error:""})))}),[L]),!d.length)return(0,v.jsx)(C,{paramsKey:{...t,extraKey:c||t?.extraKey}});if(z&&(P||n||E&&K)){const{title:e,description:t,footer:n}=(e=>{let{userStatus:t,userNodeStatus:n,accessError:r,canBeClaimed:a,cloudStatus:o,error:s}=e;return Ca[t]?Ca[t]:r?Ca.notLoggedIn:a?Ca.notClaimed:Ca[n]?Ca[n]:412===s.status?Ca.bearerError:s.status>=400?{title:`Error - ${s.status}`,description:s.errorMessage||"Something went wrong"}:Ca.default})({...T,bearerError:E,canBeClaimed:M,cloudStatus:B,error:P});return(0,v.jsx)(j.A,{title:e,message:t,footer:n})}return(0,v.jsx)(ya,{testIdPrefix:"fn",paramsKey:t,availableFnsLoaded:o,availableFns:l,...i})},Fa={extraKey:"feed"},Sa=e=>{let{paramsKey:t=Fa,...n}=e;(0,f.A)(t);const a=(0,s.E)(t);return(0,r.useEffect)((()=>a),[]),(0,v.jsx)(ya,{testIdPrefix:"feed",paramsKey:t,...n})};var Ia=n(77057),Aa=n(38823);const Ta={fn:!0,logs:!0},Ka=(0,r.memo)((e=>{let{roomId:t,flavour:n,paramsKey:a,availableFns:o}=e;const l=(e=>{const t=Ta[e];return(0,r.useMemo)((()=>({Live:{head:{label:"Live nodes",textColor:"textLite",iconName:"connectivityStatusLive",hasFn:t},node:{textColor:"textFocus",showFn:t,requireFn:t}},Stale:{head:{label:"Stale nodes",textColor:"textLite",iconName:"connectivityStatusStale"},node:{textColor:"textFocus",disabled:t}},Offline:{head:{label:"Offline nodes",textColor:"textLite",iconName:"connectivityStatusOffline"},node:{textColor:"textLite",disabled:t}}})),[e])})(n),i=(e=>{const t=(0,s.Ol)(e,"aggregations");return(0,r.useMemo)((()=>t?.node_ids?t.node_ids.buckets.reduce(((e,t)=>({...e,[t.key]:t.hits.doc_count})),{}):null),[t])})(a),d=Ta[n],c=(0,s.Ak)(a),h=(0,r.useMemo)((()=>Array.isArray(o)&&o.find((e=>e.slug===c))?.nodes||null),[c,o]),m=(0,r.useCallback)((e=>!!h&&!h[e]),[h]),x=(0,r.useCallback)((e=>u()(h?Object.keys(h):[],e)),[h]);return d&&!h?null:(0,v.jsx)(Aa.A,{title:"Nodes",testIdPrefix:"nodes",baseKey:t,extraKey:a.extraKey,baseExtraKey:a.extraKey,param:"selectedNodeIds",multi:"feed"===n,children:(0,v.jsx)(Ia.Ay,{baseKey:t,extraKey:c||a.extraKey,statusProps:l,background:"mainBackground",itemProps:{padding:[1,1,1,.5]},searchMargin:[0,0,1],multi:"feed"===n,nodeCounts:i,...d&&{useFilteredIds:x},checkIsDisabled:m,baseExtraKey:a.extraKey,resizeable:!0},n)})})),Ea=Ka,La=e=>e.name,Pa=e=>e.slug,za=(0,r.memo)((e=>{let{param:t,baseKey:n,extraKey:r,testIdPrefix:a,title:o,items:s=[],multi:l=!1}=e;return s.length?(0,v.jsx)(Aa.A,{title:o,testIdPrefix:a,baseKey:n,extraKey:r,param:t,multi:l,baseExtraKey:r,children:(0,v.jsx)(qt.Ay,{param:t,baseKey:n,extraKey:r,testIdPrefix:a,collection:s,multi:l,getValue:Pa,getLabel:La,baseExtraKey:r,resizeable:!0})}):null}));var Ma=n(83488);const Ba=e=>e.id,$a={table:function(e){let{param:t,columns:n,aggregatedView:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.entries(e.reduce(((e,a)=>(e[a[t]]={count:(e[a[t]]?.count||0)+(a.hidden?0:1),type:n[t]?.type,...r&&{actualCount:(e[a[t]]?.actualCount||0)+(a.hidden?0:a[r.column]||1),actualCountLabel:r.aggregatedLabel,countLabel:r.resultsLabel}},e)),{})).map((e=>{let[t,n]=e;return{id:t,...n}}))},default:n.n(Ma)()},Ra=e=>{let{param:t,baseKey:n,extraKey:a,filtersKey:o,testIdPrefix:l,title:i,defaultExpanded:d=!1}=e;const c=(e=>{let{extraKey:t,filtersKey:n,param:a}=e;const o=Kt({extraKey:t,omit:a,keepAll:!0}),l=(0,L.l6)(a,{extraKey:n,flavour:"arr"}),i=(0,s.Ol)({extraKey:t},"type"),d=$a[i]||$a.default,{columns:c,aggregatedView:u}=(0,s.Ol)({extraKey:t});return(0,r.useMemo)((()=>d(o,{param:a,columns:c,aggregatedView:u})),[a,o,l])})({param:t,extraKey:a,filtersKey:o}),[u,,h]=Jt({param:t,extraKey:a,title:i,testIdPrefix:l});return c&&c.length?(0,v.jsx)(Aa.A,{title:i,testIdPrefix:l,baseKey:n,extraKey:o,param:t,defaultIsOpen:d,csvDownloadable:!0,options:c,configElements:e=>{let{isOpen:t}=e;return(0,v.jsx)(v.Fragment,{children:t&&h})},baseExtraKey:a,children:(0,v.jsx)(qt.Ay,{param:t,baseKey:n,extraKey:o,testIdPrefix:l,collection:c,capitalized:!1,getValue:Ba,getLabel:Ba,sortBy:u,baseExtraKey:a,resizeable:!0})}):null};var Oa=n(73700);const Na=[],Da=e=>{let{param:t,baseKey:n,extraKey:a,filtersKey:o,testIdPrefix:l,title:i,defaultExpanded:d=!1}=e;const c=(0,s.Ol)({extraKey:a},"columns"),[u,m]=(0,L.N9)(t,{key:n,extraKey:o,flavour:"arr",defaultValue:Na}),[x,p]=r.useState(u),[g,f]=r.useState(0),y=(0,r.useCallback)((0,Oa.s)(300,(e=>{m(e),p(e)})),[m]),b=(0,r.useCallback)((e=>{let{min:t,max:n}=e;y([t,n])}),[y]);if(r.useEffect((()=>{(!x&&u||x&&u&&(x[0]!==u[0]||x[1]!==u[1]))&&(p(u),f((e=>e+1)))}),[u,x]),!c[t])return null;const j=1*(c[t].min||0),C=1*(c[t].max||0),w=c[t].valueOptions?.decimal_points||0;return(0,v.jsx)(Aa.A,{title:i,testIdPrefix:l,baseKey:n,extraKey:o,param:t,defaultIsOpen:d,showCounter:!1,children:(0,v.jsx)(h.Box,{padding:[2,0],width:"100%",children:(0,v.jsx)(h.MultiRangeInput,{min:j,max:C,onChange:b,initMin:u[0]?1*u[0]:j,initMax:u[1]?1*u[1]:C,step:Math.pow(10,-w)},g)})})},Va=(e,t)=>({key:e,type:t[e].filter,defaultExpanded:t[e].defaultExpandedFilter}),_a={multiselect:Ra,range:Da},qa=e=>{let{baseKey:t,extraKey:n}=e;const r=(0,s.Ak)({extraKey:n}),a=(e=>cr(e,Va))(n);return a.map((e=>{const a=_a[e.type]||_a.multiselect;return(0,v.jsx)(a,{title:e.key,testIdPrefix:"function",baseKey:t,extraKey:n,filtersKey:`${r||n}Filters`,param:e.key,defaultExpanded:e.defaultExpanded},e.key)}))},Wa=e=>e.name||e.id,Ha=e=>e.id,Ua=(0,r.memo)((e=>{let{title:t,options:n,param:a,baseKey:o,filtersKey:l,testIdPrefix:i,multi:d=!0,defaultIsOpen:c=!1,required:u=!1,extraKey:m}=e;const[x,p]=(0,L.r$)(`hiddenZeros-${a}`,{extraKey:m,flavour:"bool",defaultValue:!1}),g=(0,s.Be)({param:a,extraKey:m,flavour:"arr"}),f=(0,r.useMemo)((()=>n?.length?n.filter((e=>!("number"===typeof e.count&&0===e.count&&!g.includes(e.id)))):null),[n,g,x]),[y,,b]=Jt({param:a,extraKey:m,title:t,testIdPrefix:i});return n?.length?(0,v.jsx)(Aa.A,{title:t,testIdPrefix:i,baseKey:o,extraKey:l,baseExtraKey:m,param:a,defaultIsOpen:c,required:u,multi:d,csvDownloadable:!0,options:x?f:n,configElements:e=>{let{isOpen:t}=e;return(0,v.jsxs)(v.Fragment,{children:[t&&f?.length!==n?.length&&(0,v.jsx)(T.A,{content:x?"Show zeros":"Hide zeros",align:"top",children:(0,v.jsx)(h.IconButton,{padding:[0],flavour:"borderless",onClick:e=>{e.stopPropagation(),p(!x)},"data-testid":`${i}-filter-resetAll`,tiny:!0,neutral:!0,children:(0,v.jsx)(_t.g,{icon:x?Dt.pS:Nt.k6,size:"md",alt:"Hide/show zeros"})})}),t&&b]})},children:(0,v.jsx)(qt.Ay,{param:a,baseKey:o,extraKey:l,testIdPrefix:i,collection:x?f:n,capitalized:!1,getValue:Ha,getLabel:Wa,multi:d,sortBy:y,baseExtraKey:m,resizeable:!0})}):null})),Ga={nodes:!0},Za=e=>{let{baseKey:t,extraKey:n}=e;const a=(0,s.Ak)({extraKey:n}),o=(0,s.Ph)(n),l=(0,s.Ol)({extraKey:n},"columns"),[i]=(0,s.oV)({extraKey:n,param:"selectedFacets",flavour:"arr"});if(!o.length)return null;return(0,r.useMemo)((()=>i?.length&&"feed"!==n?o.filter((e=>i.includes(e.id))):o),[o,i,n]).map((e=>Ga[e.id]?null:(0,v.jsx)(Ua,{title:e.name,options:e.options,param:e.id,testIdPrefix:"function",baseKey:t,filtersKey:`${a||n}Filters`,extraKey:n,defaultIsOpen:l[e.id]?.defaultExpandedFilter},e.id)))},Ya={select:!0},Ja=(0,r.memo)((e=>{let{baseKey:t,extraKey:n}=e;const a=(0,s.Ak)({extraKey:n}),[{requiredParams:o,infoLoaded:l,missingRequired:i},d]=(0,s.WH)({extraKey:n}),[c,u]=(0,s.ZY)({extraKey:n});return(0,r.useEffect)((()=>{if(!l||!o.length||c&&Object.keys(c).length)return;const e=o.reduce(((e,t)=>{if(!t.options?.length||c[t.id]?.length)return e;const n=t.options.filter((e=>!!e.defaultSelected));return e[t.id]=n.length?n.map((e=>e.id)):[t.options[0].id],e}),{});u((t=>({...t,...e})))}),[i,o,c,l,u]),(0,r.useEffect)((()=>{l&&(o.length?c&&d((e=>({...e,missingRequired:!!o.length&&!o.every((e=>!!e.options?.length&&(Array.isArray(c[e.id])?!!c[e.id]?.length:!!c[e.id])))}))):d((e=>({...e,missingRequired:!1}))))}),[l,o,c]),o.map((e=>(0,v.jsx)(Ua,{title:e.name,options:e.options,param:e.id,testIdPrefix:"function",baseKey:t,filtersKey:`${a||n}Filters`,extraKey:n,multi:!Ya[e.type],defaultIsOpen:!0,required:!0,resizeable:!0},e.id)))}));var Xa=n(78152);const Qa=(0,r.memo)((e=>{let{facetId:t,shouldClear:n,extraKey:a}=e;const o=(0,s.hG)({param:t,extraKey:a}),[l,i]=(0,s.S3)({extraKey:a});return(0,r.useEffect)((()=>{n&&(o(void 0),i((e=>e.filter((e=>e!==t)))))}),[n,o,i,t]),null})),eo=(0,r.memo)((e=>{let{baseKey:t,extraKey:n}=e;const{alphabetical:a,columns:o,infoLoaded:l,aggregations:i,requiredParams:d}=(0,s.Ol)({extraKey:n}),c=(0,r.useMemo)((()=>a.reduce(((e,t)=>("facet"!==o[t]?.filter||e.push({name:o[t].displayName,id:t}),e)),[])),[a?.length]),[u,h]=(0,s.oV)({param:"selectedFacets",extraKey:n,flavour:"arr",defaultValue:null}),m=(0,s.Ak)({extraKey:n}),[x,p]=r.useState([]),g=(0,r.useRef)(u);return(0,r.useEffect)((()=>{u||Array.isArray(i)&&h(i.map((e=>e.id)))}),[i?.length>0,null===u]),(0,r.useEffect)((()=>{if(!g.current||!u)return;const e=g.current.filter((e=>!u.includes(e)));if(e.length>0){const t=d?.map((e=>e.id))||[],n=e.filter((e=>!t.includes(e)));n.length>0&&(p(n),setTimeout((()=>p([])),0))}g.current=u}),[u,d]),Xa.gf&&l&&u?(0,v.jsxs)(v.Fragment,{children:[x.map((e=>(0,v.jsx)(Qa,{facetId:e,shouldClear:!0,extraKey:n},e))),(0,v.jsx)(Ua,{title:"Facets to use",options:c,param:"selectedFacets",testIdPrefix:"function",baseKey:t,filtersKey:m||n,extraKey:n,multi:!0},"facets")]}):null})),to=eo,no=(0,r.memo)((e=>{let{flavour:t,paramsKey:n,availableFns:a}=e;const o=(0,p.ID)(),{loaded:l,aggregations:i,error:d}=(0,s.Ol)(n),[c]=(0,y.w)(),u=(0,s.Cs)(n);return(0,v.jsxs)(h.Flex,{column:!0,overflow:{vertical:"auto"},padding:[0,3,30],children:["feed"!==t&&(0,v.jsx)(za,{title:"Function",testIdPrefix:"function",baseKey:u,extraKey:n.extraKey,param:"selectedFn",items:a}),!c&&(0,v.jsx)(Ea,{roomId:o,flavour:t,paramsKey:n,availableFns:a}),(0,v.jsx)(Ja,{baseKey:u,extraKey:n.extraKey}),l&&!i&&!d&&(0,v.jsx)(qa,{baseKey:u,extraKey:n.extraKey}),l&&i&&!d&&(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(r.Suspense,{fallback:"",children:[(0,v.jsx)(Za,{baseKey:u,extraKey:n.extraKey}),"logs"===t&&(0,v.jsx)(to,{baseKey:u,extraKey:n.extraKey})]})})]})})),ro=no;var ao=n(60908);const oo={fn:{Component:ka,paramsKey:{extraKey:"fn"},loadingMessage:"Loading functions..."},logs:{Component:ka,paramsKey:{extraKey:"fn"},loadingMessage:"Loading logs..."},feed:{Component:Sa,paramsKey:{extraKey:"feed"},loadingMessage:"Loading events..."}},so={filters:{iconName:"filterList",...l.kO,width:"19px",Content:ro,dataTestId:"fnFilters",label:"Filters"}},lo=e=>{let{flavour:t}=e;const{Component:n,paramsKey:c,loadingMessage:u}=oo[t]||oo.fn,h=(0,o.CK)(),m=(0,o.nj)(),{loaded:x,value:p,hasError:g,refresh:f}=(0,s.vx)(c,t),[y,{width:b}]=(0,d.A)();return m?h.length||"feed"===t?(0,v.jsx)(ao.Ay,{feature:`Functions-${t}`,children:(0,v.jsx)(a.A,{"data-testid":`${t}Page`,margin:[0,0,2],sidebar:(0,v.jsx)(l.Ay,{title:"Filters",flavour:t,paramsKey:c,availableFns:p,tabs:so,loaded:!0,hasSearch:!1}),ref:y,children:(0,v.jsx)(r.Suspense,{fallback:(0,v.jsx)(Zr.I1,{flavour:t}),children:(0,v.jsx)(n,{flavour:t,testIdPrefix:t,paramsKey:c,availableFnsLoaded:x,availableFns:p,refreshAvailableFns:f,hasError:g,containerWidth:b})})})}):(0,v.jsx)(ao.Ay,{feature:`Functions-${t}`,mode:"NoNodesView",children:(0,v.jsx)(i.A,{})}):(0,v.jsx)(Zr.I1,{flavour:t})}},93926:(e,t,n)=>{n.d(t,{A:()=>o});n(96540);var r=n(65258),a=n(74848);const o=e=>{let{message:t,title:n,footer:o,...s}=e;const l=s?.["data-testid"]||"functionError";return(0,a.jsxs)(r.Flex,{alignItems:"center",column:!0,"data-testid":l,flex:!0,gap:3,justifyContent:"center",padding:[0,20],...s,children:[(0,a.jsx)(r.H3,{"data-testid":`${l}-title`,children:n}),(0,a.jsx)(r.TextBig,{color:"textDescription","data-testid":`${l}-message`,children:t}),o]})}}}]);