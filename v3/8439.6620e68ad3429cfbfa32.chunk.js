try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="6f52f47e-4ffc-436f-9d24-e9c33b19570f",e._sentryDebugIdIdentifier="sentry-dbid-6f52f47e-4ffc-436f-9d24-e9c33b19570f")}catch(e){}("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:{}).SENTRY_RELEASE={id:"6f1faf434b0a85eb183c91391b598f364a828f27"};(self.webpackChunkcloud_frontend=self.webpackChunkcloud_frontend||[]).push([[8439,9707],{5020:(e,t,n)=>{n.d(t,{Oq:()=>r,Q:()=>a,bP:()=>i,ml:()=>o});const o=(e,t)=>e.on("sizeChanged",((e,n,o)=>{if(e.getParent()!==t)return;const r=e.getAttribute("id"),a=t.getAttribute("host"),i=`chart_height.${a}/${r}`;localStorage.setItem(i,n);const s=`chart_width.${a}/${r}`;localStorage.setItem(s,o)})),r=(e,t,n)=>{const o=`chart_height.${e.getAttribute("host")}/${t}`,r=localStorage.getItem(o);return r?/px/.test(r)?parseInt(r.replace("px",""),10):parseInt(r,10):n},a=e=>{e?.id&&localStorage.setItem(`chart_layout/${e.id}`,JSON.stringify(e))},i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=localStorage.getItem(`chart_layout/${e}`);try{let e=JSON.parse(o);return e?(e=(e=>{let{i:t,id:n=t,x:o,left:r=o,y:a,top:i=a,w:s,width:l=s,h:d,height:c=d,expanded:u=!1}=e;return{id:n,width:l,height:c,left:r,top:i,expanded:u}})(e),{...n,...t,...e}):{...n,...t}}catch{return{...n,...t}}}},9962:(e,t,n)=>{n.d(t,{I:()=>o});const o=e=>{let{error:t,testPrefix:n,onClick:o,flavour:r,value:a}=e;return{"data-testid":n?`${n}-${r}`:r,flavour:r,...o&&{onClick:o},text:t?"-":`${a}`}}},13026:(e,t,n)=>{n.d(t,{A:()=>x});n(98992),n(72577);var o=n(96540),r=n(65258),a=n(74891),i=n(3203),s=n(49163),l=n(63928),d=n(1444),c=n(6304),u=n(95565),h=n(74848);const g=(0,i.A)((0,a.A)(r.Button)),m={LocalDashboard:"Favourites can be saved when the agent is part of a Netdata cloud space.",DemoSpace:"Favourites cannot be saved on a demo space.",FreePlan:()=>(0,h.jsxs)(r.Flex,{column:!0,gap:1,children:[(0,h.jsx)(r.Text,{children:"Favourites can be saved only on a paid plan."}),(0,h.jsx)(u.A,{children:(0,h.jsx)(r.Text,{color:"primary",children:"Upgrade for no limitations!"})})]}),default:null},x=e=>{let{menuId:t,menuName:n,flavour:r}=e;const[a,,i,u]=(0,c.A)(),x=(0,s._)({params:{type:["favourites"],path:[`/${r}`],entity:t}}),p=(0,o.useMemo)((()=>x.find((e=>{let{entity:n}=e;return n==t}))?.id),[x,t]),f=!!p,b=(0,l.yK)({onResolve:u}),v=(0,l.z2)(p,{onResolve:u}),{disabled:j,reason:y}=(0,d.A)(),w=(0,o.useMemo)((()=>({icon:f?"heart":"heart_hollow",tooltip:j&&y?m[y]||m.default:f?`Remove ${n} from your favourites`:`Add ${n} to your favourites`,disabled:a||j,padding:[0,2],..."FreePlan"==y?{tooltipProps:{align:"bottom",activateOn:"hover",isBasic:!0,allowHoverOnTooltip:!0}}:{}})),[f,a,n,j,y]),I=(0,o.useCallback)((()=>{j||(i(),f?v():b({type:"favourites",entity:t,path:`/${r}`,value:{menuId:t,sortOrder:Date.now()}}))}),[j,b,v,i,f,t]);return(0,h.jsx)(g,{flavour:"borderless",small:!0,onClick:I,payload:{menuId:t},...w})}},14963:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(96540),r=n(65258),a=n(50239),i=n(74848);const s=e=>{let{children:t,onClick:n,...s}=e;const l=(0,a.UH)(),d=(0,o.useCallback)((e=>{const{hash:t=""}=e.target;t.startsWith("#menu")&&(e.preventDefault(),l.goToLink(t.substr(1))),n&&n(e)}),[l]);return"string"===typeof t?(0,i.jsx)(r.TextSmall,{color:"textDescription",dangerouslySetInnerHTML:{__html:t},onClick:d,...s}):t||null}},19707:(e,t,n)=>{n.d(t,{I:()=>r});var o=n(39175);const r=()=>{if(o.Ay)return null;const{origin:e,searchParams:t}=new URL(window.location.href),n=t?.get("labra_subscription_id");if(!n)return null;const r=t?.get("cloud_provider"),a=t?.get("cloud_product_id"),i=t?.get("cloud_customer_id");if(i&&a&&r)return`${e}/api/v2/billing/labra/spaces?customer_id=${i}&marketplace=${r}&product_id=${a}&subscription_id=${n}`;const s=t?.get("aws_customer_id"),l=t?.get("aws_product_id");return s&&l?`${e}/api/v2/billing/labra/spaces?customer_id=${s}&marketplace=aws&product_id=${l}&subscription_id=${n}`:null}},27024:(e,t,n)=>{n.d(t,{A:()=>T});var o=n(96540),r=n(65258),a=n(31141),i=n(32788),s=n(29263),l=n(47410),d=n(16866),c=n(24609),u=n(19371),h=n(41579),g=n(19186),m=n(67294),x=n(5907),p=n(92726),f=n(62718),b=n(93536),v=n(38757),j=n(6304),y=n(50433),w=n(45706),I=n(28864),C=n(52795),k=n(74848);const A=(0,o.memo)((e=>{let{id:t,spaceId:n,roomId:a,chartId:i,name:s}=e;const[l,,d,h]=(0,j.A)(),{fullyLoaded:m,processing:f}=(0,p.fz)(t),b=(0,I.DH)(t,{onSuccess:()=>{(0,y.jE)(`Chart added to ${s}`),h()}}),v=l&&m,A=(0,c.ns)(n,"slug"),S=(0,g.wz)(a,"slug"),T=(0,x.nM)(t),F=(0,w.A)(l&&t,{spaceId:n,spaceSlug:A,roomId:a,roomSlug:S}),N=(0,u.eg)();(0,o.useEffect)((()=>{if(F||!v)return;const e=N.getNode({id:i}),t=(0,C.h)(e.getAttributes());T(t.contextScope,t,(()=>setTimeout(b,100)))}),[v,F]);const M=l&&(f||F);return(0,k.jsx)(r.Button,{icon:"plus",onClick:d,isLoading:M,disabled:M,alignSelf:"end"})})),S=e=>{let{spaceId:t,roomId:n,chartId:o}=e;return[{id:"name",accessorKey:"name",header:"Dashboards",cell:e=>{let{getValue:t}=e;return(0,k.jsxs)(r.Flex,{alignItems:"center",gap:3,children:[(0,k.jsx)(r.Icon,{name:"dashboards",size:"small",color:"text"}),(0,k.jsx)(r.Text,{children:t()})]})}},{id:"plusButton",accessorKey:"id",header:"",cell:e=>{let{getValue:r,row:a}=e;return(0,k.jsx)(A,{id:r(),spaceId:t,roomId:n,chartId:o,name:a.original.name})}}]},T=e=>{let{onClose:t}=e;(0,h.A)();const n=(0,g.ID)(),j=(0,g.XA)("name"),y=(0,c.vt)(),{params:w={},params:{chartId:I}}=(0,a.A)("addToDashboardModal"),C=(0,m.q)(),A=(0,p.Sf)(C),[T,F]=(0,o.useState)(""),[N,M]=(0,o.useState)(!1),D=T.length>0,P=(0,x.W6)(y,n,{onSuccess:t}),B=(0,u.eg)().getNode({id:I}),R=(0,o.useMemo)((()=>S({spaceId:y,roomId:n,chartId:I})),[y,n,I]),$=()=>{if(!B)return;const{aggregationMethod:e,selectedDimensions:t,groupBy:n,groupByLabel:o,groupingMethod:r,chartType:a,selectedLabels:i,nodesScope:s,selectedInstances:l,selectedNodes:d,contextScope:c}=B.getAttributes(),[u]=c;P(T,c,{...(0,b.L)(u),aggregationMethod:e,selectedDimensions:t,groupBy:n,groupByLabel:o,groupingMethod:r,chartType:a,selectedLabels:i,nodesScope:s,selectedInstances:l,selectedNodes:d})},L=(0,m.RQ)();return(0,k.jsxs)(i.GO,{onClose:t,children:[(0,k.jsx)(s.z,{onClose:t,title:"Add to Dashboard"}),(0,k.jsx)(l.U,{children:"Select Dashboard"}),(0,k.jsxs)(i.Yv,{gap:3,overflow:"hidden",height:"100%",children:[(0,k.jsxs)(r.H6,{children:["Add chart to one or more dashboards from the ",j]}),L?(0,k.jsx)(r.Table,{dataColumns:R,data:A}):(0,k.jsx)(f.UG,{rows:3}),(0,k.jsxs)(r.Flex,{column:!0,padding:[3,0],gap:1,children:[(0,k.jsxs)(r.H6,{children:["Create a new dashboard and add ",I," to it"]}),(0,k.jsx)(v.A,{value:T,label:"Name",onChange:e=>F(e.target.value),isValid:N,setIsValid:M,isDirty:D,instantFeedback:"all",onKeyDown:e=>e.keyCode===d.I7&&N&&$}),(0,k.jsx)(r.Button,{label:"Create & add",onClick:$,disabled:!B||!T})]})]})]})}},27496:(e,t,n)=>{n.d(t,{n:()=>i});n(96540);var o=n(14963),r=n(4719),a=n(74848);const i=(0,r.aV)((e=>e.children?(0,a.jsx)(o.A,{as:"p",role:"document",...e}):null),(e=>{let{info:t}=e;return{children:t}}))},30863:(e,t,n)=>{n.d(t,{A:()=>B});n(98992),n(54520),n(81454);var o=n(96540),r=n(65258),a=n(73700),i=n(69457),s=n(51220),l=n(53749),d=n(48106),c=n(20871);n(72577);let u=null;n(25509),n(65223),n(60321),n(41927),n(11632),n(64377),n(66771),n(12516),n(68931),n(52514),n(35694),n(52774),n(49536),n(21926),n(94483),n(16215);var h=n(57530),g=n(43375);n(8872);var m=n(33185),x=n(98131),p=n(13026),f=n(33962),b=n(4719),v=n(56876),j=n(74848);const y=(0,o.memo)((e=>{let{id:t,name:n,icon:a,isLast:i}=e;const{onMenuClick:s}=(0,v.A)(),l=(0,o.useCallback)((()=>{s({id:t})}),[t,s]),d=(0,o.useMemo)((()=>({alignItems:"center",gap:1,...i?{}:{cursor:"pointer",onClick:l}})),[i,l]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(r.Flex,{...d,children:[a?(0,j.jsx)(x.o,{icon:a,active:!0,containerProps:{width:"auto"}}):null,(0,j.jsx)(r.Text,{color:"primary",strong:!0,children:n})]}),i?null:(0,j.jsx)(r.Text,{color:"primary",strong:!0,children:">"})]})})),w=(0,o.memo)((e=>{let{menu:t}=e;const{id:n,shortName:a,name:i,icon:s,parentMenus:l}=t||{},d=(0,o.useMemo)((()=>[...l||[],{id:n,name:a||i,icon:s}]),[t]);return n?(0,j.jsx)(r.Flex,{alignItems:"center",gap:1,children:d.map(((e,t)=>(0,j.jsx)(y,{isLast:t===d.length-1,...e},e.id)))}):null})),I=(0,m.default)(r.Flex).attrs((e=>({position:"sticky",top:0,width:"100%",alignItems:"center",justifyContent:"between",padding:[2,1,2,2],zIndex:15,...e}))).withConfig({displayName:"headerAggregator__StyledContainer",componentId:"sc-10l70s7-0"})(["backdrop-filter:blur(5px);"]),C=["nodes"],k=e=>{let{flavour:t,tools:n=[]}=e;const a=(0,f.W2)(),i=(0,b.b)(a),s=(0,o.useContext)(m.ThemeContext);return!C.includes(t)&&i?(0,j.jsxs)(I,{background:(0,r.getRgbColor)("mainBackground",.8)({theme:s}),children:[(0,j.jsx)(w,{menu:i}),(0,j.jsxs)(r.Flex,{alignItems:"center",gap:1,children:[n.map((e=>{let{Component:t,...n}=e;return t?(0,j.jsx)(t,{...n},n.id):null})),(0,j.jsx)(p.A,{menuId:a,menuName:i.shortName||i.name,flavour:t})]})]}):null},A=(0,o.memo)(k),S="8px 2px",T="1px 2px",F={root:T,submenu:T,default:S},N=[{flavour:"root",id:"System-0"}],M=(0,o.memo)((e=>{let{getComponent:t,element:n,index:r,...a}=e;const i=(0,o.useMemo)((()=>n&&t(n)),[n?.id,r]),s=(0,o.useMemo)((()=>!!N.find((e=>{let{id:t,flavour:o}=e;return t===n.id&&o===n.flavour}))),[n]);return!i||s?null:(0,j.jsx)(i,{...n,index:r,...a,isVisible:!0},n.id)})),D=(0,o.memo)((e=>{let{flavour:t,elements:n,onScroll:i,dashboardOptions:l,getComponent:c,stickyBg:m="mainBackground",stickyRef:x,nextStickyRef:p,stickyIndexes:f,tmpStickyRef:b,containerWidth:v,headerProps:y={},ref:w}=e;const I=(e=>{const t=(0,o.useRef)(),n=(0,o.useRef)(),r=(0,o.useRef)(0),a=(0,o.useRef)(0);return(0,o.useCallback)((o=>{if(t.current!==e.length&&(a.current=0),n.current&&(a.current<5||t.current!==e.length)){a.current=a.current+1,t.current=e.length;const i=e.findIndex((e=>e.id===n.current.id));if(-1===i)return;const{start:s}=o.getMeasurements()[i];return o.scrollToOffset(s+r.current),clearTimeout(u),void(u=setTimeout((()=>a.current=5),200))}t.current=e.length;const i=o.scrollOffset;let s=0;const l=o.getMeasurements().find((e=>(s+=e.size,s>i)));l&&(n.current=e[l.index],r.current=i-l.start)}),[e])})(n),C=(0,o.useRef)(),[k,T]=(0,o.useState)(0),N=((e,t,n)=>{let{stickyRef:r,nextStickyRef:a,tmpStickyRef:i}=n;const s=(0,o.useRef)(),{active:l}=(0,g.fF)(),d=(0,o.useRef)();return d.current=l,(0,o.useCallback)((e=>{if(d.current&&d.current.data.current.isResizer)return s.current;if(!t)return s.current=(0,h.vp)(e),s.current;a.current=Number(Object.keys(t).find((t=>e.startIndex<t))),r.current=Number(Object.keys(t).reverse().find((t=>e.startIndex>=t))),a.current-e.startIndex===1&&(r.current=NaN);let n=(0,h.vp)(e);return null!==i.current&&(n=[...n,i.current]),isNaN(r.current)?s.current=[...new Set(n)].sort(((e,t)=>e-t)):s.current=[...new Set([r.current,...n])].sort(((e,t)=>e-t)),s.current}),[e,t])})(n,f,{stickyRef:x,nextStickyRef:p,tmpStickyRef:b}),D=(0,s.Te)({count:n.length,getScrollElement:()=>w.current,overscan:2,enableSmoothScroll:!1,estimateSize:e=>n[e].size,onChange:I,rangeExtractor:N,scrollPaddingStart:0});C.current=D,(0,d.A)(D,n);const P=(0,o.useCallback)((0,a.n)(100,(function(){i(...arguments),w.current&&T(w.current.scrollTop)})),[i]);return(0,j.jsxs)("div",{ref:w,style:{minHeight:"100%",width:"100%",overflow:"auto"},onScroll:P,children:[(0,j.jsx)(A,{flavour:t,...y}),(0,j.jsxs)("div",{style:{minHeight:`${D.getTotalSize()}px`,width:"100%",position:"relative"},children:[k>0&&!isNaN(x.current)&&(0,j.jsx)(r.Box,{sx:{top:0,left:0,width:"100%",padding:S,position:"sticky",zIndex:10,boxShadow:"2px 6px 6px -7px rgba(0, 0, 0, 0.4)"},background:m,children:(0,j.jsx)(M,{...l,element:n[x.current],index:x.current,getComponent:c})},x.current),D.getVirtualItems().map((e=>{const t=F[n[e.index].flavour]||F.default;return(0,j.jsx)(r.Box,{ref:D.measureElement,sx:{top:0,left:0,width:"100%",padding:t,position:"absolute",transform:`translateY(${e.start}px)`},"data-index":e.index,children:(0,j.jsx)(M,{...l,element:n[e.index],index:e.index,getComponent:c,containerWidth:v})},e.key)}))]})]})}),((e,t)=>e.elements.length===t.elements.length&&e.containerWidth===t.containerWidth)),P=e=>{let{flavour:t,onActiveMenuId:n,getComponent:r,dashboardOptions:a,initialChartName:s,checkVisibility:d,...u}=e;const h=(0,l.bD)(),g=(0,i.qR)((e=>e.filter((e=>d?d(e.contexts||e.contextScope||e.chartIds||[e.id]):h(e.contexts||e.contextScope||e.chartIds||[e.id]))))),[{stickyRef:m,nextStickyRef:x,tmpStickyRef:p},f]=(e=>{const t=(0,i.Tg)(),n=(0,o.useRef)(null),r=(0,o.useMemo)((()=>e.reduce(((e,n,o)=>{let{id:r,sticky:a}=n;return t[r]&&"undefined"!==typeof a&&a&&(e[o]=!0),e}),{})),[e]),a=(0,o.useRef)(),s=(0,o.useRef)(),l=(0,o.useCallback)((e=>!!r[e]),[r]),d=(0,o.useCallback)((e=>a.current===e),[]);return[{stickyRef:a,nextStickyRef:s,isSticky:l,isActiveSticky:d,tmpStickyRef:n},r,t]})(g),b=(0,o.useRef)(),v=(0,o.useRef)(),y=(0,o.useMemo)((()=>(v.current&&v.current.cancel(),v.current=(0,c.A)({stickyRef:m}),()=>v.current(b.current,n))),[g.length,n]);return(0,o.useLayoutEffect)((()=>{g.length&&y()}),[g.length,s]),(0,j.jsx)(D,{flavour:t,elements:g,onScroll:y,dashboardOptions:a,getComponent:r,ref:b,stickyRef:m,nextStickyRef:x,stickyIndexes:f,tmpStickyRef:p,...u})},B=(0,o.memo)(P)},31035:(e,t,n)=>{n.d(t,{$:()=>h,A:()=>g});var o=n(96540),r=n(30569),a=n(97940),i=n(24609),s=n(77389),l=n(63231),d=n(86706),c=n(82505),u=n(99728);const h=e=>`spaces.${e}.members`,g=e=>{const t=(0,i.vt)(),n=(0,r.yF)((0,o.useCallback)(((n,o,r)=>{let{results:a}=r;o((0,d.jX)({id:e,spaceId:t}),a)}),[e,t])),g=(0,u.JT)("user:ReadAll");(0,a.A)((()=>({key:h(e),autorun:!!e&&g,fetch:()=>(0,s.kE)(e),association:{getError:()=>(0,c.x2)({id:e,key:"error"}),getIds:()=>(0,d.kd)({id:e,key:"ids"}),getLoaded:()=>(0,d.kd)({id:e,key:"loaded"}),getUpdatedAt:()=>(0,d.kd)({id:e,key:"updatedAt"})},sort:(e,t)=>e.name.localeCompare(t.name,void 0,{sensitivity:"accent",ignorePunctuation:!0}),getResource:e=>(0,l.m)({id:e}),getResourcesInitializer:()=>l.WJ,onReceive:n,pollingOptions:{pollingInterval:315e3}})),[e,g])}},41579:(e,t,n)=>{n.d(t,{A:()=>u});n(98992),n(3949),n(81454);var o=n(96540),r=n(30569),a=n(92726),i=n(91539),s=n(24609),l=n(19186),d=n(258),c=n(67294);const u=()=>{const e=(0,s.vt)(),t=(0,l.ID)(),n=(0,r.yF)((0,o.useCallback)((function(e,n){let{data:{results:o}={}}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(n((0,c.z_)({id:t,key:"loaded"}),!0),o?.length){const e=o.sort(((e,t)=>e.name.localeCompare(t.name,void 0,{sensitivity:"accent",ignorePunctuation:!0})));e.forEach((e=>n((0,a._d)(e.id),e)));const r=e.map((e=>{let{id:t}=e;return t}));n((0,c.z_)({id:t,key:"ids"}),r)}}),[])),u=(0,o.useCallback)((()=>{(0,d.SJ)(e,t).then(n).catch((()=>{}))}),[e,t]);return(0,i.A)((()=>({polling:!1,enabled:!!e&&!!t,fetch:()=>(0,d.SJ)(e,t),onReceive:n})),[e,t]),u}},47413:(e,t,n)=>{n.d(t,{A:()=>g});n(98992),n(81454);var o=n(96540),r=n(15920),a=n(1817),i=n(44245),s=n(93335),l=n(65258),d=n(19075),c=n(74848);const u={warning:"warning",critical:"error"},h=e=>{let{alertId:t}=e;const n=(0,d.JL)(t,"status");return u[n]?(0,c.jsx)(l.Flex,{alignSelf:"center",margin:[0,0,0,2],round:1,background:u[n],width:2,height:2}):null},g=e=>{const t=(0,r.Zp)(),n=(0,r.RQ)("/spaces/:spaceSlug/rooms/:roomSlug/:type/*"),l=(0,i._F)(),d=(0,i.xK)(),u=(0,i.NU)(),g=n?n.pathnameBase:"/spaces",{pathname:m}=(0,r.zy)(),x=(0,a.A)(e[m]&&m,!0),p=(0,o.useCallback)(((e,n)=>{if(!n)return d(e);const o=l[e-1],r=l[e+1],a=(n,o)=>{t(`${n}${o?`/${o}`:""}`),d(e)};return x?a(x):o?a(o.path,o.params):r?a(r.path,r.params):a(g)}),[l,d,g,x]);return[(0,o.useMemo)((()=>l.map((e=>({...e,children:e.id&&"nodes"===e.type?(0,c.jsx)(s.N,{nodeId:e.id}):"alerts"===e.type?(0,c.jsx)(h,{alertId:e.id}):null})))),[l]),(e,t)=>{-1===e&&-1===t||u({sourceIndex:e,destinationIndex:t})},p]}},48106:(e,t,n)=>{n.d(t,{A:()=>c});n(98992),n(72577);var o=n(96540),r=n(69457),a=n(4719),i=n(50239),s=n(66814);const l=e=>{const t=(0,o.useRef)();return(0,s.i7)(e,(e=>(t.current=e,!1))),t},d=(e,t)=>{for(let n=0;n<e.length;n++){const o=e[n];if(o.id===t)return n;if(o.children&&o.children.length>0){const e=d(o.children,t);if(-1!==e)return n+1+e}}return-1},c=(e,t)=>{const n=(0,r.NF)(),s=l(a.tu),c=l(r.i8),u=(0,i.Gr)(),h=(0,o.useMemo)((()=>({goToElement:function(n){let{leaf:o=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!(!t.length||!e)&&(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;new Promise((n=>{const o=t=>{if(0===t)return n();e(),setTimeout((()=>o(--t)))};o(t)}))}((()=>{let r=d(t,n);if(o)for(;t[r]?.level<(t[r+1]?.level??999999);)r+=1;if(-1!==r)return e.scrollToIndex(r,{align:"start"})}),5),!0)},goToLink:e=>{const t=Object.values(s.current).find((t=>t.link&&t.link===e));if(t)return h.goToElement(t.id,{leaf:!0});if(c.current){const t=Object.values(c.current).find((t=>t.link&&t.link.includes(e)));if(t)return h.goToElement(t.id,{leaf:!0})}}})),[n,t]);return(0,o.useLayoutEffect)((()=>{u(h)}),[h]),h}},54025:(e,t,n)=>{n.d(t,{t:()=>a});n(96540);var o=n(65258),r=n(74848);const a=e=>{let{id:t,testId:n="chart-sub-menu-container",...a}=e;return(0,r.jsx)(o.Flex,{column:!0,gap:2,id:t,"data-testid":n,"data-menuid":t,...a})}},55048:(e,t,n)=>{n.d(t,{A:()=>l});n(98992),n(54520);var o=n(96540),r=n(46587),a=n(24609),i=n(19186),s=n(79022);const l=()=>{const e=(0,r.NJ)(),t=(0,a.vt)(),n=(0,i.ID)(),l=(0,o.useCallback)((()=>(0,s.l8)({userId:e,spaceId:t,roomId:n})),[e,t,n]),d=(0,o.useCallback)((o=>(0,s.zz)({userId:e,spaceId:t,roomId:n},o)),[e,t,n]),c=(0,o.useCallback)((e=>{const t=l();d(t.filter((t=>t!==e)))}),[e,t,n]);return[l,d,c]}},59895:(e,t,n)=>{n.d(t,{A:()=>i});n(96540);var o=n(65258),r=n(13026),a=n(74848);const i=e=>t=>t.enableFavourites&&t.selfChartIds?.length?(0,a.jsxs)(o.Flex,{alignItems:"center",justifyContent:"between",children:[(0,a.jsx)(e,{...t}),(0,a.jsx)(r.A,{menuId:t._id,menuName:t.name,flavour:t.flavour})]}):(0,a.jsx)(e,{...t})},60602:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(96540),r=n(68531);const a=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const[a,i]=(0,o.useState)(e);return(0,r.A)((()=>i(e)),t,[e,...n]),a}},63589:(e,t,n)=>{n.d(t,{A:()=>c});n(96540);var o=n(65258),r=n(82103),a=n(19186),i=n(24609),s=n(1174),l=n(74848);var d;const c=(d=o.Button,e=>{const t=(0,a.XA)(),n=(0,i.dg)();return(0,l.jsx)(s.A,{permission:"node:Create",children:a=>{const i=(0,l.jsx)(d,{disabled:!a,...e});return a?i:(0,l.jsx)(r.A,{content:n?"You are viewing your local node, connect to cloud and connect multiple nodes to view at once":`Only admin users can add nodes to ${t.name}`,"data-testid":"addNodeTooltipContainer",children:(0,l.jsx)(o.Box,{children:i})})}})})},63996:(e,t,n)=>{n.d(t,{t:()=>h});var o=n(96540),r=n(65258),a=n(73613),i=n(4719),s=n(59895),l=n(75144),d=n(74848);const c=e=>{let{name:t,level:n,descendantIds:a,enableFavourites:i,ref:s,...l}=e;const c=(0,o.useMemo)((()=>Array.from(Array(n)).fill("-").join("")),[n]),u=(0,o.useMemo)((()=>i?`${c} ${t}`:t),[i,c,t]),h=(0,o.useMemo)((()=>({...!i||a?.length&&!l?.selfChartIds?.length?{}:{color:"primary"},...l})),[a,l]);return"string"===typeof t?(0,d.jsx)(r.Text,{strong:!0,ref:s,...h,children:u}):t||null},u=(0,s.A)((e=>{let{hasTooltip:t,hasInfo:n,...o}=e;return t&&n?(0,d.jsx)(a.A,{content:(0,d.jsx)(l.X,{id:o.id}),isBasic:!0,children:(0,d.jsx)(c,{...o})}):(0,d.jsx)(c,{...o})})),h=(0,i.aV)(u,(e=>{let{name:t,info:n}=e;return{name:t,hasInfo:!!n}}))},69001:(e,t,n)=>{n.d(t,{h:()=>a});n(96540);var o=n(65258),r=n(74848);const a=e=>{let{id:t,...n}=e;return(0,r.jsx)(o.Flex,{column:!0,"data-testid":"chart-menu-wrapper","data-menuid":t,...n})}},72060:(t,n,o)=>{o.d(n,{A:()=>r});const r=t=>{try{if(!t)return null;const e=document.createElement("a");return e.href=t,/https?/.test(e.protocol)?new URL(e.protocol+"//"+e.host+e.pathname+e.search+e.hash).toString():null}catch(e){return null}}},75144:(e,t,n)=>{n.d(t,{X:()=>i});n(96540);var o=n(4719),r=n(14963),a=n(74848);const i=(0,o.aV)((e=>e.children?(0,a.jsx)(r.A,{as:"p",role:"document",...e}):null),(e=>{let{info:t}=e;return{children:t}}))},77234:(e,t,n)=>{n.d(t,{x:()=>o});const o={home:"home",overview:"overview",nodes:"nodes",k8s:"k8s",top:"top",logs:"logs",dashboards:"dashboards",dashboard:"dashboard",alerts:"alerts",ar:"ar",events:"events",insights:"insights"}},80744:(e,t,n)=>{n.d(t,{Ay:()=>m,NA:()=>g});n(98992),n(72577),n(81454);var o=n(96540),r=n(40961),a=n(43375),i=n(67012),s=n(43305),l=n(71123),d=n(61710),c=n(45427),u=n(74848);const h={sideEffects(e){let{active:t}=e;t.node.animate([{opacity:0},{opacity:1}],{easing:"ease-in",duration:250})}},g=40,m=e=>{let{cacheId:t,rootId:n,items:m,onRemove:x,Item:p,containerWidth:f=800,rowHeight:b=g,gridTracks:v=12,gutter:j=4,allowOverlap:y=!1,compactType:w="vertical",maxRows:I=3e5,Container:C=s.A,onDragEnd:k,containerId:A,itemProps:S,rearrangeable:T=!0,...F}=e;const N=(0,o.useRef)(),[M,D]=(0,o.useState)((()=>(0,l.oE)((0,l.Su)(m),w,v)));(0,i.A)((()=>{D((0,l.oE)((0,l.Su)(m),w,v))}),[v,t]);const[P,B]=(0,o.useState)(null),[R,$]=(0,o.useState)(null),L=(0,o.useRef)(null),{active:z}=(0,a.fF)();(0,a.E5)((0,o.useMemo)((()=>({onDragStart:e=>{let{active:t}=e;const{itemContainerId:n}=t.data.current||{};n===A&&(B(M),$(M))},onDragMove:e=>{let{active:t,over:n}=e;$((e=>{const{isResizer:o,isContainer:r,itemId:a,itemContainerId:i}=t.data.current||{};if(r||i!==A)return e;const{initial:s,translated:c}=t.rect.current;let u=e;const h=(0,l.GN)(u,a);if(!h)return e;const g=n?.id;if(o){if(!g)return e;if(!c||!s)return e;const t=n.rect.width+(0,d.sd)(c.right-s.right),o=n.rect.height+(0,d.sd)(c.bottom-s.bottom);let{width:r,height:a}=(0,d.tr)({gutter:j,maxRows:I,gridTracks:v,rowHeight:b,containerWidth:f},t,o,h);return h.width===r&&h.height===a?e:(h.width=r,h.height=a,u=u.map((e=>e.id===h.id?{...h,width:r,height:a}:e)),u=(0,l.oE)(u,w,v),L.current=h,u)}if(!T)return e;const m=N.current.getBoundingClientRect();let{left:x,top:p}=(0,d.zA)({gutter:j,maxRows:I,gridTracks:v,rowHeight:b,containerWidth:f},c.top-m.top,c.left-m.left,h);return h.top===p&&h.left===x?e:(u=(0,l.Pe)(u,h,x,p,!0,!1,w,v,y),u=(0,l.oE)(u,w,v),L.current=h,u)}))},onDragEnd:e=>{let{active:t,over:n}=e;const{isResizer:o,isContainer:r,itemContainerId:a}=t.data.current;if(r||a!==A)return void $(null);const i=n?.id;if(o)return R&&D(R),$(null),void k(R,L.current);null!==i?(R&&D(R),$(null),k(R,L.current)):$(null)},onDragCancel:()=>{P&&D(P),L.current=null,B(null),$(null)}})),[M,R]));const _=(0,l.Hp)(R||M),O=_*b+(_-1)*j+"px";return(0,u.jsxs)(C,{ref:N,style:{width:f,height:O},...F,children:[(R||M).map(((e,t)=>(0,u.jsx)(c.A,{...e,index:t,containerId:A,Item:p,onRemove:x,draggable:!0,containerWidth:f,rowHeight:b,gridTracks:v,gutter:j,transformed:null!==R?R[t]:null,draggableProps:e,itemProps:S,rootId:n},e.id))),(0,r.createPortal)((0,u.jsx)(a.Hd,{adjustScale:!1,dropAnimation:h,zIndex:9999,children:z&&z.data.current.rootId===n&&z.data.current.isItem?(e=>{const t=R||M;if(!t)return null;const o=t.find((t=>t.id===e.itemId));return o?(0,u.jsx)(c.A,{rootId:n,...o,containerId:e.itemContainerId,Item:p,onRemove:x,draggable:!0,containerWidth:f,rowHeight:b,gridTracks:v,gutter:j,dragOverlay:!0,itemProps:S}):null})(z.data.current):null}),document.body)]})}},88439:(e,t,n)=>{n.r(t),n.d(t,{SettingsContainer:()=>ll,default:()=>cl});var o=n(39175),r=n(7960),a=n(19707),i=n(72060),s=n(38743),l=n(63474),d=n(62718),c=n(37617),u=n(1174),h=n(92318),g=n(99728),m=n(99094),x=(n(98992),n(54520),n(72577),n(81454),n(8872),n(25509),n(65223),n(60321),n(41927),n(11632),n(64377),n(66771),n(12516),n(68931),n(52514),n(35694),n(52774),n(49536),n(21926),n(94483),n(16215),n(96540)),p=n(30569),f=n(15920),b=n(91539),v=n(24609),j=n(19186),y=n(58247),w=n(16922),I=n(81685),C=n(22068),k=n(55048),A=n(63872),S=n(44245),T=n(77234),F=n(64587),N=n(78152);const M=()=>{const e=(0,v.vt)(),t=(0,j.ID)(),n=(0,g.JT)("insights:ReadReport"),{setReport:o}=(0,I.eS)(),[r,a]=(0,C.A)(),[i,s]=(0,k.A)(),[l,d]=(0,A.A)(),{pathname:c}=(0,f.zy)(),u=c.includes(T.x.insights)&&!c.includes(m.p9),[,,,h]=(0,I.W5)(),[,M]=(0,S.m0)({tabId:T.x.insights}),[D]=(0,I.ly)(),{localeDateString:P,localeTimeString:B}=(0,F.$j)(),R=(0,p.yF)((0,x.useCallback)(((n,c,g)=>{let{data:x}=g;const p=(x?.reports||[]).filter((e=>{let{definitionId:t}=e;return N.UY||t!==m.oG.alertInvestigation})),f=r(),b=i(),v=p.filter((e=>{let{status:t}=e;return!m.bs.includes(t)})).map((e=>{let{id:t}=e;return t})),j=f.filter((e=>v.includes(e))),y=j.filter((e=>!b.includes(e))),{COMPLETED:I,FAILED:C}=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(((t,n)=>{const o=e.find((e=>e.id===n));return o?{...t,[o.status]:[...t[o.status]||[],o.id]}:t}),{COMPLETED:[],FAILED:[]})}(y,p);if(y.length&&(I.length&&(l({header:"New report",text:"A new report has been generated!"}),I.length&&o(I[0])),C.length&&(a(f.filter((e=>!C.includes(e)))),d({header:"Error",text:"Failed to generate report."})),s(Array.from(new Set([...b,...y.filter((e=>!C.includes(e)))]))),(I.length||C.length)&&h(),!u&&I.length+C.length>0)){const e=I.length>0?"success":"error";M({color:e})}c((0,w.Tj)({spaceId:e,roomId:t}),(e=>({...e,loaded:!0,reports:p.map((e=>({...e,isUnread:j.includes(e.id)})))})))}),[e,t,o,r,a,i,s,h,l,d,u,M])),$=(0,p.yF)((0,x.useCallback)(((n,o,r)=>{o((0,w.Tj)({spaceId:e,roomId:t}),(e=>({...e,loaded:!0,error:r?.response?.data||"Something went wrong"})))}),[e,t]));return(0,b.A)((()=>({enabled:N.Qi&&n&&!!e&&!!t,force:!0,polling:!!D.length,fetch:()=>(0,y.eF)({spaceId:e,roomId:t,localeDateString:P,localeTimeString:B}),onFail:$,onReceive:R,pollingOptions:{pollingInterval:u?5e3:15e3}})),[e,t,u,n,D.length,P,B])};var D=n(83268),P=n(37479),B=n(60908),R=n(85660),$=n(88255),L=n(50271),z=n(24013),_=n(87083),O=n(49435),V=n(42790),E=n(34843),K=n(52035),U=n(84929);const H={filteredNodesIds:[],filteredNodesCount:0,nodesCount:0},W=(0,U.Iz)((()=>(0,K.eU)(H))),G=()=>{const e=(0,j.ID)();return(0,E.md)(W(e))},q=()=>{const e=(0,j.ID)();return(0,V.rW)("tocSearch",{key:e,extraKey:"nodesView",defaultValue:"",flavour:"val"})},Y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;if(null===e)return 0;if("string"===typeof e){const n=t(e);return n>0?n:0}if(Array.isArray(e)){let n=0;for(const o of e){const e=Y(o,t);e>n&&(n=e)}return n}if("object"===typeof e){let n=0;for(const o in e){const r=Y(e[o],t);r>n&&(n=r)}return n}return 0},J=["version","labels","hw","os","state","nodeStatus","health","replicationFactor","replication","technology"],Q=function(e,t){let{shouldHide:n=()=>!1,cacheKey:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=(0,z.Gt)(e),a=(()=>{const e=q();return"string"!==typeof e?"":e.trim().toLowerCase()})(),[i,s,l]=(0,x.useMemo)((()=>{let e=0,t=0;const o=r.map((o=>{let r=0,i=0,s=0;if(a){const{name:e,...t}=o;i=o.name?(0,O.pe)(e,a):0,s=Y(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return J.reduce(((t,n)=>(void 0!==e[n]&&null!==e[n]&&(t[n]=e[n]),t)),{})}(t),(e=>(0,O.pe)(String(e),a)));r=("Live"===o.nodeStatus?100:"Stale"===o.nodeStatus?50:0)+10*i+s}const l=!!a&&!(i>.3||s>.3),d=n(o);return l||d||(e+=1),d||(t+=1),{id:o.id,searchScore:r,included:!l&&!d}})).filter((e=>e.included));return[o,t,e]}),[a,r,o]),d=(()=>{const e=(0,j.ID)();return(0,E.Xr)(W(e))})(),c=(0,x.useMemo)((()=>i.map((e=>{let{id:t}=e;return t}))),[i]),u=(0,x.useMemo)((()=>i.reduce(((e,t)=>{let{id:n,searchScore:o}=t;return o>0&&(e[n]=o),e}),{})),[i]);return(0,x.useEffect)((()=>{d({filteredNodeIds:c,filteredNodesCount:l,nodesCount:s})}),[c,s,l,t]),[c,u,s]};var X=n(87733),Z=n(22998),ee=n(67782),te=n(65258),ne=n(73700),oe=n(41514),re=n(74848);const ae=()=>{const[e,t]=(()=>{const e=(0,j.ID)();return(0,V.N9)("tocSearch",{key:e,extraKey:"nodesView",defaultValue:"",flavour:"val"})})(),n=(0,x.useCallback)((0,ne.s)(300,(e=>{t(e.target.value),(0,oe.H)("toc-search","search-automatic-trigger","nodes-view",e.target.value)})),[]),[o,r,,,{resetValue:a}]=(0,te.useInputValue)({value:e,onChange:n}),i=(0,x.useCallback)((()=>{t(""),a(),(0,oe.H)("toc-search","clear-search-button","nodes-view")}),[]);return(0,re.jsx)(te.TextInput,{value:o,onChange:r,size:"small",iconRight:o&&(0,re.jsx)(te.Icon,{name:"x",color:"textLite",cursor:"pointer",size:"small",onClick:i,"data-testid":"filterNodesInput-clearButton"}),placeholder:"Search nodes",name:"Search nodes","data-testid":"filterNodesInput",containerStyles:{width:"100%"}})},ie=(0,ne.s)(300,((e,t)=>(0,oe.H)("toc-search","search-results","nodes-view",e,`${t} -- nodes`))),se=()=>{const e=q(),{filteredNodesCount:t,nodesCount:n}=G();return(0,x.useEffect)((()=>{e&&ie(e,t)}),[e,t]),(0,re.jsx)(re.Fragment,{children:(0,re.jsxs)(te.TextMicro,{alignSelf:"end",color:"textLite",margin:[1,0,0],"data-testid":"numberOfNodesIndication",children:["Showing"," ",(0,re.jsx)(te.TextMicro,{strong:!0,color:"textDescription","data-testid":"numberOfNodesIndication-filteredNodesCount",children:t})," ","of total"," ",(0,re.jsx)(te.TextMicro,{strong:!0,color:"textDescription","data-testid":"numberOfNodesIndication-nodesCount",children:n})," ","nodes"]})})},le=()=>{const{filteredNodesCount:e}=G();return e?null:(0,re.jsxs)(te.Flex,{width:"100%",gap:1,margin:[4,0,0],padding:[2],alignItems:"center","data-testid":"noResultsWereFound",children:[(0,re.jsx)(te.Icon,{name:"information",color:"textDescription"}),(0,re.jsx)(te.TextMicro,{strong:!0,color:"textDescription",children:"No results were found"})]})},de=()=>(0,re.jsxs)(te.Flex,{column:!0,alignItems:"center",children:[(0,re.jsx)(ae,{}),(0,re.jsx)(se,{}),(0,re.jsx)(le,{})]});var ce=n(79748);const ue=()=>(0,re.jsxs)(te.Flex,{padding:[6],round:1,width:"600px",background:"modalInfoBackground",children:[(0,re.jsx)(te.Box,{margin:[0,4,0,0],children:(0,re.jsx)(te.Box,{as:te.Icon,width:10,height:10,name:"nodes_update"})}),(0,re.jsxs)(te.Flex,{column:!0,gap:2,children:[(0,re.jsx)(te.Text,{strong:!0,children:"Couldn't find the node you were looking for? "}),(0,re.jsxs)(te.Text,{color:"textDescription",children:["Netdata can be used to monitor all kinds of infrastructure, from tiny stand-alone IoT devices to complex hybrid setups combining on-premise and cloud infrastructure, mixing bare-metal servers, virtual machines and containers. Check our"," ",(0,re.jsx)(ce.A,{href:"https://learn.netdata.cloud/docs/deployment-guides",target:"_blank","data-ga":"node-area::click-link-collectors::nodes-view",children:"deployments guides"})," ","and start monitor your infrastructure."]})]})]}),he=()=>(0,re.jsxs)(te.Flex,{column:!0,flex:!0,justifyContent:"center",alignItems:"center",alignSelf:"center",children:[(0,re.jsxs)(te.Flex,{column:!0,justifyContent:"center",alignItems:"center",width:"300px",margin:[0,0,6],children:[(0,re.jsx)(te.H3,{margin:[0,0,4],children:"No nodes to display"}),(0,re.jsx)(te.Text,{color:"textDescription",textAlign:"center",children:"Double-check your search or filters and dates and try again with different conditions."})]}),(0,re.jsx)(ue,{})]});var ge=n(6304),me=n(63589),xe=n(69706),pe=n(32788),fe=n(29263),be=n(47410),ve=n(32052),je=n(21348),ye=n(25291),we=n(53749);const Ie=()=>{},Ce=e=>{let{roomId:t,id:n,onRemove:o=Ie}=e;const r=(0,j.wz)(t,"name"),a=(0,je.e6)(t,n,"title"),i=(0,je.gV)(t),[s,,l,d]=(0,ge.A)();return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(te.Button,{danger:!0,flavour:"hollow",onClick:l,label:"Delete metric","data-testid":"remove-metric"}),s&&(0,re.jsx)(te.ConfirmationDialog,{"data-ga":"remove-metric-dialog","data-testid":"removeMetricDialog",handleConfirm:async()=>{await i(n),o()},handleDecline:d,message:(0,re.jsxs)(re.Fragment,{children:["You are about to remove ",(0,re.jsx)("strong",{children:a})," metric.",(0,re.jsx)("br",{}),"Are you sure you want to continue?"]}),title:`Remove metric from ${r}`})]})},ke=e=>{let{link:t,children:n}=e;return(0,re.jsxs)(te.Flex,{as:"a",target:"_blank",href:t,gap:1,alignItems:"end",children:[(0,re.jsx)(te.TextNano,{textDecoration:"undeline",children:n}),(0,re.jsx)(te.Icon,{color:"text",name:"question",width:"16px",height:"16px"})]})},Ae=e=>{let{title:t,help:n,link:o,disclaimer:r,children:a,...i}=e;return(0,re.jsxs)(te.Flex,{gap:1,column:!0,...i,children:[(0,re.jsxs)(te.Flex,{justifyContent:"between",alignItems:"baseline",children:[(0,re.jsx)(te.Text,{as:"label",margin:[0],children:t}),n&&(0,re.jsx)(ke,{link:o,children:n})]}),a,r&&(0,re.jsx)(te.TextSmall,{children:r})]})};var Se=n(91130),Te=n(16866);const Fe={value:"all",label:"All"},Ne=e=>{let{dimensions:t,units:n}=e;return{dimensions:t?[Fe,...t.map((e=>{let{id:t,name:n}=e;return{value:t,label:n}}))]:[Fe],units:n}},Me=e=>{let{isNew:t}=e;return(0,re.jsxs)(te.Flex,{as:"span",gap:1,children:["Manage room",(0,re.jsx)(te.TextBig,{color:"textLite",children:"/"}),(0,re.jsxs)(te.TextBig,{color:"textLite",children:[t?"Add":"Edit"," Metric"]})]})},De=e=>{let{spaceId:t,roomId:n,id:o,onClose:r,...a}=e;const i="new"===o,s=(0,je.uB)(n,o),l=(0,je.XH)(n,{shouldPersist:!1}),d=(0,je.e6)(n,o),c=(0,x.useRef)(d),{title:u,context:h,dimensions:g=[]}=d,m=()=>{l(o,c.current),r()};(0,x.useEffect)((()=>{i&&s()}),[]);const p=(0,_.w7)({extraKey:"nodesView",merge:!1,scoped:!0}),f=(0,ye.A)(n,p,{spaceId:t});if(f)throw f;const b=(0,we.OL)(n),v=(0,x.useMemo)((()=>b.map((e=>({value:e,label:e})))),[b]),j=(0,we._0)(n),y=(0,x.useMemo)((()=>h&&{value:h,label:h}),[h]),[{dimensions:w,units:I},C]=(0,ve.A)((()=>({enabled:!!h,fetch:()=>((e,t,n)=>Se.A.get(`${Te.P8}/spaces/${e}/rooms/${t}/contexts/${encodeURIComponent(n)}`,{transform:Ne}))(t,n,h),initialValue:{dimensions:[],units:""}})),[t,n,h]),k=(0,x.useCallback)((e=>{let{value:t}=e;l(o,"context",t),l(o,"dimensions",[]),l(o,"title",t)}),[o]),A=(0,x.useMemo)((()=>w?1===w.length||g.length===w.length-1||0===g.length?[Fe]:g.map((e=>{let{id:t,name:n}=e;return{value:t,label:n}})):[Fe]),[g,w]),S=(0,x.useCallback)((e=>{const t=e.filter((e=>{let{value:t}=e;return t!==Fe.value})),n=(0===e.length||t.length!==e.length&&0!==g.length||t.length===w.length-1?[]:t).map((e=>{let{value:t,label:n}=e;return{id:t,name:n}}));l(o,"dimensions",n)}),[o,g,w]),T=(0,je.tQ)(n),F=(0,x.useCallback)((()=>T({...d,id:o,unit:I}).then(r)),[d]),N=(0,x.useCallback)((e=>{let{target:{value:t}}=e;t.length<=30&&l(o,"title",t)}),[o]),M=!u||!h||C||!j;return(0,re.jsxs)(pe.GO,{onClose:m,...a,children:[(0,re.jsx)(fe.z,{onClose:m,title:(0,re.jsx)(Me,{isNew:i}),children:(0,re.jsx)(te.Button,{label:"Save",onClick:F,disabled:M})}),(0,re.jsx)(be.U,{children:i?"Add a new metric (column)":"Edit metric"}),(0,re.jsx)(pe.Yv,{children:(0,re.jsxs)(te.Flex,{gap:6,column:!0,children:[(0,re.jsx)(Ae,{title:"Context",help:"What is a context?",link:"https://learn.netdata.cloud/docs/dashboards-and-charts/netdata-charts#contexts","data-testid":"manageMetrics-context",children:(0,re.jsx)(te.Select,{options:v,value:y,onChange:k,isLoading:!j,"data-testid":"manageMetrics-contextSelect"})}),(0,re.jsx)(Ae,{title:"Metric Title","data-testid":"manageMetrics-title",children:(0,re.jsx)(te.TextInput,{name:"title",placeholder:"Type name",value:u,onChange:N})}),(0,re.jsx)(Ae,{title:"Dimensions",help:"What is a dimension?",link:"https://learn.netdata.cloud/docs/dashboards-and-charts/netdata-charts#dimensions",disclaimer:A[0]===Fe&&"The returned value is the sum of all selected dimensions.","data-testid":"manageMetrics-dimensions",children:(0,re.jsx)(te.Select,{isMulti:!0,options:w,value:A,onChange:S,isLoading:C,isDisabled:!y,"data-testid":"manageMetrics-dimensionSelect"})}),!i&&(0,re.jsx)(te.Flex,{justifyContent:"end",children:(0,re.jsx)(Ce,{roomId:n,id:o,onRemove:r})})]})})]})},Pe=e=>{let{isOpen:t,onClose:n,onEdit:o,roomId:r,targetRef:a}=e;const[i,s]=(0,je.tY)(r);if(!a.current||!t)return null;const l=e=>{o(e),n()};return(0,re.jsxs)(te.Drop,{align:{top:"bottom",right:"right"},animation:!0,background:"dropdown",column:!0,margin:[.5,0,0],overflow:{vertical:"auto"},padding:[3],round:!0,width:70,close:n,"data-testid":"metricsMenu",onClickOutside:n,onEsc:n,target:a.current,children:[i.map((e=>(0,re.jsxs)(te.Flex,{"data-testid":`metricsMenu-metric-${e.title}`,justifyContent:"between",alignItems:"center",padding:[1,0],children:[(0,re.jsx)(te.Checkbox,{checked:!e.hidden,"data-testid":"metricsMenu-metricCheckbox",label:e.title,onChange:()=>s(e.id,"hidden",!e.hidden)}),(0,re.jsx)(te.IconButton,{"data-testid":"metricsMenu-editMetric",flavour:"borderless",icon:"pencilSolid",padding:[0],onClick:()=>l(e.id),width:"10px",height:"10px"})]},e.id))),(0,re.jsx)(te.Button,{"data-testid":"metricsMenu-addMetricButton",label:"Add new metric",icon:"plus",onClick:()=>l("new"),small:!0,alignSelf:"end"})]})},Be=e=>{let{spaceId:t,roomId:n}=e;const[o,,r,a]=(0,ge.A)(),[i,s]=(0,x.useState)(null),l=(0,x.useRef)();return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(te.Button,{"data-ga":"metric-setting::click-metric-setting::hm-nodes","data-testid":"metricSettings-button",flavour:"hollow",icon:"gear",neutral:!0,onClick:r,ref:l,label:"Metrics",small:!0}),(0,re.jsx)(Pe,{isOpen:o,onClose:a,onEdit:s,roomId:n,targetRef:l}),i&&(0,re.jsx)(De,{"data-testid":"metricsManagement",spaceId:t,roomId:n,id:i,onClose:()=>s(null)})]})};var Re=n(3203);const $e=()=>(0,oe.H)("grouping","click-grouping","hm-nodes"),Le=(0,Re.A)(me.A),ze=[{icon:"node",label:"Node status",value:"nodeStatus","data-ga":"grouping::click-grouping-node-status::hm-nodes"},{icon:"alarm_bell",label:"Alert status",value:"alertStatus","data-ga":"grouping::click-grouping-status::hm-nodes"}],_e=()=>{const e=(0,v.vt)(),t=(0,j.ID)(),[n,,o,r]=(0,ge.A)(),[a,i]=(0,L.TS)(t,"groupMode"),s=(0,x.useMemo)((()=>ze.find((e=>e.value===a))||ze[0]),[a]),l=(0,x.useCallback)((e=>{let{value:t}=e;return i(t)}),[i]);return(0,re.jsxs)(te.Flex,{alignItems:"center","data-testid":"agentsHead-actions",flexWrap:!1,gap:3,children:[(0,re.jsx)(te.Select,{label:"Group by",onChange:l,onMenuOpen:$e,options:ze,styles:{size:"tiny"},value:s}),(0,re.jsx)(Be,{roomId:t,spaceId:e}),n&&(0,re.jsx)(xe.A,{onClose:r}),(0,re.jsx)(Le,{"data-ga":"add-nodes::click-add-nodes::hm-nodes","data-testid":"agentsHead-addNode",icon:"nodes_hollow",label:"Add Nodes",onClick:o,small:!0})]})},Oe=()=>(0,re.jsx)(te.Flex,{width:"100%",justifyContent:"end",background:"mainBackground",padding:[2],children:(0,re.jsx)(_e,{})});n(3949);var Ve=n(85163),Ee=n(84535);const Ke="clear",Ue="warning",He="critical",We="unreachable";var Ge=n(49181);const qe={alertStatus:{[He]:1,[Ue]:2,[Ke]:3,[We]:4},nodeStatus:{Live:1,Stale:2,Offline:3}},Ye={nodeStatus:e=>(0,Ge.GM)(e.state),alertStatus:e=>(0,Ge.vt)(e),vendor:e=>e.labels?.vendor||"Unknown",type:e=>e.labels?.type||"Unknown",location:e=>e.labels?.sysLocation||e.labels?.location||"Unknown","":()=>"Nodes"};var Je=n(56876),Qe=n(30863),Xe=n(69001),Ze=n(95836),et=n(27496);const tt=e=>{let{id:t,...n}=e;return(0,re.jsxs)(Xe.h,{id:t,...n,children:[(0,re.jsx)(Ze.$,{id:t}),(0,re.jsx)(et.n,{id:t})]})},nt=(0,x.memo)(tt);var ot=n(16373),rt=n(90901),at=n(82103),it=n(55759),st=n(77186),lt=n(59400);const dt=e=>{let{connectivity:t,id:n,name:o,...r}=e;const a=(0,g.JT)("node:Delete"),i=!(0,j.XA)().untouchable,[s,,l,d]=(0,ge.A)(),[c,,u,h]=(0,ge.A)();return(0,re.jsxs)(lt.SS,{alignSelf:"end",gap:1,"data-testid":"node-actions",...r,children:[i&&(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(at.A,{badge:"actionRemove","data-testid":"remove-node-action",children:(0,re.jsx)(lt.d0,{"data-ga":"nodes-table-row::click-remove-node::nodes-view",onClick:u})}),c&&(0,re.jsx)(st.Ay,{ids:[n],name:o,onClose:h})]}),a&&"Offline"===t&&(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(at.A,{badge:"actionObsolete","data-testid":"obsolete-node-action",children:(0,re.jsx)(lt.AS,{"data-ga":"nodes-table-row::click-obsolete-node::nodes-view",onClick:l})}),s&&(0,re.jsx)(it.Ay,{ids:[n],name:o,onClose:d})]})]})};var ct=n(97336);const ut=e=>{let{instanceType:t,name:n,providerType:o,...r}=e;return(0,re.jsx)(at.A,{badge:"cloudInfo","data-testid":"node-cloud-info",nodeName:n,...r,children:(0,re.jsxs)(te.Flex,{alignItems:"center",gap:1,children:[(0,re.jsx)(te.Icon,{color:"textDescription","data-testid":"node-cloud-info-icon",name:"ipNetworking",width:"18px",height:"18px"}),(0,re.jsxs)(te.TextSmall,{color:"textDescription","data-testid":"node-cloud-info-text",children:[(0,Ge.ws)(o)," \u2022 ",(0,Ge.ws)(t)]})]})})},ht=e=>{let{connectivity:t,name:n,...o}=e;return(0,re.jsx)(at.A,{badge:"connectivity",connectivityState:t,"data-testid":"node-connectivity",nodeName:n,...o,children:(0,re.jsx)(te.Icon,{name:`connectivityStatus${t}`,width:"18px",height:"18px"})})},gt=e=>{let{onClick:t,...n}=e;return(0,re.jsx)(at.A,{badge:"info","data-testid":"node-info-cta",...n,children:(0,re.jsx)(te.Icon,{color:"textDescription",cursor:"pointer",height:"18px",width:"18px",name:"information",onClick:t})})},mt=e=>{let{name:t,...n}=e;return(0,re.jsx)(at.A,{badge:"k8s","data-testid":"node-kubernetes",nodeName:t,...n,children:(0,re.jsxs)(te.Flex,{alignItems:"center",gap:1,children:[(0,re.jsx)(te.Icon,{color:"textDescription","data-testid":"node-kubernetes-icon",name:"serviceKubernetes",width:"18px",height:"18px"}),(0,re.jsx)(te.TextSmall,{color:"textDescription","data-testid":"node-kubernetes-text",children:"k8s"})]})})},xt=e=>{let{kernelName:t,kernelVersion:n,name:o,...r}=e;return(0,re.jsx)(at.A,{badge:"kernel","data-testid":"node-kernel",nodeName:o,...r,children:(0,re.jsx)(te.TextSmall,{color:"textDescription",children:(0,Ge.Ud)(t,n)})})};var pt=n(52253),ft=n(41708),bt=n(92834);const vt=e=>{let{architecture:t,cpuFrequency:n,cpus:o,diskSpace:r,memory:a,name:i,os:s,osName:l,timezone:d,...c}=e;return(0,re.jsx)(at.A,{badge:"systemInfo","data-testid":"node-system-info",nodeName:i,...c,children:(0,re.jsxs)(te.Flex,{alignItems:"center",gap:1,children:[(0,re.jsx)(te.Icon,{color:"textDescription","data-testid":"node-system-info-icon",name:Ee.u[l]?.iconName||Ee.U[s]?.iconName||"os",width:"16px",height:"16px"}),(0,re.jsxs)(te.TextSmall,{color:"textDescription","data-testid":"node-system-info-text",children:[(0,Ge.ws)(l)," \u2022 ",(0,Ge.O)(n)," \u2022"," ",(0,Ge.ws)(o,1===o?"Core":"Cores")," \u2022"," ",(0,Ge.ws)(t)," \u2022"," ",(0,Ge.ws)((0,Ge.RI)(a),"RAM")," \u2022"," ",(0,Ge.ws)((0,Ge.RI)(r),"HD"),!!d&&(0,re.jsxs)(re.Fragment,{children:[" ","\u2022 ",(0,re.jsx)(bt.A,{timezone:d})]})]})]})})},jt=e=>{let{container:t,name:n,virtualization:o,...r}=e;const a=(0,Ge.Pg)(t,o);return(0,re.jsx)(at.A,{badge:"type","data-testid":"node-type",nodeName:n,nodeType:a.label,...r,children:(0,re.jsxs)(te.Flex,{alignItems:"center",gap:1,children:[(0,re.jsx)(te.Icon,{color:"textDescription","data-testid":"node-type-icon",name:a.icon,height:a.iconSize,width:a.iconSize}),(0,re.jsx)(te.TextSmall,{color:"textDescription","data-testid":"node-type-text",children:a.label})]})})};var yt=n(71236);const wt=e=>{let{health:t={}}=e;const{silencingState:n}=t.alerts||{},{state:o}=n||{};return"NONE"!=o?(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(lt.K,{"data-testid":"nodeRow-separator"}),(0,re.jsx)(te.Flex,{children:(0,re.jsx)(yt.A,{flavour:"node",silencing:n})})]}):null};var It=n(74891);const Ct=(0,It.A)((0,Re.A)(te.Button)),kt=e=>{let{id:t}=e;const n=(0,f.Zp)(),o=(0,v.bq)(),r=(0,x.useCallback)((()=>{const e={nodeId:t};n(`/spaces/${o}/settings/notifications#notificationsActiveTab=1&silencingRulePrefill=${JSON.stringify(e)}`)}),[]);return(0,re.jsx)(Ct,{feature:"SilencingNode",payload:{nodeId:""},tooltip:"Create a new silencing rule for this node",flavour:"hollow",icon:"alarm_off",iconWidth:"12px",tiny:!0,onClick:r})};var At=n(36504),St=n(92942),Tt=n(19371);const Ft=[{columnId:"address",columnFlavour:"metadata",accessorKey:"labels._net_default_iface_ip",header:"Address",headerString:"Address",size:100,minSize:40,maxSize:600,align:"left",category:"Labels"}],Nt={servers:[...Ft,{columnId:"uptime",context:"system.uptime",dimensions:"uptime",columnFlavour:"value",hideUnits:!0,header:"Uptime",headerString:"Uptime",size:80,minSize:60,maxSize:400,align:"center",labelProps:{textAlign:"right"}},{columnId:"cpuUsage",context:"system.cpu",dimensions:null,columnFlavour:"progressBar",header:"CPU",headerString:"CPU Usage",size:120,minSize:60,maxSize:400,align:"center"},{columnId:"memoryUsage",context:"system.ram",dimensions:null,columnFlavour:"progressBar",calculateTotal:!0,totalDimensions:["used","cached","buffers","free"],valueDimensions:["used","cached","buffers"],header:"Memory",headerString:"Memory Usage",size:120,minSize:60,maxSize:400,align:"center",fractionDigits:1},{columnId:"load",context:"system.load",dimensions:"load15",columnFlavour:"value",header:"Load",headerString:"Load Average",size:100,minSize:60,maxSize:400,align:"center",hideUnits:!0,labelProps:{textAlign:"right"}},{columnId:"diskRead",context:"system.io",dimensions:"reads",columnFlavour:"value",header:"Disk Read",headerString:"Disk Read",size:120,minSize:60,maxSize:400,align:"center",labelProps:{textAlign:"right"}},{columnId:"diskWrite",context:"system.io",dimensions:"writes",columnFlavour:"value",header:"Disk Write",headerString:"Disk Write",size:120,minSize:60,maxSize:400,align:"center",labelProps:{textAlign:"right"}},{columnId:"netIn",context:"system.net",dimensions:"received",columnFlavour:"value",header:"Net In",headerString:"Network In",size:120,minSize:60,maxSize:400,align:"center",labelProps:{textAlign:"right"}},{columnId:"netOut",context:"system.net",dimensions:"sent",columnFlavour:"value",header:"Net Out",headerString:"Network Out",size:120,minSize:60,maxSize:400,align:"center",labelProps:{textAlign:"right"}}],snmp:[...Ft,{columnId:"description",columnFlavour:"metadata",accessorKey:"labels.description",fallbackKeys:["labels.sysDescr"],header:"Description",headerString:"Description",size:150,minSize:40,maxSize:600,align:"left",hidden:!0,category:"Labels"},{columnId:"location",columnFlavour:"metadata",accessorKey:"labels.location",fallbackKeys:["labels.sysLocation"],header:"Location",headerString:"Location",size:120,minSize:40,maxSize:600,align:"left",hidden:!0,category:"Labels"},{columnId:"contact",columnFlavour:"metadata",accessorKey:"labels.contact",fallbackKeys:["labels.sysContact"],header:"Contact",headerString:"Contact",size:150,minSize:40,maxSize:600,align:"left",hidden:!0,category:"Labels"},{columnId:"vendor",columnFlavour:"metadata",accessorKey:"labels.vendor",header:"Vendor",headerString:"Vendor",size:120,minSize:40,maxSize:600,align:"left",category:"Labels"},{columnId:"model",columnFlavour:"metadata",accessorKey:"labels.model",header:"Model",headerString:"Model",size:120,minSize:40,maxSize:600,align:"left",category:"Labels"},{columnId:"type",columnFlavour:"metadata",accessorKey:"labels.type",header:"Type",headerString:"Type",size:80,minSize:40,maxSize:600,align:"left",category:"Labels"},{columnId:"uptime",context:"snmp.device_prof_systemUptime",dimensions:"systemUptime",columnFlavour:"value",hideUnits:!0,header:"Uptime",headerString:"System Uptime",size:80,minSize:40,maxSize:600,align:"center",labelProps:{textAlign:"right"},category:"Metrics"},{columnId:"cpuUsage",context:"snmp.device_prof_cpu_usage",dimensions:"cpu.usage",columnFlavour:"progressBar",header:"CPU",headerString:"CPU Usage",size:120,minSize:40,maxSize:600,align:"center",category:"Metrics"},{columnId:"portsUp",context:"snmp.device_prof_ifTotalOperStatus",dimensions:"up",columnFlavour:"value",header:"Ports Up",headerString:"Ports Up",size:80,minSize:40,maxSize:600,align:"center",labelProps:{textAlign:"right"},fractionDigits:0,category:"Metrics"},{columnId:"portsDown",context:"snmp.device_prof_ifTotalOperStatus",dimensions:["down","lowerLayerDown"],columnFlavour:"value",header:"Ports Down",headerString:"Ports Down",size:80,minSize:40,maxSize:600,align:"center",labelProps:{textAlign:"right"},fractionDigits:0,category:"Metrics"},{columnId:"trafficIn",context:"snmp.device_prof_ifTotalTrafficIn",dimensions:"ifTotalTrafficIn",columnFlavour:"value",header:"Traffic In",headerString:"Traffic In",size:100,minSize:40,maxSize:600,align:"center",labelProps:{textAlign:"right"},fractionDigits:1,category:"Metrics"},{columnId:"trafficOut",context:"snmp.device_prof_ifTotalTrafficOut",dimensions:"ifTotalTrafficOut",columnFlavour:"value",header:"Traffic Out",headerString:"Traffic Out",size:100,minSize:40,maxSize:600,align:"center",labelProps:{textAlign:"right"},fractionDigits:1,category:"Metrics"}]};var Mt=n(49163),Dt=n(63928);const Pt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"nodesView",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"servers";const n=(0,Mt._)({params:{type:["favourites"],path:[`/${e}/${t}`]}}),o=(0,x.useMemo)((()=>n.filter((e=>{let{value:t}=e;return t?.nodeId})).sort(((e,t)=>(e.value.sortOrder||0)-(t.value.sortOrder||0))).map((e=>{let{value:t}=e;return t.nodeId}))),[n]),r=(0,x.useMemo)((()=>n.reduce(((e,t)=>({...e,...t.value?.nodeId?{[t.value.nodeId]:t}:{}})),{})),[n]),a=(0,Dt.xS)(),i=(0,x.useCallback)((async e=>{const t=e.map(((e,t)=>{const n=r[e];if(n)return a({...n,value:{...n.value,sortOrder:t}})}));await Promise.all(t.filter(Boolean))}),[r,a]);return{favoriteNodeIds:o,settingsByNodeId:r,handleOrderChange:i}},Bt=(e,t)=>e&&e.getRoot().getChildren().find((e=>e.match({id:`nodes-${t}`})));var Rt=n(28657);const $t=e=>{let{id:t,roomId:n,nodeId:o,context:r,dimensions:a}=e;const i=(0,Tt.eg)(),s=(0,x.useMemo)((()=>{const e=Bt(i,n),s=[t,o,r].join("-");if(!e)return null;let l=e.getNode({id:s});return l?(l.updateAttribute("selectedDimensions",a.map((e=>e.name))),l):(l=i.makeChart({attributes:{id:s,nodesScope:[o],contextScope:[r],pixelsPerPoint:20,selectedDimensions:a.map((e=>e.name))}}),e.appendChild(l),l)}),[r,t,o,n,i]);return s?(0,re.jsx)(Rt.A,{chart:s,hasHeader:!1,hasFooter:!1,hasFilters:!1,height:100}):null},Lt=(0,x.memo)($t);var zt=n(74518);const _t=e=>{let{id:t,context:n,nodeId:o,isLive:r,hidden:a,title:i,dimensions:s}=e;const l=(0,j.ID)();return a||!r?null:(0,re.jsxs)(te.Flex,{column:!0,"data-testid":`metrics-chart-${n}`,flex:"grow",basis:"174px",children:[(0,re.jsx)(zt.A,{text:i||n,TextComponent:te.TextSmall,color:"textDescription",margin:[1,0,1,2],as:"div"}),(0,re.jsx)(Lt,{id:t,context:n,nodeId:o,roomId:l,dimensions:s})]})};var Ot=n(7101),Vt=n(3319);const Et=e=>{let{node:t,...n}=e;const[,o]=(0,Ot.PJ)(),{sendButtonClickedLog:r}=(0,Vt.A)(),a=t.capabilities?.dyncfg?.enabled,i=t.isLive&&a,s=i?"Configure this node":t.isLive?"Node cannot be configured":"Cannot configure a non live node",l=(0,x.useCallback)((()=>{i&&(o(!0,{nodeId:t.id}),r({feature:"DyncfgNode",description:"Configure node",nodeId:t?.id,nodeName:t?.name}))}),[i,t,o,r]),d=(0,x.useMemo)((()=>({name:"gear",size:"small",color:i?"text":"disabled",cursor:i?"pointer":"auto",onClick:l})),[i,l]);return(0,re.jsx)(at.A,{content:s,children:(0,re.jsx)(te.Flex,{...n,children:(0,re.jsx)(te.Icon,{...d})})})};var Kt=n(51262);const Ut=(Ht=Et,e=>(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(lt.K,{"data-testid":"nodeRow-separator"}),(0,re.jsx)(Ht,{...e})]}));var Ht;const Wt=e=>{let{id:t,name:n,hw:o,os:r,ni:a,capabilities:i,container:s,updateSeverity:l,bugs:d,labels:c,isLive:u,state:h,version:g,extraKey:m,health:p,menuId:f,eligibility:b}=e;const y=(0,v.dg)(),w=(0,j.ID)(),I=i.funcs?.enabled,C=i.ml?.enabled,k=(0,Ge.GM)(h),{isNodeRestricted:A}=(0,Kt.A)(),{restricted:S}=A(t),{_cloud_instance_type:T,_cloud_provider_type:F,_timezone:N}=c||{},M="true"===c?._is_k8s_node,D=!(0,Ge.Po)(T)||!(0,Ge.Po)(F),P=(0,V.Fw)("sidebarTab",{flavour:"val",extraKey:m}),B=(0,V.Fw)("sidebarOpen",{flavour:"bool"}),R=(0,V.Fw)("sidebarNodeId",{flavour:"val",extraKey:m}),$=(0,x.useCallback)((e=>{B(!0),P(e),R(t)}),[t,R,B,P]),L=(0,x.useCallback)((()=>$("alerts")),[$]),z=(0,x.useCallback)((()=>$("info")),[$]),_=(0,ot.Id)(),O=(0,rt.I)(),E=(0,je.Vw)(w);return(0,re.jsxs)(te.Flex,{"data-testid":`nodeRow-${n}`,"data-menuid":f||t,padding:[1],column:!0,gap:1,round:!0,children:[(0,re.jsxs)(te.Flex,{alignItems:"center","data-testid":"nodeRow-basic-info",gap:2,height:{min:6},children:[(0,re.jsx)(ht,{connectivity:k,"data-testid":`nodeRow-connectivity-${k.toLowerCase()}`,name:n}),(0,re.jsx)(lt.K,{"data-testid":"nodeRow-separator"}),(0,re.jsx)(ft.A,{"data-testid":"nodeRow-name",id:t,name:n,isLive:u,state:h,eligibility:b}),(0,re.jsx)(lt.K,{"data-testid":"nodeRow-separator"}),(0,re.jsx)(gt,{onClick:z,"data-testid":"nodeRow-more-info-cta"}),(0,re.jsx)(lt.K,{"data-testid":"nodeRow-separator"}),(0,re.jsx)(ct.A,{id:t,isLive:u,"data-testid":"nodeRow-alerts",name:n,onClick:L}),(0,re.jsx)(lt.K,{"data-testid":"nodeRow-separator"}),(0,re.jsx)(pt.A,{badge:"ml","data-testid":"nodeRow-machine-learning-status",enabled:C,name:n,onClick:()=>O(t),children:(0,re.jsx)(te.Icon,{name:"anomaliesLens",size:"small",color:"text"})}),(0,re.jsx)(lt.K,{"data-testid":"nodeRow-separator"}),(0,re.jsx)(pt.A,{badge:"fn","data-testid":"nodeRow-fn-status",enabled:I,name:n,onClick:()=>_(t),children:(0,re.jsx)(te.Icon,{name:"functions",size:"small",color:"text"})}),l&&(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(lt.K,{"data-testid":"nodeRow-separator"}),(0,re.jsx)(At.A,{name:n,os:r.id,container:s,warningLevel:l,labels:c,version:g,text:l,"data-testid":"nodeRow-needs-update"})]}),!!(d||[]).length&&(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(lt.K,{"data-testid":"nodeRow-separator"}),(0,re.jsx)(St.A,{bugs:d,"data-testid":"nodeRow-bugs"})]}),(0,re.jsx)(Ut,{node:{id:t,name:n,isLive:u,ni:a,capabilities:i}}),(0,re.jsx)(dt,{"data-testid":"nodeRow-node-actions",id:t,name:n,connectivity:k}),y?null:(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(wt,{health:p}),(0,re.jsx)(kt,{id:t})]})]}),(0,re.jsxs)(te.Flex,{alignItems:"center","data-testid":"nodeRow-detailed-info",gap:2,children:[(0,re.jsx)(vt,{architecture:o.architecture,cpuFrequency:o.cpuFrequency,cpus:o.cpus,"data-testid":"nodeRow-system-info",diskSpace:o.diskSpace,memory:o.memory,name:n,osName:r.nm,os:r.id,timezone:N}),(0,re.jsx)(lt.K,{"data-testid":"nodeRow-separator"}),!!r?.kernel&&(0,re.jsx)(xt,{"data-testid":"nodeRow-kernel",kernelName:r.kernel.nm,kernelVersion:r.kernel.v,name:n}),(0,re.jsx)(lt.K,{"data-testid":"nodeRow-separator"}),M&&(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(mt,{"data-testid":"nodeRow-kubernetes",name:n}),(0,re.jsx)(lt.K,{"data-testid":"nodeRow-separator"})]}),(0,re.jsx)(jt,{container:o.container,"data-testid":"nodeRow-type",name:n,virtualization:o.virtualization}),D&&(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(lt.K,{"data-testid":"nodeRow-separator"}),(0,re.jsx)(ut,{"data-testid":"nodeRow-cloud-info",instanceType:T,name:n,providerType:F})]})]}),!S&&!!E?.length&&(0,re.jsx)(te.Flex,{"data-testid":"nodeRow-charts",gap:1,children:E.map((e=>(0,re.jsx)(_t,{...e,nodeId:t,isLive:u},e.id)))})]})},Gt=e=>{switch(e.level){case 0:return nt;case 1:return Wt;default:return null}},qt=e=>{let{onChartNameChange:t,initialChartName:n,dashboardOptions:o,linkToGo:r,contextToGo:a,...i}=e;const{setActiveMenuId:s}=(0,Je.A)({onChartNameChange:t,initialChartName:n,linkToGo:r,contextToGo:a});return(0,re.jsx)(Z.H,{...i,children:(0,re.jsx)(Qe.A,{flavour:"nodes",onActiveMenuId:s,getComponent:Gt,dashboardOptions:o,initialChartName:n,checkVisibility:()=>!0})})};var Yt=n(69457),Jt=n(20871),Qt=n(48106),Xt=n(9962);const Zt={value:e=>({id:e.columnId,header:(0,re.jsx)(te.TextMicro,{strong:!0,children:e.header}),headerString:()=>e.headerString,accessorKey:e.columnId,size:e.size,minSize:e.minSize,maxSize:e.maxSize,align:e.align,category:"Metrics",enableSorting:!1,...e.labelProps&&{labelProps:e.labelProps},cell:t=>{let{row:n}=t;const o=n.original[e.columnId];if((0,Ge.Po)(o))return null;const r=o.used&&o.total;return(0,re.jsxs)(te.Flex,{alignItems:"end",justifyContent:"end",width:"100%",gap:.5,children:[(0,re.jsx)(te.Text,{textAlign:"right",children:r?(0,re.jsxs)(re.Fragment,{children:[o.used,"/",o.total]}):o.convertedValue}),!e.hideUnits&&(0,re.jsx)(te.TextMicro,{color:"textLite",strong:!0,textAlign:"right",children:o.units})]})},renderString:t=>{const n=t.original[e.columnId];return(0,Ge.Po)(n)?"":`${n.convertedValue} ${e.hideUnits?"":n.units}`},sortingFn:(t,n)=>(t.original[e.columnId]?.value||0)-(n.original[e.columnId]?.value||0)}),progressBar:e=>({id:e.columnId,header:(0,re.jsx)(te.TextMicro,{strong:!0,children:e.header}),headerString:()=>e.headerString,accessorKey:e.columnId,size:e.size,minSize:e.minSize,maxSize:e.maxSize,align:e.align,category:"Metrics",enableSorting:!1,...e.labelProps&&{labelProps:e.labelProps},cell:t=>{let{row:n}=t;const o=n.original[e.columnId];if((0,Ge.Po)(o))return null;const r=o.used&&o.total,a=r?o.percentage:parseFloat(o.convertedValue)||0,i=Math.min(a,100);return(0,re.jsxs)(te.Flex,{column:!0,width:"100%",alignItems:r?"center":"end",gap:2,children:[(0,re.jsxs)(te.Flex,{alignItems:"end",justifyContent:r?"between":"end",width:"100%",children:[r&&(0,re.jsxs)(te.Flex,{alignItems:"end",gap:.5,children:[(0,re.jsxs)(te.Text,{children:[o.used,"/",o.total]}),!e.hideUnits&&(0,re.jsx)(te.TextMicro,{color:"textLite",strong:!0,textAlign:"right",children:o.units})]}),(0,re.jsxs)(te.Flex,{alignItems:"end",children:[(0,re.jsx)(te.Text,{children:Math.round(a)}),(0,re.jsx)(te.TextMicro,{color:"textLite",strong:!0,children:"%"})]})]}),(0,re.jsx)(te.ProgressBar,{background:"panelBg",color:"textLite",height:.5,width:`${i}%`,containerWidth:"100%",border:"none",overflow:"hidden"})]})},renderString:t=>{const n=t.original[e.columnId];return(0,Ge.Po)(n)?"":`${n.used} / ${n.total} (${n.percentage.toFixed(1)}%)`},sortingFn:(t,n)=>(t.original[e.columnId]?.percentage||t.original[e.columnId]?.value||0)-(n.original[e.columnId]?.percentage||n.original[e.columnId]?.value||0)}),metadata:e=>({id:e.columnId,header:(0,re.jsx)(te.TextMicro,{strong:!0,children:e.header}),headerString:()=>e.headerString,accessorKey:e.accessorKey,size:e.size,minSize:e.minSize,maxSize:e.maxSize,align:e.align||"left",category:"Labels",cell:t=>{let{row:n}=t;const o=n.original,r=e.accessorKey.split(".");let a=o;for(const e of r)if(a=a?.[e],void 0===a)break;if(e.fallbackKeys)for(const i of e.fallbackKeys){if(!(0,Ge.Po)(a))break;const e=i.split(".");let t=o;for(const n of e)if(t=t?.[n],void 0===t)break;a=t}return(0,Ge.Po)(a)?(0,re.jsx)(te.Flex,{alignItems:"center",width:"100%",children:(0,re.jsx)(te.Text,{children:"-"})}):(0,re.jsx)(te.Flex,{alignItems:"center",width:"100%",children:(0,re.jsx)(te.Text,{children:a})})},renderString:t=>{const n=t.original,o=e.accessorKey.split(".");let r=n;for(const e of o)if(r=r?.[e],void 0===r)break;if(e.fallbackKeys)for(const a of e.fallbackKeys){if(!(0,Ge.Po)(r))break;const e=a.split(".");let t=n;for(const n of e)if(t=t?.[n],void 0===t)break;r=t}return(0,Ge.Po)(r)?"-":r},sortingFn:"basic"})};var en=n(71341),tn=(n(30670),n(36310)),nn=n(65562),on=n(60602);const rn=e=>{let{nodeId:t,metricsConfig:n,onMetricsUpdate:o}=e;const r=(0,nn.useChart)();return(0,x.useEffect)((()=>{if(!r)return;const e=()=>{const[,e]=r.getTableMatrix();if(!e)return;const a={};n.forEach((t=>{t.calculateTotal?a[t.columnId]=((e,t)=>{if(!e[t.context])return null;const n=e[t.context],o=r.getPayload()?.data?.length-1||0,a=t.valueDimensions.map((e=>n[e]?.[0])).filter(Boolean),i=t.totalDimensions.map((e=>n[e]?.[0])).filter(Boolean);if(0===a.length||0===i.length)return null;const s=a.reduce(((e,t)=>e+(r.getDimensionValue(t,o)||0)),0),l=i.reduce(((e,t)=>e+(r.getDimensionValue(t,o)||0)),0),d=l>0?s/l*100:0,c=a[0],u=r.getConvertedValue(s,{fractionDigits:t.fractionDigits,dimensionId:c});return{value:s,convertedValue:u,used:u,total:r.getConvertedValue(l,{fractionDigits:t.fractionDigits,dimensionId:c}),percentage:d,units:r.getUnitSign({dimensionId:c})}})(e,t):a[t.columnId]=((e,t)=>{if(!e[t.context])return null;const n=e[t.context],o=r.getPayload()?.data?.length-1||0;let a,i,s;if(t.dimensions){if("string"===typeof t.dimensions){const e=n[t.dimensions];if(!e?.length)return null;a=r.getAggregatedDimensionValue(e,o,{aggregationMethod:t.aggregation||"sum"}),i=r.getConvertedValue(a,{fractionDigits:t.fractionDigits,dimensionId:e[0]}),s=e[0]}else if(Array.isArray(t.dimensions)){const e=t.dimensions.flatMap((e=>n[e])).filter(Boolean);if(0===e.length)return null;a=r.getAggregatedDimensionValue(e,o,{aggregationMethod:t.aggregation||"sum"}),i=r.getConvertedValue(a,{fractionDigits:t.fractionDigits,dimensionId:e[0]}),s=e[0]}}else{const e=Object.values(n).flat();if(0===e.length)return null;a=r.getAggregatedDimensionValue(e,o,{aggregationMethod:t.aggregation||"sum"}),i=r.getConvertedValue(a,{fractionDigits:t.fractionDigits,dimensionId:e[0]}),s=e[0]}return{value:parseFloat(a)||0,convertedValue:i||"0",dimensionId:s,units:s?r.getUnitSign({dimensionId:s}):""}})(e,t)})),o(t,a)},a=t=>{t&&e()};return r.on("finishFetch",e),r.on("active",a),()=>{r.off("finishFetch",e),r.off("active",a)}}),[r,n,t,o]),null},an=e=>{let{nodeId:t,metricsConfig:n,onMetricsUpdate:o}=e;const r=(0,Tt.eg)(),a=(0,j.ID)(),i=n.reduce(((e,t)=>{if(!t.context)return e;const n=t.aggregation||"sum";return e[n]||(e[n]=[]),e[n].push(t),e}),{});return Object.entries(i).map((e=>{let[n,i]=e;const s=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sum";const r=Bt(e,t);if(!r)return null;const a=`table-metrics-${n}-${o}`;return r.getNode({id:a})}(r,a,t,n);return s?(0,re.jsx)(tn.Ay,{chart:s,children:(0,re.jsx)(rn,{nodeId:t,metricsConfig:i,onMetricsUpdate:o})},`${t}-${n}`):null}))},sn=e=>{let{osEntry:t}=e;if(!t)return(0,re.jsx)(te.Icon,{name:"os",width:"18px",height:"18px",color:"textDescription"});if(t.iconName)return(0,re.jsx)(te.Icon,{name:t.iconName,width:"18px",height:"18px",color:"textDescription",viewBox:"0 0 100 100"});if(t.logoFilename){const e=`${h.A.assetsBaseURL}/img/logos/os/${t.logoFilename}`;return(0,re.jsx)("img",{src:e,width:"18px",height:"18px",alt:t.title})}return(0,re.jsx)(te.Icon,{name:"os",width:"18px",height:"18px",color:"textDescription"})},ln=e=>{let{headerText:t="Server",onMetricsUpdate:n,metricsConfig:o}=e;return{id:"server",header:(0,re.jsx)(te.Text,{strong:!0,children:t}),headerString:t,accessorKey:"name",size:200,minSize:60,maxSize:400,align:"center",category:"Device",enableHiding:!1,cell:e=>{let{row:t}=e;const r=t.original,a=(0,Ge.GM)(r.state),i=r.os?.nm||r.labels?.os_name,s=r.os?.id,l=r.labels?.vendor,d=Ee.u[i]||Ee.U[s]||Ee.u[l],c="Live"===a?en.P.live.indicatorWrapperColor:"Stale"===a?en.P.stale.indicatorWrapperColor:en.P.offline.indicatorWrapperColor;return(0,re.jsxs)(te.Flex,{alignItems:"center",gap:2,children:[(0,re.jsx)(te.Flex,{width:2,height:2,round:"50%",background:c,flex:!1}),(0,re.jsx)(te.Flex,{width:5,height:5,flex:!1,alignItems:"center",justifyContent:"center",children:(0,re.jsx)(sn,{osEntry:d})}),(0,re.jsx)(ft.A,{id:r.id||r.nd,name:r.nm||r.name,state:r.state,isLive:r.isLive}),(0,re.jsx)(an,{nodeId:r.id||r.nd,onMetricsUpdate:n,metricsConfig:o})]})},renderString:e=>e.original.name||e.original.nm,sortingFn:"basic"}},dn=e=>({id:"alerts",header:(0,re.jsx)(te.TextMicro,{strong:!0,children:"Alerts"}),headerString:"Alerts",accessorFn:e=>{const{warning:t=0,critical:n=0}=e.health?.alerts||{};return 3*n+2*t},size:80,minSize:60,maxSize:400,align:"center",category:"Device",cell:t=>{let{row:n}=t;const o=n.original,{warning:r=0,critical:a=0}=o.health?.alerts||{},i=r+a>0,s=(0,V.Fw)("sidebarTab",{flavour:"val",extraKey:e}),l=(0,V.Fw)("sidebarOpen",{flavour:"bool"}),d=(0,V.Fw)("sidebarNodeId",{flavour:"val",extraKey:e}),c=(0,x.useCallback)((e=>{e.stopPropagation(),l(!0),s("alerts"),d(o.id)}),[o.id,d,l,s]),u=(0,Xt.I)({flavour:a>0?"error":"disabledError",value:a||" "}),h=(0,Xt.I)({flavour:r>0?"warning":"disabledWarning",value:r||" "});return(0,re.jsx)(te.Flex,{alignItems:"center",justifyContent:"center",opacity:i?1:.3,children:(0,re.jsx)(te.MasterCard,{"data-testid":"alertsMastercard",onClick:i?c:null,pillLeft:u,pillRight:h,size:"small",height:"20px"})})},renderString:e=>{const{warning:t=0,critical:n=0}=e.original.health?.alerts||{};return t+n},sortingFn:"basic"}),cn=(e,t)=>{let{extraKey:n="nodesView",tabId:o="servers",onMetricsUpdate:r}=t;return(0,x.useMemo)((()=>{const t="snmp"===o?"Device":"Server",a=(e=>e.map((e=>{const t=Zt[e.columnFlavour];return t?t(e):(console.warn(`Unknown column flavour: ${e.columnFlavour}`),Zt.value(e))})))(e)||[],i=a.reduce(((e,t)=>{const n=t.category||"Metrics";return e[n]||(e[n]=[]),e[n].push(t),e}),{});return[{id:"Server",isPlaceholder:!0,columns:[ln({headerText:t,onMetricsUpdate:r,metricsConfig:e}),dn(n)],notFlex:!0},...Object.entries(i).map((e=>{let[t,n]=e;return{id:t,header:"",columns:n,notFlex:!0}}))]}),[e,n,o,r])};var un=n(1444);const hn=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"nodesView",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"servers";const[n,,o,r]=(0,ge.A)(),a=(0,Dt.yK)({onResolve:r}),i=(0,Dt.z2)(null,{onResolve:r}),{disabled:s,reason:l}=(0,un.A)(),d=(0,x.useCallback)((async function(n,r){let{tabId:l=t,flavour:d=e}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!s&&n&&(o(),r?await i(r.id):await a({type:"favourites",entity:n,path:`/${d}/${l}`,value:{nodeId:n,sortOrder:Date.now()}}))}),[s,a,i,o,e,t]);return{isLoading:n,disabled:s,reason:l,toggleFavorite:d}};var gn=n(73613);const mn={[He]:"error",[Ue]:"warning",[Ke]:"success",[We]:"textLite"},xn=e=>{let{rows:t}=e;const n=t.map((e=>e.original.id)),o=(0,z.BU)(n).length,r=(0,z.Ig)(n).length,a=(0,z.GE)(n).length;return(0,re.jsx)(gn.A,{content:(0,re.jsxs)(te.Flex,{alignItems:"center",gap:4,background:"dropdown",round:!0,padding:[2,3],children:[(0,re.jsxs)(te.Flex,{alignItems:"center",gap:2,children:[(0,re.jsx)(te.Flex,{width:2,height:2,round:"50%",background:en.P.live.indicatorWrapperColor}),(0,re.jsxs)(te.Text,{children:["Live: ",o]})]}),(0,re.jsxs)(te.Flex,{alignItems:"center",gap:2,children:[(0,re.jsx)(te.Flex,{width:2,height:2,round:"50%",background:en.P.stale.indicatorWrapperColor}),(0,re.jsxs)(te.Text,{children:["Stale: ",r]})]}),(0,re.jsxs)(te.Flex,{alignItems:"center",gap:2,children:[(0,re.jsx)(te.Flex,{width:2,height:2,round:"50%",background:en.P.offline.indicatorWrapperColor}),(0,re.jsxs)(te.Text,{children:["Offline: ",a]})]})]}),align:"right",children:(0,re.jsxs)(te.Text,{color:"textLite",children:["(",(0,re.jsx)(te.Text,{color:en.P.live.statusTextColor,children:o}),"/",(0,re.jsx)(te.Text,{color:en.P.stale.statusTextColor,children:r}),"/",(0,re.jsx)(te.Text,{color:en.P.offline.statusTextColor,children:a}),")"]})})},pn=e=>{let{row:t,name:n,...o}=e;const r=t.getIsExpanded(),a=(i=n,en.P[i?.toLowerCase?.()]?.statusTextColor||mn[i]||"text");var i;return(0,re.jsx)(te.Flex,{alignItems:"center",flex:!0,width:"100%",background:"tableRowBg2",_hover:{background:"tableRowBg2Hover"},...o,children:(0,re.jsxs)(te.Flex,{position:"sticky",left:"0px",width:"auto",padding:[2,3],gap:2,children:[(0,re.jsx)(te.Icon,{name:"chevron_left",size:"small",color:"textLite",rotate:r?1:3}),(0,re.jsx)(te.Text,{color:a,strong:!0,children:n}),(0,re.jsx)(xn,{rows:t.subRows})]})})},fn=e=>{let{tabId:t,flavour:n,metricsData:o,onClickRow:r,columnPinning:a,columnVisibility:i,columnSizing:s,onColumnSizingChange:l,sortBy:d,onSortingChange:c,rowActions:u,columns:h}=e;const g=(0,z.Y7)(),{favoriteNodeIds:m}=Pt(n,t),[p,f]=(0,ge.A)(!0),b=(0,x.useMemo)((()=>m.map((e=>{const t=g(e),n=o[e]||{};return t?{...t,...n}:null})).filter(Boolean)),[m,g,o]),v={getIsExpanded:()=>p,subRows:b.map((e=>({original:e})))};return b.length?(0,re.jsx)(re.Fragment,{children:(0,re.jsxs)("div",{children:[(0,re.jsx)(pn,{row:v,name:"Favourites",onClick:f}),(0,re.jsx)(te.Collapsible,{open:p,children:(0,re.jsx)(te.Table,{data:b,dataColumns:h,rowActions:u,onClickRow:r,enableSorting:!0,sortBy:d,onSortingChange:c,enableColumnPinning:!0,enableResizing:!0,columnVisibility:i,columnSizing:s,onColumnSizingChange:l,background:"tableRowBg2",columnPinning:a})})]})}):null},bn={right:["actions"],left:["server"]},vn=e=>{let{nodeIds:t,onChartNameChange:n,initialChartName:o,tabId:r="servers",flavour:a="nodesView"}=e;const i=(0,Yt.qR)(),s=(0,j.ID)(),l=(0,L.Cq)(s,r),d=(0,L.A3)(s,r),[c,u]=(0,x.useState)(null),[h,m]=(0,x.useState)(null),{metricsData:p,onMetricsUpdate:f}=(()=>{const[e,t]=(0,x.useState)({}),n=(0,x.useCallback)(((e,n)=>{t((t=>({...t,[e]:{...t?.[e],...n}})))}),[]);return{metricsData:(0,on.A)(e,100),onMetricsUpdate:n}})(),b=(0,x.useCallback)(((e,t)=>{u({ids:[e],name:t})}),[]),y=(0,x.useCallback)(((e,t)=>{m({ids:[e],name:t})}),[]),w=Nt[r]||Nt.servers,I=cn(w,{extraKey:"nodesView",tabId:r,onMetricsUpdate:f}),C=(0,x.useMemo)((()=>(e=>{const t={nodeStatus:{name:"Node status",columns:[]},alertStatus:{name:"Alerts",columns:[]}};return"snmp"===e?{...t,vendor:{name:"Vendor",columns:[]},type:{name:"Type",columns:[]},location:{name:"Location",columns:[]}}:t})(r)),[r]),k=(0,x.useMemo)((()=>w.reduce(((e,t)=>(t.hidden&&(e[t.columnId]=!1),e)),{})),[w]),[A,S]=(0,V.r$)("columnVisibility",{extraKey:`nodesView-${r}`,flavour:"obj",defaultValue:k}),[T,F]=(0,V.r$)("columnSizing",{extraKey:`nodesView-${r}`,flavour:"obj",defaultValue:{}}),[N,M]=(0,V.r$)("sortBy",{extraKey:`nodesView-${r}`,flavour:"arrobj",defaultValue:[]}),D=((e,t)=>{let{flavour:n,onRemoveNode:o,onObsoleteNode:r}=t;const a=(0,g.JT)("node:Delete"),i=(0,j.XA)(),s=(0,v.dg)(),l=!i.untouchable,{isLoading:d,toggleFavorite:c,disabled:u,reason:h}=hn(n,e),{settingsByNodeId:m}=Pt(n,e),p=(0,x.useRef)(null);return p.current=t=>{const o=m[t];c(t,o,{flavour:n,tabId:e})},(0,x.useMemo)((()=>({...!s&&l&&{remove:{icon:"remove",tooltipText:"Remove node from room",handleAction:e=>o(e.id,e.name),confirmation:!0,confirmationText:e=>`Remove ${e.name} from room?`,isDisabled:()=>!1}},...!s&&!l&&{obsolete:{icon:"delete",tooltipText:"Delete node permanently",handleAction:e=>r(e.id,e.name),confirmation:!0,confirmationText:e=>`Delete ${e.name} permanently?`,isDisabled:e=>{const t=(0,Ge.GM)(e.state);return a&&"Offline"!==t}}},favorite:{icon:e=>m[e.id]?"heart_broken":"heart",tooltipText:e=>m[e.id]?"Remove from favorites":"Add to favorites",handleAction:e=>p.current(e.id),confirmation:!1,isVisible:()=>!0,isDisabled:d||u,iconColor:"textNoFocus",disabledTooltipText:h||"Saving..."}})),[a,s,l,o,r,d,u,m])})(r,{flavour:a,onRemoveNode:b,onObsoleteNode:y}),P=(0,V.Fw)("sidebarTab",{flavour:"val",extraKey:"nodesView"}),B=(0,V.Fw)("sidebarOpen",{flavour:"bool"}),R=(0,V.Fw)("sidebarNodeId",{flavour:"val",extraKey:"nodesView"}),$=(0,x.useCallback)(((e,t)=>{B(!0),P(e),R(t)}),[R,B,P]),z=(0,x.useCallback)((e=>{let{data:t}=e;t.isGroup||$("info",t.id)}),[$]),{setActiveMenuId:_}=(0,Je.A)({onChartNameChange:n,initialChartName:o}),O=(0,x.useRef)(),E=(0,x.useRef)(),K=(0,x.useMemo)((()=>(O.current&&O.current.cancel(),O.current=(0,Jt.A)({elementQueryParam:"[data-id]",dataMenuId:"data-id"}),()=>O.current(E.current?.scrollElement,_))),[i.length,_]);(0,x.useLayoutEffect)((()=>{i.length&&K()}),[i.length,o]);const U=(0,x.useRef)(),H=(0,x.useMemo)((()=>({overscan:30,virtualRef:E,onScroll:K})),[K]),W=(0,x.useMemo)((()=>i.map((e=>e.isGroup?{...e,children:e.children.map((e=>({...e,...p[e.id]||{}})))}:{...e,...p[e.id]||{}})).filter(Boolean)),[i,p]);return(0,Qt.A)(E.current,W),(0,re.jsxs)(re.Fragment,{children:[(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(fn,{tabId:r,flavour:a,metricsData:p,onRemoveNode:b,onObsoleteNode:y,onClickRow:z,columnPinning:bn,columnVisibility:A,columnSizing:T,onColumnSizingChange:F,sortBy:N,onSortingChange:M,rowActions:D,columns:I}),t.length?(0,re.jsx)(te.Table,{data:W,dataColumns:I,rowActions:D,onClickRow:z,enableSorting:!0,sortBy:N,onSortingChange:M,enableColumnVisibility:!0,enableColumnPinning:!0,enableResizing:!0,columnPinning:bn,columnVisibility:A,onColumnVisibilityChange:S,columnSizing:T,onColumnSizingChange:F,groupByColumns:C,grouping:l||"",onGroupByChange:d,getSubRows:e=>e.children,enableExpanding:!0,expanded:!0,GroupRow:pn,virtualizeOptions:H,tableRef:U,background:"tableRowBg2"}):(0,re.jsx)(he,{})]}),c&&(0,re.jsx)(st.Ay,{ids:c.ids,name:c.name,onClose:()=>u(null)}),h&&(0,re.jsx)(it.Ay,{ids:h.ids,name:h.name,onClose:()=>m(null)})]})};var jn=n(71581);const yn=(0,Re.A)(me.A),wn=e=>{let{children:t,...n}=e;const[o,,r,a]=(0,ge.A)();return(0,re.jsxs)(te.Flex,{alignItems:"end",justifyContent:"between",width:"100%",background:"mainBackground",padding:[0,0,0,4],border:{side:"bottom",size:"1px",type:"solid",color:"borderSecondary"},...n,children:[t,(0,re.jsxs)(te.Flex,{alignItems:"center",padding:[2,3],children:[o&&(0,re.jsx)(xe.A,{onClose:a}),(0,re.jsx)(yn,{"data-ga":"add-nodes::click-add-nodes::hm-nodes-table","data-testid":"nodesTable-addNode",icon:"nodes_hollow",label:"Add Nodes",onClick:r,small:!0,flavour:"hollow"})]})]})},In=e=>{let{allNodes:t,activeTabId:n,onTabChange:o,children:r}=e;const a=(0,jn.yT)(t),i=(0,x.useMemo)((()=>{const e=a.findIndex((e=>e.id===n));return e>=0?e:0}),[n,a]),s=(0,x.useCallback)((e=>{const t=a[e];t&&o&&o(t.id)}),[a,o]);return(0,re.jsx)(te.Tabs,{selected:i,onChange:s,height:"100%",padding:[4,4,2],TabsHeader:wn,gap:4,noDefaultBorder:!0,children:a.map((e=>(0,re.jsx)(te.Tab,{label:(0,re.jsx)(te.Text,{children:e.label}),"data-testid":`nodes-tab-${e.id}`,padding:[0,4],maxWidth:"100%",green:!0,children:r},e.id)))})},Cn=e=>{let{tabId:t,filteredIds:n,totalCount:o}=e;const r=(0,jn.K3)(t),a=r?.label||"Nodes",i=(0,z.BU)(n).length,s=(0,z.Ig)(n).length,l=(0,z.GE)(n).length;return(0,re.jsxs)(te.Flex,{width:"100%",justifyContent:"between",alignItems:"center",background:"mainBackground",padding:[2,3],border:"border",round:!0,children:[(0,re.jsxs)(te.Text,{strong:!0,children:["Total ",a,": ",o]}),(0,re.jsxs)(te.Flex,{alignItems:"center",gap:4,children:[(0,re.jsxs)(te.Flex,{alignItems:"center",gap:2,children:[(0,re.jsx)(te.Flex,{width:2,height:2,round:"50%",background:en.P.live.indicatorWrapperColor}),(0,re.jsxs)(te.Text,{children:["Live: ",i]})]}),(0,re.jsxs)(te.Flex,{alignItems:"center",gap:2,children:[(0,re.jsx)(te.Flex,{width:2,height:2,round:"50%",background:en.P.stale.indicatorWrapperColor}),(0,re.jsxs)(te.Text,{children:["Stale: ",s]})]}),(0,re.jsxs)(te.Flex,{alignItems:"center",gap:2,children:[(0,re.jsx)(te.Flex,{width:2,height:2,round:"50%",background:en.P.offline.indicatorWrapperColor}),(0,re.jsxs)(te.Text,{children:["Offline: ",l]})]})]})]})},kn=["config"],An=()=>{const e=(0,v.vt)(),t=(0,j.ID)(),n=(0,z.dG)(),o=(e=>{const t=(0,j.ID)(),n=(0,L.Cq)(t,e),o=Ye[n];return(0,x.useCallback)((e=>{const t=o?.(e);return{name:t,priority:qe[n]?.[t],icon:"nodeStatus"===n?`connectivityStatus${t}`:null}}),[n,o])})(n),r=(0,L.Cq)(t,n),a=(0,z.TL)(),i=(0,_.w7)({extraKey:"nodesView",merge:!1,scoped:!0}),s=(0,z.Gt)(),l=(0,jn.e$)(n),d=(0,z.Y7)(),[c,{width:u}]=(0,R.A)(),g=(0,X.K)({spaceId:e,roomId:t}),[m,p,f]=Q(i,t,{shouldHide:N.f9?l:void 0,cacheKey:n});!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],{host:n,width:o,tabId:r="servers",flavour:a="nodesView"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=(0,Tt.eg)(),s=(0,x.useMemo)((()=>{if(!i)return;let r=Bt(i,e);if(r)return r;o&&(r=i.makeContainer({attributes:{host:n,enabledXAxis:!1,id:`nodes-${e}`,hasToolbox:!1,height:"75px",groupingMethod:"average",groupBy:["dimension"],aggregationMethod:"avg",legend:!1,axisLabelFontSize:7,yAxisLabelWidth:20,hasYlabel:!1,nodesScope:t,containerWidth:o}}),i.appendChild(r))}),[e,r,o]),{favoriteNodeIds:l}=Pt(a,r),d=(0,z.BU)(t),c=(0,z.Ig)(t);(0,x.useMemo)((()=>{if(!N.f9)return;if(!s||!t?.length&&!l?.length)return;const e=(Nt[r]||Nt.servers).reduce(((e,t)=>{if(!t.context)return e;const n=t.aggregation||"sum";return e[n]||(e[n]=new Set),e[n].add(t.context),e}),{});[...d,...c,...l].forEach((t=>{Object.entries(e).forEach((e=>{let[n,o]=e;const r=`table-metrics-${t}-${n}`;let a=s.getNode({id:r});if(a)return;const l=Array.from(o);0!==l.length&&(a=i.makeChart({attributes:{id:r,contextScope:l,nodesScope:[t],aggregationMethod:n,groupingMethod:"average",groupBy:["label","dimension","context","node"],groupByLabel:["device"],tableColumns:["context","dimension"],chartLibrary:"table"}}),s.appendChild(a))}))}))}),[s,t,l,n,i,r,o])}(t,m,{host:g,width:u,tabId:n,flavour:"nodesView"});const[b,y]=(0,V.N9)("nodeIdToGo",{key:t,extraKey:"nodesView",flavour:"val"}),w=(0,x.useCallback)((e=>{a(e)}),[a]),I=(0,x.useCallback)((function(e,t){return function(e,t){let{getGrouping:n,extraKey:o,searchScores:r,groupMode:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={},s={};((e,t)=>{let{getNode:n,getGrouping:o,nodeMenus:r,menusById:a,searchScores:i}=t;e.forEach((e=>{const t=n(e);if(!t)return;const{name:a,priority:i,icon:s}=o(t);r[e]={...t,groupId:a,subMenuId:e,priority:i,groupIcon:s}})),[...e].sort(((e,t)=>{const n=i?.[e]||0,o=i?.[t]||0;if(o!==n)return o-n;const a=(r[e]?.priority||0)-(r[t]?.priority||0);if(0!==a)return a;const s=(r[e]?.groupId||"").localeCompare(r[t]?.groupId||"",void 0,{sensitivity:"accent",ignorePunctuation:!0});return 0!==s?s:(r[e]?.name||"").localeCompare(r[t]?.name||"",void 0,{sensitivity:"accent",ignorePunctuation:!0})})).forEach((e=>{const t=r[e];if(!t)return;const n=`${t.groupId}|${t.subMenuId}`;a[t.groupId]||(a[t.groupId]={byId:{},nodeIds:[]}),a[t.groupId].byId[n]||(a[t.groupId].byId[n]={byId:{},nodeIds:[]}),a[t.groupId].byId[n].nodeIds.push(t.id),a[t.groupId].nodeIds.push(t.id)}))})(e,{getNode:t,getGrouping:n,nodeMenus:i,menusById:s,searchScores:r});const l=Object.keys(s).reduce(((e,t)=>{const{nodeIds:n}=s[t],r=i[n[0]];return e[t]={level:0,name:r.groupId,id:t,childrenIds:n,link:`${(0,Ve.A)(`menu_${t}`)}`,size:24,forceVisibility:!0,icon:r.groupIcon,extraKey:o,styleProps:{important:!1,grouping:!0}},n.forEach((n=>{const r=i[n],a=Ee.u[r.os?.nm||r.labels?.os_name]||Ee.U[r.os?.id]||Ee.u[r.labels?.vendor];e[n]={...r,level:1,id:n,menuId:t,link:`${(0,Ve.A)(`menu_${t}_submenu_${n}`)}`,size:24,forceVisibility:!0,icon:a?.iconName||a?.logoFilename&&`${h.A.assetsBaseURL}/img/logos/os/${a.logoFilename}`||"os",extraKey:o}})),e}),{}),d=Object.keys(s);let c=-1;const u=d.reduce(((e,t)=>{if(c+=1,!N.f9){const n={...l[t],sticky:!0};return[...e,n,...l[t].childrenIds.reduce(((e,t)=>(c+=1,[...e,l[t]])),[])]}return a?[...e,{...l[t],isGroup:!0,children:l[t].childrenIds.reduce(((e,t)=>(c+=1,[...e,l[t]])),[])}]:[...e,...l[t].childrenIds.reduce(((e,t)=>(c+=1,[...e,l[t]])),[])]}),[]);return i=null,s=null,{stickyIds:{},allElements:u,menuIds:d,menuById:l}}(e,t,{...arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},searchScores:p})}),[p]);return(0,re.jsx)(Z.A,{getObject:d,ids:m,getMenu:I,getGrouping:o,groupMode:r,deps:[o,p,n,r],extraKey:"nodesView",children:(0,re.jsx)($.A,{ref:c,position:"relative",sidebar:(0,re.jsx)(ee.Ay,{hiddenTabs:kn,nodeIds:m,title:"Nodes",initialChartName:b,flavour:"nodesView",loaded:!0,FilterInputContainer:de}),children:!!u&&(0,re.jsxs)(re.Fragment,{children:[!N.f9&&(0,re.jsx)(Oe,{}),N.f9||m.length||!i.length?N.f9?(0,re.jsxs)(In,{allNodes:s,activeTabId:n,onTabChange:w,nodesCount:f,children:[(0,re.jsx)(Cn,{tabId:n,filteredIds:m,totalCount:f}),(0,re.jsx)(vn,{nodeIds:m,initialChartName:b,onChartNameChange:y,tabId:n,flavour:"nodesView"})]}):(0,re.jsx)(qt,{initialChartName:b,onChartNameChange:y}):(0,re.jsx)(he,{})]})})})},Sn=()=>{const e=(0,j.ID)(),t=(0,D.CK)();return(0,D.gr)(e,"loaded")&&!t.length?(0,re.jsx)(B.Ay,{feature:"NodesView",mode:"NoNodesView",children:(0,re.jsx)(P.A,{})}):(0,re.jsx)(B.Ay,{feature:"NodesView",children:(0,re.jsx)(An,{})})},Tn=()=>{const e=(0,z.nl)(),t=(0,z.xY)(e,"name");return(0,S.ZB)({title:t,id:e,destination:e}),null};var Fn=n(258);var Nn=n(98545),Mn=n(6196),Dn=n(1705),Pn=n(2626),Bn=n(41716),Rn=n(65448);var $n=n(6387),Ln=n(81395);const zn=e=>t=>`histogram::${e.getAttribute("id")}::${t}`,_n=e=>{let{container:t,...n}=e;const o=(0,Tt.eg)(),r=(0,x.useMemo)((()=>{if(!t)return null;let e=t.getNode({id:"dummy-chart"});return e||(e=o.makeChart({attributes:{id:"dummy-chart",chartLibrary:"dygraph",sparkline:!0,hasToolbox:!1,hasHoverPopover:!1,contextScope:["anomaly_detection.anomaly_rate"],aggregationMethod:"max",postAggregationMethod:"max",postgroupBy:["selected"],showPostAggregations:!0,groupingMethod:"max",expandable:!1,chartType:"stacked",colors:Ln.default[14],showAnomalies:!1,showAnnotations:!1,overlays:{latestTime:{type:"latestTime"}}},makeTrack:zn}),t.appendChild(e),e)}),[t]);return(0,x.useEffect)((()=>()=>r&&r.destroy()),[r]),(0,re.jsx)(te.Flex,{flex:!1,width:"100%",height:5,position:"sticky",bottom:"0",left:"0",right:"0",children:(0,re.jsx)(Rt.A,{"data-chartid":"dummy-chart",chart:r,overflow:"hidden",hasHeader:!1,hasFooter:!1,hasFilters:!1,tile:!1,...n,round:0})})};var On=n(65380),Vn=n(55093),En=n(77148),Kn=n(38773),Un=n(95565);const Hn=()=>(0,re.jsxs)(te.Flex,{padding:[6],round:1,width:"600px",background:"modalInfoBackground",children:[(0,re.jsx)(te.Box,{margin:[0,4,0,0],children:(0,re.jsx)(te.Box,{as:te.Icon,width:10,height:10,name:"nodes_update"})}),(0,re.jsxs)(te.Flex,{column:!0,gap:2,children:[(0,re.jsx)(te.Text,{strong:!0,children:"Couldn't find the chart you were looking for? "}),(0,re.jsxs)(te.Text,{color:"textDescription",children:["Netdata has zero-configuration auto-detection for most applications and systems, this is achieved using collectors. If you miss some specific chart please check our"," ",(0,re.jsx)(ce.A,{href:"https://learn.netdata.cloud/docs/agent/collectors",target:"_blank","data-ga":"chart-area::click-link-collectors::charts-view",children:"list of collectors"})," ","to see if any additional step is needed."]})]})]}),Wn=()=>(0,re.jsxs)(te.Flex,{width:"100%",column:!0,gap:6,margin:[8,0,0,0],children:[(0,re.jsx)(En.A,{}),(0,re.jsxs)(te.Flex,{gap:1,alignItems:"center",justifyContent:"center",padding:[2],background:"successSemi",children:[(0,re.jsx)(Un.A,{children:(0,re.jsx)(te.Text,{color:"primary",children:"Upgrade to Business for unlimited access"})}),(0,re.jsx)(te.Text,{children:"or"}),(0,re.jsx)(Kn.A,{children:(0,re.jsx)(te.Text,{color:"primary",children:"review your Space active Nodes"})})]})]}),Gn=e=>{let{noPreferredNodesError:t}=e;return(0,re.jsxs)(te.Flex,{column:!0,flex:!0,justifyContent:"center",alignItems:"center",alignSelf:"center",children:[(0,re.jsxs)(te.Flex,{column:!0,justifyContent:"center",alignItems:"center",width:"300px",margin:[0,0,6],children:[(0,re.jsx)(te.H3,{margin:[0,0,4],children:"No charts to display"}),(0,re.jsx)(te.Text,{color:"textDescription",textAlign:"center",children:"Double-check your search or filters and dates and try again with different conditions."})]}),(0,re.jsx)(Hn,{}),t&&(0,re.jsx)(Wn,{})]})};var qn=n(93997);const Yn=()=>{const[e,t]=(0,qn.sK)(),n=(0,x.useCallback)((0,ne.s)(300,(e=>{t(e.target.value),(0,oe.H)("toc-search","search-automatic-trigger","charts-view",e.target.value)})),[]),[o,r,,,{resetValue:a}]=(0,te.useInputValue)({value:e,onChange:n}),i=(0,x.useCallback)((()=>{t(""),a(),(0,oe.H)("toc-search","clear-search-button","charts-view")}),[]);return(0,re.jsx)(te.TextInput,{value:o,onChange:r,size:"small",iconRight:o&&(0,re.jsx)(te.Icon,{name:"x",color:"textLite",cursor:"pointer",size:"small",onClick:i,"data-testid":"filterChartsInput-clearButton"}),placeholder:"Search charts",name:"Search charts","data-testid":"filterChartsInput",containerStyles:{width:"100%"}})};var Jn=n(61841);const Qn=(0,ne.s)(300,((e,t)=>(0,oe.H)("toc-search","search-results","charts-view",e,`${t} -- charts`))),Xn=()=>{const e=(0,f.Zp)(),[t]=(0,Jn.Ay)(),n=(0,qn.Um)(),{filteredChartsCount:o,chartsCount:r}=(0,qn.Ad)();(0,x.useEffect)((()=>{n&&Qn(n,o)}),[n,o]);const a=(0,x.useCallback)((n=>{n.preventDefault(),e(`/spaces/${t}/settings/configurations`,{replace:!0})}),[t,e]);return(0,re.jsxs)(te.Flex,{alignItems:"center",justifyContent:"between",width:"100%",children:[(0,re.jsxs)(te.TextMicro,{color:"textLite",margin:[1,0,0],"data-testid":"numberOfChartsIndication",children:["Showing"," ",(0,re.jsx)(te.TextMicro,{strong:!0,color:"textDescription","data-testid":"numberOfChartsIndication-filteredChartsCount",children:o})," ","of total"," ",(0,re.jsx)(te.TextMicro,{strong:!0,color:"textDescription","data-testid":"numberOfChartsIndication-chartsCount",children:r})," ","charts"]}),(0,re.jsx)(ce.A,{Component:te.TextMicro,margin:[1,0,0],"data-ga":`toc-search::click-link-collectors::${name}`,onClick:a,target:"_blank",rel:"noopener noreferrer",children:"Add more charts"})]})},Zn=()=>{const{filteredChartsCount:e}=(0,qn.Ad)();return e||null===e?null:(0,re.jsxs)(te.Flex,{width:"100%",gap:1,margin:[4,0,0],padding:[2],alignItems:"center","data-testid":"noResultsWereFound",children:[(0,re.jsx)(te.Icon,{name:"information",color:"textDescription"}),(0,re.jsx)(te.TextMicro,{strong:!0,color:"textDescription",children:"No results were found"})]})};var eo=n(14512);const to=()=>(0,re.jsxs)(te.Flex,{column:!0,alignItems:"center",children:[(0,re.jsx)(Yn,{}),(0,re.jsx)(Xn,{}),(0,re.jsx)(eo.A,{}),(0,re.jsx)(Zn,{})]}),no=e=>{let{width:t=443,height:n=249,videoId:o,...r}=e;return(0,re.jsx)(te.Flex,{...r,children:(0,re.jsx)(te.Box,{className:"video-responsive",children:(0,re.jsx)("iframe",{width:t,height:n,src:`https://www.youtube.com/embed/${o}`,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,title:"Embedded youtube"})})})};var oo=n(58218),ro=n(14815);const ao=()=>{const e=(0,j.ID)(),t=(0,g.JT)("node:Create");return(0,re.jsxs)($.A,{column:!1,"data-testid":"noNodesViewPage",gap:12,padding:[6],children:[(0,re.jsxs)(te.Flex,{column:!0,gap:5,flex:{shrink:0,grow:0},"data-testid":"noKubernetesView-videoSection",children:[(0,re.jsx)(no,{"data-testid":"noNodesView-onboardingVideo",height:350,width:850,videoId:Te.BX[0]}),(0,re.jsx)(no,{"data-testid":"noNodesView-onboardingVideo",height:350,width:850,videoId:Te.BX[1]})]}),(0,re.jsxs)(te.Flex,{column:!0,gap:4,children:[(0,re.jsxs)(te.Box,{border:{side:"bottom",color:"borderSecondary"},children:[(0,re.jsx)(te.Box,{margin:[0,0,2,0],children:(0,re.jsx)(ce.A,{href:"https://learn.netdata.cloud/docs/netdata-agent/installation/kubernetes",target:"_blank",rel:"noopener noreferrer","data-ga":"k8s-tab::click-link-guides::kubernetes-overview-and-visualizations",children:(0,re.jsx)(te.TextBig,{color:"primary",children:"Kubernetes monitoring with Netdata: Overview and visualizations"})})}),(0,re.jsx)(te.Box,{margin:[0,0,2,0],children:(0,re.jsx)(ce.A,{href:"https://learn.netdata.cloud/docs/dashboards-and-charts/kubernetes-tab",target:"_blank",rel:"noopener noreferrer","data-ga":"k8s-tab::click-link-guides::kubernetes-visualizations",children:(0,re.jsx)(te.TextBig,{color:"primary",children:"Kubernetes visualizations"})})})]}),(0,re.jsx)(te.Flex,{column:!0,gap:4,children:t?(0,re.jsx)(oo.A,{integrationId:ro.v2,rooms:[e]}):(0,re.jsx)(P.S,{})})]})]})};var io=n(33185),so=n(67012),lo=n(77611);const co=io.default.div.withConfig({displayName:"selections__Separator",componentId:"sc-1cc7y18-0"})(["width:1px;height:",";background:",";"],(0,te.getSizeBy)(2.5),(0,te.getColor)("borderSecondary")),uo=[{label:"Volume",value:"volume"},{label:"KS2",value:"ks2"}],ho=[{label:"Average",value:"average"},{label:"Median",value:"median"},{label:"Min",value:"min"},{label:"Max",value:"max"},{label:"Stddev",value:"stddev"}],go=[{label:"Metrics",value:""},{label:"Anomaly Rate",value:"anomaly-bit"}],mo=()=>(0,re.jsxs)(te.Flex,{column:!0,gap:1,alignItems:"center",width:"220px",children:[(0,re.jsx)(te.TextMicro,{children:"Choose the algorithm you want to be used to identify correlations across metrics:"}),(0,re.jsxs)(te.TextMicro,{children:[(0,re.jsx)(te.TextMicro,{strong:!0,children:"KS2:"})," A statistical test comparing the distribution of the highlighted window to the baseline."]}),(0,re.jsxs)(te.TextMicro,{children:[(0,re.jsx)(te.TextMicro,{strong:!0,children:"Volume:"})," Percentage change in averages between highlighted window and baseline."]})]}),xo=()=>(0,re.jsx)(te.Flex,{column:!0,gap:1,alignItems:"center",width:"220px",children:(0,re.jsx)(te.TextMicro,{children:"What aggregation function do you want to apply when aggregating multiple datapoints for metric correlations."})}),po=()=>(0,re.jsx)(te.Flex,{column:!0,gap:1,alignItems:"center",width:"220px",children:(0,re.jsx)(te.TextMicro,{children:"Do you want to find correlations over the metric values or the anomaly rates of each metric."})}),fo=e=>{let{runGetWeights:t,nodeIds:n,flavour:o}=e;const{method:r,options:a,group:i}=(0,lo.G9)({nodeIds:n,flavour:o}),s=a?.includes(go[1].value)?go[1].value:"",l=(0,x.useCallback)((e=>n=>{let{value:o}=n;o="options"!==e?o:o?[o]:[];t({method:r,options:[a],group:i,[e]:o})}),[r,a,i]),d=(0,x.useMemo)((()=>({method:uo.find((e=>e.value===r)),group:ho.find((e=>e.value===i)),option:go.find((e=>e.value===s))})),[r,i,s]);return i?(0,re.jsxs)(te.Flex,{gap:2,children:[(0,re.jsxs)(te.Flex,{gap:1,alignItems:"center",children:[(0,re.jsx)(te.TextSmall,{color:"textLite",children:"Method:"}),(0,re.jsx)(te.Select,{options:uo,value:d.method,onChange:l("method")}),(0,re.jsx)(gn.A,{isBasic:!0,plain:!0,content:mo,align:"bottom",children:(0,re.jsx)(te.Icon,{name:"information",color:"textDescription",size:"small"})})]}),(0,re.jsx)(co,{}),(0,re.jsxs)(te.Flex,{gap:1,alignItems:"center",children:[(0,re.jsx)(te.TextSmall,{color:"textLite",children:"Aggregation:"}),(0,re.jsx)(te.Select,{options:ho,value:d.group,onChange:l("group")}),(0,re.jsx)(gn.A,{isBasic:!0,plain:!0,content:xo,align:"bottom",children:(0,re.jsx)(te.Icon,{name:"information",color:"textDescription",size:"small"})})]}),(0,re.jsx)(co,{}),(0,re.jsxs)(te.Flex,{gap:1,alignItems:"center",children:[(0,re.jsx)(te.TextSmall,{color:"textLite",children:"Data:"}),(0,re.jsx)(te.Select,{options:go,value:d.option,onChange:l("options")}),(0,re.jsx)(gn.A,{isBasic:!0,plain:!0,content:po,align:"bottom",children:(0,re.jsx)(te.Icon,{name:"information",color:"textDescription",size:"small"})})]}),(0,re.jsx)(co,{})]}):null},bo=e=>{let{highlightAfter:t,highlightBefore:n,baseline:o}=e;const{localeDateString:r,localeTimeString:a}=(0,F.$j)(),i=new Date(t),s=new Date(n),l=new Date(o),d=new Date(t),c=Math.round((n-t)/1e3),u=Math.round((t-o)/1e3),h=(0,V.rI)("highlight");return(0,re.jsxs)(te.Flex,{gap:4,alignItems:"center",children:[(0,re.jsxs)(te.Flex,{gap:2,children:[(0,re.jsxs)(te.Flex,{column:!0,gap:1,children:[(0,re.jsx)(te.TextSmall,{color:"textLite",children:"Selected area:"}),(0,re.jsx)(te.TextSmall,{color:"textLite",children:"Reference baseline:"})]}),(0,re.jsxs)(te.Flex,{column:!0,gap:1,children:[(0,re.jsxs)(te.TextSmall,{"data-testid":"metricCorrelation-selectedArea",children:[r(i,{long:!1}),","," ",a(i),"\xa0->\xa0",r(s,{long:!1}),","," ",a(s)]}),(0,re.jsxs)(te.TextSmall,{"data-testid":"metricCorrelation-referenceBaseline",children:[r(l,{long:!1}),","," ",a(l),"\xa0->\xa0",r(d,{long:!1}),","," ",a(d)]})]}),(0,re.jsxs)(te.Flex,{column:!0,gap:1,children:[(0,re.jsx)(te.TextSmall,{color:"textLite",children:"Duration:"}),(0,re.jsx)(te.TextSmall,{color:"textLite",children:"Duration:"})]}),(0,re.jsxs)(te.Flex,{column:!0,gap:1,children:[(0,re.jsxs)(te.TextSmall,{"data-testid":"metricCorrelation-selecteArea-duration",children:[c,"\xa0secs"]}),(0,re.jsxs)(te.TextSmall,{"data-testid":"metricCorrelation-referenceBaseline-duration",children:[u,"\xa0secs"]})]})]}),(0,re.jsx)(gn.A,{content:"Clear selection",align:"bottom",isBasic:!0,children:(0,re.jsx)(te.Button,{neutral:!0,flavour:"borderless",icon:"trashcan",onClick:()=>{h({after:null,before:null})},"data-ga":"metric-correlation::click-delete::charts-view","data-testid":"metricCorrelation-delete"})})]})},vo=(0,Re.A)(te.Button),jo=(0,io.default)(te.Button).withConfig({displayName:"correlation__LogoButton",componentId:"sc-15d72m3-0"})(["&&{pointer-events:none;}"]),yo=(0,io.default)(te.Button).withConfig({displayName:"correlation__CloseButton",componentId:"sc-15d72m3-1"})(["position:absolute !important;top:-3px;right:-3px;"]),wo=(0,Re.A)(yo),Io=(0,io.default)(te.Button).attrs({padding:[0],margin:[0,0,0,1.5],width:"auto"}).withConfig({displayName:"correlation__StyledButton",componentId:"sc-15d72m3-2"})(["height:16px !important;> span{margin:0 !important;}"]),Co=e=>{let{flavour:t}=e;const n=(0,v.vt)(),o=(0,j.ID)(),r=(0,z.nl)(),a=(0,x.useMemo)((()=>r?[r]:[]),[r]),i=(0,_.w7)({extraKey:"nodesView",merge:!1,scoped:!0}),s="singleNode"===t?a:i,[l,d]=(0,x.useState)(!1),[c,u]=(0,x.useState)(),{threshold:h,totalDimensionsCount:g,dimensionsCount:m,loaded:p,loading:f,getWeights:b,resetWeights:y}=(0,lo.Yy)({nodeIds:s,flavour:t},n,o),{method:w,options:I,group:C}=(0,lo.G9)({nodeIds:s,flavour:t}),{after:k,before:A}=(0,V.rW)("highlight"),S=k-4*(A-k),T=!!k;(0,x.useEffect)((()=>{if(p){let e="default-result";if(C){const t=I?.includes("anomaly-bit")?"anomaly-bit":"metrics";e=`default-result-${w}-${C}-${t}`}return(0,oe.H)("metrics-correlation",e,"charts-view",m.toString())}}),[p]),(0,so.A)((()=>{k&&d(!0)}),[k]);const F=(0,V.rI)("correlation"),N=(0,V.rI)("threshold"),M=(0,V.rI)("highlight"),D=(0,x.useCallback)((()=>{F(!1),M({after:null,before:null}),N(lo.UG),y(),(0,oe.H)("metrics-correlation","click-close","charts-view",""+(p?"finish":"start"))}),[F,M,N,y,p]),P=(0,x.useCallback)((()=>{N(lo.UG),y(),(0,oe.H)("metrics-correlation","click-delete","charts-view",""+(p?"finish":"start"))}),[N,y,p]),R=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(!1),u(),b({highlightAfter:k,highlightBefore:A,baselineAfter:S,baselineBefore:k,method:w,options:I,group:C,nodeIds:s,...e}).then((()=>N(lo.UG)))},$=!T||f;return(0,so.A)((()=>{p&&l&&T&&R()}),[p,T,l]),(0,x.useEffect)((()=>()=>y()),[]),(0,re.jsxs)(te.Flex,{round:2,background:"elementBackground",padding:[2,6,2,2],margin:[2,0],alignItems:"center",justifyContent:"between",flex:!0,"data-testid":"correlation",position:"relative",height:{min:"64px"},gap:2,children:[T?p?(0,re.jsx)(B._0,{feature:"MetricCorrelations",totalDimensionsCount:g,dimensionsCount:m,children:(0,re.jsxs)(te.Flex,{"data-testid":"metricCorrelation-resultsContainer",column:!0,width:"100%",children:[(0,re.jsxs)(te.Flex,{justifyContent:"between",alignItems:"center",gap:1,children:[(0,re.jsxs)(te.Flex,{alignItems:"center",gap:1,children:[(0,re.jsx)(te.Icon,{name:"correlation",color:"primary",width:"16px",height:"16px"}),(0,re.jsxs)(te.TextSmall,{children:["Analysed"," ",(0,re.jsx)(te.TextSmall,{color:"primary","data-testid":"metricCorrelation-resultsAnalyzed",children:g})," ","and found"," ",(0,re.jsx)(te.TextSmall,{color:"primary","data-testid":"metricCorrelation-resultsFound",children:m})," ","correlated metrics."]}),(0,re.jsx)(gn.A,{content:"Clear results",children:(0,re.jsx)(Io,{flavour:"borderless",neutral:!0,disabled:f||!p&&!T,onClick:P,"data-testid":"metricCorrelation-clear",small:!0,icon:"reload"})})]}),(0,re.jsx)(fo,{runGetWeights:R,nodeIds:s,flavour:t})]}),(0,re.jsxs)(te.Flex,{width:"100%",children:[(0,re.jsxs)(te.Flex,{alignItems:"center",gap:3,margin:[0,2,0,5],width:"100%",children:[(0,re.jsx)(te.TextNano,{whiteSpace:"nowrap",color:"textDescription",children:"Show less"}),(0,re.jsx)(te.InputRange,{"data-testid":"metricCorrelation-resultsSlider",min:0,max:1,onChange:e=>N(e.target.value.toString()),onClick:()=>(0,oe.H)("metric-correlation","click-slider","charts-view"),step:.01,value:h}),(0,re.jsx)(te.TextNano,{whiteSpace:"nowrap",color:"textDescription",children:"Show more"})]}),(0,re.jsx)(re.Fragment,{children:(0,re.jsx)(gn.A,{content:"Give us your feedback! Was it useful?",align:"bottom",enterDelay:200,showArrow:!0,activateOn:"hover",children:(0,re.jsxs)(te.Flex,{children:[(0,re.jsx)(te.Button,{flavour:"+"===c?"hollow":"borderless",disabled:c,icon:"thumb_up",onClick:()=>u("+"),"data-ga":"metric-correlation::click-thumbs-up::charts-view","data-testid":"metricCorrelation-thumbsUp",small:!0}),(0,re.jsx)(te.Button,{flavour:"-"===c?"hollow":"borderless",disabled:c,icon:"thumb_down",onClick:()=>u("-"),"data-ga":"metric-correlation::click-thumbs-down::charts-view","data-testid":"metricCorrelation-thumbsDown",small:!0})]})})})]})]})}):(0,re.jsxs)(te.Flex,{alignItems:"center","data-testid":"correlationView-timePeriod-container",gap:4,children:[(0,re.jsx)(jo,{icon:"logo_s",isLoading:f}),f?(0,re.jsx)(te.H5,{"data-testid":"metricCorrelation-loadingCalculation",children:"Calculating metric correlations..."}):(0,re.jsx)(bo,{highlightAfter:k,highlightBefore:A,baseline:S})]}):(0,re.jsxs)(te.Flex,{alignItems:"center",gap:1,children:[(0,re.jsx)(te.Icon,{name:"correlation",color:"primary"}),(0,re.jsx)(te.Text,{children:"Select a timeframe on any chart and find correlated metrics. Visit documentation"}),(0,re.jsx)("a",{href:"https://learn.netdata.cloud/docs/cloud/insights/metric-correlations",target:"_blank",rel:"noreferrer",children:(0,re.jsx)(te.Icon,{name:"nav_arrow_goto",color:"primary",width:"12px",height:"12px"})})]}),(0,re.jsxs)(te.Flex,{alignItems:"center",children:[(!p||f)&&(0,re.jsx)(gn.A,{content:$?"Select an area of interest on any chart":"Click to find correlated metrics for the selected area",align:"bottom",enterDelay:200,showArrow:!0,activateOn:"hover",children:(0,re.jsx)(vo,{label:f?"Loading...":"Find correlations",isLoading:!1,onClick:R,disabled:$,flavour:"hollow","data-ga":"metric-correlation::click-find-correlation::charts-view","data-testid":"metricCorrelation-find",small:!0,margin:[0,2,0,0],feature:"MetricCorrelations"})}),(0,re.jsx)(gn.A,{content:"Close",align:"bottom",children:(0,re.jsx)(wo,{neutral:!0,flavour:"borderless",onClick:D,"data-ga":"metric-correlation::click-close::charts-view","data-testid":"metricCorrelation-close",icon:"x",feature:"MetricCorrelations"})})]})]})};var ko=n(98383),Ao=n(88434);const So={overview:ko.A,default:null},To=(0,x.memo)((e=>{let{flavour:t,...n}=e;const{showCorrelation:o}=(0,Ao.A)(),r=So[t]||So.default;return(0,re.jsx)(te.Flex,{alignItems:!o&&"center",background:"mainBackground",column:o,"data-testid":"overview-header",gap:2,justifyContent:o?"start":"between",padding:[0,2,0,4],width:"100%",children:o?(0,re.jsx)(Co,{flavour:t}):!!r&&(0,re.jsx)(r,{...n,flavour:t})})})),Fo=To;var No=n(27024),Mo=n(98591);const Do=e=>{let{id:t,...n}=e;return(0,re.jsx)(Xe.h,{id:t,...n,children:(0,re.jsx)(Ze.$,{id:t,hasTooltip:!0,flavour:n.extraKey,enableFavourites:!0,level:n.level,descendantIds:n.descendantIds,selfChartIds:n.selfChartIds})})},Po=(0,x.memo)(Do);var Bo=n(5020),Ro=n(80744),$o=n(64156),Lo=n(28973),zo=n(52795),_o=n(23565);const Oo=(0,K.eU)(null),Vo=()=>{const e=(0,Tt.eg)(),t=(0,E.md)(Oo);return e&&e.getRoot().getChildren().find((e=>e.match({id:t})))},Eo=e=>t=>`overview-page::${e.getAttribute("id")}::${t}`;var Ko=n(54251);const Uo=[],Ho=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{selectedDimensions:e.dimensions?Object.keys(e.dimensions):Uo,selectedInstances:e.instances?Object.keys(e.instances):Uo,selectedNodes:e.nodes?Object.keys(e.nodes):Uo,weight:e.weight}},Wo=e=>{let{style:t,handleProps:n,attributes:o,listeners:r,dragging:a,dragOverlay:i,id:s,resizeHandle:l,onChangeHeight:d,onRemove:c,expanded:u,ref:h,...g}=e;const m=(0,x.useRef)({}),p=(0,j.ID)(),f=Vo(),{contextScope:b,...v}=(0,Yt.aA)(s),y=(0,Tt.eg)(),{sendLog:w,isReady:I}=(0,Vt.A)(),C=(0,_o.CS)({type:"chart",entity:b?b.join(","):s,path:"/"}),k=(0,x.useMemo)((()=>{if(!f)return null;let e=f.getNode({id:i?`dragOverlay-${s}`:s});if(e)return m.current=(0,zo.A)({...e.getAttributes(),...e.getAttribute("pristine"),pristine:{}}),e;e=y.makeChart({attributes:{id:i?`dragOverlay-${s}`:s,roomId:p,expandable:!1,...v,contextScope:b,expanded:u,toolboxProps:{drag:{...n,...r,...o}}},makeTrack:Eo}),f.appendChild(e),m.current=(0,zo.A)(e.getAttributes());const t=e.getAttribute("chartLibrary");return e.setAttributes({...m.current,...(0,zo.A)(C,!0)}),(0,Ko.A)(e,t,e.getAttribute("chartLibrary")),e}),[f,p,s,i]);(0,x.useLayoutEffect)((()=>{k&&I&&"function"===typeof w&&k.updateAttribute("logOptions",{sendLog:w,payload:{feature:"Overview"}})}),[k,w,I]);const{weight:A,selectedDimensions:S,selectedInstances:T,selectedNodes:F}=(0,Yt.uy)(b.join("|"),Ho);return(0,so.A)((()=>{k&&A&&(k.updateAttributes({selectedDimensions:S,selectedInstances:T,selectedNodes:F}),k.trigger("fetch"))}),[k,p,s,A,S.length,T.length,F.length]),(0,so.A)((()=>{if(!k||!C)return;const e=k.getAttribute("chartLibrary");k.updateAttributes({...m.current,...(0,zo.A)(C,!0)}),(0,Ko.A)(k,e,k.getAttribute("chartLibrary")),k.trigger("fetch")}),[k,p,s,C]),(0,x.useLayoutEffect)((()=>{k&&t&&(k.updateAttributes({height:t.height,width:t.width}),k.trigger("resize"))}),[k,t.height,t.width]),(0,x.useLayoutEffect)((()=>{if(k)return(0,Lo.unregister)(k.onAttributeChange("expanded",(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e===(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return;const{expandedHeight:t}=k.getAttributes();d(s,(e?1:-1)*t)})))}),[k]),(0,so.A)((()=>{k&&k.updateAttributes({toolboxProps:{drag:{...n,...r,...o,dragging:a}}})}),[k,a]),k?(0,re.jsxs)(te.Box,{ref:h,style:t,children:[(0,re.jsx)(Rt.A,{chart:k,"data-chartid":i?`dragOverlay-${s}`:s,"data-track":k.track("container"),height:t.height,width:"100%"}),l]},f&&f.getId()):null},Go=x.memo(Wo,((e,t)=>e.id===t.id&&e.style===t.style)),qo=function(){let{id:e,layout:t={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,Bo.bP)(e,t,{left:0,top:0,width:12,height:6,id:e,chartId:e,...t,minWidth:12,maxWidth:12,minHeight:4,static:!1,dashboardable:!0})},Yo=e=>{let{id:t,menuId:n,subMenuId:o,containerWidth:r,...a}=e;const i=(0,Yt.aA)(t,qo),[s,l]=(0,x.useState)((()=>[i])),d=(e,t)=>{(0,Bo.Q)(t),l(e)},c=(0,x.useRef)(1),u=(e,t)=>{const n=s.findIndex((t=>t.id===e));-1!==n&&(s[n]={...s[n],height:s[n].height+t/Ro.NA,expanded:t>0},d([...s],s[n]),c.current+=1)},h=(0,$o.A)("(max-width: 767px)"),g=(0,x.useMemo)((()=>e=>{let{id:t,...r}=e;return(0,re.jsx)(Go,{id:t,role:"graphics-object","aria-roledescription":"chart","data-menuid":o||n,onChangeHeight:u,...r},t)}),[o,n]);return(0,re.jsx)(Ro.Ay,{cacheId:c.current,rootId:t,containerId:t,onDragEnd:d,items:s,containerWidth:r-(h?16:26),"data-menuid":o||n,...a,Item:g,rearrangeable:!1})},Jo=(0,x.memo)(Yo);var Qo=n(54025),Xo=n(63996);const Zo=e=>{let{id:t,extraKey:n,descendantIds:o,level:r,selfChartIds:a}=e;return(0,re.jsx)(Qo.t,{gap:0,id:t,testId:"chart-sub-menu-container-overview",children:(0,re.jsx)(Xo.t,{id:t,margin:[1,0,0],hasTooltip:!0,flavour:n,enableFavourites:!0,level:r,descendantIds:o,selfChartIds:a})})},er=(0,x.memo)(Zo);var tr=n(4719);const nr=e=>{let{id:t}=e;const n=(0,j.ID)(),o=(0,Tt.eg)(),r=(0,Yt.Vt)(),{chartIds:a}=(0,tr.b)(t),i=Vo(),s=(0,x.useMemo)((()=>{const[e]=a;let s=i.getChildren().find((e=>e.match({id:t})));if(s)return s;const l=a.map((e=>({value:e,label:r(e).context})));return s=o.makeChart({attributes:{id:`custom-k8s-map-${t}`,contextScope:[e],roomId:n,composite:!0,chartLibrary:"groupBoxes",groupBy:["label"],groupByLabel:["k8s_namespace","k8s_pod_name"],aggregationMethod:"avg",eliminateZeroDimensions:!1,contextItems:l,toolboxElements:[]},makeTrack:Eo}),i.appendChild(s),s}),[t,i]);return(0,re.jsx)(Rt.A,{margin:[0,0,2],chart:s,"data-chartid":t,"data-track":s.track("container")},i.getId())},or=e=>{let{id:t,...n}=e;return(0,re.jsxs)(Xe.h,{id:t,padding:[6,0,0],children:[(0,re.jsx)(Ze.$,{id:t}),(0,re.jsx)(et.n,{id:t,padding:[2,0,0]}),(0,re.jsx)(nr,{id:t,...n})]})},rr=(0,x.memo)(or),ar=(0,Yt.BK)((e=>{let{style:t,id:n,menuChartAttributes:o,resizeHandle:r,handleProps:a,listeners:i,dragging:s,dragOverlay:l,onChangeHeight:d,expanded:c,ref:u,...h}=e;const g=(0,x.useRef)({}),m=(0,j.ID)(),p=(0,Tt.eg)(),f=Vo(),b=(0,_o.CS)({type:"chart",entity:n,path:"/"}),v=(0,x.useMemo)((()=>{let e=f.getChildren().find((e=>e.match({id:l?`dragOverlay-${n}`:n})));if(e)g.current=(0,zo.A)({...e.getAttributes(),...e.getAttribute("pristine")});else{e=p.makeChart({attributes:{expandable:!1,...o,roomId:m,id:l?`dragOverlay-${n}`:n,isHead:!0,expanded:c},makeTrack:Eo,toolboxProps:{drag:{...a,...i}}}),g.current=(0,zo.A)(e.getAttributes());const t=e.getAttribute("chartLibrary");e.setAttributes({...g.current,...(0,zo.A)(b,!0)}),(0,Ko.A)(e,t,e.getAttribute("chartLibrary")),f.appendChild(e)}return e}),[m,n,f]);(0,so.A)((()=>{if(!v||!b)return;const e=v.getAttribute("chartLibrary");v.updateAttributes({...g.current,...(0,zo.A)(b,!0)}),(0,Ko.A)(v,e,v.getAttribute("chartLibrary")),v.trigger("fetch")}),[v,m,n,b]),(0,x.useLayoutEffect)((()=>{v.updateAttributes({toolboxProps:{drag:{...a,...i,dragging:s}}})}),[v,s]),(0,x.useLayoutEffect)((()=>{if(v)return(0,Lo.unregister)(v.onAttributeChange("expanded",(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e===(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return;const{expandedHeight:t}=v.getAttributes();d(n,(e?1:-1)*t)})))}),[v]);return(0,we.Bu)(o.contextScope)?(0,re.jsxs)("div",{ref:u,style:t,children:[(0,re.jsx)(Rt.A,{chart:v,"data-track":v.track("container"),"data-chartid":l?`dragOverlay-${n}`:n,height:t.height,width:"100%"}),r]},f.getId()):null})),ir=(e,t,n)=>(e.layout||console.warn(t,"has no layout set, default values will be used."),(0,Bo.bP)(t,e.layout,{left:n%2,top:4*parseInt(n/2),width:6,height:4,id:e.id,contextScope:e.contextScope,minWidth:1,minHeight:1,static:!1,dashboardable:!0})),sr={k8s:rr,root:Po,submenu:er,chart:Jo,grid:(0,x.memo)((e=>{let{itemIds:t,containerWidth:n,id:o,subMenuId:r,menuId:a}=e;const i=(0,Yt.dd)(t,ir),{filteredChartsCount:s}=(0,qn.Ad)(),[l,d]=(0,x.useState)((()=>i)),c=(e,t)=>{(0,Bo.Q)(t),d(e)},u=(0,x.useRef)(1),h=(0,we.bD)(),g=(0,x.useMemo)((()=>l.filter((e=>!!e&&(!!e.contextScope&&h(e.contextScope))))),[t,l,s]),m=(0,$o.A)("(max-width: 767px)");return g.length?(0,re.jsx)(Ro.Ay,{cacheId:u.current,rootId:o,containerId:o,"data-chartid":o,"data-menuid":r||a,onDragEnd:c,items:g,containerWidth:n-(m?16:26),gridTracks:m?1:12,Item:ar,rearrangeable:!1,itemProps:{onChangeHeight:(e,t)=>{const n=l.findIndex((t=>t.id===e));-1!==n&&(l[n]={...l[n],height:l[n].height+t/Ro.NA,expanded:t>0},c([...l],l[n]),u.current+=1)}},compactType:"horizontal"}):null}),((e,t)=>e.itemIds===t.itemIds&&e.containerWidth===t.containerWidth))},lr=e=>{if(sr[e.flavour])return sr[e.flavour];switch(e.level){case 0:return Po;case 1:return er;case 2:return Jo;default:return null}},dr=e=>{let{flavour:t,onChartNameChange:n,initialChartName:o,dashboardOptions:r,linkToGo:a,contextToGo:i,containerWidth:s}=e;const[l,,,d]=(0,Mo.A)("addToDashboardModal"),{setActiveMenuId:c}=(0,Je.A)({onChartNameChange:n,initialChartName:o,linkToGo:a,contextToGo:i});return(0,re.jsxs)(Z.H,{children:[(0,re.jsx)(Qe.A,{flavour:t,onActiveMenuId:c,getComponent:lr,dashboardOptions:r,initialChartName:o,containerWidth:s}),l&&(0,re.jsx)(No.A,{onClose:d})]})};var cr=n(19075);const ur=(0,x.memo)((()=>{const[e,t]=(0,cr.KB)(),n=(0,Tt.eg)(),o=!!e&&!!n&&n.getNode({id:e.context}),r=()=>{if(t(null),!e?.context||!o)return;const n={...o.getAttribute("overlays")};delete n.alert,o.updateAttribute("overlays",n),history.replaceState({},"")};(0,x.useEffect)((()=>r),[]);const a=(0,j.ID)(),i=(0,we.R7)(e?.context&&a,e?.context);if(!e||!i?.loaded)return null;const{firstEntry:s}=i;return(0,re.jsx)(te.Layer,{backdrop:!1,position:"top",margin:[26,0,0],padding:[26,0,0],children:(0,re.jsxs)(te.Flex,{background:"tooltip",padding:[1,2],gap:2,children:[(0,re.jsxs)(te.TextSmall,{children:["Showing alert in ",(0,re.jsx)(te.TextSmall,{strong:!0,children:e.instance})," on"," ",(0,re.jsx)(te.TextSmall,{strong:!0,children:new Date(1e3*e.lastStatusChange).toLocaleString()}),!s&&" doesn't exist on the node anymore",!!s&&s>e.lastStatusChange&&" exceeds agent data retention settings"]}),(0,re.jsx)(te.Flex,{flex:!1,children:(0,re.jsx)(te.Icon,{name:"x",color:"tooltipText",onClick:r,size:"small"})})]})})})),hr=ur,gr={NoChartsView:Gn,NoNodesView:P.A,sidebar:{title:"Filters",hiddenTabs:["info"],Component:ee.Ay,props:{}},dashboardOptions:{},loadingMessage:"Loading charts...",Header:Fo},mr={overview:{...gr,sidebar:{...gr.sidebar,title:"Metrics"},feature:"Overview"},k8s:{...gr,NoChartsView:ao,NoNodesView:ao,sidebar:{...gr.sidebar,title:"Kubernetes"},loadingMessage:"Loading k8s charts...",feature:"Kubernetes"},singleNode:{...gr,sidebar:{...gr.sidebar,title:"Single Node",hiddenTabs:["filters"],props:{showCollapsed:!0}},feature:"SingleNode"}},xr=()=>((0,On.A)(),null),pr=(0,x.memo)((e=>{let{flavour:t="overview",invalidationKey:n,nodeIds:o,loaded:r,getChart:a,chartIds:i,areChartsIdsEmpty:s,showNoChartsView:d,showNoNodesView:c,initializing:u,chartName:h,setChartName:g,chartsLoaded:m,widthRef:x,containerWidth:p,nodesKey:b,blurred:v,blurProps:j={},BlurredContent:y,noPreferredNodesError:w}=e;const{dashboardOptions:I,NoChartsView:C,NoNodesView:k,sidebar:A,loadingMessage:S,Header:T,feature:F="Overview"}=mr[t],{state:N}=(0,f.zy)(),M=Vo();return c?(0,re.jsx)(B.Ay,{feature:F,mode:"NoNodesView",children:(0,re.jsx)(k,{})}):u?(0,re.jsx)(Vn.A,{title:"Please wait while charts are being initialized.",body:"Thank you for your patience!"}):r?(0,re.jsx)(B.Ay,{feature:F,children:(0,re.jsxs)(Z.A,{getObject:a,ids:i,linkToGo:N?.chartName,extraKey:t,deps:[b],children:[(0,re.jsx)(xr,{}),(0,re.jsx)(hr,{}),(0,re.jsxs)($.A,{ref:x,sidebar:(0,re.jsx)(A.Component,{nodeIds:o,title:A.title,initialChartName:h,hiddenTabs:A.hiddenTabs,flavour:t,loaded:m,FilterInputContainer:to,...A.props}),blurred:v,blurProps:j,BlurredContent:y,children:[(0,re.jsx)(T,{flavour:t}),m||w?d||s?(0,re.jsx)(C,{noPreferredNodesError:w}):(0,re.jsx)(dr,{flavour:t,dashboardOptions:I,initialChartName:h,onChartNameChange:g,linkToGo:N?.chartName,contextToGo:N?.contextToGo,containerWidth:p}):(0,re.jsx)(l.O2,{}),(0,re.jsx)(_n,{container:M})]})]},n)}):(0,re.jsx)(l.O2,{})})),fr=pr,br=e=>t=>{const n=(0,z.nl)(),o=(0,x.useMemo)((()=>[n]),[n]);return(0,re.jsx)(e,{flavour:"singleNode",nodeIds:o,nodeId:n,...t},n)};var vr=n(1817),jr=n(64867),yr=n(12407),wr=n(17829);var Ir=n(13752),Cr=n(92815),kr=n(72582),Ar=n(82650),Sr=n(9439),Tr=n(95980),Fr=n(91832),Nr=n(6504),Mr=n(22332),Dr=n(62709);const Pr=(0,io.default)(te.Icon).withConfig({displayName:"styled__StyledAlertDot",componentId:"sc-12w0ym-0"})(["position:absolute;top:0;right:-1px;width:6px;height:6px;"]);var Br=n(96026);const Rr={events:{extraKey:"feedFilters",page:"events",alertNamesKey:"alert_names",period:{after:-n(71336).d_,before:0}},alerts:{extraKey:"alerts",page:"alerts",alertNamesKey:"alertNames"}},$r=function(){let{flavour:e="events"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=(0,j.ID)(),n=(0,f.Zp)(),[o,r]=(0,Jn.Ay)(),a=(0,cr.le)(),[,i]=(0,cr.DV)(),s=(0,V.rI)(),{extraKey:l,page:d,alertNamesKey:c,period:u}=Rr[e]||Rr.events,h={defaultValue:[],key:t,extraKey:l,flavour:"arr",merge:!1},g=(0,V.rI)("alertContexts",h),m=(0,V.rI)(c,h),p=(0,V.rI)("chart_names",h),b=(0,x.useCallback)((e=>{let{name:t}=e;a(1),i({alertName:t,nodeId:null}),n(`/spaces/${o}/rooms/${r}/alerts`,{replace:!0})}),[n,o,r,a,i]),v=(0,x.useCallback)((e=>{let{context:t,name:a,instance:i}=e;u&&s((e=>({...e,...u}))),t&&g([t]),a&&m([a]),i&&p([i]),n(`/spaces/${o}/rooms/${r}/${d}`)}),[n,d,u,o,r,s,g,m,p]);return{goToAlerts:v,goToAlertConfigurations:b}};var Lr=n(39423);const zr=(0,It.A)((e=>{let{alertName:t,close:n,tooltip:o,...r}=e;const{setSelectedTab:a}=(0,Lr.A)(),{goToAlerts:i}=$r({flavour:"alerts"}),{sendLog:s}=(0,Vt.A)(),l=(0,x.useCallback)((e=>{e.stopPropagation(),s({feature:"MetricsChartManageAlerts",description:"Show alert",alertName:t}),a(0),n(),i({name:t})}),[a,i,n,s]);return(0,re.jsx)(te.IconButton,{icon:"goToNode",iconColor:"textLite",onClick:l,neutral:!0,padding:[0],width:"16px",height:"16px",...r})})),_r=(0,It.A)((e=>{let{alertName:t,nodes:n,close:o,tooltip:r,...a}=e;const{goToEdit:i}=(0,Br.q)({alertName:t,nodeIds:n}),{sendLog:s}=(0,Vt.A)(),l=(0,x.useCallback)((e=>{e.stopPropagation(),s({feature:"MetricsChartManageAlerts",description:"Edit alert",alertName:t}),i(),o()}),[n,o,i,s]);return(0,re.jsx)(te.IconButton,{icon:"pencilOutline",iconColor:"textLite",onClick:l,neutral:!0,padding:[0],width:"12px",height:"12px",...a})})),Or=e=>{let{item:{value:t,label:n,alerts:o={},nodes:r,disabled:a,onClick:i,...s},index:l,style:d,close:c,onItemClick:u,...h}=e;const{cl:g=0,cr:m=0,wr:x=0}=o,p=!!x||!!m,f={text:m,flavour:m?"error":"disabledError"},b={text:x,flavour:x?"warning":"disabledWarning"},v={text:g,flavour:g?"clear":"disabledClear"};return(0,re.jsxs)(te.MenuItemContainer,{"data-index":l,disabled:a,onClick:e=>{i&&i(e)},...s,...h,style:d,alignItems:"center",justifyContent:"between",gap:2,padding:[1,2],overflow:"hidden",cursor:"default",children:[(0,re.jsx)(te.Flex,{width:{max:"180px"},alignItems:"center",children:(0,re.jsx)(zt.A,{text:n,TextComponent:te.Text})}),(0,re.jsxs)(te.Flex,{alignItems:"center",gap:1,children:[(0,re.jsx)(te.MasterCard,{pillLeft:f,pillRight:b,pillEnd:v}),(0,re.jsx)(zr,{alertName:t,close:c,tooltip:p?"Show in active alerts":"",tooltipProps:{align:"bottom"},disabled:!p}),(0,re.jsx)(_r,{alertName:t,nodes:r,close:c,tooltip:"Edit this alert configuration",tooltipProps:{align:"bottom"}})]})]})};var Vr=n(7134),Er=n(41395),Kr=n(76661),Ur=n(21885),Hr=n(73087);const Wr=function(e){let{fallback:t="*",transform:n=e=>e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Array.isArray(e)&&e.length?e.map(n).join("|").replace(/\|+/g,"|"):t},Gr=function(){let{entityProps:e,context:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=(0,Kr.A)(),[,o]=(0,Ot.QH)();return(0,x.useCallback)((r=>{let{context:a=t,entityProps:i=e,aggregationMethod:s,groupingMethod:l,selectedDimensions:d,selectedLabels:c,selectedInstances:u,viewUpdateEvery:h,selectedNodeLabelsFilter:g,after:m,before:x,title:p}=r;const[f,b]=(e=>{if(!e)return["average",null];const t=e.match(/([a-zA-Z]+)(\d+)/);if(!t)return["average",null];const[,n,o]=t;return[n.toLowerCase(),parseInt(o,10)]})(l),v=(j=u,Array.isArray(j)&&0!==j.length?j.map((e=>{const t=e.split("@");return t.length>1?t[0]:e})).join("|"):"");var j;const y=m?m<0?Math.max(m,-600):Math.max(parseInt(-1*(x-m)/1e3,10),-600):-600,w=(e=>{if(!e)return"";const t=(0,Hr.F)({start:0,end:e});return`${(0,Vr.Vj)(t)}`})(Math.abs(1e3*y)),I="avg"===s?"average":s||"sum",C=`${(0,Er.Zr)(I)} of ${p} over ${w}`,k={format_version:1,rules:[{enabled:!0,type:v?"instance":"template",config:{match:{on:v||a,host_labels:Wr(g),instance_labels:Wr(c)},value:{database_lookup:{data_source:"samples",time_group:f,time_group_value:b,after:y,before:0,dims_group:I,dimensions:Wr(d),options:["unaligned"]},update_every:Math.min(h,60)||60},summary:p,info:C,type:"",component:"",classification:""}}],name:(0,Er.Yv)(`${w} ${p}`,{underscored:!0})};o(n({template:Ur.Sd,formData:k,entityProps:i}))}),[n,o,e])},qr=(0,Re.A)((0,It.A)(te.Button)),Yr=e=>{let{loaded:t,contexts:n=[],close:o}=e;const r=(0,Mr.useChart)(),a=r.getId(),i=n?.[0],s=(0,Mr.useAttributeValue)("nodes"),{setState:l}=(0,Ot.$h)(),{setSelectedTab:d}=(0,Lr.A)(),[c,u]=(0,Jn.Ay)(),{goToAlerts:h}=$r({flavour:"alerts"}),{value:g}=(0,Ot.wd)({node:{value:Object.keys(s)[0]},path:Ur.$7}),m=Gr(),p=(0,_.u7)({extraKey:Ur.q4}),b=(0,f.Zp)(),v=(0,x.useMemo)((()=>i?`View the active alerts for ${i} context`:"View the active alerts for this context"),[i]),j=(0,x.useCallback)((()=>{i&&(d(0),o(),h({context:i}))}),[i,h,d,c,u,o]),y=(0,x.useCallback)((()=>{if(t&&i){const{tree:e}=g||{},t=e?.[Ur.$7]?.[Ur.Sd],{nodes:n,selectedNodes:a,aggregationMethod:s,groupingMethod:d,selectedDimensions:u,selectedLabels:h,selectedInstances:x,viewUpdateEvery:f,selectedNodeLabelsFilter:v,after:j,before:y,title:w}=r.getAttributes(),I=a.length?a:Object.values(n).map((e=>{let{nd:t}=e;return t}));l({isAlert:!0}),m({entityProps:t,context:i,aggregationMethod:s,groupingMethod:d,selectedDimensions:u,selectedLabels:h,selectedInstances:x,viewUpdateEvery:f,selectedNodeLabelsFilter:v,after:j,before:y,title:w}),b(`/spaces/${c}/settings/configurations`,{replace:!0}),p(I),o()}}),[t,m,p,l,i,s,g,b,c,o]);return(0,re.jsxs)(te.Flex,{gap:2,padding:[2],border:{side:"top"},justifyContent:"center",children:[(0,re.jsx)(qr,{feature:"MetricsChartManageAlerts",label:"Go to alerts",small:!0,flavour:"hollow",icon:"goToNode",onClick:j,tooltip:v,tooltipProps:{align:"bottom"},payload:{chartId:a},disabled:!i||!t}),(0,re.jsx)(qr,{feature:"MetricsChartManageAlerts",label:"Add alert",small:!0,icon:"plus",onClick:y,tooltip:`Start adding a new alert on ${i} context`,tooltipProps:{align:"bottom"},payload:{chartId:a},disabled:!i||!t})]})},Jr=e=>{let{disabled:t}=e;const n=(0,Mr.useChart)(),{loaded:o,items:r,status:a}=(e=>{const[t,n]=(0,x.useState)(),[o,r]=(0,x.useState)([]),[a,i]=(0,x.useState)([]),[s,l]=(0,x.useState)();return(0,x.useEffect)((()=>{const t=()=>{const t=e.getAttribute("alerts"),o=Object.values(t||{}),a=Object.keys(e.getAttribute("nodes")||{});n(!0),r(o),i(a);for(let e=0;e<=o.length;e++){const{wr:t=0,cr:n=0}=o[e]||{};if(n>0){l("error");break}if(t>0){l("warning");break}}};return e&&e.on("successFetch",t),()=>{e&&e.off("successFetch",t)}}),[e,n,r,i,l]),{loaded:t,items:(0,x.useMemo)((()=>[...o.map((e=>{let{nm:t,cl:n,wr:o,cr:r}=e;return{value:t,label:t,alerts:{cl:n,wr:o,cr:r},nodes:a}}))]),[o,a]),status:s}})(n),i=n.getAttribute("contextScope");return n?(0,re.jsx)(re.Fragment,{children:(0,re.jsx)(te.Menu,{dropProps:{align:{top:"bottom",right:"right"},"data-toolbox":n.getId()},dropdownProps:{width:"360px"},Item:Or,items:r,Footer:e=>{let{close:t}=e;return(0,re.jsx)(Yr,{loaded:o,contexts:i,close:t})},children:(0,re.jsxs)(te.Flex,{alignItems:"center",position:"relative",children:[a?(0,re.jsx)(Pr,{name:"dot",color:a}):null,(0,re.jsx)(Nr.Button,{icon:(0,re.jsx)(Nr.default,{svg:Dr.A,size:"16px"}),title:"Manage alerts",disabled:t,"data-testid":"chartHeaderToolbox-manageAlerts"})]})})}):null},Qr=(e,t,n)=>{let{width:o,host:r}=n;if(!r)throw"No host provided";const a=(0,Tt.eg)(),i=(0,x.useRef)(),s=(0,we.aZ)(e,"error"),[{correlation:l},d]=(0,V.N9)(),{state:c,pathname:u}=(0,f.zy)(),h=(0,E.Xr)(Oo),g=(0,we.jI)(e),m=(0,we.DQ)(e);(0,x.useLayoutEffect)((()=>{if(!e||!a||s)return;let n=a.getRoot().getChildren().find((e=>e.match({id:u})));if(!n)return n=a.makeContainer({attributes:{id:u,roomId:e,host:r,navigation:l?"highlight":"pan",overlays:{proceeded:{type:"proceeded"}},composite:!0,nodesScope:t,hasCorrelation:!0,versions:g,containerWidth:o,toolboxElements:[...N.Dm?[Jr]:[],Sr.default,kr.default,Ir.default,Cr.default,Ar.default,Fr.A,Tr.A]}}),a.appendChild(n),h(u),i.current=n,(0,Lo.unregister)(a.on("correlation",((e,t)=>{if(!Array.isArray(t))return;const[n,o]=t;d((e=>({...e,highlight:{after:1e3*n,before:1e3*o},correlation:!0})))})),n.onAttributeChange("versions",m));h(u)}),[e,s,u,r]),(0,x.useMemo)((()=>{i.current&&(i.current.setAttribute("containerWidth",o),i.current.getNodes().forEach((e=>e.updateAttribute("containerWidth",o))))}),[i.current,o]),(0,so.A)((()=>{i.current&&i.current.setAttribute("host",r)}),[i.current,r]),(0,so.A)((()=>{i.current&&i.current.getNodes().forEach((e=>{e.updateAttribute("nodesScope",t);e.getAttribute("active")&&"chart"===e.type&&e.fetch()}))}),[i.current,t]),(0,x.useEffect)((()=>{i.current&&i.current.getApplicableNodes({syncHighlight:!0}).forEach((e=>{e.updateAttribute("navigation",l?"highlight":"pan")}))}),[i.current,l]),(0,x.useEffect)((()=>()=>i.current&&i.current.destroy()),[]),(0,x.useEffect)((()=>{if(!i.current)return;if(!c||!c.context)return;const{context:e,chartId:t,nodeId:n}=c,o=i.current.getNode({id:e});o&&o.updateAttributes({selectedInstances:[`${t}@${n}`],selectedNodes:[n]});const r=t&&n&&i.current.on("chartLoaded",(o=>{const a=o.getAttribute("id");e===a&&(o.updateAttributes({selectedInstances:[`${t}@${n}`],selectedNodes:[n]}),r())}));return()=>c&&(0,Lo.unregister)(r)}),[i.current,c])};var Xr=n(43116);const Zr={default:{shouldHide:()=>!1},k8s:{shouldHide:e=>{let{context:t}=e;return!t.includes("k8s")}}},ea=[],ta="ErrNoPreferredNodeRequested",na=e=>(0,x.memo)((t=>{let{flavour:n="overview",nodeIds:o=ea,nodeId:r,...a}=t;const i=(0,v.vt)(),s=(0,j.ID)(),l=(0,j.XA)("nodeId");r=r||l;let d=(0,_.w7)({extraKey:n,merge:!1,scoped:!0});d=o.length?o:d;const{isNodeRestricted:c,loaded:u}=(0,Kt.A)();d=(0,x.useMemo)((()=>d.filter((e=>!c(e).restricted))),[d,u]);const h=(0,D.nj)(),g=(0,we._0)(s),{state:m}=(0,f.zy)(),p=(0,we.R7)(s),b=(0,z.TG)(d),y=(0,ye.A)(s,d,{spaceId:i}),{contexts:w,metadata:I,loaded:C,dimensionsCount:k}=(0,lo.Yy)({nodeIds:d,flavour:n},i,s),[,A]=(()=>{const{state:e={}}=(0,f.zy)(),{alertId:t=null}=e||{},[n,o]=(0,cr.KB)(),r=t||n?.id,a=(0,cr.JL)(r);(0,cr.yk)(a.id),(0,x.useEffect)((()=>{(a.fullyLoaded||a.id)&&o({...a,formattedLastStatusChangeValue:(0,wr.m3)(a.lastStatusChangeValue,a.units),linkToGo:(0,Ve.A)(a.context)})}),[a.id,a.fullyLoaded]);const i=n?.id?(0,Ve.A)(n.context):null;return[a.id,i]})(),S=o?o.join():n,T=(0,X.K)({spaceId:i,roomId:s}),[F,{width:N}]=(0,R.A)();Qr(s,d,{host:T,width:N});const M=(0,we.OL)(s),P=(0,we.rx)(s),B=C?I:p,$=Zr[n]||Zr.default,L=(0,we.bo)(s),O=(0,vr.A)(L),E=(0,qn.rq)(M,p,s,{...$,shouldHide:C?e=>{let{context:t}=e;return!w.includes(t)}:$.shouldHide,force:C||L!==O,cacheKey:`${n}-${k}-${S}`}),K=(0,we.yO)(s,I),U=(0,vr.A)(y,!0),H=E<1,[W,G]=(0,V.N9)("chartName",{key:s,extraKey:S,flavour:"val"});(0,x.useEffect)((()=>{s&&G(A||m?.chartName||W)}),[s,A]);const q=Vo(),Y=Object.keys(B).length<1&&g||d.length&&!b.length,J=(0,D.CK)(),Q=P?.errorMsgKey==ta;if(!Y&&!1!==U&&y&&"No data for this period"!==y&&y!==ta&&!Object.keys(B).length)return(0,re.jsx)(Xr.A,{error:y});const Z=!!s&&h&&(!!q||Q),{restricted:ee}=c(r);return(0,re.jsx)(e,{nodeIds:b,loaded:Z,getChart:K,areChartsIdsEmpty:H,showNoNodesView:h&&!J.length,showNoChartsView:Y,initializing:y&&(0,jr.O)(y),chartName:W,setChartName:G,chartsLoaded:g&&!!N,invalidationKey:s,flavour:n,chartIds:C?w:M,widthRef:F,containerWidth:N,nodesKey:S,noPreferredNodesError:Q,blurred:ee,blurProps:{value:"12px"},BlurredContent:()=>(0,re.jsx)(yr.A,{flavour:l?"room":"node"}),...a})}));var oa=n(7761);const ra=(0,r.A)((()=>n.e(1608).then(n.bind(n,61608))),"Contents"),aa=()=>{const[e,t]=(0,oa.A$)();return e?(0,re.jsx)(x.Suspense,{fallback:"",children:(0,re.jsx)(ra,{id:e,onClose:()=>t(null)})}):null},ia=(0,It.A)(te.Icon),sa=e=>{let{title:t,icon:n,iconColor:o,...r}=e;return(0,re.jsxs)(te.Flex,{alignItems:"center",gap:2,...r,children:[n&&(0,re.jsx)(te.Icon,{name:n,...o?{color:o}:{}}),(0,re.jsx)(te.TextBig,{children:t})]})},la={ErrNoEligibleNodeRequested:"There are no eligible nodes.",default:"Something went wrong."},da=e=>{let{titleProps:t,loading:n,error:o,children:r,...a}=e;const i={padding:[4],gap:4,background:"panelBg",...t?{column:!0}:{}},s=o?la[o.errorMsgKey]||la.default:null;return(0,re.jsxs)(te.Flex,{...i,...a,children:[t?(0,re.jsx)(sa,{...t}):null,n?(0,re.jsx)(te.Text,{textAlign:"center",children:"Loading..."}):o?null:(0,re.jsx)(re.Fragment,{children:r}),s?(0,re.jsx)(te.Flex,{width:"100%",justifyContent:"center",children:(0,re.jsx)(ia,{name:"warning_triangle",size:"large",color:"text",tooltip:s})}):null]})},ca=e=>function(){let{title:t="",headerInfo:n,containerProps:o={},TitleComponent:r=te.TextBigger,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,re.jsxs)(te.Flex,{column:!0,gap:2,alignItems:"center",justifyContent:"center",...o,children:[t&&(0,re.jsxs)(te.Flex,{gap:2,alignItems:"center",children:[(0,re.jsx)(r,{children:t}),n]}),(0,re.jsx)(e,{...a})]})},ua=ca((e=>{let{number:t=0,NumberComponent:n=te.TextHuge}=e;return(0,re.jsx)(n,{strong:!0,children:t})})),ha=e=>{const t=e.reduce(((e,t)=>{let{value:n}=t;return e+n}),0);return e.map((e=>({...e,width:`${Math.floor(e.value/t*100)}%`})))},ga=function(){let{data:e=[],testId:t="",numberIndicatorProps:n={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,re.jsxs)(te.Flex,{width:"100%",column:!0,gap:2,children:[(0,re.jsx)(te.Flex,{justifyContent:"around",children:e.map((e=>{let{label:t,value:o}=e;return(0,re.jsx)(ua,{title:t,number:o,...n},`${t}-${o}`)}))}),(0,re.jsx)(te.ProgressBar,{background:"borderSecondary",border:"none",containerWidth:"100%","data-testid":t,height:2,value:ha(e.filter((e=>{let{omit:t}=e;return!t})))})]})},ma=ca((e=>{let{nodesLoaded:t,total:n,count:o,live:r,offline:a,stale:i,unseen:s,...l}=e;const d=(0,x.useMemo)((()=>[...[{label:"Live",value:r,color:"success"},{label:"Offline",value:a,color:"offline"},{label:"Stale",value:i,color:"stale"}],...s?[{label:"Unseen",value:s,color:"unseen"}]:[]]),[r,a,i,s]);return(0,re.jsxs)(te.Flex,{width:"100%",column:!0,alignItems:"center",gap:4,children:[(0,re.jsxs)(te.Flex,{gap:2,alignItems:"baseline",children:[t?(0,re.jsx)(te.TextHuge,{strong:!0,...l,children:o}):(0,re.jsx)(te.Text,{children:"Loading..."}),t&&n!=o&&(0,re.jsxs)(te.Text,{children:["of ",n]})]}),(0,re.jsx)(ga,{data:d,numberIndicatorProps:{TitleComponent:te.TextBig,NumberComponent:te.TextBigger}})]})})),xa=e=>{const t=(0,D.nj)(),n=(0,D.CK)(),o=n.length,r=(0,_.eO)({keepAll:!1}),a=(0,x.useMemo)((()=>r.reduce(((e,t)=>{let{isLive:n,isOffline:o,isUnseen:r,state:a}=t;return{live:n?e.live+1:e.live,offline:o?e.offline+1:e.offline,stale:"stale"==a?e.stale+1:e.stale,unseen:r?e.unseen+1:e.unseen}}),{live:0,offline:0,stale:0,unseen:0})),[r]),i=(0,x.useMemo)((()=>{const e=r?.length||"-";return{nodesLoaded:t,total:o,count:e,title:t&&r&&o!=e?"Selected nodes":"Total nodes",...a}}),[t,n,r,o,a]);return(0,re.jsx)(ma,{...i,...e})};var pa=n(9708);const fa=(0,io.default)(te.TextSmall).withConfig({displayName:"pieChartLabels__StyledText",componentId:"sc-3919ls-0"})(["display:flex;align-items:center;cursor:",";&:hover{opacity:",";}"],(e=>{let{onClick:t}=e;return t?"pointer":"auto"}),(e=>{let{onClick:t}=e;return t?"0.7":"1"})),ba=(0,x.memo)((e=>{let{title:t,value:n,color:o,onClick:r=null}=e;return(0,re.jsxs)(te.Flex,{alignItems:"center",justifyContent:"between",width:"100%",gap:4,flex:{grow:1,shrink:0},children:[(0,re.jsxs)(te.Flex,{gap:1,children:[(0,re.jsx)(te.Flex,{width:"4px",height:"16px",background:o}),(0,re.jsxs)(fa,{whiteSpace:"nowrap",onClick:r,children:[t,r&&(0,re.jsx)(te.Icon,{color:"textLite",margin:[0,0,0,1],name:"nav_arrow_goto",height:"10px",width:"10px"})]})]}),(0,re.jsx)(te.Text,{strong:!0,children:n??"-"})]})})),va=e=>{let{data:t}=e;return(0,re.jsx)(te.Flex,{column:!0,alignItems:"start",justifyContent:"center",gap:5,children:t.map(((e,t)=>{let{title:n,value:o,color:r,onClick:a}=e;return(0,re.jsx)(ba,{title:n,value:o,color:r,onClick:a},`${n}-${o}-${t}`)}))})},ja=e=>{let{data:t,theme:n}=e;return t.map((e=>({...e,color:(0,te.getColor)(e.color)({theme:n})})))},ya=e=>{let{chartData:t=[],lineWidth:n=15,animate:o=!0,label:r,hasData:a}=e;const i=(0,x.useContext)(io.ThemeContext);return(0,re.jsxs)(te.Flex,{gap:4,margin:[0,4],height:{min:"70px",max:"130px"},alignItems:"center",children:[(0,re.jsx)(te.Flex,{height:"70px",flex:{grow:1,shrink:1},children:a?(0,re.jsx)(pa.r,{label:()=>r,labelStyle:{fontSize:"34px",fontWeight:700,lineHeight:"38px",fill:(0,te.getColor)("textDescription")({theme:i})},labelPosition:0,data:ja({data:t,theme:i}),lineWidth:n,animate:o}):(0,re.jsx)(te.Icon,{color:"border",name:"pie_chart_skeleton",width:"70px",height:"70px",alignSelf:"center"})}),(0,re.jsx)(va,{data:t})]})};var wa=n(56473);const Ia=ca((e=>(0,re.jsx)(te.Flex,{gap:2,justifyContent:"between",padding:[2,0,0,0],children:(0,re.jsx)(ya,{...e})}))),Ca=e=>{const t=(0,wa.QD)({extraKey:"alerts"}),{critical:n,warning:o}=(t||[]).reduce(((e,t)=>{let{status:n}=t;return{...e,[n]:e[n]+1}}),{critical:0,warning:0}),r=(0,wr.x7)(),a=(0,x.useMemo)((()=>({chartData:[{title:"Critical",value:n,color:"errorText",onClick:()=>r("critical")},{title:"Warning",value:o,color:"warningText",onClick:()=>r("warning")}],hasData:!!t?.length,label:t?.length})),[n,o,r]);return(0,re.jsx)(Ia,{title:"Active alerts",...a,...e})},ka=()=>(0,re.jsxs)(te.Flex,{column:!0,gap:4,basis:"205px",children:[(0,re.jsx)(xa,{}),(0,re.jsx)(En.A,{}),(0,re.jsx)(Ca,{})]});var Aa=n(63950),Sa=n.n(Aa),Ta=n(31522);const Fa=e=>{let{label:t,color:n}=e;return(0,re.jsxs)(te.Flex,{height:"32px",gap:1,alignItems:"center",children:[(0,re.jsx)(te.Flex,{width:"12px",height:"12px",background:n}),(0,re.jsx)(te.Text,{children:(0,Er.Zr)(t)})]})},Na=e=>{let{colorBy:t}=e;const n=Object.entries(Ta.Cc[t?.value]||{}),o=Ta.Ug[t?.value]||{};return n.length?(0,re.jsx)(te.Flex,{gap:2,children:n.map((e=>{let[t,n]=e;return(0,re.jsx)(Fa,{label:o[t]||t,color:n},t)}))}):null},Ma=e=>{let{groupBy:t,setGroupBy:n=Sa(),colorBy:o,setColorBy:r=Sa(),onAddNode:a}=e;return(0,re.jsxs)(te.Flex,{alignItems:"end",justifyContent:"between",children:[(0,re.jsxs)(te.Flex,{gap:3,alignItems:"end",children:[(0,re.jsxs)(te.Flex,{column:!0,gap:1,children:[(0,re.jsx)(te.Text,{children:"Group by"}),(0,re.jsx)(te.Select,{options:Ta.XJ,value:t,onChange:n})]}),(0,re.jsxs)(te.Flex,{column:!0,gap:1,children:[(0,re.jsx)(te.Text,{children:"Color by"}),(0,re.jsx)(te.Select,{options:Ta.Hn,value:o,onChange:r})]}),(0,re.jsx)(Na,{colorBy:o})]}),(0,re.jsx)(me.A,{flavour:"borderless",icon:"add_node",iconColor:"text",onClick:a})]})},Da=(0,io.default)(te.Box).withConfig({displayName:"styled__PolygonContainer",componentId:"sc-9bx1cv-0"})(["width:22px;position:relative;aspect-ratio:1;background-color:",";cursor:",";opacity:",";clip-path:polygon( 93.56% 74.55%,50.52% 100%,6.96% 75.45%,6.44% 25.45%,49.48% 0%,93.04% 24.55%,93.56% 74.55% );"],(e=>{let{background:t}=e;return(0,te.getColor)(t||"offline")}),(e=>{let{onClick:t}=e;return t?"pointer":"default"}),(e=>{let{isDisabled:t}=e;return t?"0.5":"1"})),Pa=(0,io.default)(te.Box).withConfig({displayName:"styled__PolygonInner",componentId:"sc-9bx1cv-1"})(["width:18px;position:absolute;top:2px;left:2px;aspect-ratio:1;background-color:",";opacity:",";clip-path:polygon( 93.56% 74.55%,50.52% 100%,6.96% 75.45%,6.44% 25.45%,49.48% 0%,93.04% 24.55%,93.56% 74.55% );"],(e=>{let{background:t}=e;return(0,te.getColor)(t||"offline")}),(e=>{let{isDisabled:t}=e;return t?"0.5":"1"})),Ba=(0,io.default)(te.Icon).withConfig({displayName:"styled__AddNodeIcon",componentId:"sc-9bx1cv-2"})(["position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);"]),Ra=(0,io.default)(te.Box).withConfig({displayName:"styled__Groups",componentId:"sc-9bx1cv-3"})(["width:100%;display:grid;grid-template-columns:repeat(2,1fr);gap:16px;"]),$a=(0,io.default)(te.Flex).withConfig({displayName:"styled__NodeContainer",componentId:"sc-9bx1cv-4"})(["opacity:",";"],(e=>{let{isActive:t}=e;return t?"1":".3"})),La=(0,It.A)((e=>{let{children:t,innerProps:n={},containerProps:o={},...r}=e;return(0,re.jsx)($a,{margin:[0,0,.5,0],...r,children:(0,re.jsx)(Da,{...o,children:(0,re.jsx)(Pa,{...n,children:t})})})})),za=e=>{let{type:t,onClick:n}=e;const o=(0,j.XA)(),r=(0,v.dg)(),a=(0,g.JT)("node:Create"),i=(0,x.useMemo)((()=>({background:"success",isDisabled:!a,...a?{onClick:()=>n({type:t})}:{}})),[a]),s=a?"Add node":r?"You are viewing your local node, connect to cloud and connect multiple nodes to view at once":`Only admin users can add nodes to ${o.name}`;return(0,re.jsx)(re.Fragment,{children:(0,re.jsx)(La,{containerProps:i,innerProps:{background:"panelBg"},tooltip:s,isActive:!0,children:(0,re.jsx)(Ba,{name:"plus",color:"success"})})})},_a=La;var Oa=n(89284),Va=n(91100);const Ea=e=>{let{architecture:t,cpuFrequency:n,cpus:o,diskSpace:r,memory:a,os:i,osName:s}=e;const l=[(0,Ge.O)(n),(0,Ge.ws)(o,1===o?"Core":"Cores"),(0,Ge.ws)(t),(0,Ge.ws)((0,Ge.RI)(a),"RAM"),(0,Ge.ws)((0,Ge.RI)(r),"HD")];return(0,re.jsxs)(te.Flex,{column:!0,gap:1,children:[(0,re.jsxs)(te.Flex,{gap:1,children:[(0,re.jsx)(te.Icon,{"data-testid":"node-system-info-icon",name:Ee.u[s]?.iconName||Ee.U[i]?.iconName||"os",width:"16px",height:"16px",color:"text"}),(0,re.jsx)(te.Flex,{children:(0,Ge.ws)(s)})]}),l.map(((e,t)=>(0,re.jsxs)(te.Text,{children:["\u2022 ",e]},t)))]})};var Ka=n(23208);const Ua=e=>{let{isStable:t}=e;const n=t?{icon:"checkmark_s",color:"primary",borderColor:"primary"}:{icon:"warning_triangle",color:"stale",borderColor:"stale"};return(0,re.jsx)(te.Pill,{hollow:!0,...n,children:t?"Stable":"Unstable"})},Ha=function(){let{id:e,name:t,state:n,hw:o,os:r,isStable:a,setActiveNodes:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s=(0,oa.c8)(),{nodes:l}=s||{},d=l?.[e];return(0,x.useEffect)((()=>{if("function"===typeof i){const{children:t,parents:n}=d||{},o=d?[...[...n,...t].map((e=>{let{id:t}=e;return t}))||[],e]:[e];i({isHover:!0,nodes:o})}return()=>{"function"===typeof i&&i(Ta.vd)}}),[e,d]),(0,re.jsxs)(te.Flex,{column:!0,gap:3,width:{min:40},background:"mainBackground",padding:[2,4],children:[(0,re.jsx)(te.TextBig,{strong:!0,children:t}),(0,re.jsxs)(te.Flex,{column:!0,gap:1,children:[(0,re.jsx)(te.Text,{children:"Status"}),(0,re.jsx)(te.Flex,{children:(0,re.jsx)(Oa.A,{state:n})})]}),(0,re.jsxs)(te.Flex,{column:!0,gap:1,children:[(0,re.jsx)(te.Text,{children:"Connection"}),(0,re.jsx)(te.Flex,{children:(0,re.jsx)(Ua,{isStable:a})})]}),(0,re.jsxs)(te.Flex,{column:!0,gap:1,children:[(0,re.jsx)(te.Text,{children:"Alerts"}),(0,re.jsx)(Va.A,{id:e})]}),(0,re.jsx)(En.A,{color:"textLite"}),(0,re.jsx)(Ea,{architecture:o.architecture,cpuFrequency:o.cpuFrequency,cpus:o.cpus,"data-testid":"nodeRow-system-info",diskSpace:o.diskSpace,memory:o.memory,name:t,osName:r.nm,os:r.id}),(0,re.jsx)(En.A,{color:"textLite"}),(0,re.jsx)(Ka.A,{id:e})]})};n(37550);const Wa=function(){let{colorBy:e={},node:t={},isStable:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{value:o}=e,r=Ta.AZ[o],a=(0,Pn.Xt)(t.id),{critical:i,warning:s}=(0,cr.AO)(a),l=Ta.Cc[o];let d=l[r?.(t)?.group?.toLowerCase()];if(o==Ta.w9.stability.value){d=l[n?"stable":"unstable"]}return{borderColor:(0,x.useMemo)((()=>(e=>{let{critical:t,warning:n}=e;return t?"error":n?"warning":null})({critical:i,warning:s})||d),[d,i,s]),background:d}},Ga=e=>{let{colorBy:t,stability:n={},setActiveNodes:o,...r}=e;const{isStable:a}=n[r.id]||{},{borderColor:i,background:s}=Wa({colorBy:t,node:r,isStable:a}),[,l]=(0,oa.A$)(),d=(0,x.useCallback)((()=>l(r.id)),[r.id,l]);return(0,re.jsx)(_a,{containerProps:{background:i,onClick:d},innerProps:{background:s},tooltip:(0,re.jsx)(Ha,{isStable:a,setActiveNodes:o,...r}),...r})};var qa=n(67462);const Ya=(0,x.memo)((e=>{let{nodes:t=[],type:n,stability:o={},groupBy:r,colorBy:a,onAddNode:i,...s}=e;const[l,d]=(0,x.useState)(Ta.vd),{isHover:c,nodes:u}=l,h=r?.canAddNodes;return(0,re.jsxs)(te.Flex,{flexWrap:!0,...s,children:[t.map((e=>(0,re.jsx)(Ga,{colorBy:a,stability:o,isActive:!c||u.includes(e.id),setActiveNodes:d,...e},e.id))),h?(0,re.jsx)(za,{type:n,onClick:i}):null]})})),Ja=(e=>t=>{let{title:n,...o}=t;return n?(0,re.jsxs)(te.Flex,{column:!0,gap:2,children:[(0,re.jsxs)(te.Flex,{justifyContent:"between",border:{side:"bottom",color:"border"},children:[(0,re.jsx)(te.TextBig,{strong:!0,children:n}),o.nodes?.length?(0,re.jsx)(te.TextBig,{children:`${o.nodes.length} ${(0,qa.su)(o.nodes.length)}`}):null]}),(0,re.jsx)(e,{...o})]}):(0,re.jsx)(e,{...o})})((e=>t=>{const{stability:n}=(0,oa.SW)();return(0,re.jsx)(e,{stability:n,...t})})(Ya)),Qa=e=>t=>{const n=Ta.AZ[e],o=(0,Ta.Hl)(e);return t.reduce(((e,t)=>{const{group:r="unknown",type:a}=n(t);return e[r]?e[r].nodes=[...e[r].nodes,t]:e[r]={title:o(r),type:a,nodes:[t]},e}),{})},Xa={os:Qa("os"),version:Qa("version"),status:Qa("status"),technology:Qa("technology"),replication:Qa("replication"),cloudProvider:Qa("cloudProvider"),cloudRegion:Qa("cloudRegion"),instanceType:Qa("instanceType"),none:e=>({none:{nodes:e}})},Za=e=>{let{value:t}=e;const n=(0,_.eO)({keepAll:!1});return Xa[t]?.(n)},ei=()=>(0,re.jsx)(te.Flex,{children:(0,re.jsx)(te.TextBig,{children:"No nodes found"})}),ti=e=>{let{groupBy:t,colorBy:n,onAddNode:o}=e;const r=Za(t);if(!r)return(0,re.jsx)(ei,{});const a=Object.values(r);if(!a.length)return(0,re.jsx)(ei,{});if(t?.value==Ta.nv.value){const{nodes:e}=a[0];return(0,re.jsx)(Ja,{nodes:e,groupBy:t,colorBy:n,onAddNode:o})}const i=1==a.length?te.Flex:Ra;return(0,re.jsx)(i,{children:a.map((e=>{let{title:r,type:a,nodes:i}=e;return(0,re.jsx)(Ja,{title:r,type:a,nodes:i,groupBy:t,colorBy:n,onAddNode:o,margin:[0,0,2,0]},r)}))})},ni=()=>{const[e,t]=(0,x.useState)(Ta.nv),[n,o]=(0,x.useState)(Ta.jZ),[r,a]=(0,x.useState)(),i=(0,x.useCallback)((e=>{a(e)}),[a]),s=(0,x.useCallback)((()=>a()),[a]);return(0,re.jsxs)(te.Flex,{column:!0,gap:4,basis:"calc(100% - 410px)",children:[(0,re.jsx)(Ma,{groupBy:e,setGroupBy:t,colorBy:n,setColorBy:o,onAddNode:i}),(0,re.jsx)(te.Flex,{height:{max:150},overflow:{vertical:"auto"},children:(0,re.jsx)(ti,{groupBy:e,colorBy:n,onAddNode:i})}),r&&(0,re.jsx)(xe.A,{nodeType:r?.type,onClose:s})]})},oi=e=>(0,re.jsx)(da,{width:"100%",alignItems:"center",justiFyContent:"center",...e}),ri=()=>{const{loaded:e,totalChildren:t,totalParents:n,totalStandalone:o}=(0,oa.c8)(),r=(0,x.useMemo)((()=>[{label:"Parents",value:n,color:["blue","indigo"]},{label:"Children",value:t,color:["purple","lilac"]},{label:"Standalone",value:o,color:["yellow","yellow120"]}]),[t,n]);return e?(0,re.jsx)(ga,{numberIndicatorProps:{TitleComponent:te.Text},data:r}):(0,re.jsx)(oi,{height:"58px"})},ai=()=>(0,re.jsxs)(te.Flex,{column:!0,gap:1,alignItems:"center",width:"220px","data-testid":"nodesByDataReplication-information-text",overflow:"hidden",children:[(0,re.jsxs)(te.TextMicro,{children:[(0,re.jsx)(te.TextMicro,{strong:!0,children:"None:"})," The node's data are only on the node itself. Lose the node, lose the data!"]}),(0,re.jsxs)(te.TextMicro,{children:[(0,re.jsx)(te.TextMicro,{strong:!0,children:"Single:"})," The node's metrics are replicated to one parent. The parent can trigger alerts for the child."]}),(0,re.jsxs)(te.TextMicro,{children:[(0,re.jsx)(te.TextMicro,{strong:!0,children:"Multi:"})," Same as dual replication, but with the metrics replicated to more than one parent. Each parent in the hierarchy can trigger alerts for its children."]}),(0,re.jsx)(te.TextMicro,{margin:[2,0],children:"Aim to have most of your nodes with at least a dual replication and your critical ones with a multiple one."})]}),ii=()=>(0,re.jsx)(gn.A,{isBasic:!0,plain:!0,content:ai,align:"bottom",children:(0,re.jsx)(te.Icon,{name:"information",color:"textDescription",size:"small"})}),si=ca((()=>{const e=(0,oa.c8)(),{loaded:t,replicationFactor:n}=e||{},o=(0,x.useMemo)((()=>[{label:"None",value:n?.r_1||0,color:Ta.q5.r_1},{label:"Single",value:n?.r_2||0,color:Ta.q5.r_2},{label:"Multi",value:n?.["r_*"]||0,color:Ta.q5["r_*"]}]),[n]);return t?(0,re.jsx)(ga,{data:o}):(0,re.jsx)(oi,{height:"74px"})})),li=()=>(0,re.jsx)(si,{title:"Data Replication",headerInfo:(0,re.jsx)(ii,{})}),di=()=>(0,re.jsxs)(te.Flex,{column:!0,gap:4,basis:"205px",children:[(0,re.jsx)(ri,{}),(0,re.jsx)(En.A,{}),(0,re.jsx)(li,{})]}),ci=()=>(0,re.jsxs)(da,{children:[(0,re.jsx)(ka,{}),(0,re.jsx)(En.A,{vertical:!0}),(0,re.jsx)(ni,{}),(0,re.jsx)(En.A,{vertical:!0}),(0,re.jsx)(di,{})]});var ui=n(66118),hi=n(44731);ui.t1.register(ui.PP,ui.kc,ui.A6,ui.E8,ui.m_,ui.s$);const gi={borderWidth:0,maxBarThickness:15,minBarLength:0},mi=function(){let{alertsStats:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=(0,x.useContext)(io.ThemeContext),{hosts:n}=e?.nodes||{},o={animation:!1,maintainAspectRatio:!1,plugins:{legend:{display:!1}},responsive:!0,scales:{x:{stacked:!0,grid:{color:(0,te.getColor)("borderSecondary")({theme:t})},afterSetDimensions:e=>{e.maxHeight=50},ticks:{precision:0,callback:(e,t)=>{let n=r.labels[t];if(!n)return;let o=0;for(;n?.length>20;)n=(0,Er.P3)(n,o),o+=1;return n}}},y:{stacked:!0,grid:{color:(0,te.getColor)("borderSecondary")({theme:t})},afterSetDimensions:e=>{e.maxWidth=50}}}},r=(0,x.useMemo)((()=>{if(!n)return{datasets:[],labels:[]};const[e,t]=Object.entries(n).sort(((e,t)=>t[1].total-e[1].total)).reduce(((e,t)=>{let[n,{critical:o,warning:r}]=t;return e[0].push(n),e[1].critical?e[1].critical=[...e[1].critical,o]:e[1].critical=[o],e[1].warning?e[1].warning=[...e[1].warning,r]:e[1].warning=[r],e}),[[],{}]);return{datasets:Object.entries(t).map((e=>{let[t,n]=e;return{...gi,backgroundColor:"critical"===t?"#DB162F":"#FF9700",data:n,label:t}})),labels:e}}),[n]);return r.datasets?(0,re.jsx)(te.Flex,{width:"100%",height:40,children:(0,re.jsx)(hi.yP,{data:r,options:o})}):null},xi=e=>{let{alertsStats:t}=e;const{nodes:n}=t||{},{critical:o,warning:r,total:a}=n||{},i=(0,x.useMemo)((()=>[{label:"Warning",value:r,color:["yellow","yellow80"]},{label:"Critical",value:o,color:["red","red100"]},{label:"Total",value:a,color:["purple","lilacFocus"],omit:!0}]),[o,r,a]);return n?(0,re.jsx)(ga,{data:i}):null},pi=[{id:"name",accessorKey:"name",header:"Alert name",fullWidth:!0,cell:e=>{let{getValue:t,row:n}=e;const o=t(),{goToAlerts:r}=$r(),a=(0,x.useCallback)((e=>{e.preventDefault(),r({name:o,instance:n?.original?.chart})}),[r]);return(0,re.jsx)(gn.A,{content:"Go to events tab. Timeframe will be set to the last 24 hours.",isBasic:!0,children:(0,re.jsx)(te.Box,{children:(0,re.jsx)(ce.A,{onClick:a,children:o})})})}},{id:"chart",name:"chart",fullWidth:!0,header:"Instance"},{id:"occurrences",name:"occurrences",header:"Occurrences"},{id:"duration",name:"duration",header:"Duration (seconds)"}],fi=function(){let{data:e=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.length?(0,re.jsx)(te.Flex,{height:{max:50},overflow:{vertical:"auto"},children:(0,re.jsx)(te.Table,{data:e,dataColumns:pi,sortBy:[{id:"occurrences",desc:!0}],enableResizing:!0})}):null},bi={title:"Nodes with the most alerts in the last 24h"},vi=e=>{const t=(0,oa.jg)();return t.loaded?(0,re.jsxs)(da,{titleProps:bi,...e,children:[(0,re.jsx)(mi,{alertsStats:t}),(0,re.jsx)(xi,{alertsStats:t}),(0,re.jsxs)(te.Flex,{column:!0,gap:4,children:[(0,re.jsx)(te.TextBig,{children:"Top alerts in the last 24 h"}),(0,re.jsx)(fi,{data:t?.alerts})]})]}):(0,re.jsx)(d.nl,{})};var ji=n(58618);const yi={title:"Metrics available",justifyContent:"center"},wi=e=>{const{loaded:t,metricsCollected:n=0,error:o}=(0,oa.P9)();return t?(0,re.jsx)(da,{titleProps:yi,error:o?.response?.data,...e,children:(0,re.jsx)(te.Flex,{width:"100%",justifyContent:"center",children:(0,re.jsx)(te.TextHuge,{strong:!0,children:(0,ji.$t)(n)})})}):(0,re.jsx)(d.Tr,{title:"Metrics available",...e})},Ii={title:"Charts visualized",justifyContent:"center"},Ci=e=>{const t=(0,j.ID)(),n=(0,we._0)(t),o=(0,we.rx)(t),r=(0,we.R7)(t),a=Object.keys(r||{}).length;return n||o?(0,re.jsx)(da,{titleProps:Ii,error:o,...e,children:(0,re.jsx)(te.Flex,{width:"100%",justifyContent:"center",children:(0,re.jsx)(te.TextHuge,{strong:!0,children:(0,ji.$t)(a)})})}):(0,re.jsx)(d.Tr,{...e})},ki={title:"Alerts configured",justifyContent:"center"},Ai=e=>{const{loaded:t,value:n}=(0,cr.oU)();return t?(0,re.jsx)(da,{titleProps:ki,...e,children:(0,re.jsx)(te.Flex,{width:"100%",justifyContent:"center",children:(0,re.jsx)(te.TextHuge,{strong:!0,children:(0,ji.$t)(n?.length||0)})})}):(0,re.jsx)(d.Tr,{...e})};ui.t1.register(ui.PP,ui.kc,ui.A6,ui.E8,ui.m_,ui.s$);const Si=function(){let{dataRetention:e=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=(0,x.useContext)(io.ThemeContext),n={animation:!1,maintainAspectRatio:!1,plugins:{legend:{display:!1}},responsive:!0,scales:{x:{stacked:!0,grid:{color:(0,te.getColor)("borderSecondary")({theme:t})},afterSetDimensions:e=>{e.maxHeight=50},ticks:{precision:0,callback:(e,t)=>{let n=o.labels[t];if(!n)return;let r=0;for(;n?.length>20;)n=(0,Er.P3)(n,r),r+=1;return n}}},y:{stacked:!0,grid:{color:(0,te.getColor)("borderSecondary")({theme:t})},afterSetDimensions:e=>{e.maxWidth=50}}}},o=(0,x.useMemo)((()=>{if(!e?.length)return{datasets:[],labels:[]};const{values:t,labels:n}=e.reduce(((e,t)=>{let{label:n,value:o}=t;return e.labels.push(n),e.values.push(o),e}),{values:[],labels:[]});return{datasets:[{borderWidth:0,maxBarThickness:10,backgroundColor:"#0A81AB",minBarLength:0,data:t,label:"Nodes"}],labels:n}}),[e]);return o.datasets?(0,re.jsx)(te.Flex,{width:"100%",height:"100%",children:(0,re.jsx)(hi.yP,{data:o,options:n})}):null},Ti={title:"Data retention per Nodes"},Fi=e=>{const{dataRetention:t}=(0,oa.P9)();return(0,re.jsx)(da,{titleProps:Ti,...e,children:(0,re.jsx)(Si,{dataRetention:t})})};var Ni=n(21785),Mi=n(39870);const Di=()=>{const e=(0,v.vt)(),t=(0,j.ID)(),n=(0,oa.N3)();(0,b.A)((()=>({enabled:!(!e||!t),force:!0,fetch:()=>(0,Fn.hn)(e,t),onReceive:e=>{let{data:t}=e;return n({...Mi.jf,loaded:!0,...t})},onFail:e=>n({...Mi.jf,loaded:!0,error:e}),pollingOptions:{pollingInterval:588e3}})),[e,t])};var Pi=n(75669);const Bi=()=>{const e=(0,v.vt)(),t=(0,j.ID)(),n=(0,_.w7)({extraKey:"home",merge:!1,scoped:!0}),o=(0,oa.kf)();(0,b.A)((()=>({enabled:!(!e||!t),force:!0,fetch:()=>(0,Fn.TM)(e,t,n),onReceive:e=>{let{data:t}=e;return o({...Mi.ul,loaded:!0,...t})},onFail:e=>o({...Mi.ul,loaded:!0,error:e}),pollingOptions:{pollingInterval:588e3}})),[e,t])},Ri=()=>{const e=(0,v.vt)(),t=(0,j.ID)(),n=(0,_.w7)({extraKey:"home",merge:!1,scoped:!0}),o=(0,oa.xs)();(0,b.A)((()=>({enabled:!(!e||!t),force:!0,fetch:()=>(0,Fn.jt)(e,t,n),onReceive:e=>{let{data:t}=e;return o({...Mi.ve,loaded:!0,...t})},onFail:e=>o({...Mi.ve,loaded:!0,error:e}),pollingOptions:{pollingInterval:588e3}})),[e,t,n])},$i=()=>((0,Ni.A)(),Di(),(0,Pi.A)(),Bi(),Ri(),null),Li=()=>{const e=(0,D.CK)();return(0,D.nj)()&&!e.length?(0,re.jsx)(B.Ay,{feature:"Home",mode:"NoNodesView",children:(0,re.jsx)(P.A,{})}):(0,re.jsxs)(B.Ay,{feature:"Home",children:[(0,re.jsx)($i,{}),(0,re.jsxs)($.A,{sidebar:(0,re.jsx)(aa,{}),gap:4,padding:[4],overflow:"auto",children:[(0,re.jsx)(ci,{}),(0,re.jsxs)(te.Flex,{gap:4,children:[(0,re.jsx)(vi,{width:"60%"}),(0,re.jsxs)(te.Flex,{column:!0,gap:4,height:"100%",width:"calc(40% - 16px)",children:[(0,re.jsxs)(te.Flex,{gap:4,children:[(0,re.jsx)(wi,{flex:{grow:"1",shrink:"0"}}),(0,re.jsx)(Ci,{flex:{grow:"1",shrink:"0"}}),(0,re.jsx)(Ai,{flex:{grow:"1",shrink:"0"}})]}),(0,re.jsx)(Fi,{flex:"grow"})]})]})]})]})};var zi=n(89711);var _i=n(84060),Oi=n(31035),Vi=n(2863),Ei=n(49916);var Ki=n(46587);const Ui=()=>{const e=(0,v.vt)(),t=(0,z.nl)(),n=(0,o.ES)(e),r=(0,Ki.uW)("isAnonymous"),{value:a}=(0,z.BQ)(t,e),i=a?.agents?.[0]||{},s="windows"==(i.application?.os?.kernel||"").toLowerCase();return{hasAccess:!(n&&r&&s),reason:"windowsAgent"}};var Hi=n(14457),Wi=n(93933),Gi=n(15524);const qi=io.default.div.withConfig({displayName:"styled__Separator",componentId:"sc-1fhfk7c-0"})(["background:",";height:20px;width:1px;"],(0,te.getColor)("border")),Yi=e=>{let{flavour:t,...n}=e;const o=(0,z.nl)(),r=(0,Pn.Xt)(o),{critical:a,warning:i}=(0,cr.AO)(r),s=(0,V.Fw)("sidebarTab",{flavour:"val",extraKey:t}),l=(0,V.Fw)("sidebarOpen",{flavour:"bool"}),d=(0,x.useCallback)((e=>{l(!0),s(e)}),[l,s]),{id:c,hw:u={},cpus:h,isLive:g,name:m,os:p={},state:f,updateSeverity:b,labels:v,version:j,health:y,capabilities:w}=(0,z.xY)(o),{silencingState:I}=y?.alerts||{},C={dataTestId:"singleNode",isLive:g},k=(0,Ge.t3)({count:a,type:"critical",...C}),A=(0,Ge.t3)({count:i,type:"warning",...C}),S=(0,Ge.GM)(f),T=(0,Ge.Pg)(u.container,u.virtualization),F=(0,$o.A)("(min-width: 1760px)"),N=(0,z.TC)();return(0,re.jsxs)(te.Flex,{alignItems:"center",background:"panelBg",border:{side:"all",color:"border"},"data-testid":"singleNode-badges-container",flex:!1,gap:1,padding:[1,2],round:1,...n,children:[(0,re.jsx)(te.TextSmall,{"data-testid":`singleNode-${m}`,strong:!0,children:m}),(0,re.jsx)(at.A,{badge:"info","data-testid":"singleNode-nodeInfo-cta",children:(0,re.jsx)(te.IconButton,{flavour:"borderless",cursor:"pointer",onClick:()=>{N(c),d("info")},icon:"information",iconColor:"nodeBadgeColor",tiny:!0,width:"18px",height:"18px"})}),(0,re.jsx)(qi,{"data-testid":"singleNode-separator"}),(0,re.jsx)(at.A,{badge:"alerts",nodeName:m,children:(0,re.jsx)(te.AlertMasterCard,{onClick:k.text||A.text?()=>N(c,{},"/alerts"):null,pillLeft:k,pillRight:A})}),(0,re.jsx)(qi,{"data-testid":"singleNode-separator"}),(0,re.jsx)(Et,{node:{id:c,name:m,isLive:g,capabilities:w},padding:[0,1]}),b&&(0,re.jsx)(At.A,{"data-testid":"singleNode-update-cta",name:m,os:p.id,container:u.container,warningLevel:b,labels:v,version:j,text:b}),(0,re.jsx)(qi,{"data-testid":"singleNode-separator"}),(0,re.jsx)(at.A,{badge:"connectivity",connectivityState:S,"data-testid":"singleNode-connectivityStateInfo",nodeName:m,children:(0,re.jsx)(te.Pill,{flavour:"neutral",hollow:!0,children:S})}),(0,re.jsx)(at.A,{badge:"type","data-testid":"singleNode-nodeTypeInfo",nodeName:m,nodeType:T.label,children:(0,re.jsx)(te.Pill,{flavour:"neutral",hollow:!0,icon:T.icon,children:T.label})}),F&&(0,re.jsx)(at.A,{badge:"systemInfo","data-testid":"singleNode-systemInfo",nodeName:m,children:(0,re.jsxs)(te.Pill,{flavour:"neutral",hollow:!0,icon:Ee.u[p.nm]?.iconName||Ee.U[p.id]?.iconName||"os",children:[(0,Ge.O)(u.cpuFrequency)," (",h," ",1===u.cpus?"Core":"Cores",") -"," ",(0,Ge.RI)(u.memory)," RAM - ",(0,Ge.RI)(u.diskSpace)]})}),(0,re.jsx)(yt.A,{flavour:"node",silencing:I})]})},Ji=()=>{const e=(0,z.aH)(),t=(e=>(0,x.useMemo)((()=>({overview:{id:"overview",title:"Metrics",icon:"room_overview",path:`${e}`,dataGa:"view-picker::click-view-overview::node-view",testId:"viewPicker-singleNode-overview",tooltip:"System, containers, VMs and application metrics"},top:{id:"top",title:"Top",icon:"top",path:`${e}/top`,dataGa:"view-picker::click-view-fn::global-overview",testId:"viewPicker-singleNode-fn",tooltip:"Top processes, containers, VMs, services, queries and system components"},logs:{id:"logs",title:"Logs",icon:"logs",path:`${e}/logs`,dataGa:"view-picker::click-view-logs::global-overview",testId:"viewPicker-singleNode-logs",tooltip:"System and application logs"},alerts:{id:"alerts",title:"Alerts",icon:"alarm",path:`${e}/alerts`,dataGa:"view-picker::click-view-alerts::node-view",testId:"viewPicker-singleNode-alerts"},ar:{id:"ar",title:"Anomalies",icon:"anomaliesLens",path:`${e}/anomalies`,dataGa:"view-picker::click-view-anomalies::node-view",testId:"viewPicker-singleNode-anomalies",tooltip:"Anomaly Advisor - ML powered anomaly detection"},events:{id:"events",title:"Events",icon:"feed",path:`${e}/events`,dataGa:"view-picker::click-view-feed::node-view",testId:"viewPicker-singleNode-feed",tooltip:"Activity feed"}})),[e]))(e);return(0,x.useMemo)((()=>[t.overview,t.top,t.logs,t.alerts,t.ar,t.events].filter(Boolean)),[e])};var Qi=n(43375),Xi=n(10444);const Zi=(0,io.default)(te.Box).attrs((e=>({width:"6px",height:"6px",round:"50%",...e}))).withConfig({displayName:"withNotification__NotificationDot",componentId:"sc-ka7a4g-0"})([""]),es=e=>t=>{let{notificationBg:n,...o}=t;return n?(0,re.jsxs)(te.Flex,{position:"relative",gap:1,padding:[0,0,0,1.5],children:[(0,re.jsx)(Zi,{background:n,position:"absolute",top:-2,left:0}),(0,re.jsx)(e,{...o})]}):(0,re.jsx)(e,{...o})},ts=(0,io.keyframes)(["0%{transform:translateY(-5px) scale(1);}25%{transform:translateY(-10px) scale(0.7);}50%{transform:translateY(-5px) scale(1);}75%{transform:translateY(0) scale(1.3);}100%{transform:translateY(-5px) scale(1);}"]),ns=(0,io.default)(te.Icon).attrs({name:"long_arrow_up",color:"successText"}).withConfig({displayName:"tabLink__DropHereIcon",componentId:"sc-1h4dha1-0"})(["animation:"," 1s ease-in infinite;"],ts),os=e=>{let{active:t,highlight:n}=e;return n?"primary":t?"text":"textDescription"},rs=es(te.Icon),as=e=>{let{id:t,to:n,params:o,exact:r,icon:a,title:i,fixed:s,dataGa:l,testId:d,children:c,type:u,tooltip:h,showBorderLeft:g,droppable:m,droppableProps:p={},ref:b,isDynamic:v,highlight:j,...y}=e;const{sendLog:w}=(0,Vt.A)(),{setNodeRef:I,active:C}=(0,Qi.zM)({id:`droppable-tab-${t}`,disabled:!m,data:p}),k=(0,f.RQ)(r?n:`${n}/*`),A=(0,f.Zp)(),T=(0,Xi.J)(),F=!!k,N="nodes"!==u||F,M=(0,x.useCallback)((()=>{if(F)return;const e=`${n}${o?`/${o}`:""}`;A(e),w({feature:"Navigation",description:"Single page navigation using static tabs",tab:t,path:e})}),[t,n,F,o,w]),D=m&&C&&C.data.current?.dashboardable,P=(0,x.useRef)(),[B]=(0,S.m0)({tabId:t}),R=(0,x.useCallback)((e=>{let{button:t}=e;v&&1===t&&"function"===typeof y.onRemove&&y.onRemove(y.index,F)}),[v,y.index,F,y.onRemove]);return(0,re.jsxs)(te.NavigationTab,{ref:(0,te.mergeRefs)(I,b,P),fixed:s,active:F,showBorderLeft:g,icon:(0,re.jsx)(gn.A,{content:h||i,align:h?"bottom":"top",isBasic:!0,...j?{color:"primary"}:{},children:(0,re.jsx)(rs,{name:a,size:"small",notificationBg:B?.color})}),onActivate:M,"data-ga":l,"data-testid":d,"aria-selected":F,tooltip:h||i,...D&&{rootProps:{background:"successSemi",cursor:"alias"}},onMouseUp:R,...y,children:[!T&&!!i&&(0,re.jsx)(gn.A,{content:h||i,align:h?"bottom":"top",isBasic:!0,children:(0,re.jsx)(te.TextSmall,{alignSelf:"center",strong:j,color:os({active:F,highlight:j}),whiteSpace:"nowrap",children:i})}),P.current&&D&&(0,re.jsx)(te.Drop,{target:P.current,align:{top:"bottom"},stretch:!1,hideShadow:!0,zIndex:1,children:(0,re.jsx)(ns,{})}),N&&c]})},is={singleNode:"singleNode",logs:"logs",top:"fn",feed:"feed",anomalies:"anomalies",default:"singleNode",alerts:"alerts"},ss=(0,x.memo)((()=>{const e=Ji(),t=(0,f.RQ)("/spaces/:spaceSlug/rooms/:roomSlug/nodes/:nodeId/:path"),n=t&&is[t.params.path]||is.default;return(0,re.jsxs)(te.Flex,{justifyContent:"start",alignSelf:"start",alignItems:"end",width:"100%",height:"100%",overflow:"auto",background:"mainBackground",children:[(0,re.jsx)(Yi,{flavour:n,background:"mainBackground",border:void 0}),(0,re.jsx)(te.TabSeparator,{}),e.map(((e,t)=>{let{id:n,icon:o,title:r,path:a,...i}=e;return(0,re.jsx)(as,{exact:!0,fixed:!0,to:a,icon:o,title:r,id:n,rootProps:{background:"mainBackground"},showBorderLeft:0===t,...i},`${n}-${t}`)}))]})})),ls=ss;var ds=n(47413),cs=n(97141),us=n(5722);const hs=()=>{const{active:e}=(0,Qi.fF)(),t=(0,g.JT)("dashboard:Create"),n=(0,v.dg)();return t&&e&&!n?(0,re.jsx)(as,{to:"",id:"plus",icon:"plus",fixed:!0,droppable:!0,droppableProps:{dropArea:!0,dashboardId:"new"},testid:"roomDropdownMenu-roomOptions",disabled:!t||n}):null},gs=e=>{let{title:t,path:n,children:o,index:r,ref:a,...i}=e;return(0,re.jsx)(as,{ref:a,isDynamic:!0,showBorderLeft:0===r,to:n,title:t,"data-testid":`navigation-dynamicTab-${t}`,index:r,...i,children:o})},ms=e=>{let{staticPaths:t,...n}=e;const[o,r,a]=(0,ds.A)(t),i=(0,Gi.A)("horizontal");return(0,re.jsx)(te.BaseDraggableTabs,{onDragEnd:r,onTabClose:a,items:o,Item:gs,...n,ref:i})},xs=()=>(0,re.jsx)(f.BV,{children:(0,re.jsx)(f.qh,{path:"/spaces/:spaceSlug/rooms/:roomSlug/nodes/:nodeId/*",element:(0,re.jsx)(ls,{})})}),ps=(0,x.memo)((()=>{const[e,t]=(0,cs.A)();return(0,us.A)()?(0,re.jsxs)(te.NavigationTabs,{subTabs:(0,re.jsx)(xs,{}),children:[e.map(((e,t)=>{let{id:n,icon:o,title:r,path:a,...i}=e;return(0,re.jsx)(as,{exact:!0,fixed:!0,to:a,icon:o,title:r,id:n,...i},`${n}-${t}`)})),(0,re.jsx)(te.TabSeparator,{}),(0,re.jsx)(ms,{staticPaths:t}),(0,re.jsx)(hs,{})]}):null})),fs=ps,bs=()=>{const e=(0,Tt.eg)(),t=`/spaces/${(0,v.bq)()}/rooms/${(0,j.QW)()}/overview`,n=(0,f.Zp)();(0,x.useEffect)((()=>{if(e)return(0,Lo.unregister)(e.on("goToLink",((e,o)=>{let r=location.pathname;return e&&e.getParent().getAttribute("roomId")&&(r=e.getParent().getId(),r=/^\/spaces/.test(r)?r:t),n(r,o?{state:{chartName:o},replace:!0}:{state:{contextToGo:e?.getAttribute("contextScope")?.[0]},replace:!0})})))}),[e,t])},vs=()=>(bs(),null);var js=n(73937),ys=n(65637),ws=n(83386),Is=n(73980),Cs=n(45026);const ks=`dyncfg-edit-alet-warning-dismiss-${window.envSettings?.visitor}`,As={lineHeight:1.6},Ss=e=>{let{alertName:t,nodeIds:n=[]}=e;const r="true"===localStorage.getItem(ks),[a,,,i]=(0,ge.A)(!r),[s,l]=(0,x.useState)(),d=(0,z.xY)(n[0],"name"),c=n.length-1,u=c>0?` and ${c} other nodes`:"",h=(0,x.useCallback)((e=>{l(e)}),[l]),g=(0,x.useCallback)((()=>{s&&localStorage.setItem(ks,!0),i()}),[s,i]);return a?(0,re.jsx)(te.Modal,{backdropContainerProps:{zIndex:"60"},backdropProps:{backdropBlur:!0},children:(0,re.jsxs)(te.ModalContent,{children:[(0,re.jsx)(te.ModalHeader,{children:(0,re.jsx)(te.H4,{children:"Editing Alerts"})}),(0,re.jsx)(te.ModalBody,{children:(0,re.jsxs)(te.Flex,{column:!0,gap:2,width:{max:120},children:[(0,re.jsxs)(te.TextBig,{...As,children:["You are about to edit the alert ",(0,re.jsx)(te.TextBig,{color:"primary",children:t}),d?(0,re.jsxs)(re.Fragment,{children:[" ","on node ",(0,re.jsx)(te.TextBig,{color:"primary",children:d}),u]}):null,"."]}),(0,re.jsx)(te.TextBig,{...As,children:'Keep in mind that alerts in Netdata are templates that are applied to all instances of the same kind (e.g. editing a disk alert, means you are changing the alerts for all disks on that node). If you want to overwrite the rules for a single instance, do not change the current rules. Instead add a new rule and select "Apply to a specific instance" for that rule, matching the instance you want to overwrite.'}),o.Ay?(0,re.jsx)(te.TextBig,{...As,children:'To apply an alert on all your currently connected nodes, edit it and select "Submit to Multiple Nodes".'}):(0,re.jsx)(te.TextBig,{...As,children:'When having parents and you have connected both parents and children to Netdata Cloud, the alert needs to be altered on both Netdata parents and children, otherwise one of the two will be using the old version. To apply an alert on multiple nodes, edit it and select "Submit to Multiple Nodes".'})]})}),(0,re.jsxs)(te.ModalFooter,{justifyContent:"between",children:[(0,re.jsxs)(te.Flex,{gap:2,alignItems:"center",children:[(0,re.jsx)(te.Checkbox,{checked:s,onChange:h}),(0,re.jsx)(te.TextBig,{children:"Don't show this again"})]}),(0,re.jsx)(te.Button,{type:"button",flavour:"hollow",label:"OK",textTransform:"uppercase",onClick:g})]})]})}):null},Ts=(0,x.memo)((()=>{const{node:e}=(0,js.Z)(),{alertName:t,nodeIds:n,title:o}=(0,Cs.A)(),{loaded:r,tree:a}=(0,ys.A)(n?{value:n?.[0]}:e),i=(0,x.useMemo)((()=>a?.[Ur.$7]?.[o]||{}),[a,o]),s=(0,x.useMemo)((()=>!!Object.keys(i||{}).length),[i]);return r&&t?(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(Is.A,{flavour:"entity",title:o,entityProps:i,isOpen:s,isEditFromState:!0,renderChildren:e=>(0,re.jsx)(ws.A,{id:o,...i,...e})},JSON.stringify({loaded:r,alertName:t,alertItemExists:s})),i?(0,re.jsx)(Ss,{alertName:t,nodeIds:n}):null]}):null})),Fs=Ts,Ns=(0,x.memo)((()=>{const{node:e}=(0,js.Z)(),{path:t}=(0,ys.A)(e),n=(0,Ot.sh)({node:e,path:t}),{entityProps:o,...r}=n||{};return n?(0,re.jsx)(Is.A,{id:n.template,flavour:"entity",title:`${n.template}:placeholder`,entityProps:{...o,...r},isNewItem:!0,formData:n.formData,renderChildren:e=>(0,re.jsx)(ws.A,{...o,...e,id:n.template,isNewItem:!0})}):null})),Ms=Ns,Ds=(0,r.A)((()=>Promise.all([n.e(3961),n.e(3864),n.e(4269)]).then(n.bind(n,4269))),"ManageSpaceRoute"),Ps=(0,r.A)((()=>n.e(2201).then(n.bind(n,52201))),"Trial"),Bs=(0,r.A)((()=>n.e(5302).then(n.bind(n,5302))),"PreferredNodesModal"),Rs=(0,r.A)((()=>Promise.resolve().then(n.bind(n,61314))),"JoinSpace"),$s=(0,r.A)((()=>n.e(7530).then(n.bind(n,17530))),"NoSpaceAccess"),Ls=(0,r.A)((()=>n.e(6333).then(n.bind(n,96333))),"EmptyRoom"),zs=(0,r.A)((()=>n.e(1910).then(n.bind(n,11910))),"AlertView"),_s=(0,r.A)((()=>n.e(2177).then(n.bind(n,32177))),"Anomalies"),Os=(0,r.A)((()=>n.e(5).then(n.bind(n,5))),"AlertsSmartboard"),Vs=(0,r.A)((()=>n.e(7214).then(n.bind(n,27214))),"DashboardsOverview"),Es=(0,r.A)((()=>Promise.all([n.e(180),n.e(4424),n.e(5297)]).then(n.bind(n,95297))),"DashboardView"),Ks=(0,r.A)((()=>Promise.all([n.e(3961),n.e(2386),n.e(7122)]).then(n.bind(n,27122))),"FunctionsView"),Us=(0,r.A)((()=>Promise.all([n.e(3864),n.e(3068),n.e(4142),n.e(4087)]).then(n.bind(n,52273))),"Insights"),Hs=(0,r.A)((()=>Promise.all([n.e(3864),n.e(3068),n.e(8502)]).then(n.bind(n,43808))),"InsightsReport"),Ws=(0,r.A)((()=>n.e(8554).then(n.bind(n,88554))),"Onboarding"),Gs=(0,r.A)((()=>Promise.all([n.e(3864),n.e(8791),n.e(3185),n.e(5187)]).then(n.bind(n,53185))),"Integrations"),qs=(0,r.A)((()=>Promise.all([n.e(180),n.e(2003)]).then(n.bind(n,92003))),"DropInDashboard"),Ys=(0,r.A)((()=>n.e(5566).then(n.bind(n,73185))),"Marketplace"),Js=(0,r.A)((()=>n.e(2904).then(n.bind(n,82904)).then((e=>({default:e.AssistantAlerts})))),"AssistantAlerts"),Qs=(0,r.A)((()=>n.e(2904).then(n.bind(n,82904)).then((e=>({default:e.AssistantChat})))),"AssistantChat"),{demoSlug:Xs,demoDefaultRoomViews:Zs,defaultRoomView:el,onboardingView:tl,integrationsView:nl}=h.A,ol=br(na(fr)),rl=na(fr),al=(0,x.memo)((()=>{const[e,t]=(0,Jn.Ay)(),n=Xs===e?Zs[t]||Zs.default:o.Ay&&t===o.Iy?o.kG:el;return(0,re.jsxs)(x.Suspense,{fallback:(0,re.jsx)(d.zj,{}),children:[(0,re.jsx)(x.Suspense,{fallback:"",children:(0,re.jsx)(qs,{})}),(0,re.jsx)(f.BV,{children:(0,re.jsx)(f.qh,{path:"nodes/:nodeId/*",element:(0,re.jsx)(Tn,{})})}),(0,re.jsxs)(f.BV,{children:[(0,re.jsx)(f.qh,{path:"nodes/:nodeId",element:(0,re.jsx)(ol,{})}),(0,re.jsx)(f.qh,{path:"nodes/:nodeId/alerts",element:(0,re.jsx)(Os,{})}),(0,re.jsx)(f.qh,{path:"nodes/:nodeId/anomalies",element:(0,re.jsx)(x.Suspense,{fallback:(0,re.jsx)(d.Bm,{}),children:(0,re.jsx)(_s,{})})}),(0,re.jsx)(f.qh,{path:"nodes/:nodeId/top",element:(0,re.jsx)(Ks,{flavour:"fn"},"fn")}),(0,re.jsx)(f.qh,{path:"nodes/:nodeId/logs",element:(0,re.jsx)(Ks,{flavour:"logs"},"logs")}),(0,re.jsx)(f.qh,{path:"nodes/:nodeId/events",element:(0,re.jsx)(Ks,{flavour:"feed"},"feed")}),(0,re.jsx)(f.qh,{path:"nodes",element:(0,re.jsx)(Sn,{})}),(0,re.jsx)(f.qh,{path:"home",element:(0,re.jsx)(Li,{})}),(0,re.jsx)(f.qh,{path:"overview",element:(0,re.jsx)(rl,{})}),(0,re.jsx)(f.qh,{path:"alerts/:alertId",element:(0,re.jsx)(x.Suspense,{fallback:(0,re.jsx)(d.xh,{}),children:(0,re.jsx)(zs,{})})}),(0,re.jsx)(f.qh,{path:"alerts",element:(0,re.jsx)(Os,{})}),(0,re.jsx)(f.qh,{path:"alarms/:alertId",element:(0,re.jsx)(zs,{})}),(0,re.jsx)(f.qh,{path:"alarms",element:(0,re.jsx)(f.C5,{replace:!0,to:`/spaces/${e}/rooms/${t}/alerts`})}),(0,re.jsx)(f.qh,{path:"functions",element:(0,re.jsx)(f.C5,{replace:!0,to:`/spaces/${e}/rooms/${t}/top`})}),(0,re.jsx)(f.qh,{path:"dashboard",element:(0,re.jsx)(Es,{customDashboardId:o.LA})}),(0,re.jsx)(f.qh,{path:"dashboards/:dashboardSlug",element:(0,re.jsx)(x.Suspense,{fallback:(0,re.jsx)(l.O2,{}),children:(0,re.jsx)(Es,{})})}),(0,re.jsx)(f.qh,{path:"dashboards",element:(0,re.jsx)(Vs,{})}),(0,re.jsx)(f.qh,{path:"kubernetes",element:(0,re.jsx)(rl,{flavour:"k8s"})}),(0,re.jsx)(f.qh,{path:"anomalies",element:(0,re.jsx)(x.Suspense,{fallback:(0,re.jsx)(d.Bm,{}),children:(0,re.jsx)(_s,{})})}),(0,re.jsx)(f.qh,{path:"top",element:(0,re.jsx)(Ks,{flavour:"fn"},"fn")}),(0,re.jsx)(f.qh,{path:"logs",element:(0,re.jsx)(Ks,{flavour:"logs"},"logs")}),(0,re.jsx)(f.qh,{path:"events",element:(0,re.jsx)(Ks,{flavour:"feed"},"feed")}),(0,re.jsx)(f.qh,{path:"insights",element:(0,re.jsx)(x.Suspense,{fallback:(0,re.jsx)(d.BJ,{}),children:(0,re.jsx)(Us,{})})}),(0,re.jsx)(f.qh,{path:`${m.p9}/:reportId`,element:(0,re.jsx)(Hs,{})}),(0,re.jsx)(f.qh,{path:"/",element:(0,re.jsx)(f.C5,{replace:!0,to:`/spaces/${e}/rooms/${t}/${n}`})})]})]})})),il=()=>{const{isOnboardingPath:e,path:t}=(0,c.A)(),{isIntegrationsPath:n}=(0,Hi.Q)(),[r,i]=(0,Hi.A)(),s=(0,v.vt)(),l=(0,j.ID)(),u=(0,a.I)(),h=(0,D.gr)(l,"ids"),g=(0,D.gr)(l,"loaded"),m=(0,v.bE)(s,"isEmpty"),y=(0,x.useMemo)((()=>!0===g&&!h.length),[g,h]),w=(0,o.Az)(s);return((e,t)=>{const n=(0,p.yF)((0,x.useCallback)((async(n,o)=>{await n((0,j.LS)({id:t,key:"fullyLoaded"}))||(0,Fn.K8)(e,t).then((t=>{let{data:n}=t;return o((0,j.If)(n.id),{...n,spaceId:e,fullyLoaded:!0,loaded:!0})}))}),[e,t]));(0,x.useEffect)((()=>{e&&t&&n()}),[e,t])})(s,l),(0,Nn.A)({spaceId:s,id:l,pollingInterval:63e3}),function(e,t){let{polling:n=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=(0,p.yF)((0,x.useCallback)((function(e,n){let{data:o=[]}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n((0,Bn.t)({id:t,key:"ids"}),o.map((e=>e.id))),n((0,Bn.t)({id:t,key:"loaded"}),!0),n((0,Bn.t)({id:t,key:"updatedAt"}),(new Date).toISOString()),n((0,Bn.t)({id:t,key:"error"}),null),n(Mn.Ay,(e=>o.reduce(((e,t)=>(e[t.id]={...e[t.id],loaded:!0,...t},e)),e)));const r=o.reduce(((e,t)=>{let{id:n,nodeId:o}=t;return e[o]=[...e[o]||[],n],e}),{});n(Pn.l3,r)}),[e,t])),r=(0,p.yF)((0,x.useCallback)(((e,n,o)=>{n((0,Bn.t)({id:t,key:"error"}),(0,Rn.A)(o))}),[]));(0,b.A)((()=>({enabled:!!e&&!!t,polling:n,fetch:()=>(0,Dn.l1)(e,t),onFail:r,onReceive:o,force:!0})),[e,t])}(s,l),(0,$n.A)(s,l),function(e,t){let{types:n,entities:o,paths:r,names:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=(0,p.yF)(((i,s)=>{(0,zi.Uc)(e,t,{types:n,entities:o,paths:r,names:a}).then((n=>{let{data:o}=n;return s((0,_o.Mg)({spaceId:e,roomId:t}),o)}))}));(0,x.useEffect)((()=>{e&&t&&i()}),[e,t,n,o,r,a])}(s,l),M(),(0,x.useEffect)((()=>{w||i||u||m(r)}),[w,r,u,i,m]),u?(0,re.jsx)(x.Suspense,{fallback:"",children:(0,re.jsx)(Ys,{subCallback:u})}):i?(0,re.jsx)(d.Qk,{}):w||!r||!t||e||n?y?(0,re.jsx)(Ls,{}):(0,re.jsx)(al,{}):(0,re.jsx)(f.C5,{to:t,replace:!0})},sl=(0,s.Xc)((0,x.memo)((()=>{const e=(0,g.JT)("space:Read"),t=(0,g.JT)("room:Read"),{hasAccess:n,reason:o}=Ui();return e?n?(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(fs,{}),(0,re.jsx)(x.Suspense,{fallback:(0,re.jsx)(d.Qk,{}),children:(0,re.jsxs)(f.BV,{children:[(0,re.jsx)(f.qh,{path:"spaces/:spaceSlug/join-space",element:(0,re.jsx)(Rs,{})}),(0,re.jsx)(f.qh,{path:"spaces/:spaceSlug/no-rooms",element:(0,re.jsx)($s,{reason:"noRooms"})}),(0,re.jsx)(f.qh,{path:"spaces/:spaceSlug/settings/*",element:(0,re.jsx)(ll,{})}),(0,re.jsx)(f.qh,{path:`spaces/:spaceSlug/rooms/:roomSlug/${tl}`,element:(0,re.jsx)(x.Suspense,{fallback:(0,re.jsx)(d.NP,{}),children:(0,re.jsx)(Ws,{})})}),(0,re.jsx)(f.qh,{path:`spaces/:spaceSlug/rooms/:roomSlug/${nl}`,element:(0,re.jsx)(x.Suspense,{fallback:(0,re.jsx)(d.H$,{}),children:(0,re.jsx)(Gs,{flavour:"settingsPage"})})}),(0,re.jsx)(f.qh,{path:"spaces/:spaceSlug/rooms/:roomSlug/*",element:t?(0,re.jsx)(il,{}):(0,re.jsx)($s,{reason:"noRoomPermission"})})]})})]}):(0,re.jsx)($s,{reason:o}):(0,re.jsx)($s,{reason:"noSpacePermission"})}))),ll=()=>((0,Jn.KI)(),(0,re.jsx)(Ds,{})),dl=()=>{const e=(0,v.vt)();return(0,_i.A)(e),(0,Oi.A)(e),(e=>{const t=(0,p.yF)((0,x.useCallback)((function(t,n){let{data:{results:o}}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n((0,Vi.S)({id:e}),o)}),[])),n=(0,p.yF)((0,x.useCallback)(((t,n,o)=>{n((0,Vi.S)({id:e,key:"error"}),o)}),[])),o=(0,Ei.sC)(e,"loaded"),r=(0,g.JT)("alert:ReadAll");(0,b.A)((()=>({enabled:r&&!!e&&o,fetch:()=>(0,Dn.C2)(e),onFail:n,onReceive:t,pollingOptions:{pollingInterval:15e4}})),[e,!!o])})(e),null},cl=(0,s.Xc)((()=>{const e=(0,v.vt)();return(0,Wi.Ay)(),(0,x.useEffect)((()=>{const e=(0,i.A)(new URL(window.location.href).searchParams.get("join_callback"));e&&(window.location.href=e)}),[]),e?(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(Js,{}),(0,re.jsx)(Qs,{}),(0,re.jsx)(dl,{}),(0,re.jsx)(u.A,{permission:"space:Read",children:t=>t?(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(f.BV,{children:(0,re.jsx)(f.qh,{path:"/*",element:(0,re.jsx)(vs,{})})}),(0,re.jsx)(x.Suspense,{fallback:(0,re.jsx)(d.Qk,{}),children:(0,re.jsx)(sl,{})})]}):(0,re.jsx)($s,{reason:"noSpacePermission"},e)}),(0,re.jsx)(x.Suspense,{fallback:"",children:(0,re.jsx)(Ps,{})}),(0,re.jsxs)(x.Suspense,{fallback:"",children:[(0,re.jsx)(Bs,{}),(0,re.jsx)(Ms,{}),(0,re.jsx)(Fs,{})]})]}):(0,re.jsx)(d.Qk,{})}))},90901:(e,t,n)=>{n.d(t,{I:()=>d,q:()=>l});n(98992),n(8872);var o=n(96540),r=n(15920),a=n(24013),i=n(19186);const s=(e,t)=>t?e[t]:e,l=e=>{const t=(0,a.BU)(),n=(0,a.Gt)(t);return(0,o.useMemo)((()=>n.reduce(((t,n)=>{const{capabilities:{ml:o}}=n;return o?.enabled?t.predicting=[...t.predicting,s(n,e)]:t.incapable=[...t.incapable,s(n,e)],t}),{predicting:[],incapable:[]})),[t.length,e])},d=e=>{const t=(0,r.Zp)(),n=(()=>{const e=(0,i.r9)();return e&&`${e}/anomalies`})();return(0,o.useCallback)((function(){t(n,{state:{nodeId:arguments.length>0&&void 0!==arguments[0]?arguments[0]:e}})}),[n,t])}},91100:(e,t,n)=>{n.d(t,{A:()=>d});n(96540);var o=n(65258),r=n(9962),a=n(19075),i=n(2626),s=n(74848);const l=e=>{let{critical:t,warning:n,error:a,testPrefix:i,...l}=e;const d=(0,r.I)({error:a,testPrefix:i,flavour:t?"error":"disabledError",value:t}),c=(0,r.I)({error:a,testPrefix:i,flavour:n?"warning":"disabledWarning",value:n});return(0,s.jsx)(o.Flex,{...l,children:(0,s.jsx)(o.MasterCard,{"data-testid":"alertsMastercard",pillLeft:d,pillRight:c,size:"small"})})},d=e=>{let{id:t,testPrefix:n,...o}=e;const r=(0,i.Xt)(t),{critical:d,warning:c}=(0,a.AO)(r);return(0,s.jsx)(l,{"data-testid":"alerts",testPrefix:n,critical:d,warning:c,...o})}},93335:(e,t,n)=>{n.d(t,{N:()=>c,W:()=>u});n(96540);var o=n(19075),r=n(2626),a=n(87083),i=n(41716),s=n(91100),l=n(74848);const d=e=>{let{critical:t,warning:n,error:o}=e;return(0,l.jsx)(s.A,{critical:t,"data-testid":"tabAlerts",error:o,testPrefix:"tabAlerts-alert",warning:n,margin:[0,0,0,1]})},c=e=>{let{nodeId:t}=e;const n=(0,r.Xt)(t),{critical:a,warning:i}=(0,o.AO)(n);return(0,l.jsx)(d,{critical:a,warning:i})},u=()=>{const e=(0,a.w7)({emptyIfAll:!1}),t=(0,r.YS)(e),n=(0,i.s)("error"),{critical:s,warning:c}=(0,o.AO)(t);return(0,l.jsx)(d,{critical:s,warning:c,error:n})}},95836:(e,t,n)=>{n.d(t,{$:()=>u});n(96540);var o=n(65258),r=n(73613),a=n(4719),i=n(59895),s=n(27496),l=n(74848);const d=e=>{let{name:t,tiny:n,...r}=e;const a=n?o.Text:o.H3;return"string"===typeof t?(0,l.jsx)(a,{strong:!0,...r,children:t}):t||null},c=(0,i.A)((e=>{let{hasTooltip:t,hasInfo:n,...o}=e;return t&&n?(0,l.jsx)(r.A,{content:(0,l.jsx)(s.n,{id:o.id}),isBasic:!0,children:(0,l.jsx)(d,{...o})}):(0,l.jsx)(d,{...o})})),u=(0,a.aV)(c,(e=>{let{name:t,info:n}=e;return{name:t,hasInfo:!!n}}))},97141:(e,t,n)=>{n.d(t,{A:()=>p});var o=n(96540),r=n(19186),a=n(24609),i=n(93335),s=n(41716),l=n(93883),d=n(74848);const c=()=>{const e=(0,s.s)("error"),t=(0,s.s)("updatedAt");return(0,d.jsx)(l.A,{error:e,updatedAt:t,text:"Alerts and Notifications"})};var u=n(99728),h=n(39175),g=n(77234),m=n(78152),x=n(4204);const p=()=>{const e=(0,r.r9)(),t=(0,u.JT)("dashboard:ReadAll"),n=(e=>(0,o.useMemo)((()=>({[g.x.home]:{id:"home",title:"Home",icon:"room_home",path:`${e}/home`,dataGa:"view-picker::click-view-home::global-view",testId:"viewPicker-home",tooltip:"A dashboard metrics from all your nodes"},[g.x.overview]:{id:"overview",title:"Metrics",icon:"room_overview",path:`${e}/overview`,dataGa:"view-picker::click-view-overview::global-view",testId:"viewPicker-overview",tooltip:"System, containers, VMs and application metrics"},[g.x.nodes]:{id:"nodes",title:"Nodes",icon:"nodes_hollow",path:`${e}/nodes`,dataGa:"view-picker::click-view-nodes::global-view",testId:"viewPicker-nodes",tooltip:"An index of your nodes with alert status and key metrics"},...!window.envSettings.isAgent&&!window.envSettings.onprem&&{[g.x.k8s]:{id:"k8s",title:"K8s",icon:"serviceKubernetes",path:`${e}/kubernetes`,dataGa:"view-picker::click-view-kubernetes::global-view",testId:"viewPicker-kubernetes",tooltip:"Kubernetes clusters and container metrics"}},[g.x.top]:{id:"top",title:"Top",icon:"top",path:`${e}/top`,dataGa:"view-picker::click-view-fn::global-overview",testId:"viewPicker-fn",tooltip:"Top processes, containers, VMs, services, queries and system components"},[g.x.logs]:{id:"logs",title:"Logs",icon:"logs",path:`${e}/logs`,dataGa:"view-picker::click-view-logs::global-overview",testId:"viewPicker-logs",tooltip:"System and application logs"},[g.x.dashboards]:{id:"dashboards",title:"Dashboards",icon:"dashboard",path:`${e}/dashboards`,dataGa:"view-picker::click-view-dashboard::global-view",testId:"viewPicker-customDashboards",tooltip:"Your custom dashboards",droppable:!0,droppableProps:{dropArea:!0,dropinDashboards:!0}},[g.x.dashboard]:{id:"dashboard",title:"Dashboard",icon:"dashboard",path:`${e}/dashboard`,dataGa:"view-picker::click-view-dashboard::global-view",testId:"viewPicker-customDashboard",tooltip:"Your local custom dashboard",droppable:!0,droppableProps:{dropArea:!0,dashboardId:h.LA}},[g.x.alerts]:{id:"alerts",title:"Alerts",icon:"alarm",path:`${e}/alerts`,dataGa:"view-picker::click-view-alerts::global-view",testId:"viewPicker-alerts",tooltip:(0,d.jsx)(c,{}),children:(0,d.jsx)(i.W,{})},[g.x.ar]:{id:"ar",title:"Anomalies",icon:"anomaliesLens",path:`${e}/anomalies`,dataGa:"view-picker::click-view-anomalies::global-view",testId:"viewPicker-anomalies",tooltip:"Anomaly Advisor - ML powered anomaly detection"},[g.x.events]:{id:"events",title:"Events",icon:"feed",path:`${e}/events`,dataGa:"view-picker::click-view-feed::global-view",testId:"viewPicker-feed",tooltip:"Activity feed"},...!x.ei&&m.Qi&&{[g.x.insights]:{id:"insights",title:"Insights [PREVIEW]",icon:"insights",path:`${e}/insights`,dataGa:"view-picker::click-view-insights::global-view",testId:"viewPicker-insights",tooltip:"Insights preview",highlight:!0}}})),[e]))(e),s=(0,a.dg)(),l=(0,r.GJ)();var p,f;return[(0,o.useMemo)((()=>[!s&&!l&&n.home,n.nodes,n.overview,n.top,n.logs,!s&&!window.envSettings.onprem&&n.k8s,!s&&t&&n.dashboards,s&&t&&n.dashboard,n.alerts,n.ar,n.events,m.Qi&&!s&&n.insights].filter(Boolean)),[e,s]),(p=e,f=!s,(0,o.useMemo)((()=>({[`${p}/overview`]:!0,[`${p}/home`]:!0,[`${p}/nodes`]:!0,[`${p}/dashboards`]:!0,[`${p}/dashboard`]:!0,[`${p}/alerts`]:!0,[`${p}/anomalies`]:!0,[`${p}/top`]:!0,[`${p}/logs`]:!0,[`${p}/events`]:!0,[`${p}/insights`]:!0})),[p,f]))]}},98383:(e,t,n)=>{n.d(t,{A:()=>f});n(98992),n(81454);var o=n(96540),r=n(65258),a=n(24013),i=n(87083),s=n(74848);const l=e=>{let{children:t}=e;return(0,s.jsxs)(r.Flex,{"data-testid":"selected-nodes-container",gap:1,alignItems:"center",width:"100%",children:[(0,s.jsx)(r.Flex,{alignItems:"center",children:(0,s.jsx)(r.TextSmall,{whiteSpace:"nowrap","data-testid":"selected-nodes-container-message",color:"primary",children:"Selected filters:"})}),(0,s.jsx)(r.Flex,{height:{max:50},overflow:{vertical:"auto"},padding:[1],gap:1,alignItems:"center",flexWrap:!0,children:t})]})},d=(0,o.memo)(l);var c=n(79748);const u=e=>{let{onRemove:t}=e;return(0,s.jsx)(r.Box,{"data-testid":"remove-button",as:r.Icon,name:"close_circle",onClick:t,cursor:"pointer",width:3,height:3,color:"textLite"})},h=e=>{let{removeFilter:t,group:n,id:o,value:a,isAnchorDisabled:i,onClick:l,ref:d}=e;const[h,g]=a.split("|"),m=g?`${h} > ${g}`:h;return(0,s.jsx)(r.Flex,{ref:d,"data-testid":`selected-node-item-${o}`,children:(0,s.jsx)(r.Pill,{flavour:"neutral",hollow:!0,children:(0,s.jsxs)(r.Flex,{position:"relative",gap:2,alignItems:"center",children:[l?(0,s.jsx)(c.A,{Component:r.TextSmall,disabled:i,onClick:l,cursor:"pointer",color:"text",hoverColor:"primary",visitedColor:"accent",disabledColor:"textLite",children:m}):(0,s.jsx)(r.TextSmall,{children:m}),(0,s.jsx)(u,{onRemove:()=>t({param:n,removedValue:o}),id:o})]})})})},g=(0,o.memo)(h),m={selectedNodeIds:"Node",nodeStatuses:"Status",nodeLabels:"Host label",nodeCapabilities:"Capability",nodeVersions:"Version"},x=e=>{let{group:t,subGroup:n,groupLabel:a,values:i,filtersByLabel:l={},hasUnion:d,union:c="AND",removeFilter:u,Component:h=g}=e;const p=a||m[t];if(!Array.isArray(i)||!i.length)return null;const f="nodeLabels"!==t||n?{}:l,b=Object.entries(f);return b.length?b.map(((e,n)=>{let[o,r]=e;return(0,s.jsx)(x,{group:t,subGroup:o,groupLabel:`${m[t]} ${o}`,values:r,hasUnion:n>0,removeFilter:u},n)})):(0,s.jsxs)(o.Fragment,{children:[d&&(0,s.jsx)(r.TextSmall,{strong:!0,children:c}),(0,s.jsxs)(r.Pill,{flavour:"neutral",hollow:!0,gap:1,TextComponent:r.Flex,textProps:{alignItems:"center",gap:1},flexWrap:!0,children:[(0,s.jsxs)(r.TextNano,{strong:!0,children:[p,":"]}),i.map(((e,a)=>(0,s.jsxs)(o.Fragment,{children:[a>0&&(0,s.jsx)(r.TextSmall,{strong:!0,children:"OR"}),(0,s.jsx)(h,{removeFilter:u,id:n?`${n}|${e}`:e,value:e,group:t})]},e)))]})]},"filter")},p=e=>{let{removeFilter:t,value:n,ref:o}=e;const r=(0,a.xY)(n,"name"),i=(0,a.xY)(n,"isOffline"),l=(0,a.d3)(n);return(0,s.jsx)(g,{ref:o,removeFilter:t,group:"selectedNodeIds",id:n,value:r,isAnchorDisabled:i,onClick:l})},f=(0,o.memo)((e=>{let{flavour:t}=e;const[[n,o=[]],a]=(0,i._e)({extraKey:t,merge:!1});if(!n.length&&!o.length)return(0,s.jsx)("div",{});const l=(0,i.Pt)(n);return(0,s.jsx)(r.Flex,{width:"100%",overflow:"hidden",padding:[2,0],children:(0,s.jsxs)(d,{children:[n.map(((e,t)=>{let[n,o]=e;return(0,s.jsx)(x,{group:n,values:o,filtersByLabel:l,hasUnion:t>0,removeFilter:a},n)})),(0,s.jsx)(x,{group:"selectedNodeIds",values:o,hasUnion:!!n.length&&!!o.length,union:"OR",removeFilter:a,Component:p})]})})}))}}]);