try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="3374a9f9-6077-4707-9d3c-f529414a2f01",e._sentryDebugIdIdentifier="sentry-dbid-3374a9f9-6077-4707-9d3c-f529414a2f01")}catch(e){}("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:{}).SENTRY_RELEASE={id:"6f1faf434b0a85eb183c91391b598f364a828f27"};(self.webpackChunkcloud_frontend=self.webpackChunkcloud_frontend||[]).push([[4269,5187],{3033:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var a=n(96540),s=n(65258),l=n(63950),i=n.n(l),o=n(10853),r=n(60266),d=n(99243),c=n(74848);const u={banner:{color:"main"},sidebar:{lineHeight:"1.6",color:"main"},freePlanUpgrade:{lineHeight:"1.6",color:"main"},billing:{color:"textLite"}},m=e=>{let{canUpgrade:t,onUpdateClick:n=i(),children:a,...l}=e;return t?(0,c.jsx)(s.Box,{"data-testid":"upgrade-to-business-banner",onClick:n,as:s.Text,cursor:"pointer",textDecoration:"underline",color:"main",...l,children:a}):null},h=e=>{let{flavour:t,couponRemainingDays:n,onUpdateClick:l=i()}=e;const{daysRemaining:h,canUpgrade:g,trialEndsAt:x}=(0,o.A)(),{isEarlybirdAndCommunitySunset:p}=(0,r.A)(),b=(0,a.useMemo)((()=>({isCoupon:n>0,isEarlybirdAndCommunitySunset:p,isBanner:"banner"==t,isSidebar:"sidebar"==t,isBilling:"billing"==t,isFreePlanUpgrade:"freePlanUpgrade"==t})),[t,n]);return(0,c.jsx)(s.Flex,{justifyContent:b.isBilling?"start":"center",alignItems:"center",width:"100%",gap:2,children:b.isCoupon?(0,c.jsxs)(s.Flex,{column:!0,children:[(0,c.jsx)(s.Text,{...u[t],fontSize:"10px",strong:!0,children:"BLACK FRIDAY OFFER"}),(0,c.jsx)(d.Te,{...u[t],fontSize:"38px",lineHeight:.8,strong:!0,children:"20% off"})]}):b.isEarlybirdAndCommunitySunset?(0,c.jsxs)(s.Flex,{column:!0,gap:1,alignItems:"center",children:[(0,c.jsxs)(s.Text,{...u[t],textAlign:"center",strong:!0,...b.isBanner?{}:{fontSize:"10px"},children:["Thank you for your support!"," ",b.isBanner?(0,c.jsx)(m,{canUpgrade:g,onUpdateClick:l,children:"Upgrade"}):null]}),(0,c.jsx)(s.Text,{...u[t],color:"primary",fontSize:"22px",lineHeight:.8,strong:!0,children:"25% Lifetime off"})]}):b.isFreePlanUpgrade?(0,c.jsx)(s.Text,{...u[t],children:"Upgrade your plan for unlimited access and Business features."}):(0,c.jsxs)(s.Text,{...u[t],children:["You have ",(0,c.jsx)(s.Text,{strong:!0,...u[t],children:`${h} days`})," ","left to explore all the features of Netdata Business."," ",b.isBilling&&(0,c.jsxs)(c.Fragment,{children:["Trial ends at"," ",(0,c.jsx)(s.Text,{strong:!0,...u[t],children:x}),"."," "]}),b.isBanner?(0,c.jsx)(m,{canUpgrade:g,onUpdateClick:l,children:"Consider upgrading for unlimited access."}):(0,c.jsx)(c.Fragment,{children:"Consider upgrading for unlimited access."})]})})}},4269:(t,n,a)=>{"use strict";a.r(n),a.d(n,{default:()=>ul});var s=a(96540),l=a(15920),i=a(24609),o=a(7960),r=a(33185),d=a(65258),c=a(44926),u=a(32788),m=a(29263),h=a(85005),g=(a(98992),a(54520),a(81454),a(99728)),x=a(49916),p=a(6304),b=a(73467),j=a(71236),f=a(74848);const C=[{id:"name",accessor:"name",header:"Name",cell:e=>{let{getValue:t,row:{original:{isMember:n}}}=e;const a=t(),s=(0,g.JT)("room:ReadAll");return(0,f.jsxs)(d.Flex,{alignItems:"center",children:[s&&n&&(0,f.jsx)(b.A,{margin:[0,1,0,0]}),(0,f.jsx)(d.Text,{margin:s&&!n&&[0,0,0,4],children:a})]})}},{id:"nodeCount",accessor:"nodeCount",header:"Nodes",cell:e=>{let{getValue:t}=e;return`${t()||0}`}},{id:"memberCount",accessor:"memberCount",header:()=>"Users",cell:e=>{let{getValue:t}=e;return`${t()||0}`}},{id:"silencing",accessorKey:"silencingState",header:"Silencing",cell:e=>{let{getValue:t}=e;return(0,f.jsx)(j.A,{flavour:"room",silencing:t()})}}];a(3949);var y=a(30569),v=a(84929),w=a(50433),T=a(258),S=a(19186),A=a(68781),I=a(93933);const k=t=>(0,y.yF)((0,s.useCallback)((async function(n,a,s){let{onSuccess:l,onFail:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=await n((0,x.$e)({id:t,key:"ids"})),r=s.map((e=>{let{id:t}=e;return t})),d=o.filter((e=>!r.includes(e)));a((0,x.$e)({id:t,key:"ids"}),d);const c=await Promise.all(d.map((e=>n((0,S.LS)({id:e})))));try{if(await(async(e,t)=>Promise.all(t.map((t=>(0,T.HN)(e,t)))))(t,r),a(A.yz,(0,I.Pb)(c)),r.forEach((e=>a((0,x.Oy)(t),e))),s.forEach((e=>{let{id:n,slug:s}=e;a((0,S.LS)({id:n}),v.Ut),a((0,A.x4)([t,s]),v.Ut)})),l&&l(),s.length>1)(0,w.r0)("Rooms were successfully deleted from Space!");else{const[e]=s;(0,w.r0)(`Room ${e.name} was successfully deleted!`)}}catch(e){a((0,x.$e)({id:t,key:"ids"}),o),i&&i(e)}}),[t]));var F=a(8363);const P=e=>{let{spaceId:t,spaceName:n,startIsCreating:a}=e;const o=k(t),r=(0,g.JT)("space:Delete"),d=(0,g.JT)("room:Read"),c=(0,g.JT)("room:Create"),u=(0,g.JT)("space:CreatePersonalSilencingRule"),m=(e,t)=>{if(!e)return;const n=Array.isArray(e)?e.map((e=>{let{id:t,name:n}=e;return{id:t,name:n}})):[{id:e.id,name:e.name}];o(n,{onSuccess:()=>t.toggleAllRowsSelected(!1)})},h=(e,t)=>{const n=t.length;if(!n)return"";return 1===n?(0,F.kI)(t[0].name):(0,F.kI)(n)},x=(e,t)=>{const a=t.length;if(!a)return"";const s={...1===a?{name:t[0].name}:{roomsLength:a},spaceName:n};return(0,f.jsx)(F.rj,{...s})},{pathname:p}=(0,l.zy)(),b=(0,i.bq)(),j=(0,l.Zp)(),C=(0,s.useCallback)((e=>j(`${p}/${e}`)),[p,j]),y=(0,s.useMemo)((()=>({goto:{handleAction:e=>{let{slug:t}=e;return C(t)},icon:"chevron_right",tooltipText:"Room settings",isDisabled:()=>!d},addRule:{handleAction:e=>{const t={roomId:e.id};j(`/spaces/${b}/settings/notifications#notificationsActiveTab=1&silencingRulePrefill=${JSON.stringify(t)}`)},icon:"alarm_off",flavour:"hollow",neutral:!1,isDisabled:()=>!u,tooltipText:"Add new silencing rule",confirmation:!1},delete:{confirmLabel:"Yes, delete",confirmationMessage:e=>(0,f.jsx)(F.rj,{name:e.name,spaceName:n}),confirmationTitle:e=>(0,F.TU)(e.name),dataGa:e=>{let{slug:t}=e;return`manage-rooms::click-delete::${t}`},declineLabel:"Cancel",handleAction:m,isDisabled:e=>{let{untouchable:t}=e;return t||!r},tooltipText:"Delete room"}})),[r,C,u,d]);return{bulkActions:(0,s.useMemo)((()=>({addEntry:{dataGa:"manage-rooms::click::add-room",handleAction:a,isDisabled:!c,tooltipText:"Create room"},delete:{confirmationMessage:x,confirmationTitle:h,confirmLabel:"Yes, delete",dataGa:"manage-rooms::delete-bulk",declineLabel:"Cancel",handleAction:m,isDisabled:!r,tooltipText:"Delete rooms"}})),[c,r,x,h]),rowActions:y,onClickRow:C}},M=()=>{const e=(0,x.DL)(),t=(0,g.JT)("room:Delete"),n=e.filter((e=>!e.isAgent)).map((e=>({...e,disabled:e.untouchable||!t}))),[a,l]=(0,s.useState)(""),o=(0,i.ap)("name"),r=(0,i.ap)("id"),[d,,c,u]=(0,p.A)(),[,m]=(0,s.useState)([]),{bulkActions:h,rowActions:b}=P({startIsCreating:c,spaceId:r,spaceName:o});return{roomList:n,globalFilter:a,spaceName:o,spaceId:r,isCreating:d,rowActions:b,bulkActions:h,columns:C,startIsCreating:c,stopIsCreating:u,setGlobalFilter:l,onRowSelected:m,dataGa:"manage-rooms"}};var $=a(60908);const L=e=>{const{roomList:t,spaceName:n,isCreating:a,columns:s,setGlobalFilter:l,stopIsCreating:i,onRowSelected:o,rowActions:r,bulkActions:c,dataGa:u}=M();return(0,f.jsxs)($.Ay,{tab:"Rooms",children:[(0,f.jsxs)(d.Flex,{column:!0,height:"100%",overflow:"hidden",gap:3,...e,children:[(0,f.jsxs)(d.H3,{children:["Rooms of ",n]}),(0,f.jsx)(d.Table,{onSearch:l,onRowSelected:o,enableSorting:!0,dataColumns:s,enableSelection:!0,data:t,bulkActions:c,rowActions:r,dataGa:u,testPrefixCallback:e=>e.name})]}),a&&(0,f.jsx)(h.n,{onClose:i})]})};var R=a(92368),N=a(98545),D=a(6387),B=a(80372),_=a(86663),U=a(83268),E=a(24013);const V=()=>{const e=(0,U.CK)();return{nodes:(0,E.Gt)(e).map((e=>({...e,disabled:e.hasAccessibleData})))||[],nodeIds:e}};var H=a(37156);const O=(0,o.A)((()=>a.e(2634).then(a.bind(a,12634))),"Rules"),W=(0,s.memo)((e=>{let{roomUntouchable:t,...n}=e;const{nodes:a}=V({roomUntouchable:t});return(0,f.jsx)($.Ay,{tab:"Room::Nodes",children:(0,f.jsxs)(d.Flex,{column:!0,height:"100%",overflow:"hidden",gap:3,...n,children:[t?null:(0,f.jsx)(s.Suspense,{fallback:"",children:(0,f.jsx)(O,{})}),(0,f.jsx)(H.A,{flavour:"roomNodes",showClaimNodeOnEmptySpace:!0,enableSelection:!0,customNodes:a,roomUntouchable:t})]})})}));var Y=a(47410),q=a(82505),z=a(83488),J=a.n(z),G=a(66245),K=a.n(G),Z=a(86706),Q=a(63231),X=a(6084);const ee=[{id:"user",accessorKey:"user",header:"Name",cell:e=>{let{cell:t}=e;const{avatarURL:n,name:a}=t.row.original;return(0,f.jsxs)(d.Flex,{alignItems:"center",gap:2,children:[(0,f.jsx)(X.A,{src:n,title:a}),(0,f.jsx)(d.TextSmall,{children:a})]})}},{id:"email",accessorKey:"email",header:"Email",cell:e=>{let{getValue:t}=e;return(0,f.jsx)(d.TextSmall,{children:t()})}}],te=[{id:"user",desc:!1}],ne=e=>{let{setSelected:t}=e;const n=(0,Z.Gi)(),a=(0,q.lb)(),l=(0,s.useMemo)((()=>K()(n,a)),[n,a]),i=(0,s.useCallback)((e=>{t(e.map((e=>e.id)))}),[]),o=(0,Q.Uv)(l);return(0,f.jsx)(d.Flex,{alignItems:"start",padding:[1],overflow:{horizontal:"hidden",vertical:"auto"},children:(0,f.jsx)(d.Table,{dataColumns:ee,data:o,autoResetSelectedRows:!0,sortableBy:te,onSearch:J(),onRowSelected:i,enableSelection:!0,enableSorting:!0})})};var ae=a(3203);const se=(0,ae.A)(d.Button),le=e=>{let{onAdd:t,onClose:n,selected:a,error:s,name:l}=e;return(0,f.jsxs)(d.Flex,{alignItems:"center",justifyContent:"between",children:[s?(0,f.jsxs)(d.Text,{color:"error",children:["Select at least 1 user to add to ",l]}):(0,f.jsx)("div",{}),(0,f.jsxs)(d.Flex,{gap:2,children:[(0,f.jsx)(d.Button,{neutral:!0,flavour:"hollow",onClick:n,label:"Cancel"}),(0,f.jsx)(se,{disabled:!a.length,label:`Add ${a.length} members`,onClick:t})]})]})};var ie=a(76238),oe=a(80269),re=a(64091),de=a(40298),ce=a(12724),ue=a(51900),me=a(63872),he=a(63936),ge=a(79748),xe=a(33821);const pe=e=>{let{email:t}=e;return(0,re.B9)(t)},be={header:"Invitations",text:"Invitations successfully sent!"},je=e=>{const{id:t,slug:n}=(0,i.ap)(),a=(0,S.ID)(),l=(0,S.wz)(a,"name"),[o,r]=(0,s.useState)([]),[,,c,u]=(0,de.gg)(t),[,m]=(0,me.A)(),[h,x]=(0,s.useState)(),[p,b]=(0,s.useState)(),j=e=>{const{header:t,text:n}=e||be,a=(0,ce.UI)({header:t,text:n,success:!0});ue.A.success(a,{context:"manageInvitations"}),r([]),x(Math.random())},C=(0,s.useCallback)((()=>{const e=o.filter(pe).map((e=>({email:e.email,name:e.name,role:p,roomIDs:[a]}))),t=`${window.envSettings.cloudUrl}/spaces/${n}/join-space`;c(e,t,{onSuccess:j,onError:m})}),[o,a,p]),y=(0,g._s)();return(0,f.jsxs)(d.Flex,{column:!0,...e,children:[(0,f.jsxs)(d.H4,{children:["Send invitations to ",l," room"]}),(0,f.jsx)(ie.BZ,{children:"TIP: You can send more invitations at once, separate each with a comma."}),(0,f.jsx)(oe.y,{invitations:o,setInvitations:r},h),(0,f.jsx)(d.H5,{margin:[4,0,0],children:"Role"}),(0,f.jsxs)(ie.BZ,{children:["Choose a role for invited user."," ",(0,f.jsx)(ge.A,{href:xe.S0,target:"_blank",rel:"noopener noreferrer",Component:d.TextSmall,children:"Learn more"})]}),(0,f.jsx)(he.A,{availableRoles:y,dataGA:"invite-to-room",dataTestId:"invite-selectRole",onChange:e=>{b(e.target.value)},value:p}),(0,f.jsx)(d.Box,{alignSelf:"end",margin:[4,0,0],children:(0,f.jsx)(d.Button,{label:"Send",onClick:C,disabled:0===o.length||!p,flavour:"hollow",isLoading:u})})]})},fe=e=>{let{onClose:t,room:n}=e;const[a,l]=(0,s.useState)([]),[i,o]=(0,s.useState)(!1),r=(0,q.n)(n.spaceId,n.id),c=(0,s.useCallback)((()=>{if(!a.length)return o(!0);o(!1),r(a),t()}),[a,r]);return(0,f.jsxs)(u.GO,{onClose:t,children:[(0,f.jsx)(m.z,{onClose:t,isSubmodal:!0,title:(0,f.jsxs)(f.Fragment,{children:["Manage room",(0,f.jsx)(d.TextBig,{color:"textLite",children:"\xa0/ Add Users"})]})}),(0,f.jsxs)(Y.U,{children:["Add users to room\xa0",n.name]}),(0,f.jsxs)(u.Yv,{children:[(0,f.jsx)(je,{margin:[0,0,4]}),(0,f.jsx)(d.Flex,{column:!0,flex:!0,overflow:"hidden",padding:[0,0,2,0],children:(0,f.jsx)(ne,{setSelected:l})}),(0,f.jsx)(le,{onClose:t,onAdd:c,selected:a,error:i,name:n.name})]})]})};var Ce=a(96600),ye=a(46587);const ve=e=>`Remove ${e}`,we=e=>{let{name:t,usersLength:n}=e;return n?1===n&&t?ve(t):`Remove ${a=n} ${1===a?"user":"users"}`:"";var a},Te=e=>{let{name:t,roomName:n}=e;return(0,f.jsxs)(f.Fragment,{children:["You are about to remove ",(0,f.jsx)("strong",{children:t})," from room ",(0,f.jsx)("strong",{children:n}),".",(0,f.jsx)("br",{}),"Are you sure you want to continue?"]})},Se=e=>{let{roomName:t,usersLength:n}=e;const a=1===n?`${n} user`:`${n} users`;return(0,f.jsxs)(f.Fragment,{children:["You are about to remove ",(0,f.jsx)("strong",{children:a})," from room ",(0,f.jsx)("strong",{children:t}),".",(0,f.jsx)("br",{}),"Are you sure you want to continue?"]})},Ae=e=>{let{name:t,roomName:n,usersLength:a}=e;return a?1===a&&t?(0,f.jsx)(Te,{name:t,roomName:n}):(0,f.jsx)(Se,{roomName:n,usersLength:a}):""};var Ie=a(3319);const ke=e=>{let{spaceId:t,roomId:n,startIsInviting:a,canRemoveUser:l,untouchable:i}=e;const o=(0,q.zC)(t,n),r=(0,S.XA)("name"),{sendButtonClickedLog:d,isReady:c}=(0,Ie.A)(),u=e=>{if(!e)return;const t=Array.isArray(e)?e.map((e=>{let{user:t}=e;return t.id})):[e?.user.id];o(t)},m=(0,s.useCallback)((()=>{a(),c&&d({label:"Invite users"},!0)}),[c,d]);return{rowActions:(0,s.useMemo)((()=>({remove:{confirmLabel:"Yes, remove",confirmationMessage:e=>(0,f.jsx)(Te,{name:e.name,roomName:r}),confirmationTitle:e=>ve(e.name),declineLabel:"Cancel",disabledTooltipText:e=>i?"It's not allowed to remove users from this room. Try removing them from the space.":e.isSelf?"You cannot remove yourself. Click the leave button on the room tab.":l?"Remove is disabled":"You don't have the required permissions to remove users from this room",handleAction:u,isDisabled:e=>e.disabled,tooltipText:"Remove user from room"}})),[ve,u,Te,r]),bulkActions:(0,s.useMemo)((()=>({addEntry:{handleAction:m,tooltipText:"Invite users"},remove:{confirmLabel:"Yes, remove",confirmationMessage:(e,t)=>(0,f.jsx)(Ae,{name:t[0].name,roomName:r,usersLength:t.length}),confirmationTitle:(e,t)=>we({name:t[0].name,usersLength:t.length}),declineLabel:"Cancel",disabledTooltipText:e=>i?"It's not allowed to remove users from this room. Try removing them from the space.":e.length?l?"Remove is disabled":"You don't have the required permissions to remove users from this room":"You haven't selected any users",handleAction:u,tooltipText:"Remove users from room"}})),[u,Ae,r,a,we])}},Fe=e=>{let{untouchable:t}=e;const n=(0,s.useMemo)((()=>[{id:"name",accessor:"name",header:"Name",cell:e=>{let{getValue:t}=e;return`${t()}`}},{id:"user",accessor:"user",header:"Users",cell:e=>{let{getValue:t}=e;const{name:n,avatarURL:a,email:s}=t();return(0,f.jsxs)(d.Flex,{alignItems:"center",gap:2,children:[(0,f.jsx)(X.A,{src:a,title:`${n} - ${s||"email not set"}`}),(0,f.jsx)(d.TextSmall,{children:n})]})}},{id:"email",accessor:"email",header:"Email",width:300,align:"center",cell:e=>{let{getValue:t}=e;return(0,f.jsx)(d.TextSmall,{children:t()})}}]),[]),a=(0,q.di)(),l=(0,ye.uW)("id"),o=(0,g.JT)("space:RemoveUser"),[r,c]=(0,s.useState)([]),[u,m]=(0,s.useState)(""),[h,,x,b]=(0,p.A)(),j=(0,i.ap)("id"),C=(0,S.ID)(),{rowActions:y,bulkActions:v}=ke({selectedRows:r,spaceId:j,roomId:C,startIsInviting:x,canRemoveUser:o,untouchable:t});return{columns:n,data:(0,s.useMemo)((()=>(0,Ce.L)({data:a,currentUserId:l,canRemoveUser:o,untouchable:t})),[a]),columnVisibility:{name:!1},members:a,rowActions:y,bulkActions:v,isInviting:h,globalFilter:u,stopIsInviting:b,onRowSelected:c,setGlobalFilter:m,canRemoveUser:o}},Pe=e=>{let{room:t,...n}=e;const{untouchable:a}=t,{columns:s,data:l,columnVisibility:i,members:o,rowActions:r,bulkActions:c,isInviting:u,stopIsInviting:m,onRowSelected:h,setGlobalFilter:g,canRemoveUser:x}=Fe({untouchable:a});return(0,f.jsx)($.Ay,{tab:"Room::User",children:(0,f.jsxs)(d.Flex,{column:!0,height:"100%",overflow:"hidden",gap:3,...n,children:[(0,f.jsxs)(d.H3,{children:["Users in this room (",o.length,")"]}),(0,f.jsx)(d.Table,{enableSelection:!0,enableSorting:!0,columnVisibility:i,data:l,dataColumns:s,rowActions:r,bulkActions:c,onRowSelected:h,onSearch:g,testPrefixCallback:e=>e.name}),u&&(0,f.jsx)(fe,{onClose:m,room:t})]})})},Me={room:0,nodes:1,users:2},$e=(0,r.default)(d.Box).attrs({height:"100%",padding:[4,0],border:{side:"top",color:"border"},flex:"1",overflow:"hidden"}).withConfig({displayName:"manageRoomModal__TabContent",componentId:"sc-lrxs0y-0"})([""]),Le={1:{polling:!0,pollingInterval:1e4},default:{polling:!1}},Re=()=>{const e=(0,l.Zp)(),t=(0,i.vt)(),{roomSlug:n,spaceSlug:a,settingsTab:o}=(0,l.g)(),r=(0,S.J_)(t,n),[c,u]=(0,s.useState)(Le.default);(0,N.A)({spaceId:t,id:r,...c}),(0,D.A)(t,r);const m=(0,g.JT)("room:ReadUsers"),h=(0,S.wz)(r),[x,p]=(0,s.useState)(h.name),{search:b}=(0,l.zy)(),{tab:j="room"}=_.parse(b),C=Me[j],[y,v]=(0,s.useState)(C),[w,T,A]=(0,d.useInputValue)({maxChars:255,value:h.description}),I=(0,s.useCallback)((()=>{e((0,l.tW)(B.bq,{spaceSlug:a,settingsTab:o}))}),[a,o]),k=(0,S.a8)(h.id,{shouldPersist:!0,onSuccess:I}),F=(0,s.useCallback)((()=>k({name:x,description:w})),[x,w,k]),P=(0,s.useCallback)((e=>{v(e),u(Le[e]||Le.default)}),[v,u]);return(0,f.jsxs)(d.Flex,{column:!0,justifyContent:"between",overflow:"hidden","data-testid":"manageRoom",flex:"1",height:"100%",children:[(0,f.jsxs)(d.Tabs,{"data-testid":"manageRoom-tabs",selected:y,onChange:P,TabContent:$e,height:"100%",position:"relative",overflow:"hidden",width:"100%",children:[(0,f.jsx)(d.Tab,{"data-testid":"manageRoom-roomTab",label:(0,f.jsx)(d.H5,{children:"Room"}),children:(0,f.jsx)(R.U,{roomName:x,setRoomName:p,roomDescription:w,setRoomDescription:T,charsDescIndicator:A,"data-testid":"manageRoom-roomTabContent",id:h.id,navigateToParent:I,onSaveClick:F})}),(0,f.jsx)(d.Tab,{"data-testid":"manageRoom-nodesTab",label:(0,f.jsx)(d.H5,{children:"Nodes"}),children:(0,f.jsx)(W,{roomUntouchable:h.untouchable,"data-testid":"manageRoom-nodesTabContent"})}),m&&(0,f.jsx)(d.Tab,{"data-testid":"manageRoom-usersTab",label:(0,f.jsx)(d.H5,{children:"Users"}),children:(0,f.jsx)(Pe,{"data-testid":"manageRoom-usersTabContent",room:h})})]}),y===Me.room&&(0,f.jsx)(d.Flex,{justifyContent:"end"})]})};var Ne=a(61841);const De=e=>{let{children:t}=e;return(0,Ne.TP)(),t},Be=e=>{let{children:t}=e;return(0,S.XA)().loaded?t:null},_e=()=>(0,f.jsxs)(l.BV,{children:[(0,f.jsx)(l.qh,{path:"/",element:(0,f.jsx)(L,{})}),(0,f.jsx)(l.qh,{path:":roomSlug",element:(0,f.jsx)(De,{children:(0,f.jsx)(Be,{children:(0,f.jsx)(Re,{})})})})]});var Ue=a(89942),Ee=a(39175),Ve=a(83864),He=a(41395),Oe=a(73613),We=a(74891);const Ye=(0,We.A)(d.Pill),qe={creator:{name:"Creator",tooltip:"The creator of this space"},"scim-rule":{name:"SCIM rule",tooltip:"Joined space by SCIM group"},invitation:{name:"Invitation",tooltip:"Joined space by invitation"},default:{name:"Unknown",tooltip:null}},ze=[{id:"name",accessor:"name",header:"Name",cell:e=>{let{getValue:t}=e;return`${t()}`}},{id:"user",accessor:"user",width:300,header:"Users",cell:e=>{let{getValue:t}=e;const{name:n,avatarURL:a,email:s}=t();return(0,f.jsxs)(d.Flex,{alignItems:"center",gap:2,children:[(0,f.jsx)(X.A,{src:a,title:`${n} - ${s||"email not set"}`}),(0,f.jsx)(d.TextSmall,{children:n})]})}},{id:"email",accessor:"email",header:"Email",width:300,align:"center",cell:e=>{let{getValue:t}=e;return(0,f.jsx)(d.TextSmall,{children:t()})}},{id:"type",accessor:"type",header:"Role",width:100,align:"center",cell:e=>{let{getValue:t,row:{original:{user:{deactivated:n}}}}=e;return(0,f.jsxs)(d.Flex,{alignItems:"center",gap:1,children:[(0,f.jsx)(d.TextSmall,{strong:!0,children:(0,He.Zr)(t())}),n&&(0,f.jsx)(Oe.A,{content:"This user's role doesn't have permission to access any information on the Space. Please review user's role or space's plan.",children:(0,f.jsx)(d.Icon,{name:"warning_triangle",height:"18px",width:"18px",color:["yellow","amber"]})})]})}},{id:"joinMethod",accessor:"joinMethod",header:"Join method",width:100,align:"center",cell:e=>{let{getValue:t}=e;const n=t(),{name:a,tooltip:l}=(0,s.useMemo)((()=>qe[n]||qe.default),[n]);return(0,f.jsx)(Ye,{flavour:"neutral",hollow:!0,tooltip:l,children:(0,f.jsx)(d.TextSmall,{children:a})})}}];a(8872);var Je=a(77389),Ge=a(95201),Ke=a(72884),Ze=a(31035);const Qe=t=>{const n=(0,Ke.t)();return(0,y.yF)((0,s.useCallback)((async function(a,s,l){let{onSuccess:i,onError:o}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const r=await a((0,Z.kd)({id:t,key:"ids"})),d=r.filter((e=>!e.includes(l)));s((0,Z.kd)({id:t,key:"ids"}),d);try{await(0,Je.XY)(t,l),(async e=>{let{cacheKeyPrefix:t,memberIds:n,spaceId:a}=e;const s=`${t}${(0,Ze.$)(a)}`;await(0,Ge.y)({key:s,handleResults:e=>e.results.filter((e=>!n.includes(e.id)))})})({cacheKeyPrefix:n,spaceId:t,memberIds:l}),i&&i()}catch(e){s((0,Z.kd)({id:t,key:"ids"}),r),o&&o()}}),[t]))},Xe=t=>(0,y.yF)((0,s.useCallback)((async function(n,a,s,l){let{onSuccess:i,onError:o}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const r=await n((0,Q.Z6)(s)),d=await Promise.all(s.map((async e=>({mId:e,role:await n((0,Z.K2)({id:e,spaceId:t}))})))),{role:c,...u}=l;s.forEach((e=>{a((0,Q.m)({id:e}),(e=>({...e,...u})))})),c&&s.forEach((e=>{a((0,Z.K2)({id:e,spaceId:t}),c)}));try{await(async(e,t,n)=>Promise.all(t.map((async t=>await(0,Je.w5)(e,t,n)))))(t,s,l),i&&i()}catch(e){r.forEach((e=>{let{id:t,...n}=e;return a((0,Q.m)({id:t}),{id:t,...n})})),c&&d.forEach((e=>{let{mId:n,role:s}=e;return a((0,Z.K2)({id:n,spaceId:t}),s)})),o&&o()}}),[t])),et="change-user-role",tt="changeUserRole",nt=e=>{let{handleAction:t,ids:n,onClose:a}=e;const l=(0,Z.$D)(n),i=1===l.length?l[0]:null,o=(0,g._s)(),[r,c]=(0,s.useState)(i);return(0,f.jsx)(d.ConfirmationDialog,{confirmLabel:"Save","data-ga":et,"data-testid":tt,handleConfirm:()=>{t(r),a()},handleDecline:a,isConfirmDisabled:!r,isConfirmPositive:!0,message:(0,f.jsxs)(d.Flex,{gap:2,column:!0,children:[(0,f.jsxs)(d.TextSmall,{children:["Learn more about Netdata role-based access model on"," ",(0,f.jsx)(ge.A,{href:xe.S0,target:"_blank",rel:"noopener noreferrer",Component:d.TextSmall,children:"our documentation"})]}),(0,f.jsx)(he.A,{availableRoles:o,dataGA:et,dataTestId:tt,onChange:e=>{c(e.target.value)},value:r})]}),title:"Change roles"})},at=[{id:"id",accessor:"id"},{id:"name",accessor:"name",header:"Room"}];var st=a(55093);const lt=e=>{let{loaded:t,rooms:n,error:a,setRoomIds:l}=e;const i=(0,s.useCallback)((e=>{const t=Object.entries(e).reduce(((e,t)=>{let[n,a]=t;return[...e,...a?[n]:[]]}),[]);l(t)}),[l]),o=(0,s.useMemo)((()=>t?n.reduce(((e,t)=>({...e,[t.id]:t.isMember})),{}):{}),[t,n]);return(0,s.useEffect)((()=>{if(t&&!a){const e=n.reduce(((e,t)=>[...e,...t.isMember?[t.id]:[]]),[]);l(e)}}),[t,n,a,l]),t?a?(0,f.jsx)(d.Flex,{alignItems:"center",justifyContent:"center",height:"200px",children:(0,f.jsx)(d.TextSmall,{children:a})}):(0,f.jsxs)(d.Flex,{column:!0,gap:2,height:{max:"300px"},children:[(0,f.jsx)(d.TextSmall,{children:"Select the rooms that user will be member of. Note that user will be removed from any room that is not selected."}),(0,f.jsx)(d.Table,{data:n,dataColumns:at,columnVisibility:{id:!1},enableSorting:!0,enableSelection:!0,rowSelection:o,getRowId:e=>{let{id:t}=e;return t},onRowSelectionChange:i})]}):(0,f.jsx)(st.A,{background:"dropdown",title:"Loading rooms...",height:"200px"})};var it=a(35800),ot=a(32052);const rt=e=>{let{memberId:t}=e;const n=(0,i.vt)(),[,a]=(0,Q.ZN)({memberId:t}),l=(0,s.useCallback)((e=>{a((t=>({...t,loaded:!0,value:e})))}),[a]),o=(0,s.useCallback)((e=>{a({...it.yW,loaded:!0,error:e?.message||"Something went wrong"})}),[a]);(0,ot.A)((()=>({enabled:!!t,fetch:()=>(0,Je.Hw)(n,t),onSuccess:l,onFail:o})),[n,t])};var dt=a(30811);const ct=e=>{let{data:t,onClose:n}=e;const[a,l]=(0,s.useState)([]),i=t?.user?.id,[o,r]=(0,me.A)(),c=(0,dt.l)();rt({memberId:i});const[u]=(0,Q.ZN)({memberId:i}),{loaded:m,value:h,error:g}=u,{rooms:x=[]}=h,p=(0,Q.Vj)({memberId:i}),b=(0,s.useCallback)((()=>{o({header:"Success",text:"Successfully updated user's rooms"}),c(),p()}),[o,p,c]),j=(0,Q.Pb)({memberId:i,onSuccess:b,onError:()=>r}),C=(0,s.useCallback)((()=>{j(a)}),[a,j]);return(0,f.jsx)(d.ConfirmationDialog,{confirmLabel:"Assign","data-testid":"user-rooms-assignment-dialog",handleConfirm:C,handleDecline:n,iconName:"space_new",isConfirmPositive:!0,message:(0,f.jsx)(lt,{loaded:m,rooms:x,error:g,setRoomIds:l}),title:"Assign rooms"})},ut=e=>{let{spaceId:t,startIsInviting:n}=e;const a=Qe(t),l=Xe(t),i=(0,g.JT)("space:InviteUser"),o=(0,dt.l)(),r=(0,s.useCallback)((e=>{let{role:t,members:n}=e;l(n,{role:t},{onSuccess:o})}),[]),d=e=>t=>{if(!e)return;const n=Array.isArray(e)?e.map((e=>{let{user:t}=e;return t.id})):[e?.user.id];r({role:t,members:n})},c=(0,s.useCallback)((()=>{}),[]),u=(e,t)=>{if(!e)return;const n=Array.isArray(e)?e.map((e=>{let{user:t}=e;return t.id})):[e?.user.id];a(n,{onSuccess:()=>t.toggleAllRowsSelected(!1)})},m=(0,s.useCallback)((e=>(0,f.jsxs)(f.Fragment,{children:["Are you sure you want remove ",(0,f.jsx)("strong",{children:e.name})," from this space?"]})),[]),h=(0,s.useCallback)(((e,t)=>{const n=t.length;return n?1===n?"Delete User":"Delete Users":""}),[]),x=(0,s.useCallback)(((e,t)=>{const n=t.length;return n?(0,f.jsxs)(f.Fragment,{children:["Are you sure you want remove"," ",(0,f.jsx)("strong",{children:1===n?t[0].name:`${t.length} users`})," ","from this space?"]}):""}),[]);return{rowActions:(0,s.useMemo)((()=>({userSettings:{CustomUIAction:e=>{let{data:t,...n}=e;return(0,f.jsx)(nt,{ids:[t.user.id],...n})},handleAction:d,tooltipText:"Change Role",isDisabled:e=>e.disabled,disabledTooltipText:e=>e.isSelf?"You cannot change your role":"You don't have the required permissions to change roles for users"},roomAsignment:{CustomUIAction:ct,handleAction:c,icon:"space_new",tooltipText:"Assign rooms to user",isDisabled:e=>e.disabled,disabledTooltipText:"You cannot assign rooms to this user"},delete:{handleAction:u,confirmationTitle:"Delete User",confirmationMessage:m,isDisabled:e=>e.disabled,disabledTooltipText:e=>e.isSelf?"You cannot delete yourself. Try the space info tab, to leave space.":"You don't have the required permissions to remove users from space"}})),[]),bulkActions:(0,s.useMemo)((()=>({addEntry:{handleAction:n,tooltipText:"Invite user",isDisabled:()=>!i,disabledTooltipText:"You don't have the required permissions to invite new users"},userSettings:{CustomUIAction:e=>{let{data:t,...n}=e;return(0,f.jsx)(nt,{ids:t.map((e=>{let{user:t}=e;return t.id})),...n})},handleAction:d,tooltipText:"Change Roles",disabledTooltipText:e=>e?.length?"You don't have the required permissions to change roles for users":"You haven't selected any users"},delete:{handleAction:u,confirmationTitle:h,confirmationMessage:x,disabledTooltipText:e=>e?.length?"You don't have the required permissions to remove users from space":"You haven't selected any users"}})),[i,h,x])}},mt=()=>{const e=(0,i.vt)(),t=(0,i.ns)(e,"name"),n=(0,Z.bj)(),a=(0,ye.uW)("id"),[l,,o,r]=(0,p.A)(),[d,c]=(0,s.useState)(""),[u,m]=(0,s.useState)([]),{rowActions:h,bulkActions:x}=ut({selectedRows:u,spaceId:e,startIsInviting:o}),b=(0,g.JT)("space:RemoveUser"),j=(0,g.JT)("user:ChangeRoles"),f=(0,g.Ge)(),C=b||j,y=(0,s.useMemo)((()=>(e=>{let{fromRolePermissions:t,userList:n,canModifyUser:a,currentUserId:s}=e;return n.reduce(((e,n)=>{const l=s===n?.id,i=t.includes(n.role);return e.push({name:n.name,email:n.email,user:{avatarURL:n.avatarURL,deactivated:n.deactivated,name:n.name,email:n.email,id:n.id},joinMethod:n.joinMethod,type:n.role,disabled:!i||!a||l,isSelf:l,canModifyUser:a,canSetRole:i}),e}),[])})({userList:n,currentUserId:a,canModifyUser:C,fromRolePermissions:f})),[n]);return{columns:ze,spaceName:t,members:n,currentUserId:a,data:y,isInviting:l,globalFilter:d,rowActions:h,bulkActions:x,columnVisibility:{name:!1},onRowSelected:m,setGlobalFilter:c,startIsInviting:o,stopIsInviting:r,canModifyUser:C}},ht=e=>{const{columns:t,data:n,isInviting:a,rowActions:s,bulkActions:l,columnVisibility:i,stopIsInviting:o,setGlobalFilter:r,onRowSelected:c}=mt();return(0,f.jsxs)($.Ay,{tab:"Users",children:[(0,f.jsxs)(d.Flex,{column:!0,height:"100%",overflow:"hidden",flex:"grow",padding:[2,4,0,4],...e,children:[(0,f.jsxs)(d.TextBig,{margin:[1,0,3],children:["Learn more about Netdata role-based access model on"," ",(0,f.jsx)(ge.A,{href:xe.S0,target:"_blank",rel:"noopener noreferrer",Component:d.TextBig,children:"our documentation"})]}),(0,f.jsx)(d.Table,{onSearch:r,data:n,dataColumns:t,enableSorting:!0,enableSelection:!0,onRowSelected:c,bulkActions:l,rowActions:s,columnVisibility:i,testPrefixCallback:e=>e.name})]}),a&&(0,f.jsx)(Ve.d,{onClose:o,isSubmodal:!0})]})},gt=(0,o.A)((()=>a.e(9883).then(a.bind(a,49883))),"ManageAuth"),xt=(0,o.A)((()=>a.e(2248).then(a.bind(a,52248))),"ManageScimGroups"),pt={side:"top",type:"solid",size:"1px",color:"border"},bt=e=>{const t=(0,i.ap)("id"),n=(0,Ee.ES)(t),{userManagementActiveTab:a=0}=(0,Ue.PP)(),l=(0,s.useCallback)((e=>{const t=(0,Ue.PP)();(0,Ue.Z8)({...t,userManagementActiveTab:e})}),[]);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(d.Flex,{padding:[0,0,0,4],...e,children:(0,f.jsx)(d.H3,{children:"User Management"})}),(0,f.jsxs)(d.Tabs,{selected:parseInt(a,10),onChange:l,height:"calc(100% - 110px)",margin:[4,0,0,0],children:[(0,f.jsx)(d.Tab,{"data-testid":"spaceSettings-user-management-users-tab",label:(0,f.jsx)(d.Text,{children:"Users"}),children:(0,f.jsx)(ht,{border:pt})}),n?null:(0,f.jsx)(d.Tab,{"data-testid":"spaceSettings-user-management-aaa-tab",label:(0,f.jsx)(d.Text,{children:"Authentication & Authorization"}),children:(0,f.jsx)(s.Suspense,{fallback:"",children:(0,f.jsx)(gt,{border:pt})})}),n?null:(0,f.jsx)(d.Tab,{"data-testid":"spaceSettings-user-management-scim-groups-tab",label:(0,f.jsx)(d.Text,{children:"Groups"}),children:(0,f.jsx)(s.Suspense,{fallback:"",children:(0,f.jsx)(xt,{border:pt})})})]})]})};var jt=a(55429),ft=a(28688),Ct=a(51262);const yt=(0,s.memo)((e=>{const t=(0,i.vt)(),n=(0,i.ap)("name"),{nodeIds:a,nodes:l}=(0,ft.A)(),{preferredNodes:o}=(0,Ct.A)(),[r,c]=(0,s.useState)([]),[u,,m,h]=(0,p.A)();return(0,jt.A)(t),(0,s.useEffect)((()=>{a.length&&c(o.filter((e=>a.includes(e))))}),[a,o]),(0,f.jsx)($.Ay,{tab:"Nodes",children:(0,f.jsxs)(d.Flex,{column:!0,"data-testid":"manageClaimedNodes",height:"100%",overflow:"hidden",gap:3,...e,children:[(0,f.jsx)(d.H3,{"data-testid":"manageClaimedNodes-header",children:`Connect Nodes to ${n}`}),(0,f.jsx)(H.A,{showClaimNodeOnEmptySpace:!0,showClaimModalWithRoomSelection:!0,enableSelection:!0,customNodes:l,isSpace:!0,tempPreferredNodes:r,setTempPreferredNodes:c,loading:u,startLoading:m,stopLoading:h})]})})})),vt=yt;var wt=a(3458),Tt=a(76571),St=a(49635);const At=e=>{let{name:t,spaceName:n}=e;return(0,f.jsxs)(f.Fragment,{children:["You are about to delete ",(0,f.jsx)("strong",{children:t})," channel from ",(0,f.jsx)("strong",{children:n})," space.",(0,f.jsx)("br",{}),"This cannot be undone. Are you sure you want to continue?"]})};var It=a(52838),kt=(a(37550),a(98563));const Ft=e=>{let{integration:t={},testId:n,...a}=e;const s=a.checked?"disable":"enable";return(0,f.jsx)(d.Toggle,{colored:!0,"data-testid":`${n}-toggle`,"data-ga":`manage-channels::toggle-${t.slug}-${s}::notifications-tab`,...a})},Pt=e=>{let{testId:t,tooltipContent:n="plan",...a}=e;return a.disabled?(0,f.jsx)(Oe.A,{align:"top",content:St.r7[n],"data-testid":`${t}-warning`,plain:!0,children:(0,f.jsxs)(d.Flex,{padding:[2,2,0,0],position:"relative",children:[(0,f.jsx)(kt.id,{"data-testid":`${t}-warningIcon`}),(0,f.jsx)(Ft,{testId:t,...a})]})}):(0,f.jsx)(Ft,{testId:t,...a})},Mt=e=>{let{"data-testid":t="cellName",enabled:n,id:a,integration:s,isAvailable:l,name:i,spaceId:o,tooltipContent:r,...c}=e;const u=(0,Tt.t5)(o,"channels"),m=(0,Tt.vq)(o,"channels");return(0,f.jsxs)(d.Flex,{alignItems:"center","data-testid":t,gap:4,...c,children:[(0,f.jsx)(Pt,{checked:n,disabled:!l,integration:s,onChange:e=>{let{target:t}=e;const n=t.checked;m(u.map((e=>e.id===a?{...e,enabled:n}:e))),(0,wt.Jq)(o,a,n)},testId:t,tooltipContent:r}),(0,f.jsx)(d.Text,{"data-testid":`${t}-label`,children:i})]})},$t=e=>{let{"data-testid":t="cellService",integration:n={},kindLabel:a,...s}=e;const l=St.a$[n.slug]||{};return(0,f.jsxs)(d.Flex,{alignItems:"center","data-testid":t,gap:2,justifyContent:"between",width:"100%",...s,children:[(0,f.jsxs)(d.Flex,{alignItems:"center","data-testid":`${t}-integration`,gap:2,children:[(0,f.jsx)(d.Icon,{"data-testid":`${t}-icon`,...l}),(0,f.jsx)(d.Text,{"data-testid":`${t}-label`,children:n.title})]}),(0,f.jsx)(Oe.A,{content:a,"data-testid":`${t}-kind`,plain:!0,children:(0,f.jsx)(d.Icon,{color:"textLite",height:"16px",name:St.HA[n.kind]?.icon,width:"16px"})})]})};var Lt=a(15679);const Rt=e=>{let{getValue:t}=e;const n=(t()||[]).map((e=>(0,He.Zr)(e.toLowerCase())));return n?.length?(0,f.jsx)(d.Flex,{"data-testid":"channelNotificationsCell",flexWrap:!0,gap:1,children:n.map((e=>(0,f.jsx)(d.Flex,{padding:[.5,0],children:(0,f.jsx)(Lt.A,{noTooltip:!0,value:e})},e)))}):(0,f.jsx)(d.Text,{children:"*"})},Nt=e=>{let{canManageChannels:t,roomOptions:n,notificationOptions:a,spaceId:s}=e;return[{accessor:"name",cell:e=>{let{getValue:n,row:a}=e;return(0,f.jsx)(Mt,{enabled:a.original.enabled,id:a.original.id,integration:a.original.integration,isAvailable:t&&a.original.available,name:n(),spaceId:s,tooltipContent:t?"plan":"role"})},header:"Name",id:"name"},{accessor:"integration",cell:e=>{let{getValue:t,row:n}=e;return(0,f.jsx)($t,{integration:t(),kindLabel:n.original.kindLabel})},enableColumnFilter:!0,filterFn:(e,t,n)=>{const a=e.original.integration;return n.length<1||n.some((e=>{let{value:t}=e;return""===t||t===a?.slug}))},header:"Service",id:"integration",meta:{filter:{component:"select",isMulti:!0,options:Object.keys(St.a$).map((e=>({label:e,value:e}))),tiny:!0,"data-ga":"manage-integrations::select-service::notification-integrations-tab"},tooltip:(0,f.jsxs)(d.Flex,{column:!0,width:{max:"200px"},gap:2,children:[(0,f.jsx)(d.TextMicro,{children:"Services are distinguished in two categories."}),(0,f.jsxs)(d.TextMicro,{children:[(0,f.jsx)(kt.Jg,{name:St.HA.PERSONAL.icon})," ",(0,f.jsx)(d.TextMicro,{strong:!0,children:"Personal:"})," ",St.HA.PERSONAL.tooltip]}),(0,f.jsxs)(d.TextMicro,{children:[(0,f.jsx)(kt.Jg,{name:St.HA.SYSTEM.icon})," ",(0,f.jsx)(d.TextMicro,{strong:!0,children:"System:"})," ",St.HA.SYSTEM.tooltip]})]})}},{accessor:"notificationOptions",cell:Rt,enableColumnFilter:!0,filterFn:(e,t,n)=>n.length<1||n.some((t=>{let{label:n,value:a}=t;if(e.original.internal)return n===St.Oh.label;return e.original.notificationOptions.includes(a)})),header:"Notifications",id:"notificationOptions",meta:{filter:{component:"select",isMulti:!0,options:[...a,St.Oh],tiny:!0,"data-ga":"manage-integrations::select-notification::notification-integrations-tab"}}},{accessor:"rooms",cell:e=>{let{getValue:t,row:a}=e;const s={"data-testid":"channelRoomsCell"};if(a.original.internal)return(0,f.jsx)(d.Text,{...s,children:St.Oh.label});if(!a.original.rooms&&!a.original.rooms?.length)return(0,f.jsx)(d.Text,{...s,children:St.PT.label});const l=(0,It.Pl)({roomIds:t(),roomOptions:n});return(0,f.jsx)(d.Text,{"data-testid":"channelRoomsCell",children:l})},enableColumnFilter:!0,filterFn:(e,t,n)=>n.length<1||n.some((t=>{let{label:n,value:a}=t;if(e.original.internal)return n===St.Oh.label;const s=e.original.rooms||[];return s.length?s.includes(a):n===St.PT.label})),header:"Rooms",id:"rooms",meta:{filter:{component:"select",isMulti:!0,options:n,tiny:!0,"data-ga":"manage-integrations::select-room::notification-integrations-tab"}}}]};var Dt=a(42340),Bt=a(81391);const _t=(e,t)=>{const n=(0,Tt.ef)(t),a=(0,Bt.A)({all:!0});(0,ot.A)((()=>({enabled:!!t,fetch:()=>(0,wt.t9)(e,t),onFail:e=>n({...Dt.V,error:e.message}),onSettle:()=>n({loading:!1,loaded:!0}),onSuccess:e=>n({...Dt.V,...e.rooms?{roomSelections:a.filter((t=>{let{value:n}=t;return e.rooms.includes(n)}))}:{},...e})})),[e,t])};var Ut=a(41258),Et=a(71819);const Vt=["MobileApp","Email"],Ht=()=>{const e=(0,l.Zp)(),t=(0,g.JT)("channel:Manage"),n=(0,i.vt)(),a=(0,i.ap)("name"),o=(0,i.bq)(),[r,d]=(0,me.A)(),[c,u]=(0,s.useState)(""),m=(0,Tt.bY)();(0,Ut.A)(n);const h=(0,Tt.t5)(n,"channels"),x=(0,Tt.t5)(n,"currentChannelId"),p=(0,Tt.vq)(n,"channels"),b=(0,Tt.vq)(n,"currentChannelId"),j=(0,Bt.A)({all:!0,internal:!0}),C=(0,Et.A)(),{alerts:y,name:v,rooms:w,secrets:T}=(0,Tt.g4)(x);_t(n,x);const S=(0,s.useCallback)((e=>{b(e)}),[]),A=(0,s.useCallback)((async e=>{let{id:t}=e;try{await(0,wt.Wb)(n,t),p(h.filter((e=>e.id!==t))),r({header:"Configuration deleted successfully!"})}catch(a){d(a)}}),[h,n]),I=(0,s.useCallback)((()=>{e((0,l.tW)(B.uX,{spaceSlug:o,settingsTab:B.A8,settingsSubTab:B.G0}))}),[o]),k=(0,s.useMemo)((()=>({addEntry:{dataGa:"manage-channels::click-add-channel::notifications-tab",flavour:"hollow",handleAction:I,iconColor:"success",label:t?"Add Configuration":"View configurations",small:!0,strong:!0,width:"auto",...t?{}:{icon:""}}})),[t,I]),F=(0,s.useCallback)((e=>{e&&m({id:e})}),[m]),P=(0,s.useMemo)((()=>({testNotification:{handleAction:e=>{let{id:t}=e;F(t)},icon:"notificationTrigger",confirmation:!1,tooltipText:"Test your notification settings",disabledTooltipText:"You cannot test this notification",isDisabled:e=>{let{slug:t}=e;return Vt.includes(t)}},edit:{dataGa:e=>{let{integration:t={}}=e;return`manage-rooms::click-edit::${t.slug}`},disabledTooltipText:"Edit is disabled",handleAction:e=>{let{id:t}=e;S(t)},isDisabled:e=>{let{available:n,internal:a}=e;return!t||!n||a},TooltipComponent:Oe.A,tooltipText:"Edit setting"},delete:{confirmLabel:"Yes, delete",confirmationMessage:e=>{let{integration:t={}}=e;return(0,f.jsx)(At,{name:t.name,spaceName:a})},confirmationTitle:e=>{let{name:t}=e;return(0,It.O5)(t)},dataGa:e=>{let{integration:t={}}=e;return`manage-rooms::click-delete::${t.slug}`},declineLabel:"Cancel",handleAction:A,isDisabled:e=>{let{integration:n={}}=e;return!t||n.internal},TooltipComponent:Oe.A,tooltipText:"Delete setting"}})),[t,A,I]),M=(0,s.useMemo)((()=>Nt({canManageChannels:t,roomOptions:j,notificationOptions:C,spaceId:n})),[t,j,C,n]);return{bulkActions:k,channelData:h,currentChannelId:x,columns:M,dataGa:"manage-channels",onFilter:(e,t,n)=>{const a=e.original,s=n.toLowerCase();if(a.name?.toLowerCase()?.includes(s))return!0;if(a.integration?.slug?.toLowerCase()?.includes(s))return!0;if(a.notificationLabel?.toLowerCase()?.includes(s))return!0;if(a.internal)return St.Oh.label?.toLowerCase()?.includes(s);const l=a.rooms||[];if(!l.length)return St.PT.label?.toLowerCase()?.includes(s);return(0,It.Pl)({roomIds:l,roomOptions:j}).toLowerCase().includes(s)},onModalClose:()=>{p(h.map((e=>e.id===x?{...e,alerts:y,name:v,rooms:w,secrets:T}:e))),b("")},rowActions:P,search:c,setSearch:u}};a(23215);var Ot=a(80320),Wt=a(95263),Yt=a(64903);const qt={hours:0,minutes:30},zt=e=>{let{title:t,value:n,onChange:a}=e;const l=(0,s.useMemo)((()=>{const e=60*parseInt(n,10);return isNaN(e)?null:60*parseInt(n,10)}),[n]),i=(0,s.useCallback)((e=>{a(e/60)}),[a]);return(0,f.jsxs)(d.Flex,{column:!0,gap:1,children:[(0,f.jsx)(Wt.A,{title:t,description:"Set the desired redelivery time interval for notification to be repeated (From 30 minutes up to 24 hours)."}),(0,f.jsx)(Yt.A,{testId:"notifications-repeat-interval",value:l,onChange:i,applyOnChange:!0,minValues:qt,hideSeconds:!0,size:"tiny"})]})},Jt=(0,ae.A)((0,We.A)(d.Button)),Gt="modal",Kt=e=>{let{id:t="new",integrationId:n,onClose:a,isSubmitEnabled:o}=e;const{notificationOptions:r,name:d,repeatNotificationMin:c,rooms:u,slug:m,integration:h,secrets:g}=(0,Tt.g4)(t),x=(0,dt.l)(),p=(0,l.Zp)(),[b,j]=(0,me.A)(),C=(0,i.vt)(),y=(0,i.bq)(),v=(0,Tt.bY)(),w=(0,s.useCallback)((()=>{(m||h)&&v({slug:m||h,secrets:g})}),[m,g,v]),T=(0,l.tW)(B.bq,{spaceSlug:y,settingsTab:B.A8}),S=parseInt(c,10),A=(0,s.useCallback)((async()=>{try{const e={notification_options:r,integrationID:n,...d?{name:d}:{},...u?.length?{Rooms:u}:{},...S>0?{repeat_notification_min:S}:{},secrets:g};"new"===t?await(0,wt.Qb)(C,e):await(0,wt.eQ)(C,t,e),b({header:"new"===t?"Configuration created successfully!":"Configuration updated successfully!"}),x(),a(),p(T)}catch(e){j(e)}}),[r,n,d,u,S,g,b,x,a,p,j]);return(0,f.jsxs)(kt.fn,{column:!1,gap:2,"data-testid":`${Gt}-footer`,justifyContent:"end",children:[(0,f.jsx)(Jt,{feature:"IntegrationNotification",integrationId:n,label:"Test",flavour:"hollow",onClick:w,disabled:!o,tooltipProps:{content:"Test your notification settings",align:"bottom"}}),(0,f.jsx)(Jt,{feature:"IntegrationNotification",integrationId:n,"data-testid":`${Gt}-confirmButton`,disabled:!o,label:"OK",onClick:A,textTransform:"uppercase",tooltipProps:{content:"Save your settings",align:"bottom"}})]})},Zt="modal",Qt=e=>{let{id:t="new",integrationId:n,onClose:a,...l}=e;const{notificationOptions:i,title:o,description:r,docsLink:c,fields:u,integration:m,loaded:h,name:g,required:p,roomSelections:b,repeatNotificationMin:j,secrets:C,error:y}=(0,Tt.g4)(t),v=e=>`manage-${m}-channel::${e}::notification-${n?"integrations":"channels"}-tab`,w=(0,Bt.A)({all:!0}),T=(0,x.DL)(),S=(0,Tt.ef)(t,"notificationOptions"),A=(0,Tt.ef)(t,"name"),I=(0,Tt.ef)(t,"roomSelections"),k=(0,Tt.ef)(t,"secrets"),F=(0,Tt.ef)(t,"rooms"),P=(0,Tt.ef)(t,"repeatNotificationMin"),[M,$]=(0,s.useState)({}),L=(0,Et.A)(),R=(0,s.useMemo)((()=>i?L.filter((e=>i.includes(e.value))):[]),[L,i]),N=(0,s.useMemo)((()=>Object.keys(M)),[M]),D=(0,s.useMemo)((()=>p.every((e=>(0,It.ct)(e,C[e],u[e])))),[p,C,u]),B=(0,s.useMemo)((()=>!N.length||N.every((e=>{const t=C[e].selection;return M[e].every((n=>(0,It.ct)(n,C[e][n],u[e].fields[t][n])))}))),[N,C,u,M]),_=(0,s.useMemo)((()=>!!i?.length&&D&&B),[i,D,B]),U=(0,s.useCallback)((e=>{S(e.map((e=>{let{value:t}=e;return t})))}),[S]),E=(0,s.useCallback)((e=>{if(1===T.length)return;if(0===e.length)return F([]),void I([]);if(e.length===T.length||!e[e.length-1]?.value)return F([]),void I([St.PT]);const t=e.map((e=>{let{value:t}=e;return t})).filter(Boolean),n=e.length>1?e.filter((e=>e.value)):e;F(t),I(n)}),[T,F,I]);return h?(0,f.jsx)(d.Modal,{onEsc:a,children:(0,f.jsxs)(kt.$m,{"data-testid":l["data-testid"]||Zt,...y?{height:"auto"}:{},children:[(0,f.jsx)(d.ModalHeader,{border:{side:"bottom",color:"disabled"},column:!0,"data-testid":`${Zt}-header`,gap:.5,padding:[6,4,3],children:y?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(d.H3,{children:"Error"}),a&&(0,f.jsx)(kt.Oj,{"data-ga":v("close-modal"),"data-testid":`${Zt}-close`,onClose:a})]}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(d.Flex,{alignItems:"center","data-testid":`${Zt}-headerMain`,children:[(0,f.jsxs)(d.Flex,{"data-testid":`${Zt}-titleContainer`,gap:1,children:[(0,f.jsx)(d.Icon,{"data-testid":`${Zt}-titleIcon`,...St.a$[m]||{}}),(0,f.jsx)(d.H3,{"data-testid":`${Zt}-title`,children:o})]}),a&&(0,f.jsx)(kt.Oj,{"data-ga":v("close-modal"),"data-testid":`${Zt}-close`,onClose:a})]}),(0,f.jsxs)(d.TextSmall,{as:d.Box,"data-testid":`${Zt}-description`,children:[r,"\xa0",(0,f.jsx)(ge.A,{Component:d.TextSmall,"data-ga":v("click-docs"),"data-testid":`${Zt}-docsLink`,href:c,target:"_blank",whiteSpace:"nowrap",children:"Learn how to configure it."})]})]})}),y?(0,f.jsx)(d.ModalBody,{alignItems:"center",justifyContent:"center",height:"180px",children:(0,f.jsx)(d.TextBig,{children:y})}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(d.ModalBody,{"data-testid":`${Zt}-body`,overflow:{vertical:"auto"},padding:[0],children:[(0,f.jsxs)(kt.fn,{gap:2,"data-testid":`${Zt}-standardFields`,hasBorder:!0,children:[(0,f.jsx)(d.Text,{"data-testid":`${Zt}-standardFields-header`,children:"Notification settings"}),(0,f.jsxs)(d.Flex,{column:!0,"data-testid":`${Zt}-standardFields-body`,gap:3,children:[(0,f.jsx)(Ot.A,{component:"input","data-ga":v("configuration-name-input"),"data-testid":`${Zt}-configurationName`,onChange:A,placeholder:"i.e All alerts from All nodes",title:"Configuration name",value:g}),(0,f.jsx)(Ot.A,{component:"select","data-ga":v("rooms-select"),"data-testid":`${Zt}-rooms`,isMulti:!0,closeMenuOnSelect:!1,onChange:E,options:w,placeholder:"Select rooms",title:"Rooms",value:b}),(0,f.jsx)(Ot.A,{component:"select","data-ga":v("notification-select"),"data-testid":`${Zt}-notifications`,isRequired:!0,isMulti:!0,closeMenuOnSelect:!1,onChange:U,options:L,placeholder:"Select notifications",title:"Notifications",value:R}),(0,f.jsx)(zt,{title:"Notifications repeat",value:j,onChange:P})]})]}),(0,f.jsxs)(kt.fn,{gap:2,"data-testid":`${Zt}-dynamicFields`,hasBorder:!0,children:[(0,f.jsx)(d.Text,{"data-testid":`${Zt}-dynamicFields-header`,children:"Integration configuration"}),(0,f.jsx)(d.Flex,{column:!0,"data-testid":`${Zt}-dynamicFields-body`,gap:3,children:Object.values(u).map((e=>{let{id:t,getValue:n,onChange:a,...s}=e;return(0,f.jsx)(Ot.A,{"data-ga":v(`${t}-${s.component}`),"data-testid":`${Zt}-${t}`,getDataGa:v,id:t,onChange:a?.({id:t,setRequiredSubsets:$,setSecrets:k}),secrets:C,setSecrets:k,value:n?.({id:t,secrets:C}),...s},t)}))})]})]}),(0,f.jsx)(Kt,{id:t,integrationId:n,onClose:a,isSubmitEnabled:_})]})]})}):null},Xt=e=>{let{"data-testid":t="channelList",...n}=e;const{bulkActions:a,channelData:s,currentChannelId:l,columns:i,dataGa:o,onFilter:r,onModalClose:c,rowActions:u,search:m,setSearch:h}=Ht();return(0,f.jsx)($.Ay,{tab:"Notifications::Channels",children:(0,f.jsxs)(d.Flex,{column:!0,"data-testid":t,gap:4,width:"100%",height:"100%",overflow:"hidden",padding:[2,4],flex:"1",...n,children:[(0,f.jsx)(d.Table,{bulkActions:a,data:s,dataColumns:i,dataGa:o,globalFilter:m,globalFilterFn:r,onSearch:h,rowActions:u,testPrefix:"channelList",testPrefixCallback:e=>e.name}),!!l&&(0,f.jsx)(Qt,{"data-testid":"editChannelModal",id:l,onClose:c})]})})},en=0,tn=(0,o.A)((()=>a.e(9961).then(a.bind(a,19961))),"SilencingRules"),nn=(0,o.A)((()=>a.e(2948).then(a.bind(a,22948))),"Reachability"),an=()=>{const{notificationsActiveTab:e=en}=(0,Ue.PP)(),t=(0,s.useCallback)((e=>{const t=(0,Ue.PP)();(0,Ue.Z8)({...t,notificationsActiveTab:e})}),[]);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(d.Flex,{padding:[0,0,4,4],children:(0,f.jsx)(d.H3,{children:"Alerts & Notifications"})}),(0,f.jsxs)(d.Tabs,{selected:parseInt(e,10),onChange:t,height:"100%",overflow:"hidden",children:[(0,f.jsx)(d.Tab,{"data-testid":"spaceSettings-notifications-methods-tab","data-ga":"manage-space::click-tab::notifications-methods-tab",label:(0,f.jsx)(d.Text,{children:"Notification Methods"}),children:(0,f.jsx)(Xt,{})}),(0,f.jsx)(d.Tab,{"data-testid":"spaceSettings-notifications-silencing-rules-tab","data-ga":"manage-space::click-tab::notifications-silencing-rules-tab",label:(0,f.jsx)(d.Text,{children:"Silencing Rules"}),children:(0,f.jsx)(s.Suspense,{children:(0,f.jsx)(tn,{})})}),(0,f.jsx)(d.Tab,{"data-testid":"spaceSettings-reachability-notifications-tab","data-ga":"manage-space::click-tab::reachability-notifications-tab",label:(0,f.jsx)(d.Text,{children:"Reachability"}),children:(0,f.jsx)(s.Suspense,{children:(0,f.jsx)(nn,{})})})]})]})};var sn=a(93926),ln=a(39651);const on=e=>{let{available:t,"data-testid":n="card",description:a,docsLink:l,fields:i,id:o,internal:r,kind:c,kindLabel:u,slug:m,required:h,title:x,...b}=e;const j=St.a$[m]||{},C=(0,Tt.Mw)("new"),y=(0,Tt.ef)("new"),v=(0,g.JT)("channel:Manage"),[w,,T,S]=(0,p.A)(!1),A=(0,s.useCallback)((()=>{y({...Dt.V,title:x,description:a,docsLink:l,fields:i,integration:m,loading:!1,loaded:!0,required:h,secrets:(0,It.s7)(i,h)}),T()}),[a,l,i,m,h]);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(d.Flex,{background:"elementBackground",column:!0,"data-testid":n,justifyContent:"between",flex:!1,height:37,padding:[3,2,2,3],margin:[0,0,4,0],position:"relative",overflow:"hidden",round:.5,width:75,...b,children:[(0,f.jsx)(kt.MU,{"data-testid":`${n}-blurredIcon`,...j}),(0,f.jsxs)(d.Flex,{column:!0,"data-testid":`${n}-details`,gap:3,margin:[0,0,3,0],children:[(0,f.jsxs)(d.Flex,{"data-testid":`${n}-header`,justifyContent:"between",children:[(0,f.jsxs)(d.Flex,{alignItems:"center","data-testid":`${n}-titleContainer`,gap:1,children:[(0,f.jsx)(d.Icon,{"data-testid":`${n}-icon`,...j}),(0,f.jsx)(d.Text,{"data-testid":`${n}-title`,children:x})]}),!r&&t&&(0,f.jsx)(Oe.A,{align:"bottom",content:v?"":St.WB,plain:!0,children:(0,f.jsx)(d.Box,{children:(0,f.jsx)(kt.ro,{"data-ga":`manage-integration-${m}::click-add::notification-integrations-tab`,"data-testid":`${n}-button`,disabled:!v,label:"Add",onClick:A})})}),!r&&!t&&(0,f.jsx)(ln.A,{"data-ga":`manage-integration-${m}::click-plan-badge::notification-integrations-tab`})]}),(0,f.jsxs)(d.TextSmall,{color:"textDescription","data-testid":`${n}-description`,children:[a," ",l&&(0,f.jsx)(ge.A,{Component:kt.W6,"data-ga":`manage-integration-${m}::click-docs::notification-integrations-tab`,"data-testid":`${n}-docsLink`,href:l,target:"_blank",whiteSpace:"nowrap",children:"Learn more."})]})]}),(0,f.jsx)(Oe.A,{align:"top",content:St.HA[c].tooltip,"data-testid":`${n}-kindContainer`,plain:!0,children:(0,f.jsxs)(d.Flex,{alignItems:"end",alignSelf:"end","data-testid":`${n}-kindContainer`,gap:1,children:[(0,f.jsx)(d.Icon,{color:"textLite","data-testid":`${n}-kindIcon`,height:"16px",name:St.HA[c].icon,width:"16px"}),(0,f.jsx)(d.TextSmall,{color:"textLite","data-testid":`${n}-kind`,children:u})]})})]}),w&&(0,f.jsx)(Qt,{"data-testid":"createChannelModal",integrationId:o,onClose:()=>{S(),C()}})]})},rn=e=>{let{"data-testid":t="group",integrations:n,title:a,...s}=e;return n.length?(0,f.jsxs)(d.Flex,{column:!0,"data-testid":t,gap:2,position:"relative",...s,children:[(0,f.jsx)(d.TextBig,{color:"textDescription","data-testid":`${t}-title`,children:a}),(0,f.jsx)(d.Flex,{flexWrap:!0,"data-testid":`${t}-integrations`,gap:4,children:n.map((e=>(0,f.jsx)(on,{"data-testid":`${e.slug}Card`,...e},e.slug)))})]}):null};var dn=a(65746);const cn=e=>{const t=(0,Tt.EE)(e);(0,ot.A)((()=>({enabled:!!e,fetch:()=>(0,wt.b8)(e),onFail:e=>t({...dn.u,error:e.message}),onSettle:()=>t({loading:!1,loaded:!0}),onSuccess:e=>{t({...dn.u,...e})}})),[e])},un=e=>{let{"data-testid":t="integrations",...n}=e;const a=(0,i.vt)(),o=(0,i.bq)();cn(a);const{available:r,error:c,loaded:u,unavailable:m}=(0,Tt.m$)(a),[h,g]=(0,s.useState)([]),[x,p]=(0,s.useState)([]),[b,j]=(0,s.useState)("");if(!u)return(0,f.jsx)(st.A,{"data-testid":`${t}-loader`,title:"Loading services..."});if(c)return(0,f.jsx)(sn.A,{"data-testid":`${t}-error`,message:c,title:`Services of ${o} are currently unavailable`});const C=(0,l.tW)(B.bq,{spaceSlug:o,settingsTab:B.A8});return(0,f.jsx)($.Ay,{tab:"Notifications::Integrations",children:(0,f.jsxs)(d.Flex,{column:!0,"data-testid":t,...n,padding:[0,3,3],gap:3,overflow:"hidden",children:[(0,f.jsx)(d.Flex,{border:{side:"bottom",color:"placeholder"},"data-testid":`${t}-header`,width:"100%",children:(0,f.jsxs)(ge.A,{as:l.N_,Component:kt.He,"data-ga":"manage-integrations::click-back::notification-integrations-tab","data-testid":`${t}-backLink`,to:C,children:[(0,f.jsx)(d.Icon,{"data-testid":`${t}-backIcon`,name:"arrow_left"}),(0,f.jsx)(d.H3,{"data-testid":`${t}-title`,children:B.ys[B.G0]})]})}),(0,f.jsxs)(d.Flex,{column:!0,"data-testid":`${t}-content`,gap:2,height:"100%",overflow:"hidden",children:[(0,f.jsx)(d.Box,{as:d.SearchInput,"data-ga":"manage-integrations::search::notification-integrations-tab","data-testid":`${t}-search`,iconLeft:(0,f.jsx)(d.Icon,{name:"magnify",color:"textLite"}),onChange:e=>{j(e),g((0,It.Zv)(r,e)),p((0,It.Zv)(m,e))},placeholder:"Search service",size:"small",width:{max:49.5}}),(0,f.jsxs)(d.Flex,{column:!0,"data-testid":`${t}-groups`,overflow:"auto",height:"100%",children:[(0,f.jsx)(rn,{"data-testid":"integrationGroupAvailable",integrations:b?h:r,title:"Available"}),(0,f.jsx)(rn,{"data-testid":"integrationGroupUnavailable",integrations:b?x:m,title:"Unavailable"})]})]})]})})},mn=()=>(0,f.jsxs)(l.BV,{children:[(0,f.jsx)(l.qh,{path:"/",element:(0,f.jsx)(an,{})}),(0,f.jsx)(l.qh,{path:`/${B.G0}`,element:(0,f.jsx)(un,{})})]});var hn=a(99236);const gn=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[(0,d.useInputValue)({maxChars:20,value:e.name||""})||{},(0,d.useInputValue)({maxChars:30,value:e.slug||""})||{},(0,d.useInputValue)({maxChars:50,value:e.description||""})||{}]};var xn=a(36348),pn=a(52353),bn=a(1174),jn=a(27965),fn=a(68531);const Cn={loading:!1,isAvailable:!1,isValid:!0,error:null},yn=e=>{const t=(0,i.ap)(),[n,a]=(0,s.useState)(Cn);return(0,s.useEffect)((()=>{if(t.slug==e)a(Cn);else{const t=(0,pn.ni)(e);a({...Cn,isValid:!1,error:t})}}),[t.slug,e]),(0,fn.A)((()=>{(0,pn.ni)(e)||t.slug==e||(a((e=>({...e,loading:!0}))),(0,jn.Q9)(e).then((e=>{let{data:t}=e;a((e=>({...e,loading:!1,error:t.isAvailable?e.error:"slugNotAvailable"})))})).catch((e=>{a((t=>({...t,loading:!1,error:e.response?.data?.errorMessage||"Error while validating slug"})))})))}),500,[e]),n},vn=e=>{let{nameInput:t,slugInput:n,descriptionInput:a,onStartSlugValidation:l,onStopSlugValidation:i,onSlugValidationError:o,...r}=e;const[c,u,m,h]=t,[g,x,p,b]=n,[j,C,y,v]=a,{loading:w,error:T}=yn(g);(0,s.useEffect)((()=>{(w?l:i)()}),[w]),(0,s.useEffect)((()=>{o(T)}),[T]);const S=(0,s.useMemo)((()=>(0,pn.fc)(c)),[c]),A=(0,s.useMemo)((()=>(0,pn.e_)(j)),[j]);return(0,f.jsxs)(d.Flex,{column:!0,gap:4,...r,children:[(0,f.jsx)(bn.A,{Component:d.TextInput,permission:"space:UpdateMeta",label:"Name",value:c,onChange:u,error:pn.xc[S],isDirty:h,instantFeedback:"all",fieldIndicator:m,"data-testid":"textInputs-spaceName",containerStyles:{width:{base:150}}}),(0,f.jsx)(bn.A,{Component:d.TextInput,permission:"space:UpdateMeta",label:"Slug",value:g,onChange:x,error:pn.xc[T]||T,isDirty:b,instantFeedback:"all",fieldIndicator:p,"data-testid":"textInputs-spaceSlug",containerStyles:{width:{base:150}}}),(0,f.jsx)(bn.A,{Component:d.TextInput,permission:"space:UpdateMeta",label:"Description",value:j,onChange:C,error:pn.xc[A],isDirty:v,instantFeedback:"all",fieldIndicator:y,"data-testid":"textInputs-spaceDescription",containerStyles:{width:{base:150}}})]})};var wn=a(30005);const Tn=e=>{let{id:t,...n}=e;return(0,f.jsxs)(d.Flex,{column:!0,gap:1,...n,children:[(0,f.jsx)(d.Text,{strong:!0,children:"Space Id"}),(0,f.jsx)(wn.Ay,{confirmationText:"Space ID copied to your clipboard.",children:t})]})};var Sn=a(6818);const An=()=>(0,f.jsxs)(d.Text,{lineHeight:1.5,children:["With the change of the Space Slug, previous ",(0,f.jsx)(d.Text,{strong:!0,children:"links will be broken"}),". In case you have some bookmarks or previous references using the previous Space Slug you should update them where possible. Please confirm you want to proceed with the change."]}),In=e=>{let{handleConfirm:t,handleDecline:n}=e;return(0,f.jsx)(d.ConfirmationDialog,{confirmLabel:"Continue","data-testid":"changeSpaceSlugDialog",handleConfirm:t,handleDecline:n,message:(0,f.jsx)(An,{}),title:"Space slug change"})};var kn=a(3561);const Fn=(0,ae.A)(d.Button),Pn=e=>{let{nameInput:t,slugInput:n,descriptionInput:a,onClose:l,isValidatingSlug:o,slugError:r,...d}=e;const c=(0,i.ap)(),u=(0,kn.A)(c.id),[m,h]=(0,s.useState)(!1),[g]=t,[x]=n,[b]=a,j=(0,s.useMemo)((()=>c.slug!==x),[c.slug,x]),[C,,y,v]=(0,p.A)(),w=()=>{l(j?x:null),h(!1)},T=()=>h(!1),S=(0,s.useCallback)((e=>{!e&&j?y():(h(!0),u({name:g,description:b,...j?{slug:x}:{}},{onSuccess:w,onFail:T}))}),[g,x,b,c.slug]),A=(0,s.useCallback)((()=>S(!0)),[S]),I=(0,s.useMemo)((()=>{const e=(0,pn.fc)(g),t=(0,pn.e_)(b);return!!(m||o||e||r||t)||c.name===g&&c.slug===x&&(c.description===b||!c.description&&!b)}),[c,g,x,b,m,o]);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(Fn,{label:"SAVE",onClick:S,isLoading:m||o,disabled:I,"data-testid":"saveSpace-button",feature:"SpaceSettings",...d}),C?(0,f.jsx)(In,{handleConfirm:A,handleDecline:v}):null]})},Mn=(0,s.memo)((e=>{let{onClose:t,...n}=e;const a=(0,i.ap)(),l=(0,i.UV)("ids"),[o,,r,c]=(0,p.A)(),[u,,m,h]=(0,p.A)(),[g,x]=(0,s.useState)(),[b,j,C]=gn({name:a.name,slug:a.slug,description:a.description});if(!a.id)return null;const y=1===l.filter((e=>!(0,Ee.ES)(e))).length;return(0,f.jsxs)($.Ay,{tab:"Info",children:[(0,f.jsxs)(d.Flex,{column:!0,gap:6,"data-testid":"manageSpace",padding:[0,0,6,0],width:{max:150},...n,children:[(0,f.jsxs)(d.Flex,{column:!0,"data-testid":"manageSpace-settings",children:[(0,f.jsx)(d.H3,{margin:[0,0,4,0],children:"Info"}),(0,f.jsxs)(d.Flex,{column:!0,gap:4,children:[(0,f.jsx)(vn,{"data-testid":"manageSpace-nameInputs",nameInput:b,slugInput:j,descriptionInput:C,onStartSlugValidation:m,onStopSlugValidation:h,onSlugValidationError:x}),(0,f.jsx)(Tn,{"data-testid":"manageSpace-spaceIdInput",id:a.id,width:{base:150}}),(0,f.jsx)(d.TextInput,{label:"Your role in space",value:(0,He.Zr)(a.roleInSpace),disabled:!0,containerStyles:{width:{base:150}}}),(0,f.jsx)(d.TextInput,{label:"Plan",value:(0,He.Vn)(a?.planName||""),disabled:!0,containerStyles:{width:{base:150}}})]})]}),(0,f.jsxs)(d.Flex,{"data-testid":"manageSpace-actions",justifyContent:"between",alignItems:"center",children:[(0,f.jsxs)(d.Flex,{"data-testid":"manageSpace-deleteLeaveActions",gap:4,children:[(0,f.jsx)(Oe.A,{align:"top",content:y&&hn.sh.leave,isBasic:!0,stretch:"align",children:(0,f.jsx)(d.Flex,{alignItems:"center",children:(0,f.jsx)(d.Button,{"data-ga":"manage-space-tab::click-leave-space::manage-space-modal","data-testid":"manageSpace-leave",disabled:y,icon:"switch_off",flavour:"borderless",label:"Leave space",neutral:!0,padding:[0],width:"fit-content",onClick:r})})}),(0,f.jsx)(Sn.A,{"data-testid":"manageSpace-delete",id:a.id,isLastSpace:y,name:a.name,onClose:t})]}),(0,f.jsx)(Pn,{"data-testid":"manageSpace-save",nameInput:b,slugInput:j,descriptionInput:C,onClose:t,isValidatingSlug:u,slugError:g})]})]}),o&&(0,f.jsx)(xn.A,{id:a.id,name:a.name,onClose:c})]})}),(()=>!0));var $n=a(36229);const Ln=()=>{const e=(0,l.Zp)(),t=(0,i.vt)(),n=(0,l.RQ)(B.uX),a=(0,l.RQ)(B.bq),{params:o}=n||a||{},{spaceSlug:r="",settingsTab:d="",settingsSubTab:c=""}=o,u=(0,i.ap)("name"),m=(0,S.J_)(t,c),h=(0,S.wz)(m,"name"),g=B.ys[d],x=(0,s.useCallback)((()=>{e((0,l.tW)(B.bq,{spaceSlug:r,settingsTab:d}))}),[r,d]),p=(0,s.useMemo)((()=>{const e=[{name:"Manage Space",isDisabled:!0},{name:u,isDisabled:!0},{name:g,...!!c&&{onClick:x}}];return c&&e.push({name:g===B.ys[B.aj]?h:B.ys[c]||c}),e}),[x,h,u,g,c]);return(0,f.jsx)($n.A,{isBig:!0,items:p,showBackButton:!1,testid:"manageSpace"})};var Rn=a(10444),Nn=a(18739),Dn=a(62718),Bn=a(3941);const _n=e=>(0,f.jsx)(d.Box,{as:"hr",height:"100%",sx:{borderWidth:"0px 0px 0px 1px",borderColor:"borderSecondary",borderStyle:"solid"},...e}),Un=()=>(0,f.jsx)(_n,{height:"1px",width:"100%",sx:{borderWidth:"1px 0px 0px 0px",borderColor:"borderSecondary",borderStyle:"solid"}});var En=a(18387);const Vn=e=>{let{currentPlan:t,billingEmail:n,paymentMethod:a,businessName:s,vatNo:l,billingAddress:i}=e;const[o,r]=(0,Nn.Qh)(),c=!!t.billingEmail&&!r,u=n||"",m=u?"":"Email is required",h=a?.id?`**** ${a?.id}`:"",g=h?"":"Payment method is required",x=i?"":"Billing address is required";return(0,f.jsxs)(d.Flex,{column:!0,gap:3,children:[(0,f.jsxs)(d.Flex,{gap:4,children:[(0,f.jsx)(d.TextInput,{value:u,label:"Billing email",placeholder:"Not specified",instantFeedback:"all",isDirty:!!m,error:m,disabled:!0}),(0,f.jsx)(d.TextInput,{value:h,label:"Default payment method",placeholder:"Not specified",instantFeedback:"all",isDirty:!!g,error:g,disabled:!0})]}),l&&(0,f.jsxs)(d.Flex,{gap:4,children:[(0,f.jsx)(d.TextInput,{value:s||"",label:"Business name",placeholder:"Not specified",disabled:!0}),(0,f.jsx)(d.TextInput,{value:l,label:"VAT number",placeholder:"Not specified",disabled:!0})]}),(0,f.jsx)(d.Flex,{children:(0,f.jsx)(d.TextInput,{value:(0,En.qN)(i)||"",label:"Billing address",placeholder:"Not specified",isDirty:!!x,error:x,disabled:!0})}),(0,f.jsxs)(ge.A,{Component:d.Flex,cursor:c?"pointer":"default",disabled:!c,onClick:o,alignItems:"center",gap:1,"data-ga":"billing-options::click::billing",children:[(0,f.jsx)("span",{children:"Change billing information and payment method"}),(0,f.jsx)(d.Icon,{name:"nav_arrow_goto",width:"12px",height:"12px"})]})]})},Hn=e=>{let{onReset:t}=e;return(0,f.jsx)(d.Box,{as:d.Icon,name:"close_circle",onClick:t,cursor:"pointer",width:3,height:3,color:"border",position:"absolute",left:"2px"})},On=e=>{let{promotionCode:t,onReset:n}=e;return(0,f.jsx)(d.Flex,{width:"100%",children:(0,f.jsx)(d.Pill,{padding:[0],flavour:"neutral",hollow:!0,children:(0,f.jsxs)(d.Flex,{position:"relative",gap:2,alignItems:"center",padding:[1,2,1,5],children:[(0,f.jsx)(Hn,{onReset:n}),(0,f.jsx)(d.Text,{children:t})]})})})},Wn=e=>{let{promotionCode:t,onApply:n,error:a}=e;const[l,i]=(0,s.useState)(t||""),o=()=>{i(""),n("")};return(0,f.jsxs)(d.Flex,{column:!0,gap:1,children:[(0,f.jsx)(d.Text,{strong:!0,children:"Promotion code"}),t&&!a?(0,f.jsx)(On,{promotionCode:t,onReset:o}):(0,f.jsxs)(d.Flex,{column:!0,gap:1,children:[(0,f.jsxs)(d.Flex,{gap:2,alignItems:"baseline",children:[(0,f.jsx)(d.TextInput,{value:l,onChange:e=>i(e.target.value),placeholder:"Promotion code"}),!a&&(0,f.jsx)(d.Button,{label:"Apply",onClick:()=>n(l),padding:[3,4],disabled:!l}),!!l&&(0,f.jsx)(d.Button,{label:"Clear",flavour:"hollow",onClick:o,padding:[3,4],disabled:!l})]}),a&&(0,f.jsx)(d.Text,{color:"error",children:a})]})]})},Yn=e=>{let{needsCommitment:t,commitment:n,handleCommitmentChange:a}=e;return t&&(0,f.jsxs)(d.Flex,{column:!0,gap:2,children:[(0,f.jsxs)(d.Flex,{gap:4,alignItems:"baseline",children:[(0,f.jsx)(d.Text,{strong:!0,style:{whiteSpace:"nowrap"},children:"Committed Nodes"}),(0,f.jsx)(d.TextInput,{onChange:a,value:n,placeholder:"i.e. 14",type:"number",min:1})]}),(0,f.jsx)(d.TextSmall,{children:"25% discount applied to the per-node cost of each committed node."})]})};var qn=a(63950),zn=a.n(qn),Jn=a(88325);const Gn={earlyBird:()=>(0,f.jsxs)(d.Text,{children:["You are moving from ",(0,f.jsx)(d.Text,{strong:!0,children:"Early Bird"})," plan to another plan, you won't be able to come back to this. The ",(0,f.jsx)(d.Text,{strong:!0,children:"Community"})," free plan will be there if you wish to cancel but this doesn't allow you to invite or change users using the Member role."]}),communityV1:e=>{let{onCtaClick:t=zn()}=e;const{url:n}=(0,Jn.A)();return(0,f.jsxs)(d.Text,{children:["You are moving from ",(0,f.jsx)(d.Text,{strong:!0,children:"Community (2023.02)"})," plan to another plan, you won't be able to come back to this. The new ",(0,f.jsx)(d.Text,{strong:!0,children:"Community (2023.11)"})," free plan will be there if you wish to cancel but this will have new limitation: max of 5 nodes active and max of 1 custom dashboard. See full details on the"," ",(0,f.jsx)(ge.A,{as:l.N_,onClick:t,to:n,disabled:!n,children:(0,f.jsx)(d.Text,{color:"primary",children:"View plans page"})}),"."]})},pro:()=>(0,f.jsxs)(d.Text,{children:["You are moving from ",(0,f.jsx)(d.Text,{strong:!0,children:"Pro"})," plan to another plan by yourself, if you proceed we won't be able to migrate you to the Business plan with your current pricing conditions as communicated."]})},Kn=e=>{let{currentPlan:t,...n}=e;const a=Gn[(e=>"earlyBird"==e.slug?"earlyBird":"free"==e.slug&&"2023.02"==e.version?"communityV1":"pro"==e.slug?"pro":null)(t)]||null;return a&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(_n,{height:"1px",width:"100%",sx:{borderWidth:"1px 0px 0px 0px",borderColor:"borderSecondary",borderStyle:"solid"}}),(0,f.jsxs)(d.Flex,{gap:3,children:[(0,f.jsx)(d.Icon,{size:"large",color:"warning",name:"warning_triangle"}),(0,f.jsx)(a,{...n})]})]})};var Zn=a(68534),Qn=a(27952);const Xn=["STRIPE_INVOICE_UNPAID"],ea=()=>{const{warnings:e}=(0,Zn.A)(),t=(0,s.useMemo)((()=>e.filter((e=>{let{warningKey:t}=e;return Xn.includes(t)}),[e])));return t.length?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(_n,{height:"1px",width:"100%",sx:{borderWidth:"1px 0px 0px 0px",borderColor:"borderSecondary",borderStyle:"solid"}}),(0,f.jsxs)(d.Flex,{gap:3,children:[(0,f.jsx)(d.Icon,{size:"large",color:"warning",name:"warning_triangle"}),(0,f.jsx)(d.Flex,{column:!0,gap:1,children:t.map((e=>{let{warningKey:t,text:n}=e;return(0,f.jsx)(Qn.A,{children:n},t)}))})]})]}):null},ta=e=>"earlyBird"===e?.slug?"earlyBird":e&&e.slug&&"free"!==e.slug?`${e.slug}-${e.interval}`:"free",na=r.default.div.withConfig({displayName:"withTableWrapper__TableWrapper",componentId:"sc-drcfxi-0"})(["margin-top:30px;"]),aa=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),sa={size:50,minSize:50,maxSize:100},la=e=>()=>(0,f.jsx)(d.Flex,{width:"100%",justifyContent:"end",children:e}),ia=e=>{let{getValue:t}=e;return(0,f.jsx)(d.Flex,{width:"100%",justifyContent:"end",children:t()})},oa=[{id:"name",accessor:"name",header:"",...sa,fullWidth:!0},{id:"price",accessor:"price",header:la("Price"),cell:ia,...sa},{id:"qty",accessor:"qty",header:la("Qty"),cell:ia,...sa},{id:"month",accessor:"month",header:la("Month"),cell:ia,...sa},{id:"total",accessor:"total",header:la("Total"),cell:ia,...sa}],ra=e=>(0,f.jsxs)(d.Flex,{gap:3,...e,children:[(0,f.jsx)(d.Icon,{size:"large",color:"warning",name:"warning_triangle"}),(0,f.jsx)(d.Text,{children:"No immediate charges are applicable to this plan subscription. On-demand usage charges will be applied based on your node period count."})]}),da=(ca=d.Table,e=>(0,f.jsx)(na,{children:(0,f.jsx)(ca,{...e})}));var ca;const ua=e=>{let{lineItems:t}=e;return(0,f.jsx)(f.Fragment,{children:t.map((e=>{const t=(n=e).description?n.description.startsWith("Discount")?{color:"primary"}:n.description.startsWith("VAT")?{color:"textLite"}:{}:{};var n;const a=e.isInfo?d.TextSmall:d.Text;return(0,f.jsxs)(d.Flex,{justifyContent:"between",children:[(0,f.jsx)(a,{...t,children:e.description}),(0,f.jsx)(a,{...t,children:aa.format(e.total?.amount)})]},e.description)}))})},ma=(e=>t=>t.lineItems.totalPayable?t.lineItems.info?.length?(0,f.jsxs)(d.Flex,{column:!0,gap:1,children:[(0,f.jsx)(e,{...t}),(0,f.jsx)(ua,{lineItems:t.lineItems.info})]}):(0,f.jsx)(e,{...t}):null)((e=>{let{lineItems:t}=e;return(0,f.jsxs)(d.Flex,{justifyContent:"between",margin:[4,0,0,0],children:[(0,f.jsx)(d.H0,{strong:!0,children:"Total payable"}),(0,f.jsx)(d.H0,{strong:!0,"data-testid":"totalPayableAmountPreview",children:aa.format(t.totalPayable.total.amount)})]})})),ha=e=>{let{previewData:t,lineItems:n,agree:a,toggleAgree:s,zeroPreviewSubscriptionTotal:l,isUpdate:i}=e;const o=!i||!!t?.paymentMethod&&!!t?.billingAddress;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(Un,{}),l&&(0,f.jsx)(ra,{padding:[0,0,2,0]}),(0,f.jsxs)(d.Flex,{gap:3,children:[(0,f.jsx)(d.Checkbox,{checked:a,onChange:s,disabled:!o}),(0,f.jsxs)(d.Text,{children:["I agree to Netdata Inc's"," ",(0,f.jsx)(ge.A,{href:"https://www.netdata.cloud/service-terms/",rel:"noopener noreferrer",target:"_blank",children:"Terms of Service"})," ","and"," ",(0,f.jsx)(ge.A,{href:"https://netdata.cloud/privacy",rel:"noopener noreferer",target:"_blank",children:"Privacy Policy"})]})]}),(0,f.jsx)(ma,{lineItems:n})]})},ga=e=>{let{lineItems:t}=e;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(da,{dataColumns:oa,data:t.table}),(0,f.jsx)(Un,{}),(0,f.jsx)(ua,{lineItems:t.footer})]})};var xa=a(43891),pa=a(71282),ba=a(10853);const ja="initial",fa=[{label:"Cost concerns"},{label:"Not using advanced features"},{label:"Switching to a different solution"},{label:"Temporary project ending"},{label:"Lack of specific feature (please specify)",specify:!0},{label:"Other (please specify}",specify:!0}],Ca=e=>{let{reason:t,setReason:n,text:a,setText:l}=e;const i=fa.map((e=>({...e,value:e.label}))),o=!!t.specify,r=(0,s.useCallback)((e=>{l(e?.target?.value)}),[l]);return(0,f.jsxs)(d.Flex,{column:!0,gap:4,children:[(0,f.jsx)(d.Text,{children:"We're sorry to see you go. To help us improve, please tell us your main reason for downgrading:"}),(0,f.jsx)(d.Select,{options:i,value:t,onChange:n,placeholder:"Please select a reason"}),o?(0,f.jsx)(d.TextInput,{value:a,onChange:r,placeholder:"Please specify"}):null]})},ya=()=>(0,f.jsxs)(d.Flex,{column:!0,gap:2,children:[(0,f.jsx)(d.Text,{children:"Are you sure you want to downgrade to the Community plan?"}),(0,f.jsx)(d.Text,{children:"Downgrading will:"}),(0,f.jsxs)(xa.K,{children:[(0,f.jsx)("li",{children:(0,f.jsx)(d.Text,{children:"Occur when your current subscription expires"})}),(0,f.jsx)("li",{children:(0,f.jsx)(d.Text,{children:"Affect all users on this Space"})}),(0,f.jsx)("li",{children:(0,f.jsx)(d.Text,{children:"Remove your access to premium features"})}),(0,f.jsx)("li",{children:(0,f.jsx)(d.Text,{children:"Restrict non-admin users' access to your Space"})}),(0,f.jsx)("li",{children:(0,f.jsx)(d.Text,{children:"Limit any business notification options after 24 hours"})})]}),(0,f.jsxs)(d.Text,{children:["We'd love to keep you on the Business plan."," ",(0,f.jsx)(ge.A,{href:"mailto:support@netdata.com",as:"a",cursor:"pointer",textDecoration:"underline",children:"Can we help address any concerns"}),"?"]})]}),va=e=>{let{onConfirm:t,onClose:n}=e;const{sendButtonClickedLog:a}=(0,Ie.A)(),{onTrial:l}=(0,ba.A)(),[i,o]=(0,s.useState)(),[r,c]=(0,s.useState)(""),[u,m]=(0,s.useState)(""),h=i==ja,g=h&&(!r||r.specify&&!u),x=(0,s.useCallback)((()=>{o(ja)}),[o]),p=(0,s.useCallback)((()=>{g||(t(),n(),a({feature:"DowngradeToCommunity",reason:r?.label,details:u},!0))}),[g,a,r,u]),b=h?p:x,j=h?"Submit and Continue Downgrade":"Proceed with Downgrade",C=(0,s.useCallback)((()=>{n(),a({description:"close-billing-plan-change-confirmation-dialog"},!0)}),[a]);return l?(0,f.jsx)(pa.A,{onDecline:C}):(0,f.jsx)(d.ConfirmationDialog,{confirmLabel:j,declineLabel:"Stay on Business Plan","data-ga":"downgrade-dialog","data-testid":"downgradeDialog",handleConfirm:b,handleDecline:C,isConfirmDisabled:g,message:h?(0,f.jsx)(Ca,{reason:r,setReason:c,text:u,setText:m}):(0,f.jsx)(ya,{}),title:"Downgrade to Community?"})};var wa=a(50979);const Ta=e=>{let{isUpdate:t,currentPlan:n={},billingEmail:a,paymentMethod:s,...l}=e;const[i,o]=(0,Nn.Qh)(),r=!!n.billingEmail&&!o;return t&&a&&s?null:(0,f.jsxs)(d.Flex,{gap:3,alignItems:"center",...l,children:[(0,f.jsx)(d.Icon,{size:"large",color:"warning",name:"warning_triangle"}),(0,f.jsxs)(d.Flex,{column:!0,gap:1,children:[(0,f.jsxs)(d.Text,{children:["You can't proceed to checkout without having provided a"," ",(0,f.jsx)(d.Text,{strong:!0,children:"payment method"})," and a ",(0,f.jsx)(d.Text,{strong:!0,children:"billing address"}),"."]}),(0,f.jsx)(ge.A,{cursor:r?"pointer":"default",disabled:!r,onClick:i,gap:1,"data-ga":"billing-options::click::billing",children:"Please go to the billing portal and fill a payment method"})]})]})},Sa=()=>(0,f.jsxs)(d.Flex,{gap:2,alignItems:"center",justifyContent:"center",children:[(0,f.jsx)(d.Icon,{size:"large",color:"warning",name:"warning_triangle"}),(0,f.jsx)(d.Text,{children:"Your space cannot be upgraded, please contact billing@netdata.cloud to resolve the issue."})]});var Aa=a(47090),Ia=a(45187);const ka=e=>e?`::commited-${e}`:"",Fa=(0,r.default)(d.Flex).withConfig({displayName:"checkoutTotals__CheckoutButtonWrapper",componentId:"sc-1q0h6ca-0"})(["background:",";padding:16px 0;position:sticky;bottom:0;z-index:20;"],(0,d.getColor)("mainBackground")),Pa=(0,ae.A)(d.Button),Ma=(e=>t=>{let{title:n,isDowngrade:a,isUpdate:s,checkoutOrUpdate:l,...i}=t;const[o,,r,d]=(0,p.A)();return s&&a?(0,f.jsxs)(f.Fragment,{children:[o&&(0,f.jsx)(va,{title:n,onConfirm:l,onClose:d}),(0,f.jsx)(e,{onClick:r,...i})]}):(0,f.jsx)(e,{onClick:l,...i})})((0,r.default)(Pa).withConfig({displayName:"checkoutTotals__CheckoutButton",componentId:"sc-1q0h6ca-1"})(["flex:auto;"])),$a=e=>{let{title:t,slug:n,onClose:a,currentPlan:l,price:i,commitment:o,currentCommitment:r=0,email:c,needsCommitment:u,previewData:m,loadingPreview:h,isUpdate:g,promotionCode:x}=e;const{isBanned:b}=i||{},j=(C=l.slug,y=n,(wa.FJ[y]?.level||0)<(wa.FJ[C]?.level||0));var C,y;const[v,w]=(0,p.A)(!1),T=b||g&&!v||!g&&!c||u&&(r===o||!o||o<1),[S,A]=(0,p.A)(),I=(0,Nn.L_)(),k=(0,Nn.M4)(),F=g||l.billingEmail,P=F?k:I,{sendLog:M,isReady:$}=(0,Ie.A)(),[L,R]=(0,me.A)(),{activate:N}=(0,Ia.H)(),D=(0,s.useCallback)((()=>{A(),P({productId:i.id,email:m?.billingEmail||c,...u&&{commitment:o},...x&&{promotionCode:x}}).then((()=>{a(),M({isSuccess:!0,details:P===F?"update-billing-plan":"checkout-billing-plan"},!0),L({header:"Success",text:"You have successfully updated your plan"})})).catch((e=>{M({isFailure:!0,details:P===F?"update-billing-plan":"checkout-billing-plan"},!0);const t=e?.response?.data||e;R({header:"Error",text:(0,Aa.o)(t?.errorMsgKey,t?.errorMessage)||t?.errorMessage||"Something went wrong"})})).finally((()=>{A(),j||N()}))}),[M,$]),B=(_=m?.invoiceLineItems,(0,s.useMemo)((()=>{if(!_?.length)return null;let e=!1;return _.reduce(((t,n)=>"Total payable"==n.description?(t.totalPayable=n,e=!0,t):(n.unitPrice?t.table=[...t.table,{id:n.description,name:n.description,price:aa.format(n.unitPrice.amount),qty:n.quantity,month:n.month,total:aa.format(n.total?.amount)}]:e?t.info=[...t.info,{...n,isInfo:!0}]:t.footer=[...t.footer,n],t)),{table:[],footer:[],info:[]})}),[_]));var _;const U=(B?.footer||[]).some((e=>{let{description:t,total:n}=e;return"Subscription Total"===t&&0===n?.amount}));return(0,f.jsxs)(d.Flex,{column:!0,gap:3,children:[h||!B||U?null:(0,f.jsx)(ga,{lineItems:B}),(0,f.jsxs)(Fa,{column:!0,gap:2,children:[g&&!h&&B&&(0,f.jsx)(ha,{isUpdate:g,previewData:m,lineItems:B,agree:v,toggleAgree:w,zeroPreviewSubscriptionTotal:U}),g&&!h&&(0,f.jsx)(Ta,{currentPlan:l,billingEmail:m?.billingEmail,paymentMethod:m?.paymentMethod,padding:[0,0,4,0],isUpdate:g}),b?(0,f.jsx)(Sa,{}):null,(0,f.jsx)(Ma,{title:t,isDowngrade:j,label:g?"Checkout":"Proceed to checkout",disabled:!!T||S,checkoutOrUpdate:D,isLoading:S,"data-ga":`proceedTocheckoutButton::click-${ta(i)}${ka(o)}::billing`,"data-testid":"billingCheckoutTotals-proceedToCheckoutButton",isUpdate:g})]})]})},La=e=>{let{prices:t,currentPlan:n}=e;const[a,l]=(0,s.useState)(0),i=t[a],o=i?.commitment,r=(0,Bt.n)("id"),d=(0,U.gr)(r,"ids"),c=(0,E.BU)(d),u=Math.max(5,c.length),[m,h]=(0,s.useState)(n.committedNodes||u);return{recurringIndex:a,setRecurringIndex:l,price:i,needsCommitment:o,commitment:m,handleCommitmentChange:e=>h(e.target.value?parseInt(e.target.value,10):"")}},Ra=e=>t=>{let{modalHeader:n="Checkout",...a}=t;return(0,f.jsx)(d.Modal,{"data-testid":"billing-modal",onEsc:a.onClose,onClickOutside:a.onClose,backdropProps:{backdropBlur:!0},children:(0,f.jsxs)(d.ModalContent,{width:{min:100,base:160},height:"90vh",children:[(0,f.jsxs)(d.ModalHeader,{children:[(0,f.jsx)(d.H4,{children:n}),(0,f.jsx)(d.ModalCloseButton,{onClose:a.onClose,testId:"close-button"})]}),(0,f.jsx)(d.ModalBody,{height:"100%",justifyContent:"between",overflow:{vertical:"auto"},children:(0,f.jsx)(e,{...a})})]})})},Na=3e5,Da=Ra((e=>{let{title:t,onClose:n,prices:a,currentPlan:i={},children:o}=e;const{recurringIndex:r,setRecurringIndex:c,price:u,needsCommitment:m,commitment:h,handleCommitmentChange:x}=La({prices:a,currentPlan:i}),{state:p}=(0,l.zy)(),[b,j]=(0,s.useState)(p?.coupon||""),[C,y]=(0,s.useState)(0),[v,w]=(0,s.useState)(Na),T=(0,g.JT)("billing:Manage"),S=(0,En.di)({price:u,promotionCode:b,commitment:h}),A=(0,Nn.qW)(S,C),{loading:I,value:k,promoCodeError:F}=A;return(0,Bn.A)((()=>{I||y((e=>e+1))}),v),(0,s.useEffect)((()=>{w(I?null:Na)}),[I]),(0,f.jsx)($.Ay,{feature:"Billing::UpdateModal",children:T?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(d.Flex,{column:!0,gap:4,children:[s.Children.map(o,(e=>(0,s.cloneElement)(e,{recurringIndex:r,setRecurringIndex:c,priceLoadable:A}))),(0,f.jsx)(Yn,{needsCommitment:m,commitment:h,handleCommitmentChange:x}),(0,f.jsx)(Un,{}),I?(0,f.jsx)(st.A,{title:"Loading billing info...",height:"auto"}):k?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(Vn,{currentPlan:i,...k}),(0,f.jsx)(Un,{}),(0,f.jsx)(Wn,{promotionCode:b,onApply:j,error:F})]}):(0,f.jsx)("div",{children:"No data available"}),(0,f.jsx)(Kn,{currentPlan:i,onCtaClick:n}),(0,f.jsx)(ea,{})]}),(0,f.jsx)($a,{title:t,slug:u.slug,currentPlan:i,onClose:n,price:u,balance:i.balance,commitment:h,needsCommitment:m,previewData:k,loadingPreview:I,isUpdate:!0,promotionCode:b})]}):(0,f.jsx)(d.Flex,{children:(0,f.jsx)(d.TextBigger,{children:"You don't have permissions to change the plan."})})})}));var Ba=a(67012);const _a=Ra((e=>{let{onClose:t,prices:n,currentPlan:a={},children:i}=e;const{recurringIndex:o,setRecurringIndex:r,price:c,needsCommitment:u,commitment:m,handleCommitmentChange:h}=La({prices:n,currentPlan:a}),x=(0,ye.uW)("email"),[p,b]=(0,s.useState)(a.billingEmail||x||""),j=(0,g.JT)("billing:Manage"),{state:C}=(0,l.zy)(),[y,v]=(0,s.useState)(C?.coupon||""),{discount:w,promoCodeError:T}=(0,Nn.D)({productId:c.id,promotionCode:y,...u&&m&&{commitment:m}}),[S,A]=(0,s.useState)(0),I=(0,En.Lf)({price:c,promotionCode:y,commitment:m}),k=(0,Nn.Tr)(I,S),{loading:F,value:P}=k;return(0,Ba.A)((()=>()=>A((e=>e+1))),[w,!y]),(0,f.jsx)($.Ay,{feature:"Billing::CheckoutModal",children:j?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(d.Flex,{column:!0,gap:4,children:[s.Children.map(i,(e=>(0,s.cloneElement)(e,{recurringIndex:o,setRecurringIndex:r,priceLoadable:k}))),(0,f.jsx)(Yn,{needsCommitment:u,commitment:m,handleCommitmentChange:h}),(0,f.jsx)(Un,{}),(0,f.jsx)(d.TextInput,{onChange:e=>b(e.target.value),value:p,label:"Billing email",placeholder:"jsmith@example.com"}),(0,f.jsx)(Un,{}),(0,f.jsx)(Wn,{promotionCode:y,onApply:v,error:T}),(0,f.jsx)(Kn,{currentPlan:a,onCtaClick:t})]}),(0,f.jsx)($a,{currentPlan:a,onClose:t,price:c,balance:a.balance,commitment:m,email:p,needsCommitment:u,previewData:P,loadingPreview:F,promotionCode:y})]}):(0,f.jsx)(d.Flex,{children:(0,f.jsx)(d.TextBigger,{children:"You don't have permissions to change the plan."})})})}));a(72577);var Ua=a(64587);const Ea=e=>{let{text:t,iconProps:n={},iconRight:a,testId:s="billing-feature-item"}=e;return a?(0,f.jsxs)(d.Flex,{"data-test-id":s,width:"100%",gap:2,justifyContent:"between",children:[(0,f.jsx)(d.TextBig,{children:t}),(0,f.jsx)(d.Box,{width:5,children:(0,f.jsx)(d.Icon,{width:"20px",height:"20px",name:"check",color:"primary",...n})})]}):(0,f.jsxs)(d.Flex,{"data-test-id":s,gap:2,children:[(0,f.jsx)(d.Box,{width:5,children:(0,f.jsx)(d.Icon,{width:"20px",height:"20px",name:"check",color:"primary",...n})}),(0,f.jsx)(d.TextSmall,{children:t})]})},Va=e=>{let{features:t,showViewDetails:n,iconRight:a}=e;return(0,f.jsxs)(d.Flex,{"data-testid":"billing-features-container",column:!0,gap:1,margin:[a?6:0,0,0,0],children:[t.map((e=>{let{text:t,icon:n,iconColor:s}=e;return(0,f.jsx)(Ea,{text:t,iconProps:{...n?{name:n}:{},...s?{color:s}:{}},iconRight:a},t)})),n&&(0,f.jsxs)(d.Flex,{gap:2,children:[(0,f.jsx)(d.Box,{width:5}),(0,f.jsxs)(ge.A,{Component:d.Flex,as:l.N_,cursor:"pointer",alignItems:"center",gap:1,color:"text",hoverColor:"textFocus",to:"all-plans",children:[(0,f.jsx)(d.Text,{strong:!0,children:"View full details"}),(0,f.jsx)(d.Icon,{name:"chevron_right",width:"16px",height:"16px"})]})]})]})};var Ha=a(95565),Oa=a(67462);const Wa=(0,We.A)(d.TextSmall),Ya=e=>{let{priceLoadable:t}=e;const{loading:n,amount:a,error:s}=t||{};return n?(0,f.jsx)(d.Text,{lineHeight:"24px",children:"Getting price..."}):s?null:a?(0,f.jsxs)(d.H3,{children:[new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a),(0,f.jsx)(d.TextSmall,{color:"textLite",children:"/Node/month (billed yearly)"})]}):null},qa=e=>{let{recurringIndex:t,slug:n,version:a,priceLoadable:l}=e;const{loading:i,value:o,hasError:r}=l||{};let c=0;const u=o?.invoiceLineItems;u?.length&&(c=u.find((e=>{let{description:t}=e;return"Nodes"==t}))?.unitPrice?.amount);const m=(0,s.useMemo)((()=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{loading:t,amount:n}=e||{},a=!t&&!n;return[{free:(0,f.jsx)(d.H3,{children:"Free forever"}),homelab:(0,f.jsxs)(d.H3,{children:["$90.00",(0,f.jsx)(d.TextSmall,{color:"textLite",children:"/year"})]}),"business_2023.02":a?(0,f.jsxs)(d.H3,{children:["$3.00",(0,f.jsx)(d.TextSmall,{color:"textLite",children:"/Node/month (billed yearly)"})]}):(0,f.jsx)(Ya,{priceLoadable:e}),"business_2024.03":a?(0,f.jsxs)(d.H3,{children:["$4.50",(0,f.jsx)(d.TextSmall,{color:"textLite",children:"/Node/month (billed yearly)"})]}):(0,f.jsx)(Ya,{priceLoadable:e}),business:(0,f.jsx)(Ya,{priceLoadable:e})},{free:(0,f.jsx)(d.H3,{children:"Free forever"}),homelab:(0,f.jsxs)(d.H3,{children:["$10.00",(0,f.jsx)(d.TextSmall,{color:"textLite",children:"/month"})]}),"business_2023.02":(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)(d.H3,{children:["$4.00",(0,f.jsx)(d.TextSmall,{color:"textLite",children:"/Node/month"})]})}),"business_2024.03":(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)(d.H3,{children:["$6.00",(0,f.jsx)(d.TextSmall,{color:"textLite",children:"/Node/month"})]})}),business:(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)(d.H3,{children:["$6.00",(0,f.jsx)(d.TextSmall,{color:"textLite",children:"/Node/month"})]})})}]}({loading:i,amount:c,error:r})),[i,c,r]);return(0,f.jsx)(d.Flex,{"data-testid":"billing-price-container",column:!0,gap:2,children:m[t][`${n}_${a}`]||m[t][n]})},za=r.default.div.withConfig({displayName:"pricingDetails__OneLine",componentId:"sc-hbslp4-0"})(["white-space:nowrap white-space:nowrap;"]),Ja=e=>{let{nodesLastPeriod:t,committedNodes:n}=e;const a=t-n,s=a>0;return 0==a?(0,f.jsx)(d.TextSmall,{children:"You are using all your committed nodes."}):s?(0,f.jsxs)(d.TextSmall,{children:["You are using"," ",(0,f.jsxs)(d.TextSmall,{strong:!0,color:"error",children:[a," ",(0,Oa.su)(a).toLowerCase()," more"]})," ","than your committed nodes."]}):(0,f.jsxs)(d.TextSmall,{children:["You are using"," ",(0,f.jsxs)(d.TextSmall,{strong:!0,color:"success",children:[t," out of ",n]})," ","committed ",(0,Oa.su)(n).toLowerCase(),"."]})},Ga=e=>{let{interval:t,currentPeriodTo:n,atPeriodEnd:a,committedNodes:l,nodesLastPeriod:i,showAllPlans:o,showPromotion:r,cancelling:c,onCancelPlan:u,commitment:m}=e;const{localeDateString:h}=(0,Ua.$j)(),g=(0,s.useMemo)((()=>"downgrade"==a?{action:"downgrades",color:"warning",tooltip:"You have requested subscription cancellation. To undo this action you can resubscribe."}:{action:"renews",color:"text",tooltip:null}),[a]),x=(0,s.useMemo)((()=>({column:!0,gap:1,...o?{alignItems:"center"}:{}})),[o]);return(0,f.jsxs)(d.Flex,{...x,children:[!!n&&(0,f.jsxs)(d.TextSmall,{children:[(0,f.jsx)(d.TextSmall,{strong:!0,"data-testid":"billingPricingDetails-interval",children:`Billing ${wa.rY[t]}`})," ",(0,f.jsxs)(Wa,{color:g.color,tooltip:g.tooltip,noWrapper:!0,children:["(",g.action," ",h(new Date(n),{long:!1}),")"]})]}),r&&"month"===t&&(0,f.jsx)(ge.A,{onClick:u,disabled:c,children:(0,f.jsx)(za,{children:"Save 25% by changing your billing frequency to yearly"})}),m?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(d.TextSmall,{children:["Committed Nodes:"," ",(0,f.jsx)(d.Text,{strong:!0,"data-testid":"billingPricingDetails-committedNodesNumber",children:l})]}),"number"===typeof i?(0,f.jsx)(Ja,{nodesLastPeriod:i,committedNodes:l}):null]}):null]})},Ka=(e=>t=>{let{inModal:n,recurringIndex:a,setRecurringIndex:s,...l}=t;return n?(0,f.jsxs)(d.Flex,{"data-testid":"billing-recurring-index-container",width:"100%",justifyContent:"between",alignItems:"center",children:[(0,f.jsx)(e,{...l}),(0,f.jsx)(d.Flex,{gap:3,padding:[0,10],children:wa.HR.map(((e,t)=>(0,f.jsx)(d.RadioButton,{checked:a===t,onChange:()=>s(t),"data-testid":`billingPaidPlans-${e}-radioButton`,children:(0,f.jsx)(d.Text,{color:"textDescription",children:(0,He.Zr)(wa.rY[e])})},e)))})]}):(0,f.jsx)(e,{...l})})((e=>{let{children:t}=e;return(0,f.jsx)(d.H3,{"data-testid":"billingPricingDetails-activePlanName",children:t})})),Za=e=>{let{slug:t,version:n,prices:a,recurringIndex:l=0,setRecurringIndex:i,currentPlan:o={},isActive:r,showAllPlans:c,showTeaserDetails:u,cancelling:m,onCancelPlan:h,title:g,features:x,nodesLastPeriod:p,inModal:b,priceLoadable:j}=e;const{onTrial:C}=(0,ba.A)(),y=r?o.pricing:a[l]?.pricing||{},v=(0,En.Kj)(t),w=(0,s.useMemo)((()=>({column:!0,gap:2,...c?{height:"140px",alignItems:"center"}:{}})),[c]),T=(0,s.useMemo)((()=>({column:!0,...c?{alignItems:"center"}:{}})),[c]);return(0,f.jsxs)(d.Flex,{"data-testid":"billing-pricing-details",...w,children:[(0,f.jsxs)(d.Flex,{...T,children:[(0,f.jsxs)(d.Flex,{alignItems:"center",gap:2,children:[(0,f.jsx)(Ka,{inModal:b,recurringIndex:l,setRecurringIndex:i,children:g}),r&&!c&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(d.Pill,{flavour:"success","data-testid":"active-plan",icon:"checkmark_s",children:C?"Trial":"Active"}),C&&(0,f.jsx)(Ha.A,{children:(0,f.jsx)(d.TextBig,{color:"primary",children:"Upgrade Now!"})})]})]}),n&&(0,f.jsxs)(d.TextBig,{children:["(",n,")"]})]}),c||!r||"free"===t?(0,f.jsx)(qa,{inModal:b,isActive:r,currentPlan:o,recurringIndex:l,slug:t,version:n,priceLoadable:j,...y}):null,!c&&u&&x?.[n]?(0,f.jsx)(Va,{features:x[n],showViewDetails:!v}):null,r&&!(0,En.Kj)(t)&&!C&&(0,f.jsx)(Ga,{...o,showAllPlans:c,showPromotion:!0,cancelling:m,onCancelPlan:h,nodesLastPeriod:p})]})},Qa=e=>{let{onConfirm:t,onDecline:n}=e;const{sendButtonClickedLog:a}=(0,Ie.A)(),[l,i]=(0,p.A)(),o=(0,s.useCallback)((()=>{a({feature:"HomelabAcceptTerms"}),t()}),[a]);return(0,f.jsx)(d.ConfirmationDialog,{title:"Terms of usage",confirmLabel:"I agree",declineLabel:"Close",handleConfirm:o,handleDecline:n,isConfirmPositive:!0,isConfirmDisabled:!l,message:(0,f.jsxs)(d.Flex,{column:!0,gap:2,children:[(0,f.jsx)(d.Text,{children:"By continuing, you acknowledge that you will use Netdata ONLY for homelab purposes. If professional use is detected you will be downgraded, and will waive any rights to refunds."}),(0,f.jsxs)(d.Text,{children:["For more details on conditions please check our"," ",(0,f.jsx)(ge.A,{href:"https://www.netdata.cloud/fair-usage-policy",rel:"noopener noreferrer",strong:!0,target:"_blank",children:"Fair Usage Policy"}),"."]}),(0,f.jsx)(d.Flex,{children:(0,f.jsx)(d.Checkbox,{checked:l,onChange:i,label:"I will NOT use the Homelab plan for professional purposes (this includes testing and staging environments).",labelPosition:"right",labelProps:{strong:!0,padding:[0,0,0,1]}})})]})})};var Xa=a(81691),es=a(52950);const ts=()=>{const{reseller:e}=(0,i.ap)();return{isReseller:!!e?.ID}},ns=()=>{const{isReseller:e}=ts();return e?(0,f.jsxs)(d.Flex,{"data-testid":"billing-reseller-warning",column:!0,gap:1,children:[(0,f.jsxs)(d.Text,{children:["This subscription is managed through a ",(0,f.jsx)(d.Text,{strong:!0,children:"Partner / Reseller"}),"."]}),(0,f.jsxs)(d.Text,{children:["To make any changes to your subscription, please contact your Partner / Reseller or reach out to"," ",(0,f.jsx)(ge.A,{href:"mailto:sales@netdata.cloud",as:"a",cursor:"pointer",children:"sales@netdata.cloud"}),"."]})]}):null};var as=a(3033),ss=a(42711),ls=a(37785);const is=(0,r.default)(d.Flex).attrs((e=>({background:"mainBackground",width:e.showAllPlans?"400px":{min:"280px"},justifyContent:e.showAllPlans?"start":"between",...e}))).withConfig({displayName:"styled__StyledWrapper",componentId:"sc-1gqbztm-0"})(["place-self:",";"],(e=>{let{showAllPlans:t}=e;return t?"center":"auto"})),os=e=>{let{slug:t,version:n,prices:a=[],isSmall:o,isActive:r,currentPlan:c,showAllPlans:u,showTeaserDetails:m,allPlansView:h=!1,nodesLastPeriod:x,asAnchor:b,anchorText:j,...C}=e;const y=(0,ye.NJ)(),v=(0,i.vt)(),{isReseller:w}=ts(),{title:T,features:S}=wa.FJ[t]||wa.FJ.free,A=(0,g.JT)("billing:Manage"),{sendLog:I,sendButtonClickedLog:k,isReady:F}=(0,Ie.A)(),{onTrial:P}=(0,ba.A)(),{cancelling:M,startCancelling:$,stopCancelling:L}=(0,Nn.og)(),R="AWS"==c.paymentProvider,N=(0,s.useCallback)((function(){let{label:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};k({label:e},!0)}),[k,F]),D=(0,En.z_)({currentPlan:c,slug:t,version:n,onTrial:P}),B=M||r&&(0,En.Kj)(t)||c.slug==wa.VH.earlyBird&&t==wa.VH.free||c.slug==wa.VH.free&&"2023.02"==c.version&&t==wa.VH.free&&"2023.11"==n,[_,U]=(0,s.useState)({}),[E,,V,H]=(0,p.A)(),[O,W]=(0,me.A)(),Y=(0,Nn.M4)(),q="cancel"===_.type&&!(0,En.Kj)(c.slug)&&!E,z="cancel"===_.type&&t==wa.VH.free&&"2023.11"==n,{id:J}=(0,ls.A)(),G=(0,dt.l)(),K=(0,s.useCallback)((()=>{V(),$(),Y({productId:J}).then((()=>{O({header:"Successfully canceled subscription",text:"You are now on Community plan"}),I({isSuccess:!0,description:"cancel-subscription"})})).catch((()=>{W({header:"Failed to cancel the subscription",text:`Remained on ${T} plan`}),I({isFailure:!0,description:"cancel-subscription",error:"Failed to cancel the subscription"})})).finally((()=>{L(),G()}))}),[I,F]),Z=(0,s.useMemo)((()=>`user-${y}-space-${v}-accept-homelab-terms`),[y,v]),Q=(0,s.useCallback)((()=>{localStorage.setItem(Z,!0)}),[Z]),X=(0,s.useCallback)((()=>"true"==localStorage.getItem(Z)),[Z]),ee=(0,s.useCallback)((e=>{if(!M&&!B)if(t!=wa.VH.homelab||c.slug==wa.VH.homelab||X()){if((0,En.Kj)(t))return U({type:"cancel"}),void I(e,!0);if((0,En.Kj)(c.slug))return oe("checkout"),void I(e,!0);oe("update"),I(e,!0)}else U({type:"homelab"})}),[I,F,_,U]),te=(0,s.useCallback)((()=>{U({}),Q(),setTimeout((()=>{ee({action:Xa.o1.buttonClicked},!0)}),200)}),[U,Q,ee]),ne=!!c.billingEmail,ae=ne?Da:_a,{billingModalType:se,billingModalSlug:le}=(0,Ue.PP)(),ie=["checkout","update"].includes(se)&&t==le,oe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const n=(0,Ue.PP)();(0,Ue.Z8)({...n,billingModalType:e,billingModalSlug:""==e?e:t})},[re,,de,ce]=(0,p.A)(),ue=(0,s.useMemo)((()=>({column:!0,height:"100%",flex:o,gap:u?4:2,showAllPlans:u,isSmall:o,padding:u?[6]:[0,2,4,2],...u?{border:{side:"all",color:"border"}}:{},...C})),[u,o,C]);return(0,f.jsxs)(f.Fragment,{children:[b?(0,f.jsx)(ge.A,{"data-testid":"billing-plan-as-anchor",onClick:()=>{ee({action:Xa.o1.buttonClicked,label:D,dataGa:`upgrade-button::click-${ta({slug:t})}::current-${ta(c)}::billing`})},children:j}):(0,f.jsxs)(is,{"data-testid":"billing-plan",...ue,children:[(0,f.jsx)(Za,{slug:t,prices:a,isActive:r,currentPlan:c,cancelling:M,showAllPlans:u,showTeaserDetails:m,title:T,version:n,features:S,nodesLastPeriod:x,onCancelPlan:()=>ee({action:Xa.o1.buttonClicked,label:T})}),(0,f.jsx)(ns,{}),!h&&(0,f.jsx)(bn.A,{Component:d.Button,permission:"billing:Manage","data-ga":`upgrade-button::click-${ta({slug:t})}::current-${ta(c)}::billing`,"data-testid":`billingPlan-${t}-${r?"currentPlan":"upgradeButton"}`,label:D,flavour:(0,En.Dy)(c?.slug,t),disabled:B,width:"100%",onClick:()=>ee({action:Xa.o1.buttonClicked,label:D,dataGa:`upgrade-button::click-${ta({slug:t})}::current-${ta(c)}::billing`}),isLoading:M&&r,loadingLabel:"Cancelling"}),u&&!!S[n]?.length&&(0,f.jsx)(Va,{features:S[n],iconRight:!0}),!u&&!w&&(0,f.jsxs)(f.Fragment,{children:[P&&(0,f.jsx)(as.A,{flavour:"billing"}),(P||!(0,En.Kj)(c.slug))&&(0,f.jsxs)(d.Flex,{column:!0,gap:4,children:[(0,f.jsxs)(d.Flex,{gap:6,alignItems:"baseline",children:[P&&(0,f.jsx)(es.A,{}),!(0,En.Kj)(c.slug)&&!R&&(0,f.jsxs)(ge.A,{Component:d.Flex,as:l.N_,cursor:"pointer",alignItems:"center",gap:1,color:"text",hoverColor:"textFocus",to:"all-plans",padding:[4,0,0],disabled:M,onClick:()=>N({label:A?"Change plan":"View plans"}),"data-testid":"billingPlan-viewMorePlansLink","data-ga":"change-plan::click::billing",children:[(0,f.jsx)("span",{children:A?"Change plan":"View plans"}),(0,f.jsx)(d.Icon,{name:"chevron_right",width:"16px",height:"16px"})]})]}),P&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(ss.A,{flavour:"billing",color:"textLite",onOptOutClick:de}),re&&(0,f.jsx)(pa.A,{onDecline:ce,onCancellingEnd:()=>{}})]})]})]})]}),(q||z)&&(0,f.jsx)(va,{title:T,onConfirm:K,onClose:()=>{H(),U({})}}),"homelab"==_.type?(0,f.jsx)(Qa,{onConfirm:te,onDecline:()=>U({})}):null,ie&&(0,f.jsx)(ae,{title:T,onClose:()=>{H(),oe()},prices:a,currentPlan:c,showProrations:ne,...ne?{modalHeader:"Update plan"}:{},children:(0,f.jsx)(Za,{slug:t,prices:a,currentPlan:c,title:T,version:n,inModal:!0})})]})},rs=e=>{let{plans:t,isSmall:n,currentPlan:a,showAllPlans:s,showTeaserDetails:l,...i}=e;return(0,f.jsx)(f.Fragment,{children:wa.tD.map((e=>(Object.entries(t[e]||{})||[]).map((t=>{let[o,r]=t;return(0,f.jsx)(os,{slug:e,version:o,prices:r,isActive:a.slug==e&&a.version==o,isSmall:n,currentPlan:a,showAllPlans:s,showTeaserDetails:l,...i},`${e}-${o}`)}))))})},ds=e=>{let{isSmall:t,plans:n,currentPlan:a,showAllPlans:s=!1,showTeaserDetails:l=!1}=e;const{version:i}=(0,ls.A)(),o=(n.free?.[a?.version]||n.free?.[i])?.[0];return(0,f.jsxs)(d.Flex,{gap:6,children:[(0,f.jsx)(os,{slug:"free",version:o?.version,prices:o?.prices,isSmall:t,isActive:"free"===a.slug&&a.version==o?.version,currentPlan:a,showAllPlans:s,showTeaserDetails:l,...s?{background:"panelBg"}:{}}),(0,f.jsx)(rs,{plans:n,isSmall:t,currentPlan:a,showAllPlans:s,showTeaserDetails:l,...s?{background:"panelBg"}:{}})]})},cs=e=>{let{children:t,...n}=e;return(0,f.jsx)(d.Flex,{alignItems:"center",gap:2,...n,children:t})},us=()=>(0,f.jsxs)(d.Flex,{column:!0,gap:2,width:65,children:[(0,f.jsxs)(d.TextMicro,{children:[(0,f.jsx)(d.TextMicro,{strong:!0,children:"Available credit"})," for you to use on any plan subscriptions with us."]}),(0,f.jsx)(d.TextMicro,{children:"It is ok to change your mind, we will give you full flexibility! You can change the plan level, billing frequency or committed nodes, we won't hold you to any choice. When applicable, we'll credit you back on any unused amount."})]}),ms=(0,We.A)(ge.A),hs=e=>{let{currentPlan:t}=e;const[n,a]=(0,Nn.Qh)(),l=!!t.billingEmail&&!a,i=(0,g.JT)("billing:ReadAll"),o=t?.marketplaceUrl,r="AWS"==t?.paymentProvider,c=(0,s.useCallback)((()=>{o&&(location.href=o)}),[o]);return(0,f.jsxs)(d.Flex,{column:!0,gap:2,children:[(0,f.jsx)(d.H3,{children:"Plan & Billing"}),i&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(cs,{children:[r?null:(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(d.Flex,{gap:1,alignItems:"center",children:[(0,f.jsx)(d.Text,{children:"Credit:"}),(0,f.jsx)(d.Text,{"data-testid":"billingHeader-credits",strong:!0,children:aa.format(t.balance.amount||0)}),(0,f.jsx)(Oe.A,{content:us,align:"bottom",isBasic:!0,children:(0,f.jsx)(d.Icon,{name:"information",width:"16px",height:"16px",color:"textLite"})})]}),(0,f.jsx)(_n,{})]}),(0,f.jsxs)(d.Text,{children:["Billing email:"," ",(0,f.jsx)(d.Text,{strong:!0,"data-testid":"billingHeader-email",children:t.billingEmail||"-"})]}),(0,f.jsx)(_n,{}),o?(0,f.jsxs)(ms,{Component:d.Flex,cursor:"pointer",onClick:c,alignItems:"center",gap:1,tooltip:"Manage your subscription on the AWS Marketplace","data-ga":"billing-options::click::billing","data-testid":"billingHeader-goToMarketplace",children:[(0,f.jsx)("span",{children:"Manage your Subscription"}),(0,f.jsx)(d.Icon,{name:"nav_arrow_goto",width:"12px",height:"12px"})]}):(0,f.jsxs)(ge.A,{Component:d.Flex,cursor:l?"pointer":"default",disabled:!l,onClick:n,alignItems:"center",gap:1,"data-ga":"billing-options::click::billing","data-testid":"billingHeader-goToPortal",children:[(0,f.jsx)("span",{children:"Billing options and Invoices"}),(0,f.jsx)(d.Icon,{name:"nav_arrow_goto",width:"12px",height:"12px"})]})]}),(0,f.jsx)(_n,{height:1,width:"100%",sx:{borderWidth:"1px 0px 0px 0px",borderColor:"borderSecondary",borderStyle:"solid"}})]})]})};a(78898);var gs=a(43329),xs=a(52365);function ps(e){const t=(0,xs.A)(e?.in),n=(0,gs.w)(e?.in,0);return n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()-1),n.setHours(23,59,59,999),n}var bs=a(6463),js=a(69821),fs=a(60125);function Cs(e,t,n){const{years:a=0,months:s=0,weeks:l=0,days:i=0,hours:o=0,minutes:r=0,seconds:d=0}=t,c=(0,fs.a)(e,s+12*a,n),u=(0,js.e)(c,i+7*l,n),m=1e3*(d+60*(r+60*o));return(0,gs.w)(n?.in||e,+u-m)}var ys=a(63537),vs=a(66118),ws=a(5638),Ts=a(44731),Ss=a(46123),As=a(38743),Is=a(42790),ks=a(47809);const Fs={nodes:1,p90:2,committed_nodes:3},Ps={"Daily count":"The weighted 90th percentile of the live node count during the day, taking time as the weight. If you have 30 live nodes throughout the day, except for a two hour peak of 44 live nodes, the daily value is 31.","Committed nodes":"The number of nodes committed to in the yearly plan. In case the period count is higher than the number of committed nodes, the difference is billed as overage.","Period count":"The 90th percentile of the daily counts for this period up to the date. The last value for the period is used as the number of nodes for the bill for that period."};vs.t1.register(vs.kc,vs.PP,vs.E8,vs.FN,vs.No,vs.s$,vs.m_,vs.ZT,vs.A6,ws.A),vs.m_.positioners.follow=function(e,t){return!e?.length||t.y>360?(this._resolveAnimations().update(this,{opacity:0}),!1):(0===this.opacity&&this._resolveAnimations().update(this,{opacity:1}),{x:t.x,y:t.y})};const Ms=e=>({nodes:{label:"Daily count",type:"bar",color:(0,d.getColor)("text")({theme:e}),backgroundColor:(0,d.getColor)("primary")({theme:e}),borderColor:(0,d.getColor)("primary")({theme:e}),borderWidth:2,pointStyle:"rectangle",usePointStyle:!0},p90:{label:"Period count",type:"line",color:(0,d.getColor)("text")({theme:e}),borderColor:(0,d.getColor)(["purple","lilac"])({theme:e}),borderWidth:2,fill:!1,stepped:!0},committed_nodes:{label:"Committed nodes",type:"line",color:(0,d.getColor)("text")({theme:e}),borderColor:(0,d.getColor)(["blue","aquamarine"])({theme:e}),borderWidth:2,fill:!1,borderDash:[1,2],borderDashOffset:1,pointStyle:!1}}),$s={border:{side:"all",color:"inputBorder",padding:[3]},round:!0},Ls=ps(),Rs=(0,bs.o)(Cs(Ls,{months:1})),Ns=e=>{let{onNodesLastPeriodFetch:t}=e;const n=(0,Is.rW)("offset"),a=(0,i.vt)(),[l,o]=(0,s.useState)((()=>({start:Rs,end:Ls}))),[c,u,m]=(0,ot.A)((()=>({enabled:!!a&&!!l.start&&!!l.end,fetch:()=>(0,ks.U2)(a,{after:Math.floor((0,ys.W)((0,Ua.ii)(l.start,n))/1e3),before:Math.floor((0,ys.W)((0,Ua.ii)(l.end,n))/1e3)}),initialValue:{labels:[],data:[]},onSuccess:e=>{let{data:n,labels:a}=e;if(!n.length)return;const s=n.at(-1),l=s[a.indexOf("nodes")],i=s[a.indexOf("timestamp")];t((e=>e.timestamp>i?e:{timestamp:i,value:l}))}})),[a,l,t]),h=(0,s.useContext)(r.ThemeContext),g=(0,s.useMemo)((()=>{const e=c.data.map((e=>{let[t]=e;return t})),t=c.labels.reduce(((t,n,a)=>a?[{...Ms(h)[n],data:e.map(((e,t)=>c.data[t][a])),order:Fs[n]},...t]:t),[]);return{labels:e,datasets:t}}),[c]),[x,p]=function(e){let{data:t,annotations:n=[]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{localeDateString:a}=(0,Ua.$j)(),l=(0,s.useRef)(!1),i=(0,s.useRef)(),o=(0,s.useMemo)((()=>({interaction:{axis:"x"},plugins:{legend:{position:"bottom",align:"start",onClick:(e,t,n)=>{const a=n.legendItems.findIndex((e=>e.text===t.text));n.chart.isDatasetVisible(a)?n.chart.hide(a):n.chart.show(a)},labels:{generateLabels:e=>e.data.datasets.map(((t,n)=>({fontColor:t.color,text:t.label,fillStyle:t.backgroundColor,strokeStyle:t.borderColor,pointStyle:"Daily count"===t.label?"rect":"line",hidden:!e.isDatasetVisible(n),order:t.order}))).sort(((e,t)=>e.order-t.order)),usePointStyle:!0},onHover:function(e,t){!l.current&&i.current&&(l.current=!0,i.current.innerHTML=Ps[t.text],i.current.style.left=e.x+"px",i.current.style.top=e.y+"px",i.current.style.visibility="visible",i.current.style.transform="translateY(-100%)")},onLeave:function(){i.current&&(l.current=!1,i.current.innerHTML="",i.current.style.visibility="hidden")}},tooltip:{enabled:!0,mode:"nearest",intersect:!1,yAlign:"bottom",usePointStyle:!0,position:"follow",backgroundColor:(0,d.getColor)("tooltip")({theme:e}),color:(0,d.getColor)("tooltipText")({theme:e}),callbacks:{title:e=>{const[t]=e;return t?a(1e3*t.label,{month:"2-digit",day:"2-digit",year:"numeric",long:!1,dateStyle:void 0}):""},labelPointStyle:e=>({pointStyle:"Total Nodes"===e.dataset.label?"rect":"line"}),label:e=>`  ${e.formattedValue} ${e.dataset.label||""}`}},annotation:{annotations:n.reduce(((n,a,s)=>({...n,[`annotation${s}`]:{type:"line",value:t.findIndex((e=>e[0]===a.timestamp)),borderColor:(0,d.getRgbColor)("attention",.3)({theme:e}),borderDashOffset:0,borderWidth:10,drawTime:"afterDatasetsDraw",label:{drawTime:"afterDatasetsDraw",display:!1,backgroundColor:(0,d.getRgbColor)("attention",.8)({theme:e}),borderWidth:0,color:"white",content:a.name,textAlign:"center"},scaleID:"x",enter(e,t){const n=e.chart,a=n.options.plugins.annotation.annotations[`annotation${s}`];a.label.display=!0,a.label.position=t.y/e.chart.chartArea.height>.5?"start":"end",n.update()},leave(e){const t=e.chart;t.options.plugins.annotation.annotations[`annotation${s}`].label.display=!1,t.update()}}})),{})}},responsive:!0,maintainAspectRatio:!1,scales:{x:{ticks:{callback:function(e){return a(1e3*this.getLabelForValue(e),{month:"2-digit",day:"2-digit",year:"numeric",long:!1,dateStyle:void 0})},color:(0,d.getColor)("textLite")({theme:e})}},y:{beginAtZero:!0,ticks:{color:(0,d.getColor)("textLite")({theme:e})}}}})),[e,t]);return[o,i]}(h,c);return(0,f.jsxs)(d.Flex,{column:!0,gap:4,children:[(0,f.jsxs)(d.Flex,{alignItems:"center",justifyContent:"between",children:[(0,f.jsx)(d.H3,{children:"Usage"}),(0,f.jsx)(Ss.A,{values:l,utc:n,onChange:o,tagging:"billing-usage",isPlaying:!1,onlyDates:!0,accessorProps:$s,padding:[4,0],width:"auto",maxDate:Ls})]}),(0,f.jsxs)(d.Flex,{position:"relative",height:90,children:[u?(0,f.jsx)(st.A,{height:"calculate(100vh-375px)",title:"Loading billing data..."}):m?(0,f.jsx)(As.H4,{title:"Chart couldn't be loaded"}):(0,f.jsx)(Ts.t1,{type:"bar",data:g,options:x}),(0,f.jsx)(d.Flex,{ref:p,background:"main",color:"generic",position:"absolute",round:!0,padding:[3],width:{max:75},sx:{visibility:"hidden"},onMouseOver:()=>p.current.style.visibility="hidden"})]})]})},Ds=e=>{let{isSmall:t,currentPlan:n,loaded:a,currentLoaded:l,plans:i}=e;const[o,r]=(0,s.useState)({timestamp:null,value:null}),d=i[n.slug]?i[n.slug][n.version]:[];return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(hs,{currentPlan:n}),a&&l?(0,f.jsxs)(f.Fragment,{children:[(0,En.Kj)(n.slug)?(0,f.jsx)(ds,{isSmall:t,plans:i,currentPlan:n,showTeaserDetails:!0}):(0,f.jsx)(os,{slug:n.slug,version:n.version,prices:d,width:t?"auto":120,padding:[0],height:"auto",isSmall:t,isActive:!0,currentPlan:n,allPlansView:!0,nodesLastPeriod:o.value}),(0,f.jsx)(_n,{height:1,width:"100%",sx:{borderWidth:"1px 0px 0px 0px",borderColor:"borderSecondary",borderStyle:"solid"}}),(0,f.jsx)(Ns,{onNodesLastPeriodFetch:r})]}):(0,f.jsx)(Dn.Jr,{})]})};var Bs=a(41514);const _s={year:"Yearly",month:"Monthly"},Us=e=>{let{currentPlan:t}=e;const n=(0,i.bq)(),[a,s]=(0,Nn.Qh)(),{cancelling:o,startCancelling:r,stopCancelling:c}=(0,Nn.og)(),u=!!t.billingEmail&&!s,[m,h]=(0,p.A)(),[x,b]=(0,me.A)(),j=(0,Nn.M4)(),{title:C}=wa.FJ[t.slug]||wa.FJ.free,{id:y}=(0,ls.A)(),v=(0,g.JT)("billing:Manage"),w=(0,g.JT)("billing:ReadAll"),{title:T}=wa.FJ[t?.slug]||wa.FJ.free,S=_s[t?.interval];return(0,f.jsxs)(d.Flex,{column:!0,gap:2,children:[(0,f.jsxs)(d.Flex,{gap:2,alignItems:"center",children:[(0,f.jsx)(ge.A,{as:l.N_,to:`/spaces/${n}/settings/billing`,disabled:o,color:"text",hoverColor:"textLite",showToolTip:!0,content:"Back to Plan & Billing",align:"bottom",isBasic:!0,children:(0,f.jsx)(d.Icon,{name:"arrow_left",width:"20px",height:"20px",margin:[1.5,0,0]})}),(0,f.jsx)(d.H3,{children:"All Plans"})]}),(0,f.jsxs)(cs,{children:[(0,f.jsxs)(d.Flex,{gap:1,alignItems:"center",children:[(0,f.jsx)(d.Text,{children:"Active plan:"}),(0,f.jsx)(d.Text,{strong:!0,children:T})]}),(0,f.jsx)(_n,{}),S&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(d.Flex,{gap:1,alignItems:"center",children:[(0,f.jsx)(d.Text,{children:"Billing frequency:"}),(0,f.jsx)(d.Text,{strong:!0,children:S})]}),(0,f.jsx)(_n,{})]}),t.commitment?(0,f.jsxs)(d.Flex,{gap:1,alignItems:"center",children:[(0,f.jsx)(d.Text,{children:"Committed Nodes:"}),(0,f.jsx)(d.Text,{strong:!0,children:t?.committedNodes||0})]}):null,(0,f.jsx)(_n,{}),w&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(d.Flex,{gap:1,alignItems:"center",children:[(0,f.jsx)(d.Text,{children:"Credit:"}),(0,f.jsx)(d.Text,{strong:!0,children:aa.format(t?.balance?.amount||0)}),(0,f.jsx)(Oe.A,{content:us,align:"bottom",isBasic:!0,children:(0,f.jsx)(d.Icon,{name:"information",width:"16px",height:"16px",color:"textLite"})})]}),(0,f.jsx)(_n,{}),(0,f.jsxs)(d.Flex,{gap:1,alignItems:"center",children:[(0,f.jsx)(d.Text,{children:"Billing email:"}),(0,f.jsx)(d.Text,{strong:!0,children:t?.billingEmail||"-"})]}),(0,f.jsx)(_n,{})]}),(0,f.jsxs)(ge.A,{Component:d.Flex,cursor:u?"pointer":"default",disabled:!u,onClick:a,alignItems:"center",gap:1,children:[(0,f.jsx)("span",{children:"Billing options and Invoices"}),(0,f.jsx)(d.Icon,{name:"nav_arrow_goto",width:"12px",height:"12px"})]}),!(0,En.Kj)(t?.slug)&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(_n,{}),(0,f.jsx)(ge.A,{Component:d.Flex,cursor:"pointer",onClick:h,alignItems:"center",gap:1,disabled:o||!v,"data-ga":"cancel-plan::click::billing",children:(0,f.jsx)(d.Text,{textDecoration:"underline",children:o?"Canceling plan...":"Cancel plan"})})]})]}),(0,f.jsx)(_n,{height:1,width:"100%",sx:{borderWidth:"1px 0px 0px 0px",borderColor:"borderSecondary",borderStyle:"solid"}}),m&&(0,f.jsx)(va,{title:"Community",onConfirm:()=>{r(),j({productId:y}).then((()=>((0,Bs.H)("billing","cancel-plan","global-view",{slug:t?.slug,interval:t?.interval,success:!0}),x({header:"Successfully requested subscription cancellation",text:"When your current subscription expires you will be moved to the Community Plan"})))).catch((()=>((0,Bs.H)("billing","cancel-plan","global-view",{slug:t?.slug,interval:t?.interval,success:!1}),b({header:"Failed to cancel the subscription",text:`Remained on ${C} plan`})))).finally((()=>{c()}))},onClose:h})]})},Es=e=>{let{plans:t,currentPlan:n}=e;const{sendButtonClickedLog:a}=(0,Ie.A)(),{version:l}=(0,ls.s)(),i=t[wa.VH.homelab]?.[l],o=(0,s.useCallback)((()=>{window.open("https://www.netdata.cloud/request-enterprise/","_blank","noopener,noreferrer"),a({feature:"OnPremContact"})}),[a]),r=(0,s.useCallback)((()=>{window.open("https://www.netdata.cloud/pricing/","_blank","noopener,noreferrer"),a({feature:"OnPlanComparison"})}),[a]);return(0,f.jsxs)(d.Flex,{column:!0,gap:2,alignItems:"center",children:[(0,f.jsxs)(d.Text,{children:["Check our"," ",(0,f.jsx)(os,{asAnchor:!0,anchorText:"Homelab Plan",slug:wa.VH.homelab,plans:t,version:l,prices:i,currentPlan:n})," ","for home-based projects and our ",(0,f.jsx)(ge.A,{onClick:o,children:"On-prem Plan"})," for full onsite deployment!"]}),(0,f.jsx)(ge.A,{onClick:r,children:"Check the full plan comparison on our website."})]})};var Vs=a(29022);const Hs=()=>(0,f.jsx)(Vs.A,{title:"No access",children:(0,f.jsx)(d.Text,{children:"You don't have permissions to view this page."})}),Os=e=>{let{plans:t,plansLoaded:n,currentPlan:a}=e;const{isReseller:s}=ts();return s?(0,f.jsx)(Hs,{}):n?(0,f.jsxs)(d.Flex,{column:!0,gap:8,height:"100%",overflow:{vertical:"auto"},children:[(0,f.jsx)(Us,{currentPlan:a}),(0,f.jsxs)(d.Flex,{column:!0,gap:8,alignItems:"center",children:[(0,f.jsx)(ds,{plans:t,currentPlan:a,showAllPlans:!0,showTeaserDetails:!0}),(0,f.jsx)(Es,{plans:t,currentPlan:a})]})]}):(0,f.jsx)(Dn.Jr,{})},Ws={month:"Monthly",year:"Yearly"},Ys=()=>{const[e,t]=(0,l.ok)(),[n,a]=(0,me.A)(),{activate:i}=(0,Ia.H)();(0,s.useEffect)((()=>{const s=e.get("from"),l=e.get("from_committed_nodes"),o=e.get("interval"),r=e.get("result"),d=e.get("to"),c=e.get("to_committed_nodes"),u=e.get("from_trial"),m=(0,En.JR)(s,d);if(r){const h="success"==r,g={from:s,fromNodes:l,interval:o,to:d,toNodes:c,fromTrial:u,success:h};(h?n:a)((e=>{let{from:t,to:n,fromNodes:a,toNodes:s,interval:l,fromTrial:i,success:o=!0}=e;if(i)return{header:o?"Successful upgrade":"Failed to upgrade",text:o?"You have successfully upgraded your plan":"Something went wrong"};const r=Ws[l]||l;if(t===n&&a===s)return{header:o?"Successful billing cycle change":"Failed to update billing cycle",text:o?`Subscription billing cycle changed to ${r}`:`Subscription is still on ${r} billing cycle`};if(t===n)return{header:o?"Successful change of commitment":"Failed to change the commitment",text:o?`Commitment ${a<s?"increased":"decreased"} from ${a} to ${s} nodes`:`Commitment remained the same, ${a} nodes`};const d=!(0,En.JR)(t,n);return{header:o?`Successfully ${d?"downgraded":"upgraded"} plan`:`Failed to ${d?"downgrade":"upgrade"} plan`,text:o?`Subsrciprion ${d?"downgraded":"upgraded"} from ${t} to ${n} plan (${r})`:`Remained on ${t} plan`}})(g)),(0,Bs.H)("billing","callback","global-view",g),m&&i(),e&&(e.delete("from"),e.delete("from_committed_nodes"),e.delete("interval"),e.delete("result"),e.delete("to"),e.delete("to_committed_nodes"),e.delete("from_trial"),t(e))}}),[e,n,a,i])},qs=()=>{const[e]=(0,Ne.Ay)();return(0,f.jsx)(l.C5,{replace:!0,to:`/spaces/${e}`})},zs=()=>{Ys();const{loaded:e,value:t}=(0,Nn.lU)(),{loaded:n,value:a}=(0,Nn.JN)(),s="AWS"==a?.paymentProvider,i=(0,Rn.J)();return(0,f.jsx)($.Ay,{feature:"Billing",children:(0,f.jsx)(d.Flex,{column:!0,height:"calc(100% - 30px)",gap:3,children:(0,f.jsxs)(l.BV,{children:[(0,f.jsx)(l.qh,{path:"/all-plans",element:s?(0,f.jsx)(qs,{}):(0,f.jsx)(Os,{plans:t,plansLoaded:e,currentPlan:a})}),(0,f.jsx)(l.qh,{path:"/",element:(0,f.jsx)(Ds,{isSmall:i,currentPlan:a,loaded:e,currentLoaded:n,plans:t})})]})})})};var Js=a(14815),Gs=a(4204);const Ks=(0,o.A)((()=>Promise.all([a.e(8791),a.e(3185)]).then(a.bind(a,53185)))),Zs=(0,o.A)((()=>Promise.all([a.e(7167),a.e(7044)]).then(a.bind(a,97044)))),Qs=(0,r.default)(c.t).withConfig({displayName:"manageWorkspace__ColumnHeader",componentId:"sc-1q2o0yg-0"})(["width:180px;padding:16px;"]),Xs=e=>t=>(0,f.jsx)(s.Suspense,{fallback:(0,f.jsx)(Dn.aW,{}),children:(0,f.jsx)(e,{...t})}),el=e=>t=>(0,f.jsx)(u.Yv,{flex:"1",overflow:"hidden",children:(0,f.jsx)(e,{...t})}),tl=e=>t=>{let{containerProps:n={},...a}=t;return(0,f.jsx)(u.Yv,{flex:"1",overflow:"hidden",height:"100%",padding:[4,0,0],...n,children:(0,f.jsx)(e,{...a})})},nl=el(Mn),al=el(_e),sl=el(vt),ll=tl(bt),il=tl(mn),ol=el(zs),rl=tl(Xs(Ks)),dl=el(Xs(Zs)),cl=(0,s.memo)((()=>{const e=(0,l.Zp)(),{state:t={},pathname:n}=(0,l.zy)(),{settingsTab:a,...o}=(0,l.g)(),[r]=(0,s.useState)(t?.previousUrlPath||null),c=(0,i.ap)("name"),h=(0,i.ap)("id"),x=(e=>{const t=B.IV.indexOf(e);return-1!==t?t:B.Wk})(a),p=(0,s.useCallback)((t=>{const a=((e,t)=>{const n=e.split("/"),a=n.indexOf("settings")+1-n.length;return`${n.slice(0,a).join("/")}/${B.IV[t]||B.Wk}`})(n,t);e(a)}),[a]);(0,s.useEffect)((()=>{B.ys[a]||e((0,l.tW)(n,{...o,settingsTab:B.Wk}))}),[]);const b=(0,g.JT)("billing:ReadBasic"),j=(0,g.JT)("room:ReadAll"),C=(0,g.JT)("user:ReadAll"),y=(0,g.JT)("channel:ReadAll"),v=(0,S.At)(),w=(0,Ee.ES)(h);(0,s.useEffect)((()=>{b||a===B.bO&&e((0,l.tW)(n,{...o,settingsTab:B.Wk}))}),[b,a]);const T=(0,i.bq)(),A=(0,s.useCallback)((t=>{e(t?`/spaces/${t}`:r||`/spaces/${T}`)}),[r,T]);return c?(0,f.jsx)($.Ay,{feature:"SpaceSettings",children:(0,f.jsxs)(u.GO,{full:!0,"data-testid":"manageWorkspaceModal",closeOnClickOutside:!1,closeOnEsc:!1,onClose:A,width:"100%",children:[(0,f.jsx)(m.z,{"data-testid":"manageWorkspaceModal-header",onClose:A,title:(0,f.jsx)(Ln,{})}),(0,f.jsxs)(d.Tabs,{row:!0,column:!1,"data-testid":"manageWorkspaceModal-tabs",selected:x,onChange:p,TabsHeader:Qs,tabsProps:{column:!0},height:"100%",noDefaultBorder:!0,position:"relative",overflow:"hidden",width:"100%",children:[w?null:(0,f.jsx)(d.Tab,{basis:0,"data-testid":"manageWorkspaceModal-spaceTab",label:B.ys[B.mm],"data-ga":"manage-space::click-tab::space-tab",isMenuItem:!0,children:(0,f.jsx)(nl,{"data-testid":"manageWorkspaceModal-spaceTabContent",onClose:A,small:!0})}),!w&&j?(0,f.jsx)(d.Tab,{basis:0,"data-testid":"manageWorkspaceModal-warRoomsTab","data-ga":"manage-space::click-tab::rooms-tab",label:"Rooms",isMenuItem:!0,children:(0,f.jsx)(al,{"data-testid":"manageWorkspaceModal-warRoomsTabContent"})}):null,j||v?(0,f.jsx)(d.Tab,{basis:0,label:"Nodes","data-testid":"manageWorkspaceModal-nodesTab","data-ga":"manage-space::click-tab::nodes-tab",isMenuItem:!0,children:(0,f.jsx)(sl,{"data-testid":"manageWorkspaceModal-nodesTabContent"})}):null,!w&&C?(0,f.jsx)(d.Tab,{basis:0,"data-testid":"manageWorkspaceModal-usersTab","data-ga":"manage-space::click-tab::users-tab",label:"User Management",isMenuItem:!0,children:(0,f.jsx)(ll,{"data-testid":"manageWorkspaceModal-usersTabContent"})}):null,!w&&y?(0,f.jsx)(d.Tab,{basis:0,label:"Alerts & Notifications","data-testid":"manageWorkspaceModal-notificationsTab","data-ga":"manage-space::click-tab::notifications-tab",isMenuItem:!0,children:(0,f.jsx)(il,{})}):null,w||!b||Gs.ei?null:(0,f.jsx)(d.Tab,{basis:0,"data-testid":"manageWorkspaceModal-billingTab","data-ga":"manage-space::click-tab::billing-tab",label:"Plan & Billing",isMenuItem:!0,children:(0,f.jsx)(ol,{"data-testid":"manageWorkspaceModal-billingTabContent"})}),!w&&j?(0,f.jsx)(d.Tab,{basis:0,"data-testid":"manageWorkspaceModal-integrationsTab","data-ga":"manage-space::click-tab::integrations-tab",label:"Integrations",isMenuItem:!0,children:(0,f.jsx)(rl,{flavour:Js.D_.settingsPage,containerProps:{padding:[0]},"data-testid":"manageWorkspaceModal-integrationsTabContent"})}):null,(0,f.jsx)(d.Tab,{basis:0,"data-testid":"manageWorkspaceModal-configurationsTab","data-ga":"manage-space::click-tab::configurations-tab",label:B.ys[B.$d],isMenuItem:!0,children:(0,f.jsx)(dl,{})})]})]})}):null})),ul=()=>{const e=(0,i.ap)("id"),t=(0,Ee.ES)(e)?"virtual":"default",n=B.DT[t],{pathname:a,state:s}=(0,l.zy)();return(0,f.jsxs)(l.BV,{children:[(0,f.jsx)(l.qh,{path:"/",element:(0,f.jsx)(l.C5,{state:s,to:{pathname:`${a}/${n}`}})}),(0,f.jsx)(l.qh,{path:":settingsTab/*",element:(0,f.jsx)(cl,{})})]})}},10853:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});n(98992),n(72577);var a=n(96540),s=n(46587),l=n(99728),i=n(24285),o=n(86706),r=(n(37550),n(32370)),d=n(73087),c=n(68399);var u=n(18739),m=n(53142),h=n(18387),g=n(19707);const x=e=>{const t=new Date(e||void 0).toLocaleDateString();return"Invalid Date"!==t?t:null},p=()=>{const e=(0,o.gk)(),t=(0,o.bj)(),{id:n,isAnonymous:p}=(0,s.uW)(),b=(0,a.useMemo)((()=>!!(t||[]).find((e=>e.id===n&&"creator"===e.joinMethod))),[n,t]),j=(0,g.I)(),{loaded:f,value:C,refresh:y}=(0,u.JN)(),{isFailure:v}=(0,m.A)(),{slug:w,trialEndsAt:T,paymentProvider:S}=C||{},A=(0,a.useMemo)((()=>(e=>{if(!e)return null;const t=new Date(e)-new Date;return Math.ceil(t/864e5)})(T)),[T]),I=f&&!!T&&!j,k=(0,l.JT)("billing:Manage"),[F]=(0,i.ng)("trialModalDismissed"),P=e&&b&&k&&(I||v)&&!localStorage.getItem(c.$B)&&!F,[M,$]=(0,a.useState)(localStorage.getItem(c.TB)),[L,R]=(0,a.useState)(),N=(D=A)>8?"default":D>3?"warning":"critical";var D;const B=!p&&k;return(0,a.useEffect)((()=>{const e=((e,t,n,a)=>{if(t<0)return!1;const s=new Date(e||void 0);if(!(0,r.f)(s))return!1;const l=new Date(a||void 0);if(!(0,r.f)(l))return t<=c.w1;const{days:i}=(0,d.F)({start:l,end:s});return n.some((e=>e>=t&&e<i))})(T,A,c.ml,M);R(e)}),[T,A,M]),{trialWelcomeVisible:P,sidebarWarningVisible:I,bannerVisible:L,dismissBanner:()=>{const e=(new Date).toISOString();$(e),localStorage.setItem(c.TB,e)},daysRemaining:A,trialEndsAt:x(T),trialEndsAtRaw:T,type:N,canUpgrade:B,onTrial:I,refreshPlan:y,planIsFreeOrEarlyBird:(0,h.Kj)(w),paymentProvider:S}}},15679:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});n(96540);var a=n(65258),s=n(73613),l=n(74848);const i=(o=e=>{let{value:t,...n}=e;return(0,l.jsx)(a.Pill,{"data-testid":"pill-content",flavour:"neutral",size:"small",...n,children:t})},e=>{let{noTooltip:t,...n}=e;return t?(0,l.jsx)(o,{...n}):(0,l.jsx)(s.A,{content:n.value,children:(0,l.jsx)(a.Box,{children:(0,l.jsx)(o,{...n})})})});var o},27952:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});n(96540);var a=n(83312),s=n(33185),l=n(65258),i=n(79748),o=n(74848);const r=s.default.article.withConfig({displayName:"markdocSchema__StyledArticle",componentId:"sc-c3znqb-0"})(["padding:0;"]),d=(0,s.default)(l.Text).attrs((e=>({color:"main",fontSize:"14px",...e}))).withConfig({displayName:"markdocSchema__StyledText",componentId:"sc-c3znqb-1"})([""]),c=(0,s.default)(i.A).attrs((e=>({color:"main",fontSize:"14px",...e}))).withConfig({displayName:"markdocSchema__StyledAnchor",componentId:"sc-c3znqb-2"})(["&:hover{color:"," !important;}"],(0,l.getColor)("main")),u={document:{render:r},paragraph:{render:e=>{let{children:t,...n}=e;return(0,o.jsx)(l.Flex,{padding:[1,0],...n,children:(0,o.jsx)(d,{children:t})})}},link:{render:e=>{let{children:t,href:n,...a}=e;return(0,o.jsx)(c,{href:n,rel:"noopener noreferrer",target:"_blank",...a,children:t})},attributes:{href:{type:String}}},strong:{render:e=>{let{children:t,...n}=e;return(0,o.jsx)(d,{strong:!0,fontSize:"14px",...n,children:t})}}},m=e=>{let{children:t}=e;return(0,o.jsx)(a.A,{config:{nodes:u},children:t})}},36229:(e,t,n)=>{"use strict";n.d(t,{A:()=>g});n(98992),n(54520),n(81454);var a=n(33185),s=n(68090),l=n.n(s),i=n(96540),o=n(65258),r=n(41395),d=n(74848);const c=(0,a.default)(o.Box).withConfig({displayName:"breadcrumbs__StyledItemContainer",componentId:"sc-3u39st-0"})([""]),u=(0,a.css)(["&:hover{color:",";}"],(e=>{let{withHover:t,theme:n}=e;return t&&(0,o.getColor)("success")({theme:n})})),m=(0,a.default)(o.Text).withConfig({displayName:"breadcrumbs__StyledText",componentId:"sc-3u39st-1"})(["",""],u),h=(0,a.default)(o.TextSmall).withConfig({displayName:"breadcrumbs__StyledTextSmall",componentId:"sc-3u39st-2"})(["",""],u),g=e=>{let{items:t,isBig:n,showBackButton:a=!0,testid:s="",...u}=e;const g=(0,i.useMemo)((()=>{if(!t?.length||!a)return null;return l()(t.filter((e=>{let{onClick:t}=e;return!!t}))).onClick}),[t,a]);if(!t?.length)return null;const x=n?m:h;return(0,d.jsxs)(o.Flex,{gap:4,...u,children:[a&&(0,d.jsx)(o.Button,{onClick:g,icon:"chevron_left",label:"Back",neutral:!0,flavour:"hollow",small:!0,padding:[0,2,0,1],textTransform:"uppercase","data-testid":`${s}-breadcrumbs-backButton`}),(0,d.jsx)(o.Flex,{gap:2,alignItems:"center",children:t.map(((e,t)=>{let{isDisabled:n,name:a,onClick:l}=e;return(0,d.jsx)(c,{alignItems:"center",...l&&{cursor:"pointer",onClick:l},"data-testid":`${s}-breadcrumbs-level-${t}`,children:(0,d.jsxs)(x,{color:n&&"textLite","data-testid":`${s}-breadcrumbs-level-${t}`,withHover:!!l,children:[0!==t&&" / ",(0,r.Zr)(a||"")]})},t)}))})]})}},36348:(t,n,a)=>{"use strict";a.d(n,{A:()=>v});var s=a(96540),l=a(65258),i=a(15920),o=a(46587),r=a(86706),d=(a(98992),a(54520),a(30569)),c=a(84929),u=a(63872),m=a(77389),h=a(99236),g=a(24609),x=a(32874),p=a(15624),b=a(49916);var j=a(64999),f=a(74848);const C="leave-space-dialog",y="leaveSpaceDialog",v=t=>{let{id:n,name:a,onClose:v}=t;const w=(0,i.Zp)(),T=(0,o.uW)("id"),S=(0,r.Gi)(),A=(0,r.i3)(),I=(0,r.pB)(),k=(t=>{const[,n]=(0,u.A)();return(0,d.yF)((0,s.useCallback)((async(a,s,l)=>{let{currentUserId:i,onSuccess:o,onError:d}=l;const u=await a((0,g.nC)("ids")),j=u.filter((e=>t!==e)),f=e=>{s(e,c.Ut)},[C]=j;if(!C)return void n({header:"Spaces",text:h.sh.leave});const{slug:y}=C&&await a((0,p.Ay)(C));s((0,g.nC)("ids"),j),s(x.A,(e=>e.filter((e=>e!==t))));try{await(0,m.XY)(t,[i]),o&&o(y),(0,r.Z8)(f,t),(0,b.Is)(f,t),f((0,p.Ay)(t))}catch(e){s((0,g.nC)("ids"),u),d&&d()}}),[t,n]))})(n),F=(0,j.A)(n),P=(0,s.useCallback)((e=>w(`/spaces/${e}`)),[]),M=1===S.length,$=1===A.length&&I,L=M?{confirmLabel:"Yes, leave","data-ga":`${C}-last-member`,"data-testid":`${y}LastMember`,handleConfirm:()=>F({onSuccess:P}),message:(0,f.jsxs)(f.Fragment,{children:["If you leave, space ",(0,f.jsx)("strong",{children:a})," will be deleted immediately.",(0,f.jsx)("br",{}),"Are you sure you want to continue?"]}),title:`Leave and delete ${a} space`}:$?{confirmLabel:"Give rights","data-ga":`${C}-last-admin`,"data-testid":`${y}LastAdmin`,handleConfirm:()=>w("users"),isConfirmPositive:!0,message:(0,f.jsxs)(f.Fragment,{children:["You are the last admin of ",(0,f.jsx)("strong",{children:a})," space. Please give admin rights to another member so you can leave this space."]}),title:`Leave ${a} space`}:{confirmLabel:"Yes, leave","data-ga":C,"data-testid":y,handleConfirm:()=>k({currentUserId:T,onSuccess:P}),message:(0,f.jsxs)(f.Fragment,{children:["You are about to leave ",(0,f.jsx)("strong",{children:a})," space.",(0,f.jsx)("br",{}),"Are you sure you want to continue?"]}),title:`Leave ${a} space`};return(0,f.jsx)(l.ConfirmationDialog,{handleDecline:v,...L})}},37785:(e,t,n)=>{"use strict";n.d(t,{A:()=>r,s:()=>o});var a=n(18739),s=n(18387),l=n(50979);const i=e=>{const{value:t}=(0,a.lU)();if(!t?.[e])return{};const n=Object.keys(t[e]).sort(s.M7)[0];return{id:t[e][n]?t[e][n][0]?.id:null,version:n}},o=()=>i(l.VH.homelab),r=()=>i(l.VH.free)},42711:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var a=n(96540),s=n(63950),l=n.n(s),i=n(65258),o=n(3319),r=n(74848);const d={default:"Or you can opt to downgrade immediately",billing:"Or you can opt to downgrade immediately"},c=e=>{let{flavour:t="default",onOptOutClick:n=l(),...s}=e;const{sendLog:c,isReady:u}=(0,o.A)(),m=(0,a.useCallback)((()=>{n(),c({feature:"TrialOptOut",isStart:!0})}),[u]);return(0,r.jsxs)(i.Text,{...s,children:["After the trial, you'll automatically switch to the free Community plan."," ",(0,r.jsx)(i.Box,{"data-testid":"upgrade-to-business-banner",onClick:m,as:i.Text,cursor:"pointer",textDecoration:"underline",color:"primary",children:d[t]}),"."]})}},43891:(e,t,n)=>{"use strict";n.d(t,{K:()=>l,P:()=>i});var a=n(33185),s=n(65258);const l=a.default.ul.withConfig({displayName:"styled__StyledList",componentId:"sc-z791f1-0"})(["list-style:disc outside none;margin-left:16px;"]),i=(0,a.default)(s.ModalContent).attrs((e=>{let{isMobile:t}=e;return{width:t?{base:"95vw"}:{}}})).withConfig({displayName:"styled__TrialWelcomeModalContent",componentId:"sc-z791f1-1"})([""])},45187:(e,t,n)=>{"use strict";n.d(t,{R:()=>r,H:()=>d});var a=n(34843),s=n(52035);const l=(0,s.eU)(!1),i=(0,s.eU)(!1);var o=n(96540);const r=()=>{const[e,t]=(0,a.fp)(l);return{isInitialized:e,init:(0,o.useCallback)((()=>t(!0)),[t])}},d=()=>{const[e,t]=(0,a.fp)(i);return{isActive:e,activate:(0,o.useCallback)((()=>t(!0)),[t]),deactivate:(0,o.useCallback)((()=>t(!1)),[t])}}},52365:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(43329);function s(e){return(0,a.w)(e,Date.now())}},60266:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(96540),s=n(24609),l=n(10853);var i=n(6304);const o=e=>{const t=new Date(e||void 0).toDateString();return"Invalid Date"!==t?t:null},r=()=>{const e=(0,s.ap)(),t=(0,a.useMemo)((()=>`dismissedBumpedWarningKey_${e?.id}`),[e?.id]),[n,,,r]=(0,i.A)(!localStorage.getItem(t)),{trialEndsAtRaw:d}=(0,l.A)(),c=d&&"EarlybirdAndCommunitySunset"==e?.metadata?.joinTrialCode,u=n&&d&&c,m=c?"EARLYB25":null,h=(0,a.useCallback)((()=>{localStorage.setItem(t,!0),r()}),[r,t]);return{isModalVisible:u,isEarlybirdAndCommunitySunset:c,coupon:m,trialEndsAt:o(d),onClose:h}}},64903:(e,t,n)=>{"use strict";n.d(t,{A:()=>j});var a=n(96540),s=n(65258),l=n(6304);const i=(e,t)=>{const n=e&&!isNaN(parseInt(e))?Math.min(parseInt(e),t):null;return null===n?"":n<10?"0"+n:n.toString()},o=e=>{let{value:t,min:n,max:s,onChange:o}=e;const[r,,d,c]=(0,l.A)(),[u,m]=(0,a.useState)(i(t,s)),[h,g]=(0,a.useState)();return{inputProps:(0,a.useMemo)((()=>r?{type:"number",min:n,max:s}:{type:"text"}),[r,n,s]),renderedValue:u,error:h,onInput:(0,a.useCallback)((e=>{const t=e?.target?.value,n=parseInt(t,10);n>s?g(`Maximum value is ${s}`):g();const a=Math.min(n,s);o(a),m(t)}),[s,o,m,g]),onFocus:d,onBlur:(0,a.useCallback)((e=>{const t=e?.target?.value;c(),m(i(t,s))}),[s,c,m])}},r={hours:99,minutes:59,seconds:59,default:59},d={hours:0,minutes:0,seconds:0,default:0};var c=n(74891),u=n(74848);const m=(0,c.A)(s.Flex),h=e=>{let{value:t,onChange:n,min:a=d.default,max:l=r.default,inputProps:i={},...c}=e;const{inputProps:h,renderedValue:g,error:x,onInput:p,onFocus:b,onBlur:j}=o({value:t,min:a,max:l,onChange:n});return(0,u.jsx)(m,{tooltip:x,tooltipProps:{align:"bottom"},children:(0,u.jsx)(s.TextInput,{width:{base:20},value:g,onInput:p,onFocus:b,onBlur:j,size:"small",error:x,hideErrorMessage:!0,...i,...h,...c})})},g=e=>{let{value:t,onChange:n,applyOnChange:s}=e;const{hours:l,minutes:i,seconds:o}=(e=>null===e||isNaN(e)?{hours:null,minutes:null,seconds:null}:{hours:Math.floor(e/3600),minutes:Math.floor(e%3600/60),seconds:e%60})(t),[r,d]=(0,a.useState)(l),[c,u]=(0,a.useState)(i),[m,h]=(0,a.useState)(o),g=(0,a.useCallback)((()=>{const e=function(){let{hours:e=0,minutes:t=0,seconds:n=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 60*e*60+60*t+n}({hours:r,minutes:c,seconds:m});n(e)}),[r,c,m,n]);return(0,a.useEffect)((()=>{s&&g()}),[s,r,c,m,g]),{hours:r,minutes:c,seconds:m,onHoursChange:d,onMinutesChange:u,onSecondsChange:h,onApply:g}};var x=n(3203);const p=(0,c.A)(s.Flex),b=(0,x.A)(s.Button),j=e=>{let{testId:t,value:n,onChange:a,applyOnChange:s,minValues:l=d,maxValues:i=r,hideSeconds:o,inputProps:c={},...m}=e;const{disabledTooltip:x,disabled:j,...f}=m,{hours:C,minutes:y,seconds:v,onHoursChange:w,onMinutesChange:T,onSecondsChange:S,onApply:A}=g({value:n,onChange:a,applyOnChange:s});return(0,u.jsxs)(p,{gap:2,alignItems:"end",tooltip:j?x:null,tooltipProps:{align:"bottom"},"data-testid":t,children:[(0,u.jsx)(h,{label:"Hours",value:C,min:l.hours,max:i.hours,onChange:w,disabled:j,inputProps:c,...f}),(0,u.jsx)(h,{label:"Minutes",value:y,min:l.minutes,max:i.minutes,onChange:T,disabled:j,inputProps:c,...f}),o?null:(0,u.jsx)(h,{label:"Seconds",value:v,min:l.seconds,max:i.seconds,onChange:S,disabled:j,inputProps:c,...f}),s?null:(0,u.jsx)(b,{label:"Apply",onClick:A,small:!0,style:{height:"tiny"==m.size?"24px":"28px"},payload:{info:"Apply reachability notifications delay",testId:t},...m})]})}},68399:(e,t,n)=>{"use strict";n.d(t,{$B:()=>o,TB:()=>r,W1:()=>s,ml:()=>l,ue:()=>a,w1:()=>i});const a={default:"successSemi",warning:"warningSemi",critical:"errorSemi"},s={default:{background:"successSemi",border:"success"},warning:{background:"warningSemi",border:"warning"},critical:{background:"errorSemi",border:"error"}},l=[10,3,2,1],i=12,o="dismissedTrialWelcome",r="dismissedTrialWarningDate"},68534:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});n(98992),n(81454);var a=n(24609);const s=()=>{const e=(0,a.ap)(),{warnings:t}=e||{};return{warnings:(t||[]).map((e=>{let{kind:t,text:n,urgency:a}=e;return{warningKey:t,warningLevel:a||"info",text:n}}))}}},71282:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var a=n(96540),s=n(63950),l=n.n(s),i=n(65258),o=n(18739),r=n(63872),d=n(60908),c=n(3203),u=n(3319),m=n(6304),h=n(37785),g=n(74848);const x=(0,c.A)(i.Button),p=e=>{let{onConfirm:t,onDecline:n=l(),onCancellingEnd:s=l()}=e;const c=(0,o.M4)(),[p,b]=(0,r.A)(),{id:j}=(0,h.A)(),{sendLog:f,isReady:C}=(0,u.A)(),[y,,v,w]=(0,m.A)(),T=(0,a.useCallback)((()=>{v(),c({productId:j}).then((()=>{p({header:"Successfully canceled subscription",text:"You are now on Community plan"}),f({feature:"TrialOptOut",isSuccess:!0})})).catch((()=>{b({header:"Failed to cancel the subscription",text:"Remained on Business plan"}),f({feature:"TrialOptOut",isFailure:!0,error:"Failed to cancel the subscription"})})).finally((()=>{s(),w()}))}),[j,C]),S=(0,a.useCallback)((()=>{t?t():T()}),[t,T]);return(0,g.jsx)(i.Modal,{backdropProps:{backdropBlur:!0},children:(0,g.jsx)(d.Ay,{feature:"TrialOptOut",children:(0,g.jsxs)(i.ModalContent,{width:{base:140},children:[(0,g.jsx)(i.ModalHeader,{children:(0,g.jsx)(i.Flex,{gap:2,alignItems:"center",children:(0,g.jsx)(i.H4,{children:"Opt out of Free Trial"})})}),(0,g.jsx)(i.ModalBody,{children:y?(0,g.jsx)(i.Flex,{height:"100px",children:(0,g.jsx)(i.TextBig,{children:"Changing billing plan..."})}):(0,g.jsxs)(i.Flex,{gap:2,column:!0,children:[(0,g.jsx)(i.H3,{children:"Are You Sure?"}),(0,g.jsx)(i.TextBig,{children:"It looks like you have chosen to opt-out of your free 14-day business trial. Are you sure you do not want to experience all the features Netdata has to offer?"}),(0,g.jsx)(i.TextBig,{children:"By opting out, you will be downgraded to the community plan immediately."})]})}),(0,g.jsx)(i.ModalFooter,{children:(0,g.jsxs)(i.Flex,{justifyContent:"end",gap:4,padding:[1,2],children:[(0,g.jsx)(x,{feature:"TrialOptOut",label:"Yes, I am sure!",flavour:"hollow",small:!0,onClick:S,disabled:!j||y,textTransform:""}),(0,g.jsx)(x,{feature:"TrialOptOut",label:"No, I want the trial!",small:!0,onClick:n,disabled:y,textTransform:""})]})})]})})})}},80320:(e,t,n)=>{"use strict";n.d(t,{A:()=>b});var a=n(96540),s=n(65258),l=n(95263),i=n(74848);const o=e=>{let{"data-testid":t="input",description:n,isRequired:a,onChange:o,title:r,...d}=e;return(0,i.jsxs)(s.Flex,{column:!0,"data-testid":t,flex:"grow",gap:1,children:[(0,i.jsx)(l.A,{"data-testid":t,description:n,isRequired:a,title:r}),(0,i.jsx)(s.TextInput,{"data-testid":`${t}-field`,size:"tiny",onChange:e=>{let{target:t}=e;return o(t.value)},...d})]})};n(98992),n(81454);const r=e=>{let{"data-testid":t="select",description:n,getDataGa:a,fields:o,id:r,isRequired:d,onChange:c,secrets:u,setSecrets:m,title:h,...g}=e;return(0,i.jsxs)(s.Flex,{column:!0,"data-testid":t,flex:"grow",gap:1,children:[(0,i.jsx)(l.A,{"data-testid":t,description:n,isRequired:d,title:h}),(0,i.jsx)(s.Select,{"data-testid":`${t}-field`,menuPortalTarget:document.body,onChange:e=>c(e),styles:{size:"tiny"},menuPlacement:"auto",...g}),Object.values(o?.[g.value?.value]||{}).map((e=>{let{getValue:n,id:s,onChange:l,...o}=e;return(0,i.jsx)(p,{"data-ga":a(`${r}-${s}-${o.component}`),"data-testid":`${t}-${s}`,id:s,onChange:l({id:r,setSecrets:m,subsetId:s}),value:n({id:r,secrets:u,subsetId:s}),...o},s)}))]})};n(8872);var d=n(90179),c=n.n(d),u=n(97200),m=n.n(u),h=n(52838),g=n(98563);const x={default:()=>null,pairs:e=>{let{componentPairs:t,"data-testid":n="pairs",description:o,getDataGa:r,id:d,isRequired:u,placeholder:x,setSecrets:p,title:j}=e;const[f,C]=(0,a.useState)({});(0,a.useEffect)((()=>{const e=Object.values(f).reduce(((e,t)=>{let{key:n,value:a}=t;return n?{...e,[n]:a||""}:e}),{});p((t=>Object.keys(e).length?{...t,[d]:e}:c()(t,d)))}),[f]);return(0,i.jsxs)(s.Flex,{column:!0,"data-testid":n,gap:1,children:[(0,i.jsxs)(s.Flex,{alignItems:"center",justifyContent:"between",children:[(0,i.jsx)(l.A,{"data-testid":n,description:o,isRequired:u,title:j}),t.map((e=>{const a=(0,h.$Q)(e);return(0,i.jsx)(g.ro,{"data-ga":r(`${d}-${a}-add`),"data-testid":`${n}-${a}Add`,label:1===t.length?"Add":`Add ${a}`,onClick:()=>(e=>C((t=>({...t,[m()("pair_")]:{key:"",components:e,value:""}}))))(e)},a)}))]}),Object.entries(f).map((e=>{let[t,{key:a,components:l,value:o}]=e;const[u,m]=l,g=(0,h.$Q)(l);return(0,i.jsxs)(s.Flex,{alignItems:"end",gap:2,children:[(0,i.jsx)(b,{component:u,"data-ga":r(`${d}-${g}-key`),"data-testid":`${n}-${g}Key`,onChange:e=>C((n=>({...n,[t]:{...n[t],key:e}}))),value:a,placeholder:x,title:"Key"}),(0,i.jsx)(b,{component:m,"data-ga":r(`${d}-${g}-value`),"data-testid":`${n}-${g}Value`,onChange:e=>C((n=>({...n,[t]:{...n[t],value:e}}))),value:o,placeholder:x,title:"Value"}),(0,i.jsx)(s.Button,{flavour:"borderless",icon:"trashcan",margin:[0,0,1,0],neutral:!0,onClick:()=>{C((e=>c()(e,t)))}})]},`${g}-${t}`)}))]})},input:o,select:r},p=e=>{let{component:t,...n}=e;const a=x[t]||x.default;return(0,i.jsx)(a,{...n})},b=p},93926:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});n(96540);var a=n(65258),s=n(74848);const l=e=>{let{message:t,title:n,footer:l,...i}=e;const o=i?.["data-testid"]||"functionError";return(0,s.jsxs)(a.Flex,{alignItems:"center",column:!0,"data-testid":o,flex:!0,gap:3,justifyContent:"center",padding:[0,20],...i,children:[(0,s.jsx)(a.H3,{"data-testid":`${o}-title`,children:n}),(0,s.jsx)(a.TextBig,{color:"textDescription","data-testid":`${o}-message`,children:t}),l]})}},95263:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});n(96540);var a=n(65258),s=n(73613),l=n(74848);const i=e=>{let{description:t,isRequired:n,title:i,...o}=e;const r=o["data-testid"]?`${o["data-testid"]}-label`:"fieldLabel";return(0,l.jsxs)(a.Flex,{"data-testid":`${r}-container`,gap:1,children:[(0,l.jsxs)(a.TextSmall,{color:"textLite","data-testid":r,children:[i,n&&" *"]}),t&&(0,l.jsx)(s.A,{align:"top",content:t,"data-testid":`${r}-info`,plain:!0,children:(0,l.jsx)(a.Icon,{color:"textLite",name:"information",size:"small"})})]})}},97200:(e,t,n)=>{var a=n(13222),s=0;e.exports=function(e){var t=++s;return a(e)+t}},98563:(e,t,n)=>{"use strict";n.d(t,{$m:()=>d,He:()=>l,Jg:()=>h,MU:()=>i,Oj:()=>c,W6:()=>r,fn:()=>u,id:()=>m,ro:()=>o});var a=n(33185),s=n(65258);const l=(0,a.default)(s.Flex).attrs({alignItems:"center",color:"text",gap:1,hoverColor:"text"}).withConfig({displayName:"styled__AnchorComponent",componentId:"sc-wc4x41-0"})(["&,&:hover{text-decoration:none;}"]),i=(0,a.default)(s.Icon).attrs({height:"130px",width:"130px"}).withConfig({displayName:"styled__BlurredIcon",componentId:"sc-wc4x41-1"})(["filter:blur(70px);position:absolute;left:0;top:0;opacity:0.5;"]),o=(0,a.default)(s.Button).attrs((e=>({height:"22px",icon:"plus",padding:[.5,2,.5,1],small:!0,width:"auto",flavour:"hollow",...e}))).withConfig({displayName:"styled__IntegrationAction",componentId:"sc-wc4x41-2"})(["&& > span{font-weight:bold;margin-left:4px;}"]),r=(0,a.default)(s.TextSmall).withConfig({displayName:"styled__LearnMoreTest",componentId:"sc-wc4x41-3"})(["position:relative;"]),d=(0,a.default)(s.ModalContent).attrs((e=>({height:{base:"80vh",max:"80vh",min:45},width:{base:121,max:140,min:70},...e}))).withConfig({displayName:"styled__ModalContent",componentId:"sc-wc4x41-4"})(["box-shadow:0 18px 28px rgb(9 30 66 / 15%),0 0 1px rgb(9 30 66 / 31%);"]),c=(0,a.default)(s.ModalCloseButton).attrs({color:"text",height:"16px",width:"16px"}).withConfig({displayName:"styled__ModalClose",componentId:"sc-wc4x41-5"})(["&:hover{fill:",";}"],(0,s.getColor)("selected")),u=(0,a.default)(s.Flex).attrs((e=>{let{hasBorder:t,...n}=e;return{...t?{border:{side:"bottom",color:"disabled"}}:{},column:!0,padding:[3,4],...n}})).withConfig({displayName:"styled__ModalSection",componentId:"sc-wc4x41-6"})([""]),m=(0,a.default)(s.Icon).attrs({name:"warning_triangle",height:"18px",width:"18px",color:["yellow","amber"]}).withConfig({displayName:"styled__WarningIcon",componentId:"sc-wc4x41-7"})(["position:absolute;top:0;right:0;z-index:1;"]),h=(0,a.default)(s.Icon).attrs({height:"12px",width:"12px",color:"white"}).withConfig({displayName:"styled__SystemIcon",componentId:"sc-wc4x41-8"})(["position:relative;top:2px;"])},99243:(e,t,n)=>{"use strict";n.d(t,{PL:()=>o,Te:()=>r,bg:()=>i});var a=n(33185),s=n(65258),l=n(68399);const i=(0,a.default)(s.Flex).attrs({position:"relative"}).withConfig({displayName:"styled__TrialWarningSidebar",componentId:"sc-66x250-0"})(["background-color:",";border-width:1px;border-style:dashed;border-color:",";border-radius:2px;"],(e=>{let{type:t}=e;return(0,s.getColor)(l.W1[t]?.background)}),(e=>{let{type:t}=e;return(0,s.getColor)(l.W1[t]?.border)})),o=(0,a.default)(s.Button).withConfig({displayName:"styled__TrialUpgradeButton",componentId:"sc-66x250-1"})(["flex:auto;"]),r=(0,a.default)(s.Text).attrs({strong:!0,lineHeight:.8}).withConfig({displayName:"styled__PromoText",componentId:"sc-66x250-2"})(["background-color:",";background-image:linear-gradient( 43deg,"," 0%,"," 46%,"," 100% );-webkit-background-clip:text;-webkit-text-fill-color:transparent;"],(0,s.getColor)("primary"),(0,s.getColor)(["blue","aquamarine"]),(0,s.getColor)(["purple","mauve"]),(0,s.getColor)("primary"))}}]);